{
  "openapi": "3.1.0",
  "info": {
    "title": "FastAPI",
    "version": "0.1.0"
  },
  "paths": {
    "/v1/package/{identifier}/releases": {
      "get": {
        "tags": ["default", "MCP"],
        "summary": "Get all releases for a package",
        "description": "Get all releases for a package, with the latest version appearing first",
        "operationId": "get_package_releases",
        "parameters": [
          {
            "name": "identifier",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Package identifier",
              "description": "Package identifier in `<owner>/<package-name>` format"
            },
            "description": "Package identifier in `<owner>/<package-name>` format"
          }
        ],
        "responses": {
          "200": {
            "description": "A list of package releases",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PackageReleases"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/package/{identifier}/releases/{version}": {
      "get": {
        "tags": ["default", "MCP"],
        "summary": "Get a package release",
        "description": "Get information for a single package release, including readme if available.",
        "operationId": "get_package_release",
        "parameters": [
          {
            "name": "identifier",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Package identifier",
              "description": "Package identifier in `<owner>/<package-name>` format"
            },
            "description": "Package identifier in `<owner>/<package-name>` format"
          },
          {
            "name": "version",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Version",
              "description": "Package version in `x.y.z` format",
              "examples": [
                {
                  "value": "0.1.0"
                }
              ]
            },
            "description": "Package version in `x.y.z` format"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HydratedPackageRelease"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/package/{identifier}": {
      "get": {
        "tags": ["default", "MCP"],
        "summary": "Get a package",
        "description": "Get information for a package, including readme if available. Details are sourced from the package's latest release.",
        "operationId": "get_package",
        "parameters": [
          {
            "name": "identifier",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Package identifier",
              "description": "Package identifier in `<owner>/<package-name>` format"
            },
            "description": "Package identifier in `<owner>/<package-name>` format"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HydratedPackage"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/packages": {
      "get": {
        "tags": ["default", "MCP"],
        "summary": "Search for packages",
        "description": "Search for packages by identifier or summary, with closest matches appearing first.",
        "operationId": "query_packages",
        "parameters": [
          {
            "name": "query",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Search query",
              "examples": ["usb", "esp32"],
              "title": "Query"
            },
            "description": "Search query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueryResult"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/packages/popular": {
      "get": {
        "tags": ["default"],
        "summary": "Get popular packages",
        "description": "Get most popular packages",
        "operationId": "get_popular_packages",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueryResult"
                }
              }
            }
          }
        }
      }
    },
    "/v1/packages/recent": {
      "get": {
        "tags": ["default"],
        "summary": "Get recently added packages",
        "description": "Get most recently-updated packages",
        "operationId": "get_recent_packages",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueryResult"
                }
              }
            }
          }
        }
      }
    },
    "/v1/packages/all": {
      "get": {
        "tags": ["default"],
        "summary": "Get all packages",
        "description": "Get all packages in the repository, sorted by name",
        "operationId": "get_all_packages",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueryResult"
                }
              }
            }
          }
        }
      }
    },
    "/v1/publish": {
      "post": {
        "tags": ["default"],
        "summary": "Request a package upload",
        "description": "Request a package upload. Returns a pre-signed URL for uploading package contents.",
        "operationId": "publish_request",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PublishRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublishRequestResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "GithubOIDC": []
          },
          {
            "OpenIdConnect": []
          }
        ]
      }
    },
    "/v1/publish/upload-complete": {
      "post": {
        "tags": ["default"],
        "summary": "Notify of a completed package upload",
        "description": "Notify of a completed package upload. Triggers validation and processing of uploaded package.",
        "operationId": "publish_upload_complete",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UploadCompleteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublishCompletedResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "GithubOIDC": []
          },
          {
            "OpenIdConnect": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "ArtifactInfo": {
        "properties": {
          "filename": {
            "type": "string",
            "title": "Filename"
          },
          "url": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Url"
          },
          "size": {
            "type": "integer",
            "minimum": 0,
            "title": "Size"
          },
          "hashes": {
            "$ref": "#/components/schemas/FileHashes"
          },
          "build_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Build Name"
          }
        },
        "type": "object",
        "required": ["filename", "url", "size", "hashes"],
        "title": "ArtifactInfo"
      },
      "ArtifactsInfo": {
        "properties": {
          "artifacts": {
            "items": {
              "$ref": "#/components/schemas/ArtifactInfo"
            },
            "type": "array",
            "title": "Artifacts"
          }
        },
        "type": "object",
        "title": "ArtifactsInfo"
      },
      "Author": {
        "properties": {
          "name": {
            "type": "string",
            "title": "Name"
          },
          "email": {
            "type": "string",
            "title": "Email"
          }
        },
        "type": "object",
        "required": ["name", "email"],
        "title": "Author"
      },
      "FileHashes": {
        "properties": {
          "sha256": {
            "type": "string",
            "title": "Sha256"
          }
        },
        "type": "object",
        "required": ["sha256"],
        "title": "FileHashes"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HydratedPackage": {
        "properties": {
          "info": {
            "$ref": "#/components/schemas/PackageInfo"
          },
          "readme": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Readme"
          }
        },
        "type": "object",
        "required": ["info"],
        "title": "HydratedPackage"
      },
      "HydratedPackageRelease": {
        "properties": {
          "info": {
            "$ref": "#/components/schemas/PackageReleaseInfo"
          },
          "readme": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Readme"
          }
        },
        "type": "object",
        "required": ["info"],
        "title": "HydratedPackageRelease"
      },
      "LayoutInfo": {
        "properties": {
          "build_name": {
            "type": "string",
            "pattern": "^[a-zA-Z0-9_-]+$",
            "title": "Build Name",
            "examples": ["default", "example"]
          },
          "url": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Url"
          }
        },
        "type": "object",
        "required": ["build_name", "url"],
        "title": "LayoutInfo"
      },
      "LayoutsInfo": {
        "properties": {
          "layouts": {
            "items": {
              "$ref": "#/components/schemas/LayoutInfo"
            },
            "type": "array",
            "title": "Layouts"
          }
        },
        "type": "object",
        "title": "LayoutsInfo"
      },
      "PackageDependencies": {
        "properties": {
          "requires": {
            "items": {
              "$ref": "#/components/schemas/RegistryDependencySpec"
            },
            "type": "array",
            "title": "Requires"
          }
        },
        "type": "object",
        "title": "PackageDependencies"
      },
      "PackageInfo": {
        "properties": {
          "created_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At"
          },
          "released_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Released At"
          },
          "key": {
            "type": "string",
            "format": "uuid4",
            "title": "Key"
          },
          "identifier": {
            "type": "string",
            "title": "Package identifier",
            "description": "Package identifier in `<owner>/<package-name>` format"
          },
          "version": {
            "type": "string",
            "title": "Version",
            "description": "Package version in `x.y.z` format",
            "examples": [
              {
                "value": "0.1.0"
              }
            ]
          },
          "repository": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Repository"
          },
          "authors": {
            "items": {
              "$ref": "#/components/schemas/Author"
            },
            "type": "array",
            "minItems": 1,
            "title": "Authors"
          },
          "license": {
            "type": "string",
            "title": "License"
          },
          "summary": {
            "type": "string",
            "title": "Summary"
          },
          "homepage": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 2083,
                "minLength": 1,
                "format": "uri"
              },
              {
                "type": "null"
              }
            ],
            "title": "Homepage"
          },
          "readme_url": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 2083,
                "minLength": 1,
                "format": "uri"
              },
              {
                "type": "null"
              }
            ],
            "title": "Readme Url"
          },
          "url": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Url"
          },
          "stats": {
            "$ref": "#/components/schemas/PackageStats"
          }
        },
        "type": "object",
        "required": [
          "key",
          "identifier",
          "version",
          "repository",
          "authors",
          "license",
          "summary",
          "url",
          "stats"
        ],
        "title": "PackageInfo"
      },
      "PackageInfoBrief": {
        "properties": {
          "identifier": {
            "type": "string",
            "title": "Package identifier",
            "description": "Package identifier in `<owner>/<package-name>` format"
          },
          "version": {
            "type": "string",
            "title": "Version",
            "description": "Package version in `x.y.z` format",
            "examples": [
              {
                "value": "0.1.0"
              }
            ]
          },
          "summary": {
            "type": "string",
            "title": "Summary"
          },
          "url": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Url"
          },
          "repository": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Repository"
          },
          "homepage": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 2083,
                "minLength": 1,
                "format": "uri"
              },
              {
                "type": "null"
              }
            ],
            "title": "Homepage"
          }
        },
        "type": "object",
        "required": ["identifier", "version", "summary", "url", "repository"],
        "title": "PackageInfoBrief",
        "description": "Package overview for search results."
      },
      "PackageReleaseInfo": {
        "properties": {
          "created_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At"
          },
          "released_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Released At"
          },
          "key": {
            "type": "string",
            "format": "uuid4",
            "title": "Key"
          },
          "identifier": {
            "type": "string",
            "title": "Package identifier",
            "description": "Package identifier in `<owner>/<package-name>` format"
          },
          "version": {
            "type": "string",
            "title": "Version",
            "description": "Package version in `x.y.z` format",
            "examples": [
              {
                "value": "0.1.0"
              }
            ]
          },
          "repository": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Repository"
          },
          "authors": {
            "items": {
              "$ref": "#/components/schemas/Author"
            },
            "type": "array",
            "minItems": 1,
            "title": "Authors"
          },
          "license": {
            "type": "string",
            "title": "License"
          },
          "summary": {
            "type": "string",
            "title": "Summary"
          },
          "homepage": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 2083,
                "minLength": 1,
                "format": "uri"
              },
              {
                "type": "null"
              }
            ],
            "title": "Homepage"
          },
          "readme_url": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 2083,
                "minLength": 1,
                "format": "uri"
              },
              {
                "type": "null"
              }
            ],
            "title": "Readme Url"
          },
          "url": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Url"
          },
          "stats": {
            "$ref": "#/components/schemas/PackageStats"
          },
          "hashes": {
            "$ref": "#/components/schemas/FileHashes"
          },
          "filename": {
            "type": "string",
            "title": "Filename"
          },
          "git_ref": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Git Ref"
          },
          "requires_atopile": {
            "type": "string",
            "pattern": "\n    ^\n    (\\^|>=|<=|>|<|=)?           # Optional operator (^, >=, <=, >, <, =)\n    (\\d+)\\.(\\d+)\\.(\\d+)         # Version number (major.minor.patch)\n    (                           # Optional additional constraint\n        \\s*,\\s*                 # Comma separator with optional whitespace\n        (\\^|>=|<=|>|<|=)?       # Optional operator for second constraint\n        (\\d+)\\.(\\d+)\\.(\\d+)     # Second version number\n    )?\n    $\n    ",
            "title": "Requires Atopile",
            "description": "Version requirement specification. Supported operators: `^`, `>=`, `<=`, `>`, `<`, `=`. Example: `^1.0.0`",
            "examples": [
              {
                "value": "^1.0.0"
              },
              {
                "value": ">=1.0.0"
              },
              {
                "value": "<1.0.0"
              },
              {
                "value": ">=1.0.0,<2.0.0"
              }
            ]
          },
          "size": {
            "type": "integer",
            "exclusiveMinimum": 0,
            "title": "Size"
          },
          "download_url": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Download Url"
          },
          "builds": {
            "anyOf": [
              {
                "items": {
                  "type": "string",
                  "pattern": "^[a-zA-Z0-9_-]+$",
                  "examples": ["default", "example"]
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Builds"
          },
          "dependencies": {
            "$ref": "#/components/schemas/PackageDependencies"
          },
          "artifacts": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ArtifactsInfo"
              },
              {
                "type": "null"
              }
            ]
          },
          "layouts": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/LayoutsInfo"
              },
              {
                "type": "null"
              }
            ]
          },
          "yanked_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Yanked At"
          },
          "yanked_reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Yanked Reason"
          }
        },
        "type": "object",
        "required": [
          "key",
          "identifier",
          "version",
          "repository",
          "authors",
          "license",
          "summary",
          "url",
          "stats",
          "hashes",
          "filename",
          "requires_atopile",
          "size",
          "download_url",
          "dependencies"
        ],
        "title": "PackageReleaseInfo"
      },
      "PackageReleases": {
        "properties": {
          "releases": {
            "items": {
              "$ref": "#/components/schemas/PackageReleaseInfo"
            },
            "type": "array",
            "title": "Releases"
          }
        },
        "type": "object",
        "required": ["releases"],
        "title": "PackageReleases"
      },
      "PackageStats": {
        "properties": {
          "total_downloads": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Total Downloads"
          },
          "this_week_downloads": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "This Week Downloads"
          },
          "this_month_downloads": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "This Month Downloads"
          }
        },
        "type": "object",
        "title": "PackageStats"
      },
      "PresignedUploadInfo": {
        "properties": {
          "url": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Url"
          },
          "fields": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object",
            "title": "Fields"
          }
        },
        "type": "object",
        "required": ["url", "fields"],
        "title": "PresignedUploadInfo"
      },
      "PublishCompletedResponse": {
        "properties": {
          "status": {
            "type": "string",
            "const": "ok",
            "title": "Status",
            "default": "ok"
          },
          "url": {
            "type": "string",
            "maxLength": 2083,
            "minLength": 1,
            "format": "uri",
            "title": "Url"
          }
        },
        "type": "object",
        "required": ["url"],
        "title": "PublishCompletedResponse"
      },
      "PublishRequest": {
        "properties": {
          "identifier": {
            "type": "string",
            "title": "Package identifier",
            "description": "Package identifier in `<owner>/<package-name>` format"
          },
          "package_version": {
            "type": "string",
            "title": "Version",
            "description": "Package version in `x.y.z` format",
            "examples": [
              {
                "value": "0.1.0"
              }
            ]
          },
          "git_ref": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Git Ref"
          },
          "package_size": {
            "type": "integer",
            "exclusiveMinimum": 0,
            "title": "Package Size"
          },
          "artifacts_size": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0
              },
              {
                "type": "null"
              }
            ],
            "title": "Artifacts Size"
          },
          "manifest": {
            "additionalProperties": true,
            "type": "object",
            "title": "Manifest"
          }
        },
        "type": "object",
        "required": [
          "identifier",
          "package_version",
          "package_size",
          "manifest"
        ],
        "title": "PublishRequest"
      },
      "PublishRequestResponse": {
        "properties": {
          "status": {
            "type": "string",
            "const": "ok",
            "title": "Status",
            "default": "ok"
          },
          "release_id": {
            "type": "string",
            "format": "uuid4",
            "title": "Release Id"
          },
          "upload_info": {
            "$ref": "#/components/schemas/PresignedUploadInfo"
          },
          "artifacts_upload_info": {
            "$ref": "#/components/schemas/PresignedUploadInfo"
          }
        },
        "type": "object",
        "required": ["release_id", "upload_info", "artifacts_upload_info"],
        "title": "PublishRequestResponse"
      },
      "QueryResult": {
        "properties": {
          "packages": {
            "items": {
              "$ref": "#/components/schemas/PackageInfoBrief"
            },
            "type": "array",
            "title": "Packages"
          }
        },
        "type": "object",
        "required": ["packages"],
        "title": "QueryResult"
      },
      "RegistryDependencySpec": {
        "properties": {
          "type": {
            "type": "string",
            "const": "registry",
            "title": "Type",
            "default": "registry"
          },
          "identifier": {
            "type": "string",
            "title": "Identifier"
          },
          "release": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Release"
          }
        },
        "type": "object",
        "title": "RegistryDependencySpec"
      },
      "UploadCompleteRequest": {
        "properties": {
          "release_id": {
            "type": "string",
            "format": "uuid4",
            "title": "Release Id"
          }
        },
        "type": "object",
        "required": ["release_id"],
        "title": "UploadCompleteRequest"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": ["loc", "msg", "type"],
        "title": "ValidationError"
      }
    },
    "securitySchemes": {
      "GithubOIDC": {
        "type": "http",
        "scheme": "bearer",
        "model": {
          "type": "openIdConnect",
          "openIdConnectUrl": "https://token.actions.githubusercontent.com/.well-known/openid-configuration"
        },
        "scheme_name": "OpenIdConnect",
        "auto_error": true
      },
      "OpenIdConnect": {
        "type": "openIdConnect",
        "openIdConnectUrl": "https://token.actions.githubusercontent.com/.well-known/openid-configuration"
      }
    }
  }
}
