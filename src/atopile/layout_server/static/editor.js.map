{
  "version": 3,
  "sources": ["../frontend/src/math.ts", "../frontend/src/camera.ts", "../frontend/src/pan-and-zoom.ts", "../frontend/src/webgl/helpers.ts", "../frontend/src/webgl/shaders.ts", "../frontend/node_modules/earcut/src/earcut.js", "../frontend/src/webgl/tessellator.ts", "../frontend/src/webgl/renderer.ts", "../frontend/src/colors.ts", "../frontend/src/painter.ts", "../frontend/src/hit-test.ts", "../frontend/src/editor.ts", "../frontend/src/main.ts"],
  "sourcesContent": ["/** 2D vector */\nexport class Vec2 {\n    x: number;\n    y: number;\n\n    constructor(x: number = 0, y: number = 0) {\n        this.x = x;\n        this.y = y;\n    }\n\n    copy(): Vec2 {\n        return new Vec2(this.x, this.y);\n    }\n\n    *[Symbol.iterator]() {\n        yield this.x;\n        yield this.y;\n    }\n\n    get magnitude(): number {\n        return Math.sqrt(this.x ** 2 + this.y ** 2);\n    }\n\n    get normal(): Vec2 {\n        return new Vec2(-this.y, this.x);\n    }\n\n    normalize(): Vec2 {\n        const l = this.magnitude;\n        if (l === 0) return new Vec2(0, 0);\n        return new Vec2(this.x / l, this.y / l);\n    }\n\n    add(b: Vec2): Vec2 {\n        return new Vec2(this.x + b.x, this.y + b.y);\n    }\n\n    sub(b: Vec2): Vec2 {\n        return new Vec2(this.x - b.x, this.y - b.y);\n    }\n\n    multiply(s: number): Vec2 {\n        return new Vec2(this.x * s, this.y * s);\n    }\n}\n\ntype ElementArray = [number, number, number, number, number, number, number, number, number];\n\n/** 3x3 transformation matrix (column-major) */\nexport class Matrix3 {\n    elements: Float32Array;\n\n    constructor(elements: ElementArray | Float32Array) {\n        this.elements = new Float32Array(elements);\n    }\n\n    static identity(): Matrix3 {\n        return new Matrix3([1, 0, 0, 0, 1, 0, 0, 0, 1]);\n    }\n\n    static orthographic(width: number, height: number): Matrix3 {\n        return new Matrix3([2 / width, 0, 0, 0, -2 / height, 0, -1, 1, 1]);\n    }\n\n    static translation(x: number, y: number): Matrix3 {\n        return new Matrix3([1, 0, 0, 0, 1, 0, x, y, 1]);\n    }\n\n    static scaling(x: number, y: number): Matrix3 {\n        return new Matrix3([x, 0, 0, 0, y, 0, 0, 0, 1]);\n    }\n\n    static rotation(radians: number): Matrix3 {\n        const c = Math.cos(radians);\n        const s = Math.sin(radians);\n        return new Matrix3([c, -s, 0, s, c, 0, 0, 0, 1]);\n    }\n\n    copy(): Matrix3 {\n        return new Matrix3(this.elements);\n    }\n\n    transform(vec: Vec2): Vec2 {\n        const e = this.elements;\n        const x = vec.x * e[0]! + vec.y * e[3]! + e[6]!;\n        const y = vec.x * e[1]! + vec.y * e[4]! + e[7]!;\n        return new Vec2(x, y);\n    }\n\n    multiply_self(b: Matrix3): Matrix3 {\n        const a = this.elements;\n        const be = b.elements;\n        const a00 = a[0]!, a01 = a[1]!, a02 = a[2]!;\n        const a10 = a[3]!, a11 = a[4]!, a12 = a[5]!;\n        const a20 = a[6]!, a21 = a[7]!, a22 = a[8]!;\n        const b00 = be[0]!, b01 = be[1]!, b02 = be[2]!;\n        const b10 = be[3]!, b11 = be[4]!, b12 = be[5]!;\n        const b20 = be[6]!, b21 = be[7]!, b22 = be[8]!;\n\n        a[0] = b00 * a00 + b01 * a10 + b02 * a20;\n        a[1] = b00 * a01 + b01 * a11 + b02 * a21;\n        a[2] = b00 * a02 + b01 * a12 + b02 * a22;\n        a[3] = b10 * a00 + b11 * a10 + b12 * a20;\n        a[4] = b10 * a01 + b11 * a11 + b12 * a21;\n        a[5] = b10 * a02 + b11 * a12 + b12 * a22;\n        a[6] = b20 * a00 + b21 * a10 + b22 * a20;\n        a[7] = b20 * a01 + b21 * a11 + b22 * a21;\n        a[8] = b20 * a02 + b21 * a12 + b22 * a22;\n        return this;\n    }\n\n    multiply(b: Matrix3): Matrix3 {\n        return this.copy().multiply_self(b);\n    }\n\n    translate_self(x: number, y: number): Matrix3 {\n        return this.multiply_self(Matrix3.translation(x, y));\n    }\n\n    scale_self(x: number, y: number): Matrix3 {\n        return this.multiply_self(Matrix3.scaling(x, y));\n    }\n\n    inverse(): Matrix3 {\n        const e = this.elements;\n        const a00 = e[0]!, a01 = e[1]!, a02 = e[2]!;\n        const a10 = e[3]!, a11 = e[4]!, a12 = e[5]!;\n        const a20 = e[6]!, a21 = e[7]!, a22 = e[8]!;\n\n        const b01 = a22 * a11 - a12 * a21;\n        const b11 = -a22 * a10 + a12 * a20;\n        const b21 = a21 * a10 - a11 * a20;\n\n        const det = a00 * b01 + a01 * b11 + a02 * b21;\n        const inv = 1.0 / det;\n\n        return new Matrix3([\n            b01 * inv,\n            (-a22 * a01 + a02 * a21) * inv,\n            (a12 * a01 - a02 * a11) * inv,\n            b11 * inv,\n            (a22 * a00 - a02 * a20) * inv,\n            (-a12 * a00 + a02 * a10) * inv,\n            b21 * inv,\n            (-a21 * a00 + a01 * a20) * inv,\n            (a11 * a00 - a01 * a10) * inv,\n        ]);\n    }\n}\n\n/** Axis-aligned bounding box */\nexport class BBox {\n    constructor(\n        public x: number = 0,\n        public y: number = 0,\n        public w: number = 0,\n        public h: number = 0,\n    ) {\n        if (this.w < 0) { this.w *= -1; this.x -= this.w; }\n        if (this.h < 0) { this.h *= -1; this.y -= this.h; }\n    }\n\n    get x2(): number { return this.x + this.w; }\n    get y2(): number { return this.y + this.h; }\n    get center(): Vec2 { return new Vec2(this.x + this.w / 2, this.y + this.h / 2); }\n\n    static from_points(points: Vec2[]): BBox {\n        if (points.length === 0) return new BBox();\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n        for (const p of points) {\n            if (p.x < minX) minX = p.x;\n            if (p.y < minY) minY = p.y;\n            if (p.x > maxX) maxX = p.x;\n            if (p.y > maxY) maxY = p.y;\n        }\n        return new BBox(minX, minY, maxX - minX, maxY - minY);\n    }\n\n    static combine(boxes: BBox[]): BBox {\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n        for (const b of boxes) {\n            if (b.w === 0 && b.h === 0) continue;\n            if (b.x < minX) minX = b.x;\n            if (b.y < minY) minY = b.y;\n            if (b.x2 > maxX) maxX = b.x2;\n            if (b.y2 > maxY) maxY = b.y2;\n        }\n        if (minX === Infinity) return new BBox();\n        return new BBox(minX, minY, maxX - minX, maxY - minY);\n    }\n\n    contains_point(v: Vec2): boolean {\n        return v.x >= this.x && v.x <= this.x2 && v.y >= this.y && v.y <= this.y2;\n    }\n\n    grow(d: number): BBox {\n        return new BBox(this.x - d, this.y - d, this.w + d * 2, this.h + d * 2);\n    }\n}\n", "import { Vec2, Matrix3, BBox } from \"./math\";\n\n/** 2D camera with pan, zoom, and viewport management */\nexport class Camera2 {\n    viewport_size: Vec2 = new Vec2(0, 0);\n    center: Vec2 = new Vec2(0, 0);\n    zoom: number = 1;\n\n    get matrix(): Matrix3 {\n        const mx = this.viewport_size.x / 2;\n        const my = this.viewport_size.y / 2;\n        const dx = this.center.x - this.center.x * this.zoom;\n        const dy = this.center.y - this.center.y * this.zoom;\n        const left = -(this.center.x - mx) + dx;\n        const top = -(this.center.y - my) + dy;\n        return Matrix3.identity()\n            .translate_self(left, top)\n            .scale_self(this.zoom, this.zoom);\n    }\n\n    get bbox(): BBox {\n        const m = this.matrix.inverse();\n        const start = m.transform(new Vec2(0, 0));\n        const end = m.transform(new Vec2(this.viewport_size.x, this.viewport_size.y));\n        return new BBox(start.x, start.y, end.x - start.x, end.y - start.y);\n    }\n\n    set bbox(bbox: BBox) {\n        const zoom_w = this.viewport_size.x / bbox.w;\n        const zoom_h = this.viewport_size.y / bbox.h;\n        this.zoom = Math.min(zoom_w, zoom_h);\n        this.center = bbox.center;\n    }\n\n    translate(delta: Vec2): void {\n        this.center = this.center.add(delta);\n    }\n\n    screen_to_world(v: Vec2): Vec2 {\n        return this.matrix.inverse().transform(v);\n    }\n\n    world_to_screen(v: Vec2): Vec2 {\n        return this.matrix.transform(v);\n    }\n}\n", "import { Camera2 } from \"./camera\";\nimport { Vec2 } from \"./math\";\n\nconst zoom_speed = 0.005;\nconst pan_speed = 1;\nconst line_delta_multiplier = 8;\nconst page_delta_multiplier = 24;\n\nexport type PanAndZoomCallback = () => void;\n\n/** Interactive pan and zoom attached to an HTML element */\nexport class PanAndZoom {\n    constructor(\n        public readonly target: HTMLElement,\n        public camera: Camera2,\n        public callback: PanAndZoomCallback,\n        public min_zoom = 0.1,\n        public max_zoom = 100,\n    ) {\n        this.target.addEventListener(\"wheel\", (e) => this.#on_wheel(e), { passive: false });\n\n        let dragStart: Vec2 | null = null;\n        let dragging = false;\n\n        this.target.addEventListener(\"mousedown\", (e: MouseEvent) => {\n            if (e.button === 1 || e.button === 2) {\n                e.preventDefault();\n                dragging = true;\n                dragStart = new Vec2(e.clientX, e.clientY);\n            }\n        });\n\n        this.target.addEventListener(\"mousemove\", (e: MouseEvent) => {\n            if (dragging && dragStart) {\n                const cur = new Vec2(e.clientX, e.clientY);\n                const delta = cur.sub(dragStart);\n                this.#handle_pan(-delta.x, -delta.y);\n                dragStart = cur;\n            }\n        });\n\n        this.target.addEventListener(\"mouseup\", (e: MouseEvent) => {\n            if (e.button === 1 || e.button === 2) {\n                dragging = false;\n                dragStart = null;\n            }\n        });\n\n        this.target.addEventListener(\"contextmenu\", (e) => e.preventDefault());\n\n        // Touch support\n        let touchStart: TouchList | null = null;\n        let pinchDist: number | null = null;\n\n        this.target.addEventListener(\"touchstart\", (e: TouchEvent) => {\n            if (e.touches.length === 2) {\n                pinchDist = this.#touchDistance(e.touches);\n            } else if (e.touches.length === 1) {\n                touchStart = e.touches;\n            }\n        });\n\n        this.target.addEventListener(\"touchmove\", (e: TouchEvent) => {\n            if (e.touches.length === 2 && pinchDist !== null) {\n                const cur = this.#touchDistance(e.touches);\n                const scale = (cur / pinchDist) * 4;\n                this.#handle_zoom(pinchDist < cur ? -scale : scale);\n                pinchDist = cur;\n            } else if (e.touches.length === 1 && touchStart !== null) {\n                const sx = touchStart[0]!.clientX, sy = touchStart[0]!.clientY;\n                const ex = e.touches[0]!.clientX, ey = e.touches[0]!.clientY;\n                this.#handle_pan(sx - ex, sy - ey);\n                touchStart = e.touches;\n            }\n        });\n\n        this.target.addEventListener(\"touchend\", () => {\n            pinchDist = null;\n            touchStart = null;\n        });\n    }\n\n    #touchDistance(touches: TouchList): number {\n        const dx = touches[0]!.clientX - touches[1]!.clientX;\n        const dy = touches[0]!.clientY - touches[1]!.clientY;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n\n    #on_wheel(e: WheelEvent): void {\n        e.preventDefault();\n        let dy = e.deltaY;\n        if (e.deltaMode === WheelEvent.DOM_DELTA_LINE) dy *= line_delta_multiplier;\n        else if (e.deltaMode === WheelEvent.DOM_DELTA_PAGE) dy *= page_delta_multiplier;\n        dy = Math.sign(dy) * Math.min(page_delta_multiplier, Math.abs(dy));\n\n        if (e.ctrlKey || e.shiftKey) {\n            let dx = e.deltaX;\n            if (e.deltaMode === WheelEvent.DOM_DELTA_LINE) dx *= line_delta_multiplier;\n            dx = Math.sign(dx) * Math.min(page_delta_multiplier, Math.abs(dx));\n            this.#handle_pan(dx, dy);\n        } else {\n            const rect = this.target.getBoundingClientRect();\n            const mouse = new Vec2(e.clientX - rect.left, e.clientY - rect.top);\n            this.#handle_zoom(dy, mouse);\n        }\n    }\n\n    #handle_pan(dx: number, dy: number): void {\n        const delta = new Vec2(dx * pan_speed, dy * pan_speed).multiply(1 / this.camera.zoom);\n        this.camera.translate(delta);\n        this.callback();\n    }\n\n    #handle_zoom(delta: number, mouse?: Vec2): void {\n        // Capture world position under cursor BEFORE zoom change\n        const worldBefore = mouse ? this.camera.screen_to_world(mouse) : null;\n\n        this.camera.zoom *= Math.exp(delta * -zoom_speed);\n        this.camera.zoom = Math.min(this.max_zoom, Math.max(this.camera.zoom, this.min_zoom));\n\n        // Adjust center so the world point under cursor stays fixed\n        if (worldBefore && mouse) {\n            const worldAfter = this.camera.screen_to_world(mouse);\n            this.camera.translate(worldBefore.sub(worldAfter));\n        }\n\n        this.callback();\n    }\n}\n", "/** Shader uniform wrapper */\nclass Uniform {\n    constructor(\n        public gl: WebGL2RenderingContext,\n        public name: string,\n        public location: WebGLUniformLocation,\n    ) {}\n\n    f1(x: number) { this.gl.uniform1f(this.location, x); }\n    mat3f(transpose: boolean, data: Float32Array) {\n        this.gl.uniformMatrix3fv(this.location, transpose, data);\n    }\n}\n\n/** Compiled shader program */\nexport class ShaderProgram {\n    program: WebGLProgram;\n    uniforms: Record<string, Uniform> = {};\n    attribs: Record<string, number> = {};\n\n    constructor(\n        public gl: WebGL2RenderingContext,\n        vert_src: string,\n        frag_src: string,\n    ) {\n        const vert = ShaderProgram.compile(gl, gl.VERTEX_SHADER, vert_src);\n        const frag = ShaderProgram.compile(gl, gl.FRAGMENT_SHADER, frag_src);\n        this.program = ShaderProgram.link(gl, vert, frag);\n        this.#discover_uniforms();\n        this.#discover_attribs();\n    }\n\n    static compile(gl: WebGL2RenderingContext, type: GLenum, src: string): WebGLShader {\n        const shader = gl.createShader(type)!;\n        gl.shaderSource(shader, src);\n        gl.compileShader(shader);\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n            const info = gl.getShaderInfoLog(shader);\n            gl.deleteShader(shader);\n            throw new Error(`Shader compile error: ${info}`);\n        }\n        return shader;\n    }\n\n    static link(gl: WebGL2RenderingContext, vert: WebGLShader, frag: WebGLShader): WebGLProgram {\n        const prog = gl.createProgram()!;\n        gl.attachShader(prog, vert);\n        gl.attachShader(prog, frag);\n        gl.linkProgram(prog);\n        if (!gl.getProgramParameter(prog, gl.LINK_STATUS)) {\n            const info = gl.getProgramInfoLog(prog);\n            gl.deleteProgram(prog);\n            throw new Error(`Shader link error: ${info}`);\n        }\n        return prog;\n    }\n\n    #discover_uniforms() {\n        const count = this.gl.getProgramParameter(this.program, this.gl.ACTIVE_UNIFORMS);\n        for (let i = 0; i < count; i++) {\n            const info = this.gl.getActiveUniform(this.program, i)!;\n            const loc = this.gl.getUniformLocation(this.program, info.name)!;\n            this.uniforms[info.name] = new Uniform(this.gl, info.name, loc);\n        }\n    }\n\n    #discover_attribs() {\n        const count = this.gl.getProgramParameter(this.program, this.gl.ACTIVE_ATTRIBUTES);\n        for (let i = 0; i < count; i++) {\n            const info = this.gl.getActiveAttrib(this.program, i)!;\n            this.attribs[info.name] = this.gl.getAttribLocation(this.program, info.name);\n        }\n    }\n\n    bind() { this.gl.useProgram(this.program); }\n}\n\n/** GPU buffer */\nexport class Buffer {\n    #buf: WebGLBuffer;\n    target: GLenum;\n\n    constructor(public gl: WebGL2RenderingContext, target?: GLenum) {\n        this.target = target ?? gl.ARRAY_BUFFER;\n        this.#buf = gl.createBuffer()!;\n    }\n\n    dispose() { this.gl.deleteBuffer(this.#buf); }\n    bind() { this.gl.bindBuffer(this.target, this.#buf); }\n\n    set(data: Float32Array, usage?: GLenum) {\n        this.bind();\n        this.gl.bufferData(this.target, data, usage ?? this.gl.STATIC_DRAW);\n    }\n}\n\n/** Vertex Array Object */\nexport class VertexArray {\n    vao: WebGLVertexArrayObject;\n    buffers: Buffer[] = [];\n\n    constructor(public gl: WebGL2RenderingContext) {\n        this.vao = gl.createVertexArray()!;\n        this.bind();\n    }\n\n    dispose() {\n        this.gl.deleteVertexArray(this.vao);\n        for (const buf of this.buffers) buf.dispose();\n    }\n\n    bind() { this.gl.bindVertexArray(this.vao); }\n\n    buffer(attrib: number, size: number): Buffer {\n        const b = new Buffer(this.gl);\n        b.bind();\n        this.gl.vertexAttribPointer(attrib, size, this.gl.FLOAT, false, 0, 0);\n        this.gl.enableVertexAttribArray(attrib);\n        this.buffers.push(b);\n        return b;\n    }\n}\n", "export const polygon_vert = `#version 300 es\nuniform mat3 u_matrix;\nin vec2 a_position;\nin vec4 a_color;\nout vec4 v_color;\nvoid main() {\n    v_color = a_color;\n    gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\n}`;\n\nexport const polygon_frag = `#version 300 es\nprecision highp float;\nuniform float u_depth;\nuniform float u_alpha;\nin vec4 v_color;\nout vec4 o_color;\nvoid main() {\n    vec4 c = v_color;\n    c.a *= u_alpha;\n    o_color = c;\n    gl_FragDepth = u_depth;\n}`;\n\nexport const polyline_vert = `#version 300 es\nuniform mat3 u_matrix;\nin vec2 a_position;\nin vec4 a_color;\nin float a_cap_region;\nout vec2 v_linespace;\nout float v_cap_region;\nout vec4 v_color;\nvec2 c_linespace[6] = vec2[](\n    vec2(-1, -1), vec2( 1, -1), vec2(-1,  1),\n    vec2(-1,  1), vec2( 1, -1), vec2( 1,  1)\n);\nvoid main() {\n    int vi = int(gl_VertexID % 6);\n    v_linespace = c_linespace[vi];\n    v_cap_region = a_cap_region;\n    gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\n    v_color = a_color;\n}`;\n\nexport const polyline_frag = `#version 300 es\nprecision highp float;\nuniform float u_depth;\nuniform float u_alpha;\nin vec2 v_linespace;\nin float v_cap_region;\nin vec4 v_color;\nout vec4 outColor;\nvoid main() {\n    vec4 c = v_color;\n    c.a *= u_alpha;\n    float x = v_linespace.x;\n    float y = v_linespace.y;\n    if(x < (-1.0 + v_cap_region)) {\n        float a = (1.0 + x) / v_cap_region;\n        x = mix(-1.0, 0.0, a);\n        if(x*x + y*y >= 1.0) discard;\n    } else if (x > (1.0 - v_cap_region)) {\n        float a = (x - (1.0 - v_cap_region)) / v_cap_region;\n        x = mix(0.0, 1.0, a);\n        if(x*x + y*y >= 1.0) discard;\n    }\n    outColor = c;\n    gl_FragDepth = u_depth;\n}`;\n", "\nexport default function earcut(data, holeIndices, dim = 2) {\n\n    const hasHoles = holeIndices && holeIndices.length;\n    const outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n    let outerNode = linkedList(data, 0, outerLen, dim, true);\n    const triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    let minX, minY, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = data[0];\n        minY = data[1];\n        let maxX = minX;\n        let maxY = minY;\n\n        for (let i = dim; i < outerLen; i += dim) {\n            const x = data[i];\n            const y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 32767 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize, 0);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    let last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (let i = start; i < end; i += dim) last = insertNode(i / dim | 0, data[i], data[i + 1], last);\n    } else {\n        for (let i = end - dim; i >= start; i -= dim) last = insertNode(i / dim | 0, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    let p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    let stop = ear;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        const prev = ear.prev;\n        const next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            triangles.push(prev.i, ear.i, next.i); // cut off the triangle\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    const a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    const ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox\n    const x0 = Math.min(ax, bx, cx),\n        y0 = Math.min(ay, by, cy),\n        x1 = Math.max(ax, bx, cx),\n        y1 = Math.max(ay, by, cy);\n\n    let p = c.next;\n    while (p !== a) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    const a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    const ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox\n    const x0 = Math.min(ax, bx, cx),\n        y0 = Math.min(ay, by, cy),\n        x1 = Math.max(ax, bx, cx),\n        y1 = Math.max(ay, by, cy);\n\n    // z-order range for the current triangle bbox;\n    const minZ = zOrder(x0, y0, minX, minY, invSize),\n        maxZ = zOrder(x1, y1, minX, minY, invSize);\n\n    let p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles) {\n    let p = start;\n    do {\n        const a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i, p.i, b.i);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    let a = start;\n    do {\n        let b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                let c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize, 0);\n                earcutLinked(c, triangles, dim, minX, minY, invSize, 0);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    const queue = [];\n\n    for (let i = 0, len = holeIndices.length; i < len; i++) {\n        const start = holeIndices[i] * dim;\n        const end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        const list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareXYSlope);\n\n    // process holes from left to right\n    for (let i = 0; i < queue.length; i++) {\n        outerNode = eliminateHole(queue[i], outerNode);\n    }\n\n    return outerNode;\n}\n\nfunction compareXYSlope(a, b) {\n    let result = a.x - b.x;\n    // when the left-most point of 2 holes meet at a vertex, sort the holes counterclockwise so that when we find\n    // the bridge to the outer shell is always the point that they meet at.\n    if (result === 0) {\n        result = a.y - b.y;\n        if (result === 0) {\n            const aSlope = (a.next.y - a.y) / (a.next.x - a.x);\n            const bSlope = (b.next.y - b.y) / (b.next.x - b.x);\n            result = aSlope - bSlope;\n        }\n    }\n    return result;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and link it\nfunction eliminateHole(hole, outerNode) {\n    const bridge = findHoleBridge(hole, outerNode);\n    if (!bridge) {\n        return outerNode;\n    }\n\n    const bridgeReverse = splitPolygon(bridge, hole);\n\n    // filter collinear points around the cuts\n    filterPoints(bridgeReverse, bridgeReverse.next);\n    return filterPoints(bridge, bridge.next);\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    let p = outerNode;\n    const hx = hole.x;\n    const hy = hole.y;\n    let qx = -Infinity;\n    let m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    // unless they intersect at a vertex, then choose the vertex\n    if (equals(hole, p)) return p;\n    do {\n        if (equals(hole, p.next)) return p.next;\n        else if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            const x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                m = p.x < p.next.x ? p : p.next;\n                if (x === hx) return m; // hole touches outer segment; pick leftmost endpoint\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    const stop = m;\n    const mx = m.x;\n    const my = m.y;\n    let tanMin = Infinity;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            const tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    let p = start;\n    do {\n        if (p.z === 0) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    let numMerges;\n    let inSize = 1;\n\n    do {\n        let p = list;\n        let e;\n        list = null;\n        let tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            let q = p;\n            let pSize = 0;\n            for (let i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            let qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = (x - minX) * invSize | 0;\n    y = (y - minY) * invSize | 0;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    let p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) >= (ax - px) * (cy - py) &&\n           (ax - px) * (by - py) >= (bx - px) * (ay - py) &&\n           (bx - px) * (cy - py) >= (cx - px) * (by - py);\n}\n\n// check if a point lies within a convex triangle but false if its equal to the first point of the triangle\nfunction pointInTriangleExceptFirst(ax, ay, bx, by, cx, cy, px, py) {\n    return !(ax === px && ay === py) && pointInTriangle(ax, ay, bx, by, cx, cy, px, py);\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // doesn't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    const o1 = sign(area(p1, q1, p2));\n    const o2 = sign(area(p1, q1, q2));\n    const o3 = sign(area(p2, q2, p1));\n    const o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    let p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    let p = a;\n    let inside = false;\n    const px = (a.x + b.x) / 2;\n    const py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    const a2 = createNode(a.i, a.x, a.y),\n        b2 = createNode(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    const p = createNode(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction createNode(i, x, y) {\n    return {\n        i, // vertex index in coordinates array\n        x, y, // vertex coordinates\n        prev: null, // previous and next vertex nodes in a polygon ring\n        next: null,\n        z: 0, // z-order curve value\n        prevZ: null, // previous and next nodes in z-order\n        nextZ: null,\n        steiner: false // indicates whether this is a steiner point\n    };\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nexport function deviation(data, holeIndices, dim, triangles) {\n    const hasHoles = holeIndices && holeIndices.length;\n    const outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    let polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (let i = 0, len = holeIndices.length; i < len; i++) {\n            const start = holeIndices[i] * dim;\n            const end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    let trianglesArea = 0;\n    for (let i = 0; i < triangles.length; i += 3) {\n        const a = triangles[i] * dim;\n        const b = triangles[i + 1] * dim;\n        const c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n}\n\nfunction signedArea(data, start, end, dim) {\n    let sum = 0;\n    for (let i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nexport function flatten(data) {\n    const vertices = [];\n    const holes = [];\n    const dimensions = data[0][0].length;\n    let holeIndex = 0;\n    let prevLen = 0;\n\n    for (const ring of data) {\n        for (const p of ring) {\n            for (let d = 0; d < dimensions; d++) vertices.push(p[d]);\n        }\n        if (prevLen) {\n            holeIndex += prevLen;\n            holes.push(holeIndex);\n        }\n        prevLen = ring.length;\n    }\n    return {vertices, holes, dimensions};\n}\n", "import earcut from \"earcut\";\nimport { Vec2 } from \"../math\";\n\nconst VERTS_PER_QUAD = 6;\n\n/** Convert quad corners to 2 triangles (6 vertices) */\nfunction quad_to_triangles(a: Vec2, b: Vec2, c: Vec2, d: Vec2): number[] {\n    return [a.x, a.y, c.x, c.y, b.x, b.y, b.x, b.y, c.x, c.y, d.x, d.y];\n}\n\nfunction fill_color(dest: Float32Array, r: number, g: number, b: number, a: number, offset: number, count: number) {\n    for (let i = 0; i < count; i++) {\n        dest[offset + i * 4] = r;\n        dest[offset + i * 4 + 1] = g;\n        dest[offset + i * 4 + 2] = b;\n        dest[offset + i * 4 + 3] = a;\n    }\n}\n\nexport interface TessPolylineResult {\n    positions: Float32Array;\n    caps: Float32Array;\n    colors: Float32Array;\n    vertexCount: number;\n}\n\n/** Tessellate a polyline (array of points + width) into quads with round caps */\nexport function tessellate_polyline(\n    points: Vec2[],\n    width: number,\n    r: number, g: number, b: number, a: number,\n): TessPolylineResult {\n    const segCount = points.length - 1;\n    const maxVerts = segCount * VERTS_PER_QUAD;\n    const positions = new Float32Array(maxVerts * 2);\n    const caps = new Float32Array(maxVerts);\n    const colors = new Float32Array(maxVerts * 4);\n    let vi = 0;\n\n    for (let i = 1; i < points.length; i++) {\n        const p1 = points[i - 1]!;\n        const p2 = points[i]!;\n        const line = p2.sub(p1);\n        const len = line.magnitude;\n        if (len === 0) continue;\n\n        const norm = line.normal.normalize();\n        const n = norm.multiply(width / 2);\n        const n2 = n.normal;\n\n        const qa = p1.add(n).add(n2);\n        const qb = p1.sub(n).add(n2);\n        const qc = p2.add(n).sub(n2);\n        const qd = p2.sub(n).sub(n2);\n\n        const cap_region = width / (len + width);\n\n        positions.set(quad_to_triangles(qa, qb, qc, qd), vi * 2);\n        for (let j = 0; j < VERTS_PER_QUAD; j++) caps[vi + j] = cap_region;\n        fill_color(colors, r, g, b, a, vi * 4, VERTS_PER_QUAD);\n        vi += VERTS_PER_QUAD;\n    }\n\n    return {\n        positions: positions.subarray(0, vi * 2),\n        caps: caps.subarray(0, vi),\n        colors: colors.subarray(0, vi * 4),\n        vertexCount: vi,\n    };\n}\n\nexport interface TessCircleResult {\n    positions: Float32Array;\n    caps: Float32Array;\n    colors: Float32Array;\n    vertexCount: number;\n}\n\n/** Tessellate a filled circle into a quad (rendered as SDF in the polyline shader) */\nexport function tessellate_circle(\n    cx: number, cy: number, radius: number,\n    r: number, g: number, b: number, a: number,\n): TessCircleResult {\n    const positions = new Float32Array(VERTS_PER_QUAD * 2);\n    const caps = new Float32Array(VERTS_PER_QUAD);\n    const colors = new Float32Array(VERTS_PER_QUAD * 4);\n\n    const n = new Vec2(radius, 0);\n    const n2 = n.normal;\n    const c = new Vec2(cx, cy);\n\n    const qa = c.add(n).add(n2);\n    const qb = c.sub(n).add(n2);\n    const qc = c.add(n).sub(n2);\n    const qd = c.sub(n).sub(n2);\n\n    positions.set(quad_to_triangles(qa, qb, qc, qd), 0);\n    for (let i = 0; i < VERTS_PER_QUAD; i++) caps[i] = 1.0;\n    fill_color(colors, r, g, b, a, 0, VERTS_PER_QUAD);\n\n    return { positions, caps, colors, vertexCount: VERTS_PER_QUAD };\n}\n\nexport interface TessPolygonResult {\n    positions: Float32Array;\n    colors: Float32Array;\n    vertexCount: number;\n}\n\n/** Triangulate a polygon using earcut */\nexport function triangulate_polygon(\n    points: Vec2[],\n    r: number, g: number, b: number, a: number,\n): TessPolygonResult {\n    const flat = new Array(points.length * 2);\n    for (let i = 0; i < points.length; i++) {\n        flat[i * 2] = points[i]!.x;\n        flat[i * 2 + 1] = points[i]!.y;\n    }\n\n    const indices = earcut(flat);\n    const positions = new Float32Array(indices.length * 2);\n    for (let i = 0; i < indices.length; i++) {\n        positions[i * 2] = flat[indices[i]! * 2]!;\n        positions[i * 2 + 1] = flat[indices[i]! * 2 + 1]!;\n    }\n\n    const vertexCount = indices.length;\n    const colors = new Float32Array(vertexCount * 4);\n    fill_color(colors, r, g, b, a, 0, vertexCount);\n\n    return { positions, colors, vertexCount };\n}\n", "import { Vec2, Matrix3 } from \"../math\";\nimport { ShaderProgram, VertexArray, Buffer } from \"./helpers\";\nimport { polygon_vert, polygon_frag, polyline_vert, polyline_frag } from \"./shaders\";\nimport {\n    tessellate_polyline, tessellate_circle, triangulate_polygon,\n    type TessPolylineResult, type TessCircleResult, type TessPolygonResult,\n} from \"./tessellator\";\n\n/** A set of GPU-uploaded primitives for one render layer */\nclass PrimitiveSet {\n    #polyline_data: TessPolylineResult[] = [];\n    #circle_data: TessCircleResult[] = [];\n    #polygon_data: TessPolygonResult[] = [];\n\n    // committed GPU state\n    #poly_vao?: VertexArray;\n    #poly_pos_buf?: Buffer;\n    #poly_color_buf?: Buffer;\n    #poly_vertex_count = 0;\n\n    #line_vao?: VertexArray;\n    #line_pos_buf?: Buffer;\n    #line_cap_buf?: Buffer;\n    #line_color_buf?: Buffer;\n    #line_vertex_count = 0;\n\n    constructor(private gl: WebGL2RenderingContext) {}\n\n    add_polyline(points: Vec2[], width: number, r: number, g: number, b: number, a: number) {\n        if (points.length < 2) return;\n        this.#polyline_data.push(tessellate_polyline(points, width, r, g, b, a));\n    }\n\n    add_circle(cx: number, cy: number, radius: number, r: number, g: number, b: number, a: number) {\n        this.#circle_data.push(tessellate_circle(cx, cy, radius, r, g, b, a));\n    }\n\n    add_polygon(points: Vec2[], r: number, g: number, b: number, a: number) {\n        if (points.length < 3) return;\n        this.#polygon_data.push(triangulate_polygon(points, r, g, b, a));\n    }\n\n    /** Upload all collected data to GPU */\n    commit(polylineShader: ShaderProgram, polygonShader: ShaderProgram) {\n        // Merge and upload polylines + circles (share the same shader)\n        const lineItems = [...this.#polyline_data, ...this.#circle_data];\n        if (lineItems.length > 0) {\n            let totalVerts = 0;\n            for (const item of lineItems) totalVerts += item.vertexCount;\n\n            const pos = new Float32Array(totalVerts * 2);\n            const cap = new Float32Array(totalVerts);\n            const col = new Float32Array(totalVerts * 4);\n            let pi = 0, ci = 0, coli = 0;\n\n            for (const item of lineItems) {\n                pos.set(item.positions, pi); pi += item.positions.length;\n                cap.set(item.caps, ci); ci += item.caps.length;\n                col.set(item.colors, coli); coli += item.colors.length;\n            }\n\n            this.#line_vao = new VertexArray(this.gl);\n            this.#line_pos_buf = this.#line_vao.buffer(polylineShader.attribs[\"a_position\"]!, 2);\n            this.#line_pos_buf.set(pos);\n            this.#line_cap_buf = this.#line_vao.buffer(polylineShader.attribs[\"a_cap_region\"]!, 1);\n            this.#line_cap_buf.set(cap);\n            this.#line_color_buf = this.#line_vao.buffer(polylineShader.attribs[\"a_color\"]!, 4);\n            this.#line_color_buf.set(col);\n            this.#line_vertex_count = totalVerts;\n        }\n\n        // Merge and upload polygons\n        if (this.#polygon_data.length > 0) {\n            let totalVerts = 0;\n            for (const item of this.#polygon_data) totalVerts += item.vertexCount;\n\n            const pos = new Float32Array(totalVerts * 2);\n            const col = new Float32Array(totalVerts * 4);\n            let pi = 0, coli = 0;\n\n            for (const item of this.#polygon_data) {\n                pos.set(item.positions, pi); pi += item.positions.length;\n                col.set(item.colors, coli); coli += item.colors.length;\n            }\n\n            this.#poly_vao = new VertexArray(this.gl);\n            this.#poly_pos_buf = this.#poly_vao.buffer(polygonShader.attribs[\"a_position\"]!, 2);\n            this.#poly_pos_buf.set(pos);\n            this.#poly_color_buf = this.#poly_vao.buffer(polygonShader.attribs[\"a_color\"]!, 4);\n            this.#poly_color_buf.set(col);\n            this.#poly_vertex_count = totalVerts;\n        }\n\n        // Free CPU data\n        this.#polyline_data = [];\n        this.#circle_data = [];\n        this.#polygon_data = [];\n    }\n\n    render(polylineShader: ShaderProgram, polygonShader: ShaderProgram, matrix: Matrix3, depth: number, alpha: number) {\n        if (this.#poly_vertex_count > 0) {\n            polygonShader.bind();\n            polygonShader.uniforms[\"u_matrix\"]!.mat3f(false, matrix.elements);\n            polygonShader.uniforms[\"u_depth\"]!.f1(depth);\n            polygonShader.uniforms[\"u_alpha\"]!.f1(alpha);\n            this.#poly_vao!.bind();\n            this.gl.drawArrays(this.gl.TRIANGLES, 0, this.#poly_vertex_count);\n        }\n\n        if (this.#line_vertex_count > 0) {\n            polylineShader.bind();\n            polylineShader.uniforms[\"u_matrix\"]!.mat3f(false, matrix.elements);\n            polylineShader.uniforms[\"u_depth\"]!.f1(depth);\n            polylineShader.uniforms[\"u_alpha\"]!.f1(alpha);\n            this.#line_vao!.bind();\n            this.gl.drawArrays(this.gl.TRIANGLES, 0, this.#line_vertex_count);\n        }\n    }\n\n    dispose() {\n        this.#poly_vao?.dispose();\n        this.#line_vao?.dispose();\n    }\n}\n\n/** A named render layer with its own PrimitiveSet */\nexport class RenderLayer {\n    geometry: PrimitiveSet;\n    depth: number;\n\n    constructor(\n        private gl: WebGL2RenderingContext,\n        public name: string,\n        depth: number,\n    ) {\n        this.geometry = new PrimitiveSet(gl);\n        this.depth = depth;\n    }\n\n    commit(polylineShader: ShaderProgram, polygonShader: ShaderProgram) {\n        this.geometry.commit(polylineShader, polygonShader);\n    }\n\n    render(polylineShader: ShaderProgram, polygonShader: ShaderProgram, matrix: Matrix3, alpha = 1) {\n        this.geometry.render(polylineShader, polygonShader, matrix, this.depth, alpha);\n    }\n\n    dispose() {\n        this.geometry.dispose();\n    }\n}\n\n/** Retained-mode WebGL2 renderer */\nexport class Renderer {\n    gl: WebGL2RenderingContext;\n    canvas: HTMLCanvasElement;\n    layers: RenderLayer[] = [];\n    projection_matrix: Matrix3 = Matrix3.identity();\n\n    private polylineShader!: ShaderProgram;\n    private polygonShader!: ShaderProgram;\n    private activeLayer: RenderLayer | null = null;\n    private nextDepth = 0.01;\n\n    constructor(canvas: HTMLCanvasElement) {\n        this.canvas = canvas;\n        const gl = canvas.getContext(\"webgl2\", { alpha: false });\n        if (!gl) throw new Error(\"WebGL2 not available\");\n        this.gl = gl;\n    }\n\n    setup() {\n        const gl = this.gl;\n        gl.enable(gl.BLEND);\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n        gl.enable(gl.DEPTH_TEST);\n        gl.depthFunc(gl.GREATER);\n        gl.clearColor(0.12, 0.12, 0.12, 1);\n        gl.clearDepth(0);\n\n        this.polylineShader = new ShaderProgram(gl, polyline_vert, polyline_frag);\n        this.polygonShader = new ShaderProgram(gl, polygon_vert, polygon_frag);\n\n        this.update_size();\n    }\n\n    update_size() {\n        const dpr = window.devicePixelRatio;\n        const rect = this.canvas.getBoundingClientRect();\n        const pw = Math.round(rect.width * dpr);\n        const ph = Math.round(rect.height * dpr);\n        if (this.canvas.width === pw && this.canvas.height === ph) return;\n        this.canvas.width = pw;\n        this.canvas.height = ph;\n        this.gl.viewport(0, 0, pw, ph);\n        this.projection_matrix = Matrix3.orthographic(rect.width, rect.height);\n    }\n\n    clear() {\n        this.update_size();\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n    }\n\n    /** Remove all layers and free GPU resources */\n    dispose_layers() {\n        for (const layer of this.layers) layer.dispose();\n        this.layers = [];\n        this.nextDepth = 0.01;\n    }\n\n    start_layer(name: string): RenderLayer {\n        const layer = new RenderLayer(this.gl, name, this.nextDepth);\n        this.nextDepth += 0.01;\n        this.activeLayer = layer;\n        return layer;\n    }\n\n    end_layer(): RenderLayer {\n        if (!this.activeLayer) throw new Error(\"No active layer\");\n        this.activeLayer.commit(this.polylineShader, this.polygonShader);\n        this.layers.push(this.activeLayer);\n        const l = this.activeLayer;\n        this.activeLayer = null;\n        return l;\n    }\n\n    /** Get current active layer's PrimitiveSet for drawing */\n    get active(): PrimitiveSet {\n        return this.activeLayer!.geometry;\n    }\n\n    /** Draw all layers with the given camera transform */\n    draw(cameraMatrix: Matrix3) {\n        this.clear();\n        const total = this.projection_matrix.multiply(cameraMatrix);\n        for (const layer of this.layers) {\n            layer.render(this.polylineShader, this.polygonShader, total);\n        }\n    }\n}\n", "/** RGBA color tuples [r, g, b, a] in 0-1 range */\nexport type Color = [number, number, number, number];\n\n/** Layer name \u2192 color mapping for PCB rendering */\nexport const LAYER_COLORS: Record<string, Color> = {\n    \"F.Cu\":     [0.85, 0.20, 0.20, 0.8],\n    \"B.Cu\":     [0.20, 0.40, 0.85, 0.8],\n    \"In1.Cu\":   [0.85, 0.85, 0.20, 0.8],\n    \"In2.Cu\":   [0.85, 0.40, 0.85, 0.8],\n    \"F.SilkS\":  [0.0,  0.85, 0.85, 0.9],\n    \"B.SilkS\":  [0.85, 0.0,  0.85, 0.9],\n    \"F.Mask\":   [0.6,  0.15, 0.6,  0.4],\n    \"B.Mask\":   [0.15, 0.6,  0.15, 0.4],\n    \"F.Paste\":  [0.85, 0.55, 0.55, 0.5],\n    \"B.Paste\":  [0.55, 0.55, 0.85, 0.5],\n    \"F.Fab\":    [0.6,  0.6,  0.2,  0.7],\n    \"B.Fab\":    [0.2,  0.2,  0.6,  0.7],\n    \"F.CrtYd\":  [0.4,  0.4,  0.4,  0.5],\n    \"B.CrtYd\":  [0.3,  0.3,  0.5,  0.5],\n    \"Edge.Cuts\": [0.9, 0.85, 0.2,  1.0],\n    \"Dwgs.User\": [0.6, 0.6,  0.6,  0.6],\n    \"Cmts.User\": [0.4, 0.4,  0.8,  0.6],\n};\n\nexport const PAD_COLOR: Color = [0.35, 0.60, 0.35, 0.9];\nexport const PAD_FRONT_COLOR: Color = [0.85, 0.20, 0.20, 0.7];\nexport const PAD_BACK_COLOR: Color = [0.20, 0.40, 0.85, 0.7];\nexport const VIA_COLOR: Color = [0.6, 0.6, 0.6, 0.9];\nexport const VIA_DRILL_COLOR: Color = [0.15, 0.15, 0.15, 1.0];\nexport const SELECTION_COLOR: Color = [1.0, 1.0, 1.0, 0.3];\nexport const BOARD_BG: Color = [0.08, 0.08, 0.08, 1.0];\nexport const ZONE_COLOR_ALPHA = 0.25;\n\nexport function getLayerColor(layer: string | null | undefined): Color {\n    if (!layer) return [0.5, 0.5, 0.5, 0.5];\n    return LAYER_COLORS[layer] ?? [0.5, 0.5, 0.5, 0.5];\n}\n\nexport function getPadColor(layers: string[]): Color {\n    const hasFront = layers.some(l => l === \"F.Cu\" || l === \"*.Cu\");\n    const hasBack = layers.some(l => l === \"B.Cu\" || l === \"*.Cu\");\n    if (hasFront && hasBack) return PAD_COLOR;\n    if (hasFront) return PAD_FRONT_COLOR;\n    if (hasBack) return PAD_BACK_COLOR;\n    return PAD_COLOR;\n}\n", "import { Vec2, BBox } from \"./math\";\nimport { Renderer, RenderLayer } from \"./webgl/renderer\";\nimport { getLayerColor, getPadColor, VIA_COLOR, VIA_DRILL_COLOR, SELECTION_COLOR, ZONE_COLOR_ALPHA } from \"./colors\";\nimport type { RenderModel, FootprintModel, PadModel, TrackModel, DrawingModel, Point2, Point3 } from \"./types\";\n\nconst DEG_TO_RAD = Math.PI / 180;\n\nfunction p2v(p: Point2): Vec2 {\n    return new Vec2(p.x, p.y);\n}\n\n/** Transform a local point by a footprint's position + rotation */\nfunction fpTransform(fpAt: Point3, localX: number, localY: number): Vec2 {\n    const rad = -(fpAt.r || 0) * DEG_TO_RAD;\n    const cos = Math.cos(rad);\n    const sin = Math.sin(rad);\n    return new Vec2(\n        fpAt.x + localX * cos - localY * sin,\n        fpAt.y + localX * sin + localY * cos,\n    );\n}\n\n/** Transform by pad rotation, then footprint rotation */\nfunction padTransform(fpAt: Point3, padAt: Point3, lx: number, ly: number): Vec2 {\n    const padRad = -(padAt.r || 0) * DEG_TO_RAD;\n    const pc = Math.cos(padRad), ps = Math.sin(padRad);\n    const px = lx * pc - ly * ps;\n    const py = lx * ps + ly * pc;\n    return fpTransform(fpAt, padAt.x + px, padAt.y + py);\n}\n\n/** Approximate a 3-point arc with line segments */\nfunction arcToPoints(start: Point2, mid: Point2, end: Point2, segments = 32): Vec2[] {\n    const ax = start.x, ay = start.y;\n    const bx = mid.x, by = mid.y;\n    const cx = end.x, cy = end.y;\n\n    const D = 2 * (ax * (by - cy) + bx * (cy - ay) + cx * (ay - by));\n    if (Math.abs(D) < 1e-10) {\n        return [new Vec2(ax, ay), new Vec2(bx, by), new Vec2(cx, cy)];\n    }\n\n    const ux = ((ax * ax + ay * ay) * (by - cy) + (bx * bx + by * by) * (cy - ay) + (cx * cx + cy * cy) * (ay - by)) / D;\n    const uy = ((ax * ax + ay * ay) * (cx - bx) + (bx * bx + by * by) * (ax - cx) + (cx * cx + cy * cy) * (bx - ax)) / D;\n    const radius = Math.sqrt((ax - ux) ** 2 + (ay - uy) ** 2);\n    const startAngle = Math.atan2(ay - uy, ax - ux);\n    const midAngle = Math.atan2(by - uy, bx - ux);\n    const endAngle = Math.atan2(cy - uy, cx - ux);\n\n    let da1 = midAngle - startAngle;\n    while (da1 > Math.PI) da1 -= 2 * Math.PI;\n    while (da1 < -Math.PI) da1 += 2 * Math.PI;\n\n    const clockwise = da1 < 0;\n    let sweep = endAngle - startAngle;\n    if (clockwise) {\n        while (sweep > 0) sweep -= 2 * Math.PI;\n    } else {\n        while (sweep < 0) sweep += 2 * Math.PI;\n    }\n\n    const points: Vec2[] = [];\n    for (let i = 0; i <= segments; i++) {\n        const t = i / segments;\n        const angle = startAngle + sweep * t;\n        points.push(new Vec2(ux + radius * Math.cos(angle), uy + radius * Math.sin(angle)));\n    }\n    return points;\n}\n\n/** Paint the entire render model into renderer layers */\nexport function paintAll(renderer: Renderer, model: RenderModel, hiddenLayers?: Set<string>): void {\n    const hidden = hiddenLayers ?? new Set<string>();\n    renderer.dispose_layers();\n    if (!hidden.has(\"Edge.Cuts\")) paintBoardEdges(renderer, model);\n    paintZones(renderer, model, hidden);\n    paintTracks(renderer, model, hidden);\n    if (!hidden.has(\"Vias\")) paintVias(renderer, model);\n    for (const fp of model.footprints) {\n        paintFootprint(renderer, fp, hidden);\n    }\n}\n\nfunction paintBoardEdges(renderer: Renderer, model: RenderModel) {\n    const layer = renderer.start_layer(\"Edge.Cuts\");\n    const [r, g, b, a] = getLayerColor(\"Edge.Cuts\");\n\n    for (const edge of model.board.edges) {\n        if (edge.type === \"line\" && edge.start && edge.end) {\n            layer.geometry.add_polyline([p2v(edge.start), p2v(edge.end)], 0.15, r, g, b, a);\n        } else if (edge.type === \"arc\" && edge.start && edge.mid && edge.end) {\n            layer.geometry.add_polyline(arcToPoints(edge.start, edge.mid, edge.end), 0.15, r, g, b, a);\n        } else if (edge.type === \"circle\" && edge.center && edge.end) {\n            const cx = edge.center.x, cy = edge.center.y;\n            const rad = Math.sqrt((edge.end.x - cx) ** 2 + (edge.end.y - cy) ** 2);\n            const pts: Vec2[] = [];\n            for (let i = 0; i <= 64; i++) {\n                const angle = (i / 64) * 2 * Math.PI;\n                pts.push(new Vec2(cx + rad * Math.cos(angle), cy + rad * Math.sin(angle)));\n            }\n            layer.geometry.add_polyline(pts, 0.15, r, g, b, a);\n        } else if (edge.type === \"rect\" && edge.start && edge.end) {\n            const s = edge.start, e = edge.end;\n            layer.geometry.add_polyline([\n                new Vec2(s.x, s.y), new Vec2(e.x, s.y), new Vec2(e.x, e.y), new Vec2(s.x, e.y), new Vec2(s.x, s.y),\n            ], 0.15, r, g, b, a);\n        }\n    }\n    renderer.end_layer();\n}\n\nfunction paintZones(renderer: Renderer, model: RenderModel, hidden: Set<string>) {\n    for (const zone of model.zones) {\n        for (const filled of zone.filled_polygons) {\n            if (hidden.has(filled.layer)) continue;\n            const [r, g, b] = getLayerColor(filled.layer);\n            const layer = renderer.start_layer(`zone_${zone.uuid ?? \"\"}:${filled.layer}`);\n            const pts = filled.points.map(p2v);\n            if (pts.length >= 3) {\n                layer.geometry.add_polygon(pts, r, g, b, ZONE_COLOR_ALPHA);\n            }\n            renderer.end_layer();\n        }\n    }\n}\n\nfunction paintTracks(renderer: Renderer, model: RenderModel, hidden: Set<string>) {\n    const byLayer = new Map<string, TrackModel[]>();\n    for (const track of model.tracks) {\n        const ln = track.layer ?? \"F.Cu\";\n        if (hidden.has(ln)) continue;\n        let arr = byLayer.get(ln);\n        if (!arr) { arr = []; byLayer.set(ln, arr); }\n        arr.push(track);\n    }\n    for (const [layerName, tracks] of byLayer) {\n        const [r, g, b, a] = getLayerColor(layerName);\n        const layer = renderer.start_layer(`tracks:${layerName}`);\n        for (const track of tracks) {\n            layer.geometry.add_polyline([p2v(track.start), p2v(track.end)], track.width, r, g, b, a);\n        }\n        renderer.end_layer();\n    }\n    if (model.arcs.length > 0) {\n        const arcByLayer = new Map<string, typeof model.arcs>();\n        for (const arc of model.arcs) {\n            const ln = arc.layer ?? \"F.Cu\";\n            if (hidden.has(ln)) continue;\n            let arr = arcByLayer.get(ln);\n            if (!arr) { arr = []; arcByLayer.set(ln, arr); }\n            arr.push(arc);\n        }\n        for (const [layerName, arcs] of arcByLayer) {\n            const [r, g, b, a] = getLayerColor(layerName);\n            const layer = renderer.start_layer(`arc_tracks:${layerName}`);\n            for (const arc of arcs) {\n                layer.geometry.add_polyline(arcToPoints(arc.start, arc.mid, arc.end), arc.width, r, g, b, a);\n            }\n            renderer.end_layer();\n        }\n    }\n}\n\nfunction paintVias(renderer: Renderer, model: RenderModel) {\n    if (model.vias.length === 0) return;\n    const layer = renderer.start_layer(\"vias\");\n    for (const via of model.vias) {\n        const [vr, vg, vb, va] = VIA_COLOR;\n        layer.geometry.add_circle(via.at.x, via.at.y, via.size / 2, vr, vg, vb, va);\n        const [dr, dg, db, da] = VIA_DRILL_COLOR;\n        layer.geometry.add_circle(via.at.x, via.at.y, via.drill / 2, dr, dg, db, da);\n    }\n    renderer.end_layer();\n}\n\nfunction paintFootprint(renderer: Renderer, fp: FootprintModel, hidden: Set<string>) {\n    const drawingsByLayer = new Map<string, DrawingModel[]>();\n    for (const drawing of fp.drawings) {\n        const ln = drawing.layer ?? \"F.SilkS\";\n        if (hidden.has(ln)) continue;\n        let arr = drawingsByLayer.get(ln);\n        if (!arr) { arr = []; drawingsByLayer.set(ln, arr); }\n        arr.push(drawing);\n    }\n    for (const [layerName, drawings] of drawingsByLayer) {\n        const [r, g, b, a] = getLayerColor(layerName);\n        const layer = renderer.start_layer(`fp:${fp.uuid}:${layerName}`);\n        for (const drawing of drawings) {\n            paintDrawing(layer, fp.at, drawing, r, g, b, a);\n        }\n        renderer.end_layer();\n    }\n    if (fp.pads.length > 0) {\n        // Check if any pad layer is visible\n        const anyVisible = fp.pads.some(pad => pad.layers.some(l => !hidden.has(l)));\n        if (anyVisible) {\n            const layer = renderer.start_layer(`fp:${fp.uuid}:pads`);\n            for (const pad of fp.pads) {\n                if (pad.layers.some(l => !hidden.has(l))) {\n                    paintPad(layer, fp.at, pad);\n                }\n            }\n            renderer.end_layer();\n        }\n    }\n}\n\nfunction paintDrawing(layer: RenderLayer, fpAt: Point3, drawing: DrawingModel, r: number, g: number, b: number, a: number) {\n    const w = drawing.width || 0.12;\n\n    if (drawing.type === \"line\" && drawing.start && drawing.end) {\n        const p1 = fpTransform(fpAt, drawing.start.x, drawing.start.y);\n        const p2 = fpTransform(fpAt, drawing.end.x, drawing.end.y);\n        layer.geometry.add_polyline([p1, p2], w, r, g, b, a);\n    } else if (drawing.type === \"arc\" && drawing.start && drawing.mid && drawing.end) {\n        const localPts = arcToPoints(drawing.start, drawing.mid, drawing.end);\n        const worldPts = localPts.map(p => fpTransform(fpAt, p.x, p.y));\n        layer.geometry.add_polyline(worldPts, w, r, g, b, a);\n    } else if (drawing.type === \"circle\" && drawing.center && drawing.end) {\n        const cx = drawing.center.x, cy = drawing.center.y;\n        const rad = Math.sqrt((drawing.end.x - cx) ** 2 + (drawing.end.y - cy) ** 2);\n        const pts: Vec2[] = [];\n        for (let i = 0; i <= 48; i++) {\n            const angle = (i / 48) * 2 * Math.PI;\n            pts.push(new Vec2(cx + rad * Math.cos(angle), cy + rad * Math.sin(angle)));\n        }\n        layer.geometry.add_polyline(pts.map(p => fpTransform(fpAt, p.x, p.y)), w, r, g, b, a);\n    } else if (drawing.type === \"rect\" && drawing.start && drawing.end) {\n        const s = drawing.start, e = drawing.end;\n        const corners = [\n            fpTransform(fpAt, s.x, s.y), fpTransform(fpAt, e.x, s.y),\n            fpTransform(fpAt, e.x, e.y), fpTransform(fpAt, s.x, e.y),\n            fpTransform(fpAt, s.x, s.y),\n        ];\n        layer.geometry.add_polyline(corners, w, r, g, b, a);\n    } else if (drawing.type === \"polygon\" && drawing.points) {\n        const worldPts = drawing.points.map(p => fpTransform(fpAt, p.x, p.y));\n        if (worldPts.length >= 3) {\n            worldPts.push(worldPts[0]!.copy());\n            layer.geometry.add_polyline(worldPts, w, r, g, b, a);\n        }\n    }\n}\n\nfunction paintPad(layer: RenderLayer, fpAt: Point3, pad: PadModel) {\n    const [cr, cg, cb, ca] = getPadColor(pad.layers);\n    const hw = pad.size.w / 2;\n    const hh = pad.size.h / 2;\n\n    if (pad.shape === \"circle\") {\n        const center = fpTransform(fpAt, pad.at.x, pad.at.y);\n        layer.geometry.add_circle(center.x, center.y, hw, cr, cg, cb, ca);\n    } else if (pad.shape === \"oval\") {\n        const longAxis = Math.max(hw, hh);\n        const shortAxis = Math.min(hw, hh);\n        const focalDist = longAxis - shortAxis;\n        let p1: Vec2, p2: Vec2;\n        if (hw >= hh) {\n            p1 = padTransform(fpAt, pad.at, -focalDist, 0);\n            p2 = padTransform(fpAt, pad.at, focalDist, 0);\n        } else {\n            p1 = padTransform(fpAt, pad.at, 0, -focalDist);\n            p2 = padTransform(fpAt, pad.at, 0, focalDist);\n        }\n        layer.geometry.add_polyline([p1, p2], shortAxis * 2, cr, cg, cb, ca);\n    } else {\n        const corners = [\n            padTransform(fpAt, pad.at, -hw, -hh), padTransform(fpAt, pad.at, hw, -hh),\n            padTransform(fpAt, pad.at, hw, hh), padTransform(fpAt, pad.at, -hw, hh),\n        ];\n        layer.geometry.add_polygon(corners, cr, cg, cb, ca);\n    }\n\n    if (pad.drill && pad.type === \"thru_hole\") {\n        const center = fpTransform(fpAt, pad.at.x, pad.at.y);\n        const drillR = (pad.drill.size_x ?? pad.size.w * 0.5) / 2;\n        layer.geometry.add_circle(center.x, center.y, drillR, 0.15, 0.15, 0.15, 1.0);\n    }\n}\n\n/** Paint a selection highlight around a footprint */\nexport function paintSelection(renderer: Renderer, fp: FootprintModel): RenderLayer {\n    const layer = renderer.start_layer(\"selection\");\n    const [r, g, b, a] = SELECTION_COLOR;\n\n    const allPoints: Vec2[] = [];\n    for (const pad of fp.pads) {\n        const center = fpTransform(fp.at, pad.at.x, pad.at.y);\n        const hw = pad.size.w / 2, hh = pad.size.h / 2;\n        allPoints.push(center.add(new Vec2(-hw, -hh)));\n        allPoints.push(center.add(new Vec2(hw, hh)));\n    }\n    for (const drawing of fp.drawings) {\n        if (drawing.start) allPoints.push(fpTransform(fp.at, drawing.start.x, drawing.start.y));\n        if (drawing.end) allPoints.push(fpTransform(fp.at, drawing.end.x, drawing.end.y));\n        if (drawing.center) allPoints.push(fpTransform(fp.at, drawing.center.x, drawing.center.y));\n    }\n\n    if (allPoints.length > 0) {\n        const bbox = BBox.from_points(allPoints).grow(0.5);\n        layer.geometry.add_polygon([\n            new Vec2(bbox.x, bbox.y), new Vec2(bbox.x2, bbox.y),\n            new Vec2(bbox.x2, bbox.y2), new Vec2(bbox.x, bbox.y2),\n        ], r, g, b, a);\n    }\n\n    renderer.end_layer();\n    return layer;\n}\n\n/** Compute a bounding box for the full render model */\nexport function computeBBox(model: RenderModel): BBox {\n    const points: Vec2[] = [];\n    for (const edge of model.board.edges) {\n        if (edge.start) points.push(p2v(edge.start));\n        if (edge.end) points.push(p2v(edge.end));\n        if (edge.mid) points.push(p2v(edge.mid));\n        if (edge.center) points.push(p2v(edge.center));\n    }\n    for (const fp of model.footprints) {\n        points.push(new Vec2(fp.at.x, fp.at.y));\n        for (const pad of fp.pads) {\n            points.push(fpTransform(fp.at, pad.at.x, pad.at.y));\n        }\n    }\n    for (const track of model.tracks) {\n        points.push(p2v(track.start));\n        points.push(p2v(track.end));\n    }\n    for (const via of model.vias) {\n        points.push(p2v(via.at));\n    }\n    if (points.length === 0) return new BBox(0, 0, 100, 100);\n    return BBox.from_points(points).grow(5);\n}\n", "import { Vec2, BBox } from \"./math\";\nimport type { FootprintModel, Point3 } from \"./types\";\n\nconst DEG_TO_RAD = Math.PI / 180;\n\nfunction fpTransform(fpAt: Point3, localX: number, localY: number): Vec2 {\n    const rad = -(fpAt.r || 0) * DEG_TO_RAD;\n    const cos = Math.cos(rad);\n    const sin = Math.sin(rad);\n    return new Vec2(\n        fpAt.x + localX * cos - localY * sin,\n        fpAt.y + localX * sin + localY * cos,\n    );\n}\n\n/** Compute bounding box for a footprint in world coords */\nexport function footprintBBox(fp: FootprintModel): BBox {\n    const points: Vec2[] = [];\n    for (const pad of fp.pads) {\n        const center = fpTransform(fp.at, pad.at.x, pad.at.y);\n        const hw = pad.size.w / 2;\n        const hh = pad.size.h / 2;\n        points.push(center.add(new Vec2(-hw, -hh)));\n        points.push(center.add(new Vec2(hw, hh)));\n    }\n    for (const drawing of fp.drawings) {\n        if (drawing.start) points.push(fpTransform(fp.at, drawing.start.x, drawing.start.y));\n        if (drawing.end) points.push(fpTransform(fp.at, drawing.end.x, drawing.end.y));\n        if (drawing.center) points.push(fpTransform(fp.at, drawing.center.x, drawing.center.y));\n        if (drawing.points) {\n            for (const p of drawing.points) {\n                points.push(fpTransform(fp.at, p.x, p.y));\n            }\n        }\n    }\n    if (points.length === 0) {\n        return new BBox(fp.at.x - 1, fp.at.y - 1, 2, 2);\n    }\n    return BBox.from_points(points).grow(0.2);\n}\n\n/** Find the footprint under a world-space point, returns index or -1 */\nexport function hitTestFootprints(worldPos: Vec2, footprints: FootprintModel[]): number {\n    for (let i = footprints.length - 1; i >= 0; i--) {\n        const bbox = footprintBBox(footprints[i]!);\n        if (bbox.contains_point(worldPos)) {\n            return i;\n        }\n    }\n    return -1;\n}\n", "import { Vec2 } from \"./math\";\nimport { Camera2 } from \"./camera\";\nimport { PanAndZoom } from \"./pan-and-zoom\";\nimport { Renderer } from \"./webgl/renderer\";\nimport { paintAll, paintSelection, computeBBox } from \"./painter\";\nimport { hitTestFootprints } from \"./hit-test\";\nimport type { RenderModel } from \"./types\";\n\nexport class Editor {\n    private canvas: HTMLCanvasElement;\n    private renderer: Renderer;\n    private camera: Camera2;\n    private panAndZoom: PanAndZoom;\n    private model: RenderModel | null = null;\n    private baseUrl: string;\n    private ws: WebSocket | null = null;\n\n    // Selection & drag state\n    private selectedFpIndex = -1;\n    private isDragging = false;\n    private dragStartWorld: Vec2 | null = null;\n    private dragStartFpPos: { x: number; y: number } | null = null;\n    private needsRedraw = true;\n\n    // Layer visibility\n    private hiddenLayers: Set<string> = new Set();\n    private onLayersChanged: (() => void) | null = null;\n\n    // Track current mouse position\n    private lastMouseScreen: Vec2 = new Vec2(0, 0);\n\n    constructor(canvas: HTMLCanvasElement, baseUrl: string) {\n        this.canvas = canvas;\n        this.baseUrl = baseUrl;\n        this.renderer = new Renderer(canvas);\n        this.camera = new Camera2();\n        this.panAndZoom = new PanAndZoom(canvas, this.camera, () => this.requestRedraw());\n\n        this.setupMouseHandlers();\n        this.setupKeyboardHandlers();\n        this.setupResizeHandler();\n        this.renderer.setup();\n        this.startRenderLoop();\n    }\n\n    async init() {\n        await this.fetchAndPaint();\n        this.connectWebSocket();\n    }\n\n    private async fetchAndPaint() {\n        const resp = await fetch(`${this.baseUrl}/api/render-model`);\n        this.applyModel(await resp.json(), true);\n    }\n\n    private applyModel(model: RenderModel, fitToView = false) {\n        this.model = model;\n        this.paint();\n\n        this.camera.viewport_size = new Vec2(this.canvas.clientWidth, this.canvas.clientHeight);\n        if (fitToView) {\n            this.camera.bbox = computeBBox(this.model);\n        }\n        this.requestRedraw();\n    }\n\n    private paint() {\n        if (!this.model) return;\n        paintAll(this.renderer, this.model, this.hiddenLayers);\n\n        if (this.selectedFpIndex >= 0 && this.selectedFpIndex < this.model.footprints.length) {\n            paintSelection(this.renderer, this.model.footprints[this.selectedFpIndex]!);\n        }\n    }\n\n    private connectWebSocket() {\n        const wsUrl = this.baseUrl.replace(/^http/, \"ws\") + \"/ws\";\n        this.ws = new WebSocket(wsUrl);\n        this.ws.onopen = () => console.log(\"WS connected\");\n        this.ws.onmessage = (event) => {\n            const msg = JSON.parse(event.data);\n            if (msg.type === \"layout_updated\" && msg.model) {\n                this.applyModel(msg.model);\n            }\n        };\n        this.ws.onerror = (err) => console.error(\"WS error:\", err);\n        this.ws.onclose = () => {\n            setTimeout(() => this.connectWebSocket(), 2000);\n        };\n    }\n\n    private setupMouseHandlers() {\n        this.canvas.addEventListener(\"mousedown\", (e: MouseEvent) => {\n            if (e.button !== 0) return;\n\n            const rect = this.canvas.getBoundingClientRect();\n            const screenPos = new Vec2(e.clientX - rect.left, e.clientY - rect.top);\n            const worldPos = this.camera.screen_to_world(screenPos);\n\n            if (!this.model) return;\n\n            const hitIdx = hitTestFootprints(worldPos, this.model.footprints);\n\n            if (hitIdx >= 0) {\n                this.selectedFpIndex = hitIdx;\n                const fp = this.model.footprints[hitIdx]!;\n                this.isDragging = true;\n                this.dragStartWorld = worldPos;\n                this.dragStartFpPos = { x: fp.at.x, y: fp.at.y };\n                this.repaintWithSelection();\n            } else {\n                if (this.selectedFpIndex >= 0) {\n                    this.selectedFpIndex = -1;\n                    this.paint();\n                    this.requestRedraw();\n                }\n            }\n        });\n\n        this.canvas.addEventListener(\"mousemove\", (e: MouseEvent) => {\n            const rect = this.canvas.getBoundingClientRect();\n            this.lastMouseScreen = new Vec2(e.clientX - rect.left, e.clientY - rect.top);\n\n            if (!this.isDragging || !this.model || this.selectedFpIndex < 0) return;\n\n            const worldPos = this.camera.screen_to_world(this.lastMouseScreen);\n            const delta = worldPos.sub(this.dragStartWorld!);\n            const fp = this.model.footprints[this.selectedFpIndex]!;\n            fp.at.x = this.dragStartFpPos!.x + delta.x;\n            fp.at.y = this.dragStartFpPos!.y + delta.y;\n\n            this.paint();\n            this.requestRedraw();\n        });\n\n        this.canvas.addEventListener(\"mouseup\", async (e: MouseEvent) => {\n            if (e.button !== 0 || !this.isDragging) return;\n            this.isDragging = false;\n\n            if (!this.model || this.selectedFpIndex < 0 || !this.dragStartFpPos) return;\n            const fp = this.model.footprints[this.selectedFpIndex]!;\n\n            // Skip noop moves\n            const dx = fp.at.x - this.dragStartFpPos.x;\n            const dy = fp.at.y - this.dragStartFpPos.y;\n            if (Math.abs(dx) < 0.001 && Math.abs(dy) < 0.001) return;\n\n            await this.executeAction(\"move\", {\n                uuid: fp.uuid,\n                x: fp.at.x,\n                y: fp.at.y,\n                r: fp.at.r || null,\n            });\n        });\n    }\n\n    private setupKeyboardHandlers() {\n        window.addEventListener(\"keydown\", async (e: KeyboardEvent) => {\n            // R \u2014 rotate selected footprint by 90 degrees\n            if (e.key === \"r\" || e.key === \"R\") {\n                if (e.ctrlKey || e.metaKey || e.altKey) return;\n                await this.actionOnSelected(\"rotate\", (fp) => ({ uuid: fp.uuid, delta_degrees: 90 }));\n                return;\n            }\n\n            // F \u2014 flip selected footprint\n            if (e.key === \"f\" || e.key === \"F\") {\n                if (e.ctrlKey || e.metaKey || e.altKey) return;\n                await this.actionOnSelected(\"flip\", (fp) => ({ uuid: fp.uuid }));\n                return;\n            }\n\n            // Ctrl+Z \u2014 undo\n            if ((e.ctrlKey || e.metaKey) && e.key === \"z\" && !e.shiftKey) {\n                e.preventDefault();\n                await this.serverAction(\"/api/undo\");\n                return;\n            }\n\n            // Ctrl+Shift+Z or Ctrl+Y \u2014 redo\n            if (((e.ctrlKey || e.metaKey) && e.key === \"z\" && e.shiftKey) ||\n                ((e.ctrlKey || e.metaKey) && e.key === \"y\")) {\n                e.preventDefault();\n                await this.serverAction(\"/api/redo\");\n                return;\n            }\n        });\n    }\n\n    private setupResizeHandler() {\n        window.addEventListener(\"resize\", () => {\n            this.requestRedraw();\n        });\n    }\n\n    private async actionOnSelected(\n        type: string,\n        detailsFn: (fp: RenderModel[\"footprints\"][0]) => Record<string, unknown>,\n    ) {\n        if (!this.model || this.selectedFpIndex < 0) return;\n        const fp = this.model.footprints[this.selectedFpIndex]!;\n        await this.executeAction(type, detailsFn(fp));\n    }\n\n    private async executeAction(type: string, details: Record<string, unknown>) {\n        try {\n            const resp = await fetch(`${this.baseUrl}/api/execute-action`, {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ type, details }),\n            });\n            const data = await resp.json();\n            if (data.model) this.applyModel(data.model);\n        } catch (err) {\n            console.error(\"Failed to execute action:\", err);\n        }\n    }\n\n    private async serverAction(endpoint: string) {\n        try {\n            const resp = await fetch(`${this.baseUrl}${endpoint}`, { method: \"POST\" });\n            const data = await resp.json();\n            if (data.model) this.applyModel(data.model);\n        } catch (err) {\n            console.error(`Failed ${endpoint}:`, err);\n        }\n    }\n\n    // --- Layer visibility ---\n\n    setLayerVisible(layer: string, visible: boolean) {\n        if (visible) {\n            this.hiddenLayers.delete(layer);\n        } else {\n            this.hiddenLayers.add(layer);\n        }\n        this.paint();\n        this.requestRedraw();\n    }\n\n    isLayerVisible(layer: string): boolean {\n        return !this.hiddenLayers.has(layer);\n    }\n\n    getLayers(): string[] {\n        if (!this.model) return [];\n        const layers = new Set<string>();\n        for (const fp of this.model.footprints) {\n            layers.add(fp.layer);\n            for (const pad of fp.pads) {\n                for (const l of pad.layers) layers.add(l);\n            }\n            for (const d of fp.drawings) {\n                if (d.layer) layers.add(d.layer);\n            }\n        }\n        for (const t of this.model.tracks) {\n            if (t.layer) layers.add(t.layer);\n        }\n        for (const a of this.model.arcs) {\n            if (a.layer) layers.add(a.layer);\n        }\n        for (const z of this.model.zones) {\n            for (const fp of z.filled_polygons) layers.add(fp.layer);\n        }\n        layers.add(\"Edge.Cuts\");\n        layers.add(\"Vias\");\n        return [...layers].sort();\n    }\n\n    setOnLayersChanged(cb: () => void) {\n        this.onLayersChanged = cb;\n    }\n\n    private repaintWithSelection() {\n        this.paint();\n        this.requestRedraw();\n    }\n\n    private requestRedraw() {\n        this.needsRedraw = true;\n    }\n\n    private startRenderLoop() {\n        const loop = () => {\n            if (this.needsRedraw) {\n                this.needsRedraw = false;\n                this.camera.viewport_size = new Vec2(this.canvas.clientWidth, this.canvas.clientHeight);\n                this.renderer.draw(this.camera.matrix);\n            }\n            requestAnimationFrame(loop);\n        };\n        requestAnimationFrame(loop);\n    }\n}\n", "import { Editor } from \"./editor\";\nimport { getLayerColor } from \"./colors\";\n\nconst canvas = document.getElementById(\"editor-canvas\") as HTMLCanvasElement;\nif (!canvas) {\n    throw new Error(\"Canvas element #editor-canvas not found\");\n}\n\nconst baseUrl = window.location.origin;\nconst editor = new Editor(canvas, baseUrl);\n\nfunction buildLayerPanel() {\n    const panel = document.getElementById(\"layer-panel\");\n    if (!panel) return;\n    panel.innerHTML = \"\";\n\n    const layers = editor.getLayers();\n    for (const layerName of layers) {\n        const row = document.createElement(\"label\");\n        row.className = \"layer-row\";\n\n        const cb = document.createElement(\"input\");\n        cb.type = \"checkbox\";\n        cb.checked = editor.isLayerVisible(layerName);\n        cb.addEventListener(\"change\", () => {\n            editor.setLayerVisible(layerName, cb.checked);\n        });\n\n        const swatch = document.createElement(\"span\");\n        swatch.className = \"layer-swatch\";\n        const [r, g, b] = getLayerColor(layerName);\n        swatch.style.background = `rgb(${Math.round(r * 255)},${Math.round(g * 255)},${Math.round(b * 255)})`;\n\n        const label = document.createElement(\"span\");\n        label.textContent = layerName;\n\n        row.appendChild(cb);\n        row.appendChild(swatch);\n        row.appendChild(label);\n        panel.appendChild(row);\n    }\n}\n\neditor.init().then(() => {\n    buildLayerPanel();\n    editor.setOnLayersChanged(buildLayerPanel);\n}).catch((err) => {\n    console.error(\"Failed to initialize editor:\", err);\n});\n"],
  "mappings": ";AACO,IAAM,OAAN,MAAM,MAAK;AAAA,EACd;AAAA,EACA;AAAA,EAEA,YAAY,IAAY,GAAG,IAAY,GAAG;AACtC,SAAK,IAAI;AACT,SAAK,IAAI;AAAA,EACb;AAAA,EAEA,OAAa;AACT,WAAO,IAAI,MAAK,KAAK,GAAG,KAAK,CAAC;AAAA,EAClC;AAAA,EAEA,EAAE,OAAO,QAAQ,IAAI;AACjB,UAAM,KAAK;AACX,UAAM,KAAK;AAAA,EACf;AAAA,EAEA,IAAI,YAAoB;AACpB,WAAO,KAAK,KAAK,KAAK,KAAK,IAAI,KAAK,KAAK,CAAC;AAAA,EAC9C;AAAA,EAEA,IAAI,SAAe;AACf,WAAO,IAAI,MAAK,CAAC,KAAK,GAAG,KAAK,CAAC;AAAA,EACnC;AAAA,EAEA,YAAkB;AACd,UAAM,IAAI,KAAK;AACf,QAAI,MAAM;AAAG,aAAO,IAAI,MAAK,GAAG,CAAC;AACjC,WAAO,IAAI,MAAK,KAAK,IAAI,GAAG,KAAK,IAAI,CAAC;AAAA,EAC1C;AAAA,EAEA,IAAI,GAAe;AACf,WAAO,IAAI,MAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC;AAAA,EAC9C;AAAA,EAEA,IAAI,GAAe;AACf,WAAO,IAAI,MAAK,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,CAAC;AAAA,EAC9C;AAAA,EAEA,SAAS,GAAiB;AACtB,WAAO,IAAI,MAAK,KAAK,IAAI,GAAG,KAAK,IAAI,CAAC;AAAA,EAC1C;AACJ;AAKO,IAAM,UAAN,MAAM,SAAQ;AAAA,EACjB;AAAA,EAEA,YAAY,UAAuC;AAC/C,SAAK,WAAW,IAAI,aAAa,QAAQ;AAAA,EAC7C;AAAA,EAEA,OAAO,WAAoB;AACvB,WAAO,IAAI,SAAQ,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,EAClD;AAAA,EAEA,OAAO,aAAa,OAAe,QAAyB;AACxD,WAAO,IAAI,SAAQ,CAAC,IAAI,OAAO,GAAG,GAAG,GAAG,KAAK,QAAQ,GAAG,IAAI,GAAG,CAAC,CAAC;AAAA,EACrE;AAAA,EAEA,OAAO,YAAY,GAAW,GAAoB;AAC9C,WAAO,IAAI,SAAQ,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,EAClD;AAAA,EAEA,OAAO,QAAQ,GAAW,GAAoB;AAC1C,WAAO,IAAI,SAAQ,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,EAClD;AAAA,EAEA,OAAO,SAAS,SAA0B;AACtC,UAAM,IAAI,KAAK,IAAI,OAAO;AAC1B,UAAM,IAAI,KAAK,IAAI,OAAO;AAC1B,WAAO,IAAI,SAAQ,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,EACnD;AAAA,EAEA,OAAgB;AACZ,WAAO,IAAI,SAAQ,KAAK,QAAQ;AAAA,EACpC;AAAA,EAEA,UAAU,KAAiB;AACvB,UAAM,IAAI,KAAK;AACf,UAAM,IAAI,IAAI,IAAI,EAAE,CAAC,IAAK,IAAI,IAAI,EAAE,CAAC,IAAK,EAAE,CAAC;AAC7C,UAAM,IAAI,IAAI,IAAI,EAAE,CAAC,IAAK,IAAI,IAAI,EAAE,CAAC,IAAK,EAAE,CAAC;AAC7C,WAAO,IAAI,KAAK,GAAG,CAAC;AAAA,EACxB;AAAA,EAEA,cAAc,GAAqB;AAC/B,UAAM,IAAI,KAAK;AACf,UAAM,KAAK,EAAE;AACb,UAAM,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC;AACzC,UAAM,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC;AACzC,UAAM,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC;AACzC,UAAM,MAAM,GAAG,CAAC,GAAI,MAAM,GAAG,CAAC,GAAI,MAAM,GAAG,CAAC;AAC5C,UAAM,MAAM,GAAG,CAAC,GAAI,MAAM,GAAG,CAAC,GAAI,MAAM,GAAG,CAAC;AAC5C,UAAM,MAAM,GAAG,CAAC,GAAI,MAAM,GAAG,CAAC,GAAI,MAAM,GAAG,CAAC;AAE5C,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,MAAE,CAAC,IAAI,MAAM,MAAM,MAAM,MAAM,MAAM;AACrC,WAAO;AAAA,EACX;AAAA,EAEA,SAAS,GAAqB;AAC1B,WAAO,KAAK,KAAK,EAAE,cAAc,CAAC;AAAA,EACtC;AAAA,EAEA,eAAe,GAAW,GAAoB;AAC1C,WAAO,KAAK,cAAc,SAAQ,YAAY,GAAG,CAAC,CAAC;AAAA,EACvD;AAAA,EAEA,WAAW,GAAW,GAAoB;AACtC,WAAO,KAAK,cAAc,SAAQ,QAAQ,GAAG,CAAC,CAAC;AAAA,EACnD;AAAA,EAEA,UAAmB;AACf,UAAM,IAAI,KAAK;AACf,UAAM,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC;AACzC,UAAM,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC;AACzC,UAAM,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC,GAAI,MAAM,EAAE,CAAC;AAEzC,UAAM,MAAM,MAAM,MAAM,MAAM;AAC9B,UAAM,MAAM,CAAC,MAAM,MAAM,MAAM;AAC/B,UAAM,MAAM,MAAM,MAAM,MAAM;AAE9B,UAAM,MAAM,MAAM,MAAM,MAAM,MAAM,MAAM;AAC1C,UAAM,MAAM,IAAM;AAElB,WAAO,IAAI,SAAQ;AAAA,MACf,MAAM;AAAA,OACL,CAAC,MAAM,MAAM,MAAM,OAAO;AAAA,OAC1B,MAAM,MAAM,MAAM,OAAO;AAAA,MAC1B,MAAM;AAAA,OACL,MAAM,MAAM,MAAM,OAAO;AAAA,OACzB,CAAC,MAAM,MAAM,MAAM,OAAO;AAAA,MAC3B,MAAM;AAAA,OACL,CAAC,MAAM,MAAM,MAAM,OAAO;AAAA,OAC1B,MAAM,MAAM,MAAM,OAAO;AAAA,IAC9B,CAAC;AAAA,EACL;AACJ;AAGO,IAAM,OAAN,MAAM,MAAK;AAAA,EACd,YACW,IAAY,GACZ,IAAY,GACZ,IAAY,GACZ,IAAY,GACrB;AAJS;AACA;AACA;AACA;AAEP,QAAI,KAAK,IAAI,GAAG;AAAE,WAAK,KAAK;AAAI,WAAK,KAAK,KAAK;AAAA,IAAG;AAClD,QAAI,KAAK,IAAI,GAAG;AAAE,WAAK,KAAK;AAAI,WAAK,KAAK,KAAK;AAAA,IAAG;AAAA,EACtD;AAAA,EAEA,IAAI,KAAa;AAAE,WAAO,KAAK,IAAI,KAAK;AAAA,EAAG;AAAA,EAC3C,IAAI,KAAa;AAAE,WAAO,KAAK,IAAI,KAAK;AAAA,EAAG;AAAA,EAC3C,IAAI,SAAe;AAAE,WAAO,IAAI,KAAK,KAAK,IAAI,KAAK,IAAI,GAAG,KAAK,IAAI,KAAK,IAAI,CAAC;AAAA,EAAG;AAAA,EAEhF,OAAO,YAAY,QAAsB;AACrC,QAAI,OAAO,WAAW;AAAG,aAAO,IAAI,MAAK;AACzC,QAAI,OAAO,UAAU,OAAO,UAAU,OAAO,WAAW,OAAO;AAC/D,eAAW,KAAK,QAAQ;AACpB,UAAI,EAAE,IAAI;AAAM,eAAO,EAAE;AACzB,UAAI,EAAE,IAAI;AAAM,eAAO,EAAE;AACzB,UAAI,EAAE,IAAI;AAAM,eAAO,EAAE;AACzB,UAAI,EAAE,IAAI;AAAM,eAAO,EAAE;AAAA,IAC7B;AACA,WAAO,IAAI,MAAK,MAAM,MAAM,OAAO,MAAM,OAAO,IAAI;AAAA,EACxD;AAAA,EAEA,OAAO,QAAQ,OAAqB;AAChC,QAAI,OAAO,UAAU,OAAO,UAAU,OAAO,WAAW,OAAO;AAC/D,eAAW,KAAK,OAAO;AACnB,UAAI,EAAE,MAAM,KAAK,EAAE,MAAM;AAAG;AAC5B,UAAI,EAAE,IAAI;AAAM,eAAO,EAAE;AACzB,UAAI,EAAE,IAAI;AAAM,eAAO,EAAE;AACzB,UAAI,EAAE,KAAK;AAAM,eAAO,EAAE;AAC1B,UAAI,EAAE,KAAK;AAAM,eAAO,EAAE;AAAA,IAC9B;AACA,QAAI,SAAS;AAAU,aAAO,IAAI,MAAK;AACvC,WAAO,IAAI,MAAK,MAAM,MAAM,OAAO,MAAM,OAAO,IAAI;AAAA,EACxD;AAAA,EAEA,eAAe,GAAkB;AAC7B,WAAO,EAAE,KAAK,KAAK,KAAK,EAAE,KAAK,KAAK,MAAM,EAAE,KAAK,KAAK,KAAK,EAAE,KAAK,KAAK;AAAA,EAC3E;AAAA,EAEA,KAAK,GAAiB;AAClB,WAAO,IAAI,MAAK,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,KAAK,IAAI,IAAI,GAAG,KAAK,IAAI,IAAI,CAAC;AAAA,EAC1E;AACJ;;;ACnMO,IAAM,UAAN,MAAc;AAAA,EACjB,gBAAsB,IAAI,KAAK,GAAG,CAAC;AAAA,EACnC,SAAe,IAAI,KAAK,GAAG,CAAC;AAAA,EAC5B,OAAe;AAAA,EAEf,IAAI,SAAkB;AAClB,UAAM,KAAK,KAAK,cAAc,IAAI;AAClC,UAAM,KAAK,KAAK,cAAc,IAAI;AAClC,UAAM,KAAK,KAAK,OAAO,IAAI,KAAK,OAAO,IAAI,KAAK;AAChD,UAAM,KAAK,KAAK,OAAO,IAAI,KAAK,OAAO,IAAI,KAAK;AAChD,UAAM,OAAO,EAAE,KAAK,OAAO,IAAI,MAAM;AACrC,UAAM,MAAM,EAAE,KAAK,OAAO,IAAI,MAAM;AACpC,WAAO,QAAQ,SAAS,EACnB,eAAe,MAAM,GAAG,EACxB,WAAW,KAAK,MAAM,KAAK,IAAI;AAAA,EACxC;AAAA,EAEA,IAAI,OAAa;AACb,UAAM,IAAI,KAAK,OAAO,QAAQ;AAC9B,UAAM,QAAQ,EAAE,UAAU,IAAI,KAAK,GAAG,CAAC,CAAC;AACxC,UAAM,MAAM,EAAE,UAAU,IAAI,KAAK,KAAK,cAAc,GAAG,KAAK,cAAc,CAAC,CAAC;AAC5E,WAAO,IAAI,KAAK,MAAM,GAAG,MAAM,GAAG,IAAI,IAAI,MAAM,GAAG,IAAI,IAAI,MAAM,CAAC;AAAA,EACtE;AAAA,EAEA,IAAI,KAAK,MAAY;AACjB,UAAM,SAAS,KAAK,cAAc,IAAI,KAAK;AAC3C,UAAM,SAAS,KAAK,cAAc,IAAI,KAAK;AAC3C,SAAK,OAAO,KAAK,IAAI,QAAQ,MAAM;AACnC,SAAK,SAAS,KAAK;AAAA,EACvB;AAAA,EAEA,UAAU,OAAmB;AACzB,SAAK,SAAS,KAAK,OAAO,IAAI,KAAK;AAAA,EACvC;AAAA,EAEA,gBAAgB,GAAe;AAC3B,WAAO,KAAK,OAAO,QAAQ,EAAE,UAAU,CAAC;AAAA,EAC5C;AAAA,EAEA,gBAAgB,GAAe;AAC3B,WAAO,KAAK,OAAO,UAAU,CAAC;AAAA,EAClC;AACJ;;;AC1CA,IAAM,aAAa;AACnB,IAAM,YAAY;AAClB,IAAM,wBAAwB;AAC9B,IAAM,wBAAwB;AAKvB,IAAM,aAAN,MAAiB;AAAA,EACpB,YACoB,QACT,QACA,UACA,WAAW,KACX,WAAW,KACpB;AALkB;AACT;AACA;AACA;AACA;AAEP,SAAK,OAAO,iBAAiB,SAAS,CAAC,MAAM,KAAK,UAAU,CAAC,GAAG,EAAE,SAAS,MAAM,CAAC;AAElF,QAAI,YAAyB;AAC7B,QAAI,WAAW;AAEf,SAAK,OAAO,iBAAiB,aAAa,CAAC,MAAkB;AACzD,UAAI,EAAE,WAAW,KAAK,EAAE,WAAW,GAAG;AAClC,UAAE,eAAe;AACjB,mBAAW;AACX,oBAAY,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO;AAAA,MAC7C;AAAA,IACJ,CAAC;AAED,SAAK,OAAO,iBAAiB,aAAa,CAAC,MAAkB;AACzD,UAAI,YAAY,WAAW;AACvB,cAAM,MAAM,IAAI,KAAK,EAAE,SAAS,EAAE,OAAO;AACzC,cAAM,QAAQ,IAAI,IAAI,SAAS;AAC/B,aAAK,YAAY,CAAC,MAAM,GAAG,CAAC,MAAM,CAAC;AACnC,oBAAY;AAAA,MAChB;AAAA,IACJ,CAAC;AAED,SAAK,OAAO,iBAAiB,WAAW,CAAC,MAAkB;AACvD,UAAI,EAAE,WAAW,KAAK,EAAE,WAAW,GAAG;AAClC,mBAAW;AACX,oBAAY;AAAA,MAChB;AAAA,IACJ,CAAC;AAED,SAAK,OAAO,iBAAiB,eAAe,CAAC,MAAM,EAAE,eAAe,CAAC;AAGrE,QAAI,aAA+B;AACnC,QAAI,YAA2B;AAE/B,SAAK,OAAO,iBAAiB,cAAc,CAAC,MAAkB;AAC1D,UAAI,EAAE,QAAQ,WAAW,GAAG;AACxB,oBAAY,KAAK,eAAe,EAAE,OAAO;AAAA,MAC7C,WAAW,EAAE,QAAQ,WAAW,GAAG;AAC/B,qBAAa,EAAE;AAAA,MACnB;AAAA,IACJ,CAAC;AAED,SAAK,OAAO,iBAAiB,aAAa,CAAC,MAAkB;AACzD,UAAI,EAAE,QAAQ,WAAW,KAAK,cAAc,MAAM;AAC9C,cAAM,MAAM,KAAK,eAAe,EAAE,OAAO;AACzC,cAAM,QAAS,MAAM,YAAa;AAClC,aAAK,aAAa,YAAY,MAAM,CAAC,QAAQ,KAAK;AAClD,oBAAY;AAAA,MAChB,WAAW,EAAE,QAAQ,WAAW,KAAK,eAAe,MAAM;AACtD,cAAM,KAAK,WAAW,CAAC,EAAG,SAAS,KAAK,WAAW,CAAC,EAAG;AACvD,cAAM,KAAK,EAAE,QAAQ,CAAC,EAAG,SAAS,KAAK,EAAE,QAAQ,CAAC,EAAG;AACrD,aAAK,YAAY,KAAK,IAAI,KAAK,EAAE;AACjC,qBAAa,EAAE;AAAA,MACnB;AAAA,IACJ,CAAC;AAED,SAAK,OAAO,iBAAiB,YAAY,MAAM;AAC3C,kBAAY;AACZ,mBAAa;AAAA,IACjB,CAAC;AAAA,EACL;AAAA,EAEA,eAAe,SAA4B;AACvC,UAAM,KAAK,QAAQ,CAAC,EAAG,UAAU,QAAQ,CAAC,EAAG;AAC7C,UAAM,KAAK,QAAQ,CAAC,EAAG,UAAU,QAAQ,CAAC,EAAG;AAC7C,WAAO,KAAK,KAAK,KAAK,KAAK,KAAK,EAAE;AAAA,EACtC;AAAA,EAEA,UAAU,GAAqB;AAC3B,MAAE,eAAe;AACjB,QAAI,KAAK,EAAE;AACX,QAAI,EAAE,cAAc,WAAW;AAAgB,YAAM;AAAA,aAC5C,EAAE,cAAc,WAAW;AAAgB,YAAM;AAC1D,SAAK,KAAK,KAAK,EAAE,IAAI,KAAK,IAAI,uBAAuB,KAAK,IAAI,EAAE,CAAC;AAEjE,QAAI,EAAE,WAAW,EAAE,UAAU;AACzB,UAAI,KAAK,EAAE;AACX,UAAI,EAAE,cAAc,WAAW;AAAgB,cAAM;AACrD,WAAK,KAAK,KAAK,EAAE,IAAI,KAAK,IAAI,uBAAuB,KAAK,IAAI,EAAE,CAAC;AACjE,WAAK,YAAY,IAAI,EAAE;AAAA,IAC3B,OAAO;AACH,YAAM,OAAO,KAAK,OAAO,sBAAsB;AAC/C,YAAM,QAAQ,IAAI,KAAK,EAAE,UAAU,KAAK,MAAM,EAAE,UAAU,KAAK,GAAG;AAClE,WAAK,aAAa,IAAI,KAAK;AAAA,IAC/B;AAAA,EACJ;AAAA,EAEA,YAAY,IAAY,IAAkB;AACtC,UAAM,QAAQ,IAAI,KAAK,KAAK,WAAW,KAAK,SAAS,EAAE,SAAS,IAAI,KAAK,OAAO,IAAI;AACpF,SAAK,OAAO,UAAU,KAAK;AAC3B,SAAK,SAAS;AAAA,EAClB;AAAA,EAEA,aAAa,OAAe,OAAoB;AAE5C,UAAM,cAAc,QAAQ,KAAK,OAAO,gBAAgB,KAAK,IAAI;AAEjE,SAAK,OAAO,QAAQ,KAAK,IAAI,QAAQ,CAAC,UAAU;AAChD,SAAK,OAAO,OAAO,KAAK,IAAI,KAAK,UAAU,KAAK,IAAI,KAAK,OAAO,MAAM,KAAK,QAAQ,CAAC;AAGpF,QAAI,eAAe,OAAO;AACtB,YAAM,aAAa,KAAK,OAAO,gBAAgB,KAAK;AACpD,WAAK,OAAO,UAAU,YAAY,IAAI,UAAU,CAAC;AAAA,IACrD;AAEA,SAAK,SAAS;AAAA,EAClB;AACJ;;;AC/HA,IAAM,UAAN,MAAc;AAAA,EACV,YACW,IACA,MACA,UACT;AAHS;AACA;AACA;AAAA,EACR;AAAA,EAEH,GAAG,GAAW;AAAE,SAAK,GAAG,UAAU,KAAK,UAAU,CAAC;AAAA,EAAG;AAAA,EACrD,MAAM,WAAoB,MAAoB;AAC1C,SAAK,GAAG,iBAAiB,KAAK,UAAU,WAAW,IAAI;AAAA,EAC3D;AACJ;AAGO,IAAM,gBAAN,MAAM,eAAc;AAAA,EAKvB,YACW,IACP,UACA,UACF;AAHS;AAIP,UAAM,OAAO,eAAc,QAAQ,IAAI,GAAG,eAAe,QAAQ;AACjE,UAAM,OAAO,eAAc,QAAQ,IAAI,GAAG,iBAAiB,QAAQ;AACnE,SAAK,UAAU,eAAc,KAAK,IAAI,MAAM,IAAI;AAChD,SAAK,mBAAmB;AACxB,SAAK,kBAAkB;AAAA,EAC3B;AAAA,EAdA;AAAA,EACA,WAAoC,CAAC;AAAA,EACrC,UAAkC,CAAC;AAAA,EAcnC,OAAO,QAAQ,IAA4B,MAAc,KAA0B;AAC/E,UAAM,SAAS,GAAG,aAAa,IAAI;AACnC,OAAG,aAAa,QAAQ,GAAG;AAC3B,OAAG,cAAc,MAAM;AACvB,QAAI,CAAC,GAAG,mBAAmB,QAAQ,GAAG,cAAc,GAAG;AACnD,YAAM,OAAO,GAAG,iBAAiB,MAAM;AACvC,SAAG,aAAa,MAAM;AACtB,YAAM,IAAI,MAAM,yBAAyB,IAAI,EAAE;AAAA,IACnD;AACA,WAAO;AAAA,EACX;AAAA,EAEA,OAAO,KAAK,IAA4B,MAAmB,MAAiC;AACxF,UAAM,OAAO,GAAG,cAAc;AAC9B,OAAG,aAAa,MAAM,IAAI;AAC1B,OAAG,aAAa,MAAM,IAAI;AAC1B,OAAG,YAAY,IAAI;AACnB,QAAI,CAAC,GAAG,oBAAoB,MAAM,GAAG,WAAW,GAAG;AAC/C,YAAM,OAAO,GAAG,kBAAkB,IAAI;AACtC,SAAG,cAAc,IAAI;AACrB,YAAM,IAAI,MAAM,sBAAsB,IAAI,EAAE;AAAA,IAChD;AACA,WAAO;AAAA,EACX;AAAA,EAEA,qBAAqB;AACjB,UAAM,QAAQ,KAAK,GAAG,oBAAoB,KAAK,SAAS,KAAK,GAAG,eAAe;AAC/E,aAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC5B,YAAM,OAAO,KAAK,GAAG,iBAAiB,KAAK,SAAS,CAAC;AACrD,YAAM,MAAM,KAAK,GAAG,mBAAmB,KAAK,SAAS,KAAK,IAAI;AAC9D,WAAK,SAAS,KAAK,IAAI,IAAI,IAAI,QAAQ,KAAK,IAAI,KAAK,MAAM,GAAG;AAAA,IAClE;AAAA,EACJ;AAAA,EAEA,oBAAoB;AAChB,UAAM,QAAQ,KAAK,GAAG,oBAAoB,KAAK,SAAS,KAAK,GAAG,iBAAiB;AACjF,aAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC5B,YAAM,OAAO,KAAK,GAAG,gBAAgB,KAAK,SAAS,CAAC;AACpD,WAAK,QAAQ,KAAK,IAAI,IAAI,KAAK,GAAG,kBAAkB,KAAK,SAAS,KAAK,IAAI;AAAA,IAC/E;AAAA,EACJ;AAAA,EAEA,OAAO;AAAE,SAAK,GAAG,WAAW,KAAK,OAAO;AAAA,EAAG;AAC/C;AAGO,IAAM,SAAN,MAAa;AAAA,EAIhB,YAAmB,IAA4B,QAAiB;AAA7C;AACf,SAAK,SAAS,UAAU,GAAG;AAC3B,SAAK,OAAO,GAAG,aAAa;AAAA,EAChC;AAAA,EANA;AAAA,EACA;AAAA,EAOA,UAAU;AAAE,SAAK,GAAG,aAAa,KAAK,IAAI;AAAA,EAAG;AAAA,EAC7C,OAAO;AAAE,SAAK,GAAG,WAAW,KAAK,QAAQ,KAAK,IAAI;AAAA,EAAG;AAAA,EAErD,IAAI,MAAoB,OAAgB;AACpC,SAAK,KAAK;AACV,SAAK,GAAG,WAAW,KAAK,QAAQ,MAAM,SAAS,KAAK,GAAG,WAAW;AAAA,EACtE;AACJ;AAGO,IAAM,cAAN,MAAkB;AAAA,EAIrB,YAAmB,IAA4B;AAA5B;AACf,SAAK,MAAM,GAAG,kBAAkB;AAChC,SAAK,KAAK;AAAA,EACd;AAAA,EANA;AAAA,EACA,UAAoB,CAAC;AAAA,EAOrB,UAAU;AACN,SAAK,GAAG,kBAAkB,KAAK,GAAG;AAClC,eAAW,OAAO,KAAK;AAAS,UAAI,QAAQ;AAAA,EAChD;AAAA,EAEA,OAAO;AAAE,SAAK,GAAG,gBAAgB,KAAK,GAAG;AAAA,EAAG;AAAA,EAE5C,OAAO,QAAgB,MAAsB;AACzC,UAAM,IAAI,IAAI,OAAO,KAAK,EAAE;AAC5B,MAAE,KAAK;AACP,SAAK,GAAG,oBAAoB,QAAQ,MAAM,KAAK,GAAG,OAAO,OAAO,GAAG,CAAC;AACpE,SAAK,GAAG,wBAAwB,MAAM;AACtC,SAAK,QAAQ,KAAK,CAAC;AACnB,WAAO;AAAA,EACX;AACJ;;;ACzHO,IAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUrB,IAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAarB,IAAM,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBtB,IAAM,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AC1Cd,SAAR,OAAwB,MAAM,aAAa,MAAM,GAAG;AAEvD,QAAM,WAAW,eAAe,YAAY;AAC5C,QAAM,WAAW,WAAW,YAAY,CAAC,IAAI,MAAM,KAAK;AACxD,MAAI,YAAY,WAAW,MAAM,GAAG,UAAU,KAAK,IAAI;AACvD,QAAM,YAAY,CAAC;AAEnB,MAAI,CAAC,aAAa,UAAU,SAAS,UAAU;AAAM,WAAO;AAE5D,MAAI,MAAM,MAAM;AAEhB,MAAI;AAAU,gBAAY,eAAe,MAAM,aAAa,WAAW,GAAG;AAG1E,MAAI,KAAK,SAAS,KAAK,KAAK;AACxB,WAAO,KAAK,CAAC;AACb,WAAO,KAAK,CAAC;AACb,QAAI,OAAO;AACX,QAAI,OAAO;AAEX,aAAS,IAAI,KAAK,IAAI,UAAU,KAAK,KAAK;AACtC,YAAM,IAAI,KAAK,CAAC;AAChB,YAAM,IAAI,KAAK,IAAI,CAAC;AACpB,UAAI,IAAI;AAAM,eAAO;AACrB,UAAI,IAAI;AAAM,eAAO;AACrB,UAAI,IAAI;AAAM,eAAO;AACrB,UAAI,IAAI;AAAM,eAAO;AAAA,IACzB;AAGA,cAAU,KAAK,IAAI,OAAO,MAAM,OAAO,IAAI;AAC3C,cAAU,YAAY,IAAI,QAAQ,UAAU;AAAA,EAChD;AAEA,eAAa,WAAW,WAAW,KAAK,MAAM,MAAM,SAAS,CAAC;AAE9D,SAAO;AACX;AAGA,SAAS,WAAW,MAAM,OAAO,KAAK,KAAK,WAAW;AAClD,MAAI;AAEJ,MAAI,cAAe,WAAW,MAAM,OAAO,KAAK,GAAG,IAAI,GAAI;AACvD,aAAS,IAAI,OAAO,IAAI,KAAK,KAAK;AAAK,aAAO,WAAW,IAAI,MAAM,GAAG,KAAK,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG,IAAI;AAAA,EACpG,OAAO;AACH,aAAS,IAAI,MAAM,KAAK,KAAK,OAAO,KAAK;AAAK,aAAO,WAAW,IAAI,MAAM,GAAG,KAAK,CAAC,GAAG,KAAK,IAAI,CAAC,GAAG,IAAI;AAAA,EAC3G;AAEA,MAAI,QAAQ,OAAO,MAAM,KAAK,IAAI,GAAG;AACjC,eAAW,IAAI;AACf,WAAO,KAAK;AAAA,EAChB;AAEA,SAAO;AACX;AAGA,SAAS,aAAa,OAAO,KAAK;AAC9B,MAAI,CAAC;AAAO,WAAO;AACnB,MAAI,CAAC;AAAK,UAAM;AAEhB,MAAI,IAAI,OACJ;AACJ,KAAG;AACC,YAAQ;AAER,QAAI,CAAC,EAAE,YAAY,OAAO,GAAG,EAAE,IAAI,KAAK,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,MAAM,IAAI;AACpE,iBAAW,CAAC;AACZ,UAAI,MAAM,EAAE;AACZ,UAAI,MAAM,EAAE;AAAM;AAClB,cAAQ;AAAA,IAEZ,OAAO;AACH,UAAI,EAAE;AAAA,IACV;AAAA,EACJ,SAAS,SAAS,MAAM;AAExB,SAAO;AACX;AAGA,SAAS,aAAa,KAAK,WAAW,KAAK,MAAM,MAAM,SAAS,MAAM;AAClE,MAAI,CAAC;AAAK;AAGV,MAAI,CAAC,QAAQ;AAAS,eAAW,KAAK,MAAM,MAAM,OAAO;AAEzD,MAAI,OAAO;AAGX,SAAO,IAAI,SAAS,IAAI,MAAM;AAC1B,UAAM,OAAO,IAAI;AACjB,UAAM,OAAO,IAAI;AAEjB,QAAI,UAAU,YAAY,KAAK,MAAM,MAAM,OAAO,IAAI,MAAM,GAAG,GAAG;AAC9D,gBAAU,KAAK,KAAK,GAAG,IAAI,GAAG,KAAK,CAAC;AAEpC,iBAAW,GAAG;AAGd,YAAM,KAAK;AACX,aAAO,KAAK;AAEZ;AAAA,IACJ;AAEA,UAAM;AAGN,QAAI,QAAQ,MAAM;AAEd,UAAI,CAAC,MAAM;AACP,qBAAa,aAAa,GAAG,GAAG,WAAW,KAAK,MAAM,MAAM,SAAS,CAAC;AAAA,MAG1E,WAAW,SAAS,GAAG;AACnB,cAAM,uBAAuB,aAAa,GAAG,GAAG,SAAS;AACzD,qBAAa,KAAK,WAAW,KAAK,MAAM,MAAM,SAAS,CAAC;AAAA,MAG5D,WAAW,SAAS,GAAG;AACnB,oBAAY,KAAK,WAAW,KAAK,MAAM,MAAM,OAAO;AAAA,MACxD;AAEA;AAAA,IACJ;AAAA,EACJ;AACJ;AAGA,SAAS,MAAM,KAAK;AAChB,QAAM,IAAI,IAAI,MACV,IAAI,KACJ,IAAI,IAAI;AAEZ,MAAI,KAAK,GAAG,GAAG,CAAC,KAAK;AAAG,WAAO;AAG/B,QAAM,KAAK,EAAE,GAAG,KAAK,EAAE,GAAG,KAAK,EAAE,GAAG,KAAK,EAAE,GAAG,KAAK,EAAE,GAAG,KAAK,EAAE;AAG/D,QAAM,KAAK,KAAK,IAAI,IAAI,IAAI,EAAE,GAC1B,KAAK,KAAK,IAAI,IAAI,IAAI,EAAE,GACxB,KAAK,KAAK,IAAI,IAAI,IAAI,EAAE,GACxB,KAAK,KAAK,IAAI,IAAI,IAAI,EAAE;AAE5B,MAAI,IAAI,EAAE;AACV,SAAO,MAAM,GAAG;AACZ,QAAI,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAC9C,2BAA2B,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,EAAE,CAAC,KAC3D,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,KAAK;AAAG,aAAO;AACzC,QAAI,EAAE;AAAA,EACV;AAEA,SAAO;AACX;AAEA,SAAS,YAAY,KAAK,MAAM,MAAM,SAAS;AAC3C,QAAM,IAAI,IAAI,MACV,IAAI,KACJ,IAAI,IAAI;AAEZ,MAAI,KAAK,GAAG,GAAG,CAAC,KAAK;AAAG,WAAO;AAE/B,QAAM,KAAK,EAAE,GAAG,KAAK,EAAE,GAAG,KAAK,EAAE,GAAG,KAAK,EAAE,GAAG,KAAK,EAAE,GAAG,KAAK,EAAE;AAG/D,QAAM,KAAK,KAAK,IAAI,IAAI,IAAI,EAAE,GAC1B,KAAK,KAAK,IAAI,IAAI,IAAI,EAAE,GACxB,KAAK,KAAK,IAAI,IAAI,IAAI,EAAE,GACxB,KAAK,KAAK,IAAI,IAAI,IAAI,EAAE;AAG5B,QAAM,OAAO,OAAO,IAAI,IAAI,MAAM,MAAM,OAAO,GAC3C,OAAO,OAAO,IAAI,IAAI,MAAM,MAAM,OAAO;AAE7C,MAAI,IAAI,IAAI,OACR,IAAI,IAAI;AAGZ,SAAO,KAAK,EAAE,KAAK,QAAQ,KAAK,EAAE,KAAK,MAAM;AACzC,QAAI,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,MAAM,KAAK,MAAM,KACrE,2BAA2B,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,EAAE,CAAC,KAAK,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,KAAK;AAAG,aAAO;AACzG,QAAI,EAAE;AAEN,QAAI,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,MAAM,KAAK,MAAM,KACrE,2BAA2B,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,EAAE,CAAC,KAAK,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,KAAK;AAAG,aAAO;AACzG,QAAI,EAAE;AAAA,EACV;AAGA,SAAO,KAAK,EAAE,KAAK,MAAM;AACrB,QAAI,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,MAAM,KAAK,MAAM,KACrE,2BAA2B,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,EAAE,CAAC,KAAK,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,KAAK;AAAG,aAAO;AACzG,QAAI,EAAE;AAAA,EACV;AAGA,SAAO,KAAK,EAAE,KAAK,MAAM;AACrB,QAAI,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,MAAM,MAAM,KAAK,MAAM,KACrE,2BAA2B,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE,GAAG,EAAE,CAAC,KAAK,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,KAAK;AAAG,aAAO;AACzG,QAAI,EAAE;AAAA,EACV;AAEA,SAAO;AACX;AAGA,SAAS,uBAAuB,OAAO,WAAW;AAC9C,MAAI,IAAI;AACR,KAAG;AACC,UAAM,IAAI,EAAE,MACR,IAAI,EAAE,KAAK;AAEf,QAAI,CAAC,OAAO,GAAG,CAAC,KAAK,WAAW,GAAG,GAAG,EAAE,MAAM,CAAC,KAAK,cAAc,GAAG,CAAC,KAAK,cAAc,GAAG,CAAC,GAAG;AAE5F,gBAAU,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;AAG5B,iBAAW,CAAC;AACZ,iBAAW,EAAE,IAAI;AAEjB,UAAI,QAAQ;AAAA,IAChB;AACA,QAAI,EAAE;AAAA,EACV,SAAS,MAAM;AAEf,SAAO,aAAa,CAAC;AACzB;AAGA,SAAS,YAAY,OAAO,WAAW,KAAK,MAAM,MAAM,SAAS;AAE7D,MAAI,IAAI;AACR,KAAG;AACC,QAAI,IAAI,EAAE,KAAK;AACf,WAAO,MAAM,EAAE,MAAM;AACjB,UAAI,EAAE,MAAM,EAAE,KAAK,gBAAgB,GAAG,CAAC,GAAG;AAEtC,YAAI,IAAI,aAAa,GAAG,CAAC;AAGzB,YAAI,aAAa,GAAG,EAAE,IAAI;AAC1B,YAAI,aAAa,GAAG,EAAE,IAAI;AAG1B,qBAAa,GAAG,WAAW,KAAK,MAAM,MAAM,SAAS,CAAC;AACtD,qBAAa,GAAG,WAAW,KAAK,MAAM,MAAM,SAAS,CAAC;AACtD;AAAA,MACJ;AACA,UAAI,EAAE;AAAA,IACV;AACA,QAAI,EAAE;AAAA,EACV,SAAS,MAAM;AACnB;AAGA,SAAS,eAAe,MAAM,aAAa,WAAW,KAAK;AACvD,QAAM,QAAQ,CAAC;AAEf,WAAS,IAAI,GAAG,MAAM,YAAY,QAAQ,IAAI,KAAK,KAAK;AACpD,UAAM,QAAQ,YAAY,CAAC,IAAI;AAC/B,UAAM,MAAM,IAAI,MAAM,IAAI,YAAY,IAAI,CAAC,IAAI,MAAM,KAAK;AAC1D,UAAM,OAAO,WAAW,MAAM,OAAO,KAAK,KAAK,KAAK;AACpD,QAAI,SAAS,KAAK;AAAM,WAAK,UAAU;AACvC,UAAM,KAAK,YAAY,IAAI,CAAC;AAAA,EAChC;AAEA,QAAM,KAAK,cAAc;AAGzB,WAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACnC,gBAAY,cAAc,MAAM,CAAC,GAAG,SAAS;AAAA,EACjD;AAEA,SAAO;AACX;AAEA,SAAS,eAAe,GAAG,GAAG;AAC1B,MAAI,SAAS,EAAE,IAAI,EAAE;AAGrB,MAAI,WAAW,GAAG;AACd,aAAS,EAAE,IAAI,EAAE;AACjB,QAAI,WAAW,GAAG;AACd,YAAM,UAAU,EAAE,KAAK,IAAI,EAAE,MAAM,EAAE,KAAK,IAAI,EAAE;AAChD,YAAM,UAAU,EAAE,KAAK,IAAI,EAAE,MAAM,EAAE,KAAK,IAAI,EAAE;AAChD,eAAS,SAAS;AAAA,IACtB;AAAA,EACJ;AACA,SAAO;AACX;AAGA,SAAS,cAAc,MAAM,WAAW;AACpC,QAAM,SAAS,eAAe,MAAM,SAAS;AAC7C,MAAI,CAAC,QAAQ;AACT,WAAO;AAAA,EACX;AAEA,QAAM,gBAAgB,aAAa,QAAQ,IAAI;AAG/C,eAAa,eAAe,cAAc,IAAI;AAC9C,SAAO,aAAa,QAAQ,OAAO,IAAI;AAC3C;AAGA,SAAS,eAAe,MAAM,WAAW;AACrC,MAAI,IAAI;AACR,QAAM,KAAK,KAAK;AAChB,QAAM,KAAK,KAAK;AAChB,MAAI,KAAK;AACT,MAAI;AAKJ,MAAI,OAAO,MAAM,CAAC;AAAG,WAAO;AAC5B,KAAG;AACC,QAAI,OAAO,MAAM,EAAE,IAAI;AAAG,aAAO,EAAE;AAAA,aAC1B,MAAM,EAAE,KAAK,MAAM,EAAE,KAAK,KAAK,EAAE,KAAK,MAAM,EAAE,GAAG;AACtD,YAAM,IAAI,EAAE,KAAK,KAAK,EAAE,MAAM,EAAE,KAAK,IAAI,EAAE,MAAM,EAAE,KAAK,IAAI,EAAE;AAC9D,UAAI,KAAK,MAAM,IAAI,IAAI;AACnB,aAAK;AACL,YAAI,EAAE,IAAI,EAAE,KAAK,IAAI,IAAI,EAAE;AAC3B,YAAI,MAAM;AAAI,iBAAO;AAAA,MACzB;AAAA,IACJ;AACA,QAAI,EAAE;AAAA,EACV,SAAS,MAAM;AAEf,MAAI,CAAC;AAAG,WAAO;AAMf,QAAM,OAAO;AACb,QAAM,KAAK,EAAE;AACb,QAAM,KAAK,EAAE;AACb,MAAI,SAAS;AAEb,MAAI;AAEJ,KAAG;AACC,QAAI,MAAM,EAAE,KAAK,EAAE,KAAK,MAAM,OAAO,EAAE,KAC/B,gBAAgB,KAAK,KAAK,KAAK,IAAI,IAAI,IAAI,IAAI,KAAK,KAAK,KAAK,IAAI,IAAI,EAAE,GAAG,EAAE,CAAC,GAAG;AAErF,YAAM,MAAM,KAAK,IAAI,KAAK,EAAE,CAAC,KAAK,KAAK,EAAE;AAEzC,UAAI,cAAc,GAAG,IAAI,MACpB,MAAM,UAAW,QAAQ,WAAW,EAAE,IAAI,EAAE,KAAM,EAAE,MAAM,EAAE,KAAK,qBAAqB,GAAG,CAAC,KAAO;AAClG,YAAI;AACJ,iBAAS;AAAA,MACb;AAAA,IACJ;AAEA,QAAI,EAAE;AAAA,EACV,SAAS,MAAM;AAEf,SAAO;AACX;AAGA,SAAS,qBAAqB,GAAG,GAAG;AAChC,SAAO,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,IAAI,KAAK,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,IAAI;AACpE;AAGA,SAAS,WAAW,OAAO,MAAM,MAAM,SAAS;AAC5C,MAAI,IAAI;AACR,KAAG;AACC,QAAI,EAAE,MAAM;AAAG,QAAE,IAAI,OAAO,EAAE,GAAG,EAAE,GAAG,MAAM,MAAM,OAAO;AACzD,MAAE,QAAQ,EAAE;AACZ,MAAE,QAAQ,EAAE;AACZ,QAAI,EAAE;AAAA,EACV,SAAS,MAAM;AAEf,IAAE,MAAM,QAAQ;AAChB,IAAE,QAAQ;AAEV,aAAW,CAAC;AAChB;AAIA,SAAS,WAAW,MAAM;AACtB,MAAI;AACJ,MAAI,SAAS;AAEb,KAAG;AACC,QAAI,IAAI;AACR,QAAI;AACJ,WAAO;AACP,QAAI,OAAO;AACX,gBAAY;AAEZ,WAAO,GAAG;AACN;AACA,UAAI,IAAI;AACR,UAAI,QAAQ;AACZ,eAAS,IAAI,GAAG,IAAI,QAAQ,KAAK;AAC7B;AACA,YAAI,EAAE;AACN,YAAI,CAAC;AAAG;AAAA,MACZ;AACA,UAAI,QAAQ;AAEZ,aAAO,QAAQ,KAAM,QAAQ,KAAK,GAAI;AAElC,YAAI,UAAU,MAAM,UAAU,KAAK,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI;AAClD,cAAI;AACJ,cAAI,EAAE;AACN;AAAA,QACJ,OAAO;AACH,cAAI;AACJ,cAAI,EAAE;AACN;AAAA,QACJ;AAEA,YAAI;AAAM,eAAK,QAAQ;AAAA;AAClB,iBAAO;AAEZ,UAAE,QAAQ;AACV,eAAO;AAAA,MACX;AAEA,UAAI;AAAA,IACR;AAEA,SAAK,QAAQ;AACb,cAAU;AAAA,EAEd,SAAS,YAAY;AAErB,SAAO;AACX;AAGA,SAAS,OAAO,GAAG,GAAG,MAAM,MAAM,SAAS;AAEvC,OAAK,IAAI,QAAQ,UAAU;AAC3B,OAAK,IAAI,QAAQ,UAAU;AAE3B,OAAK,IAAK,KAAK,KAAM;AACrB,OAAK,IAAK,KAAK,KAAM;AACrB,OAAK,IAAK,KAAK,KAAM;AACrB,OAAK,IAAK,KAAK,KAAM;AAErB,OAAK,IAAK,KAAK,KAAM;AACrB,OAAK,IAAK,KAAK,KAAM;AACrB,OAAK,IAAK,KAAK,KAAM;AACrB,OAAK,IAAK,KAAK,KAAM;AAErB,SAAO,IAAK,KAAK;AACrB;AAGA,SAAS,YAAY,OAAO;AACxB,MAAI,IAAI,OACJ,WAAW;AACf,KAAG;AACC,QAAI,EAAE,IAAI,SAAS,KAAM,EAAE,MAAM,SAAS,KAAK,EAAE,IAAI,SAAS;AAAI,iBAAW;AAC7E,QAAI,EAAE;AAAA,EACV,SAAS,MAAM;AAEf,SAAO;AACX;AAGA,SAAS,gBAAgB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI;AACrD,UAAQ,KAAK,OAAO,KAAK,QAAQ,KAAK,OAAO,KAAK,QAC1C,KAAK,OAAO,KAAK,QAAQ,KAAK,OAAO,KAAK,QAC1C,KAAK,OAAO,KAAK,QAAQ,KAAK,OAAO,KAAK;AACtD;AAGA,SAAS,2BAA2B,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI;AAChE,SAAO,EAAE,OAAO,MAAM,OAAO,OAAO,gBAAgB,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,EAAE;AACtF;AAGA,SAAS,gBAAgB,GAAG,GAAG;AAC3B,SAAO,EAAE,KAAK,MAAM,EAAE,KAAK,EAAE,KAAK,MAAM,EAAE,KAAK,CAAC,kBAAkB,GAAG,CAAC;AAAA,GAC9D,cAAc,GAAG,CAAC,KAAK,cAAc,GAAG,CAAC,KAAK,aAAa,GAAG,CAAC;AAAA,GAC9D,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,KAAK,KAAK,GAAG,EAAE,MAAM,CAAC;AAAA,EAC7C,OAAO,GAAG,CAAC,KAAK,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,IAAI,KAAK,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,IAAI;AACrF;AAGA,SAAS,KAAK,GAAG,GAAG,GAAG;AACnB,UAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE;AAC9D;AAGA,SAAS,OAAO,IAAI,IAAI;AACpB,SAAO,GAAG,MAAM,GAAG,KAAK,GAAG,MAAM,GAAG;AACxC;AAGA,SAAS,WAAW,IAAI,IAAI,IAAI,IAAI;AAChC,QAAM,KAAK,KAAK,KAAK,IAAI,IAAI,EAAE,CAAC;AAChC,QAAM,KAAK,KAAK,KAAK,IAAI,IAAI,EAAE,CAAC;AAChC,QAAM,KAAK,KAAK,KAAK,IAAI,IAAI,EAAE,CAAC;AAChC,QAAM,KAAK,KAAK,KAAK,IAAI,IAAI,EAAE,CAAC;AAEhC,MAAI,OAAO,MAAM,OAAO;AAAI,WAAO;AAEnC,MAAI,OAAO,KAAK,UAAU,IAAI,IAAI,EAAE;AAAG,WAAO;AAC9C,MAAI,OAAO,KAAK,UAAU,IAAI,IAAI,EAAE;AAAG,WAAO;AAC9C,MAAI,OAAO,KAAK,UAAU,IAAI,IAAI,EAAE;AAAG,WAAO;AAC9C,MAAI,OAAO,KAAK,UAAU,IAAI,IAAI,EAAE;AAAG,WAAO;AAE9C,SAAO;AACX;AAGA,SAAS,UAAU,GAAG,GAAG,GAAG;AACxB,SAAO,EAAE,KAAK,KAAK,IAAI,EAAE,GAAG,EAAE,CAAC,KAAK,EAAE,KAAK,KAAK,IAAI,EAAE,GAAG,EAAE,CAAC,KAAK,EAAE,KAAK,KAAK,IAAI,EAAE,GAAG,EAAE,CAAC,KAAK,EAAE,KAAK,KAAK,IAAI,EAAE,GAAG,EAAE,CAAC;AAC1H;AAEA,SAAS,KAAK,KAAK;AACf,SAAO,MAAM,IAAI,IAAI,MAAM,IAAI,KAAK;AACxC;AAGA,SAAS,kBAAkB,GAAG,GAAG;AAC7B,MAAI,IAAI;AACR,KAAG;AACC,QAAI,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,MAAM,EAAE,KAC7D,WAAW,GAAG,EAAE,MAAM,GAAG,CAAC;AAAG,aAAO;AAC5C,QAAI,EAAE;AAAA,EACV,SAAS,MAAM;AAEf,SAAO;AACX;AAGA,SAAS,cAAc,GAAG,GAAG;AACzB,SAAO,KAAK,EAAE,MAAM,GAAG,EAAE,IAAI,IAAI,IAC7B,KAAK,GAAG,GAAG,EAAE,IAAI,KAAK,KAAK,KAAK,GAAG,EAAE,MAAM,CAAC,KAAK,IACjD,KAAK,GAAG,GAAG,EAAE,IAAI,IAAI,KAAK,KAAK,GAAG,EAAE,MAAM,CAAC,IAAI;AACvD;AAGA,SAAS,aAAa,GAAG,GAAG;AACxB,MAAI,IAAI;AACR,MAAI,SAAS;AACb,QAAM,MAAM,EAAE,IAAI,EAAE,KAAK;AACzB,QAAM,MAAM,EAAE,IAAI,EAAE,KAAK;AACzB,KAAG;AACC,QAAM,EAAE,IAAI,OAAS,EAAE,KAAK,IAAI,MAAQ,EAAE,KAAK,MAAM,EAAE,KAC9C,MAAM,EAAE,KAAK,IAAI,EAAE,MAAM,KAAK,EAAE,MAAM,EAAE,KAAK,IAAI,EAAE,KAAK,EAAE;AAC/D,eAAS,CAAC;AACd,QAAI,EAAE;AAAA,EACV,SAAS,MAAM;AAEf,SAAO;AACX;AAIA,SAAS,aAAa,GAAG,GAAG;AACxB,QAAM,KAAK,WAAW,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAC/B,KAAK,WAAW,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAC7B,KAAK,EAAE,MACP,KAAK,EAAE;AAEX,IAAE,OAAO;AACT,IAAE,OAAO;AAET,KAAG,OAAO;AACV,KAAG,OAAO;AAEV,KAAG,OAAO;AACV,KAAG,OAAO;AAEV,KAAG,OAAO;AACV,KAAG,OAAO;AAEV,SAAO;AACX;AAGA,SAAS,WAAW,GAAG,GAAG,GAAG,MAAM;AAC/B,QAAM,IAAI,WAAW,GAAG,GAAG,CAAC;AAE5B,MAAI,CAAC,MAAM;AACP,MAAE,OAAO;AACT,MAAE,OAAO;AAAA,EAEb,OAAO;AACH,MAAE,OAAO,KAAK;AACd,MAAE,OAAO;AACT,SAAK,KAAK,OAAO;AACjB,SAAK,OAAO;AAAA,EAChB;AACA,SAAO;AACX;AAEA,SAAS,WAAW,GAAG;AACnB,IAAE,KAAK,OAAO,EAAE;AAChB,IAAE,KAAK,OAAO,EAAE;AAEhB,MAAI,EAAE;AAAO,MAAE,MAAM,QAAQ,EAAE;AAC/B,MAAI,EAAE;AAAO,MAAE,MAAM,QAAQ,EAAE;AACnC;AAEA,SAAS,WAAW,GAAG,GAAG,GAAG;AACzB,SAAO;AAAA,IACH;AAAA;AAAA,IACA;AAAA,IAAG;AAAA;AAAA,IACH,MAAM;AAAA;AAAA,IACN,MAAM;AAAA,IACN,GAAG;AAAA;AAAA,IACH,OAAO;AAAA;AAAA,IACP,OAAO;AAAA,IACP,SAAS;AAAA;AAAA,EACb;AACJ;AA+BA,SAAS,WAAW,MAAM,OAAO,KAAK,KAAK;AACvC,MAAI,MAAM;AACV,WAAS,IAAI,OAAO,IAAI,MAAM,KAAK,IAAI,KAAK,KAAK,KAAK;AAClD,YAAQ,KAAK,CAAC,IAAI,KAAK,CAAC,MAAM,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,CAAC;AACtD,QAAI;AAAA,EACR;AACA,SAAO;AACX;;;ACjpBA,IAAM,iBAAiB;AAGvB,SAAS,kBAAkB,GAAS,GAAS,GAAS,GAAmB;AACrE,SAAO,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;AACtE;AAEA,SAAS,WAAW,MAAoB,GAAW,GAAW,GAAW,GAAW,QAAgB,OAAe;AAC/G,WAAS,IAAI,GAAG,IAAI,OAAO,KAAK;AAC5B,SAAK,SAAS,IAAI,CAAC,IAAI;AACvB,SAAK,SAAS,IAAI,IAAI,CAAC,IAAI;AAC3B,SAAK,SAAS,IAAI,IAAI,CAAC,IAAI;AAC3B,SAAK,SAAS,IAAI,IAAI,CAAC,IAAI;AAAA,EAC/B;AACJ;AAUO,SAAS,oBACZ,QACA,OACA,GAAW,GAAW,GAAW,GACf;AAClB,QAAM,WAAW,OAAO,SAAS;AACjC,QAAM,WAAW,WAAW;AAC5B,QAAM,YAAY,IAAI,aAAa,WAAW,CAAC;AAC/C,QAAM,OAAO,IAAI,aAAa,QAAQ;AACtC,QAAM,SAAS,IAAI,aAAa,WAAW,CAAC;AAC5C,MAAI,KAAK;AAET,WAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACpC,UAAM,KAAK,OAAO,IAAI,CAAC;AACvB,UAAM,KAAK,OAAO,CAAC;AACnB,UAAM,OAAO,GAAG,IAAI,EAAE;AACtB,UAAM,MAAM,KAAK;AACjB,QAAI,QAAQ;AAAG;AAEf,UAAM,OAAO,KAAK,OAAO,UAAU;AACnC,UAAM,IAAI,KAAK,SAAS,QAAQ,CAAC;AACjC,UAAM,KAAK,EAAE;AAEb,UAAM,KAAK,GAAG,IAAI,CAAC,EAAE,IAAI,EAAE;AAC3B,UAAM,KAAK,GAAG,IAAI,CAAC,EAAE,IAAI,EAAE;AAC3B,UAAM,KAAK,GAAG,IAAI,CAAC,EAAE,IAAI,EAAE;AAC3B,UAAM,KAAK,GAAG,IAAI,CAAC,EAAE,IAAI,EAAE;AAE3B,UAAM,aAAa,SAAS,MAAM;AAElC,cAAU,IAAI,kBAAkB,IAAI,IAAI,IAAI,EAAE,GAAG,KAAK,CAAC;AACvD,aAAS,IAAI,GAAG,IAAI,gBAAgB;AAAK,WAAK,KAAK,CAAC,IAAI;AACxD,eAAW,QAAQ,GAAG,GAAG,GAAG,GAAG,KAAK,GAAG,cAAc;AACrD,UAAM;AAAA,EACV;AAEA,SAAO;AAAA,IACH,WAAW,UAAU,SAAS,GAAG,KAAK,CAAC;AAAA,IACvC,MAAM,KAAK,SAAS,GAAG,EAAE;AAAA,IACzB,QAAQ,OAAO,SAAS,GAAG,KAAK,CAAC;AAAA,IACjC,aAAa;AAAA,EACjB;AACJ;AAUO,SAAS,kBACZ,IAAY,IAAY,QACxB,GAAW,GAAW,GAAW,GACjB;AAChB,QAAM,YAAY,IAAI,aAAa,iBAAiB,CAAC;AACrD,QAAM,OAAO,IAAI,aAAa,cAAc;AAC5C,QAAM,SAAS,IAAI,aAAa,iBAAiB,CAAC;AAElD,QAAM,IAAI,IAAI,KAAK,QAAQ,CAAC;AAC5B,QAAM,KAAK,EAAE;AACb,QAAM,IAAI,IAAI,KAAK,IAAI,EAAE;AAEzB,QAAM,KAAK,EAAE,IAAI,CAAC,EAAE,IAAI,EAAE;AAC1B,QAAM,KAAK,EAAE,IAAI,CAAC,EAAE,IAAI,EAAE;AAC1B,QAAM,KAAK,EAAE,IAAI,CAAC,EAAE,IAAI,EAAE;AAC1B,QAAM,KAAK,EAAE,IAAI,CAAC,EAAE,IAAI,EAAE;AAE1B,YAAU,IAAI,kBAAkB,IAAI,IAAI,IAAI,EAAE,GAAG,CAAC;AAClD,WAAS,IAAI,GAAG,IAAI,gBAAgB;AAAK,SAAK,CAAC,IAAI;AACnD,aAAW,QAAQ,GAAG,GAAG,GAAG,GAAG,GAAG,cAAc;AAEhD,SAAO,EAAE,WAAW,MAAM,QAAQ,aAAa,eAAe;AAClE;AASO,SAAS,oBACZ,QACA,GAAW,GAAW,GAAW,GAChB;AACjB,QAAM,OAAO,IAAI,MAAM,OAAO,SAAS,CAAC;AACxC,WAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACpC,SAAK,IAAI,CAAC,IAAI,OAAO,CAAC,EAAG;AACzB,SAAK,IAAI,IAAI,CAAC,IAAI,OAAO,CAAC,EAAG;AAAA,EACjC;AAEA,QAAM,UAAU,OAAO,IAAI;AAC3B,QAAM,YAAY,IAAI,aAAa,QAAQ,SAAS,CAAC;AACrD,WAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,KAAK;AACrC,cAAU,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAC,IAAK,CAAC;AACvC,cAAU,IAAI,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAC,IAAK,IAAI,CAAC;AAAA,EACnD;AAEA,QAAM,cAAc,QAAQ;AAC5B,QAAM,SAAS,IAAI,aAAa,cAAc,CAAC;AAC/C,aAAW,QAAQ,GAAG,GAAG,GAAG,GAAG,GAAG,WAAW;AAE7C,SAAO,EAAE,WAAW,QAAQ,YAAY;AAC5C;;;AC3HA,IAAM,eAAN,MAAmB;AAAA,EAiBf,YAAoB,IAA4B;AAA5B;AAAA,EAA6B;AAAA,EAhBjD,iBAAuC,CAAC;AAAA,EACxC,eAAmC,CAAC;AAAA,EACpC,gBAAqC,CAAC;AAAA;AAAA,EAGtC;AAAA,EACA;AAAA,EACA;AAAA,EACA,qBAAqB;AAAA,EAErB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,qBAAqB;AAAA,EAIrB,aAAa,QAAgB,OAAe,GAAW,GAAW,GAAW,GAAW;AACpF,QAAI,OAAO,SAAS;AAAG;AACvB,SAAK,eAAe,KAAK,oBAAoB,QAAQ,OAAO,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,EAC3E;AAAA,EAEA,WAAW,IAAY,IAAY,QAAgB,GAAW,GAAW,GAAW,GAAW;AAC3F,SAAK,aAAa,KAAK,kBAAkB,IAAI,IAAI,QAAQ,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,EACxE;AAAA,EAEA,YAAY,QAAgB,GAAW,GAAW,GAAW,GAAW;AACpE,QAAI,OAAO,SAAS;AAAG;AACvB,SAAK,cAAc,KAAK,oBAAoB,QAAQ,GAAG,GAAG,GAAG,CAAC,CAAC;AAAA,EACnE;AAAA;AAAA,EAGA,OAAO,gBAA+B,eAA8B;AAEhE,UAAM,YAAY,CAAC,GAAG,KAAK,gBAAgB,GAAG,KAAK,YAAY;AAC/D,QAAI,UAAU,SAAS,GAAG;AACtB,UAAI,aAAa;AACjB,iBAAW,QAAQ;AAAW,sBAAc,KAAK;AAEjD,YAAM,MAAM,IAAI,aAAa,aAAa,CAAC;AAC3C,YAAM,MAAM,IAAI,aAAa,UAAU;AACvC,YAAM,MAAM,IAAI,aAAa,aAAa,CAAC;AAC3C,UAAI,KAAK,GAAG,KAAK,GAAG,OAAO;AAE3B,iBAAW,QAAQ,WAAW;AAC1B,YAAI,IAAI,KAAK,WAAW,EAAE;AAAG,cAAM,KAAK,UAAU;AAClD,YAAI,IAAI,KAAK,MAAM,EAAE;AAAG,cAAM,KAAK,KAAK;AACxC,YAAI,IAAI,KAAK,QAAQ,IAAI;AAAG,gBAAQ,KAAK,OAAO;AAAA,MACpD;AAEA,WAAK,YAAY,IAAI,YAAY,KAAK,EAAE;AACxC,WAAK,gBAAgB,KAAK,UAAU,OAAO,eAAe,QAAQ,YAAY,GAAI,CAAC;AACnF,WAAK,cAAc,IAAI,GAAG;AAC1B,WAAK,gBAAgB,KAAK,UAAU,OAAO,eAAe,QAAQ,cAAc,GAAI,CAAC;AACrF,WAAK,cAAc,IAAI,GAAG;AAC1B,WAAK,kBAAkB,KAAK,UAAU,OAAO,eAAe,QAAQ,SAAS,GAAI,CAAC;AAClF,WAAK,gBAAgB,IAAI,GAAG;AAC5B,WAAK,qBAAqB;AAAA,IAC9B;AAGA,QAAI,KAAK,cAAc,SAAS,GAAG;AAC/B,UAAI,aAAa;AACjB,iBAAW,QAAQ,KAAK;AAAe,sBAAc,KAAK;AAE1D,YAAM,MAAM,IAAI,aAAa,aAAa,CAAC;AAC3C,YAAM,MAAM,IAAI,aAAa,aAAa,CAAC;AAC3C,UAAI,KAAK,GAAG,OAAO;AAEnB,iBAAW,QAAQ,KAAK,eAAe;AACnC,YAAI,IAAI,KAAK,WAAW,EAAE;AAAG,cAAM,KAAK,UAAU;AAClD,YAAI,IAAI,KAAK,QAAQ,IAAI;AAAG,gBAAQ,KAAK,OAAO;AAAA,MACpD;AAEA,WAAK,YAAY,IAAI,YAAY,KAAK,EAAE;AACxC,WAAK,gBAAgB,KAAK,UAAU,OAAO,cAAc,QAAQ,YAAY,GAAI,CAAC;AAClF,WAAK,cAAc,IAAI,GAAG;AAC1B,WAAK,kBAAkB,KAAK,UAAU,OAAO,cAAc,QAAQ,SAAS,GAAI,CAAC;AACjF,WAAK,gBAAgB,IAAI,GAAG;AAC5B,WAAK,qBAAqB;AAAA,IAC9B;AAGA,SAAK,iBAAiB,CAAC;AACvB,SAAK,eAAe,CAAC;AACrB,SAAK,gBAAgB,CAAC;AAAA,EAC1B;AAAA,EAEA,OAAO,gBAA+B,eAA8B,QAAiB,OAAe,OAAe;AAC/G,QAAI,KAAK,qBAAqB,GAAG;AAC7B,oBAAc,KAAK;AACnB,oBAAc,SAAS,UAAU,EAAG,MAAM,OAAO,OAAO,QAAQ;AAChE,oBAAc,SAAS,SAAS,EAAG,GAAG,KAAK;AAC3C,oBAAc,SAAS,SAAS,EAAG,GAAG,KAAK;AAC3C,WAAK,UAAW,KAAK;AACrB,WAAK,GAAG,WAAW,KAAK,GAAG,WAAW,GAAG,KAAK,kBAAkB;AAAA,IACpE;AAEA,QAAI,KAAK,qBAAqB,GAAG;AAC7B,qBAAe,KAAK;AACpB,qBAAe,SAAS,UAAU,EAAG,MAAM,OAAO,OAAO,QAAQ;AACjE,qBAAe,SAAS,SAAS,EAAG,GAAG,KAAK;AAC5C,qBAAe,SAAS,SAAS,EAAG,GAAG,KAAK;AAC5C,WAAK,UAAW,KAAK;AACrB,WAAK,GAAG,WAAW,KAAK,GAAG,WAAW,GAAG,KAAK,kBAAkB;AAAA,IACpE;AAAA,EACJ;AAAA,EAEA,UAAU;AACN,SAAK,WAAW,QAAQ;AACxB,SAAK,WAAW,QAAQ;AAAA,EAC5B;AACJ;AAGO,IAAM,cAAN,MAAkB;AAAA,EAIrB,YACY,IACD,MACP,OACF;AAHU;AACD;AAGP,SAAK,WAAW,IAAI,aAAa,EAAE;AACnC,SAAK,QAAQ;AAAA,EACjB;AAAA,EAVA;AAAA,EACA;AAAA,EAWA,OAAO,gBAA+B,eAA8B;AAChE,SAAK,SAAS,OAAO,gBAAgB,aAAa;AAAA,EACtD;AAAA,EAEA,OAAO,gBAA+B,eAA8B,QAAiB,QAAQ,GAAG;AAC5F,SAAK,SAAS,OAAO,gBAAgB,eAAe,QAAQ,KAAK,OAAO,KAAK;AAAA,EACjF;AAAA,EAEA,UAAU;AACN,SAAK,SAAS,QAAQ;AAAA,EAC1B;AACJ;AAGO,IAAM,WAAN,MAAe;AAAA,EAClB;AAAA,EACA;AAAA,EACA,SAAwB,CAAC;AAAA,EACzB,oBAA6B,QAAQ,SAAS;AAAA,EAEtC;AAAA,EACA;AAAA,EACA,cAAkC;AAAA,EAClC,YAAY;AAAA,EAEpB,YAAYA,SAA2B;AACnC,SAAK,SAASA;AACd,UAAM,KAAKA,QAAO,WAAW,UAAU,EAAE,OAAO,MAAM,CAAC;AACvD,QAAI,CAAC;AAAI,YAAM,IAAI,MAAM,sBAAsB;AAC/C,SAAK,KAAK;AAAA,EACd;AAAA,EAEA,QAAQ;AACJ,UAAM,KAAK,KAAK;AAChB,OAAG,OAAO,GAAG,KAAK;AAClB,OAAG,UAAU,GAAG,WAAW,GAAG,mBAAmB;AACjD,OAAG,OAAO,GAAG,UAAU;AACvB,OAAG,UAAU,GAAG,OAAO;AACvB,OAAG,WAAW,MAAM,MAAM,MAAM,CAAC;AACjC,OAAG,WAAW,CAAC;AAEf,SAAK,iBAAiB,IAAI,cAAc,IAAI,eAAe,aAAa;AACxE,SAAK,gBAAgB,IAAI,cAAc,IAAI,cAAc,YAAY;AAErE,SAAK,YAAY;AAAA,EACrB;AAAA,EAEA,cAAc;AACV,UAAM,MAAM,OAAO;AACnB,UAAM,OAAO,KAAK,OAAO,sBAAsB;AAC/C,UAAM,KAAK,KAAK,MAAM,KAAK,QAAQ,GAAG;AACtC,UAAM,KAAK,KAAK,MAAM,KAAK,SAAS,GAAG;AACvC,QAAI,KAAK,OAAO,UAAU,MAAM,KAAK,OAAO,WAAW;AAAI;AAC3D,SAAK,OAAO,QAAQ;AACpB,SAAK,OAAO,SAAS;AACrB,SAAK,GAAG,SAAS,GAAG,GAAG,IAAI,EAAE;AAC7B,SAAK,oBAAoB,QAAQ,aAAa,KAAK,OAAO,KAAK,MAAM;AAAA,EACzE;AAAA,EAEA,QAAQ;AACJ,SAAK,YAAY;AACjB,SAAK,GAAG,MAAM,KAAK,GAAG,mBAAmB,KAAK,GAAG,gBAAgB;AAAA,EACrE;AAAA;AAAA,EAGA,iBAAiB;AACb,eAAW,SAAS,KAAK;AAAQ,YAAM,QAAQ;AAC/C,SAAK,SAAS,CAAC;AACf,SAAK,YAAY;AAAA,EACrB;AAAA,EAEA,YAAY,MAA2B;AACnC,UAAM,QAAQ,IAAI,YAAY,KAAK,IAAI,MAAM,KAAK,SAAS;AAC3D,SAAK,aAAa;AAClB,SAAK,cAAc;AACnB,WAAO;AAAA,EACX;AAAA,EAEA,YAAyB;AACrB,QAAI,CAAC,KAAK;AAAa,YAAM,IAAI,MAAM,iBAAiB;AACxD,SAAK,YAAY,OAAO,KAAK,gBAAgB,KAAK,aAAa;AAC/D,SAAK,OAAO,KAAK,KAAK,WAAW;AACjC,UAAM,IAAI,KAAK;AACf,SAAK,cAAc;AACnB,WAAO;AAAA,EACX;AAAA;AAAA,EAGA,IAAI,SAAuB;AACvB,WAAO,KAAK,YAAa;AAAA,EAC7B;AAAA;AAAA,EAGA,KAAK,cAAuB;AACxB,SAAK,MAAM;AACX,UAAM,QAAQ,KAAK,kBAAkB,SAAS,YAAY;AAC1D,eAAW,SAAS,KAAK,QAAQ;AAC7B,YAAM,OAAO,KAAK,gBAAgB,KAAK,eAAe,KAAK;AAAA,IAC/D;AAAA,EACJ;AACJ;;;AC3OO,IAAM,eAAsC;AAAA,EAC/C,QAAY,CAAC,MAAM,KAAM,KAAM,GAAG;AAAA,EAClC,QAAY,CAAC,KAAM,KAAM,MAAM,GAAG;AAAA,EAClC,UAAY,CAAC,MAAM,MAAM,KAAM,GAAG;AAAA,EAClC,UAAY,CAAC,MAAM,KAAM,MAAM,GAAG;AAAA,EAClC,WAAY,CAAC,GAAM,MAAM,MAAM,GAAG;AAAA,EAClC,WAAY,CAAC,MAAM,GAAM,MAAM,GAAG;AAAA,EAClC,UAAY,CAAC,KAAM,MAAM,KAAM,GAAG;AAAA,EAClC,UAAY,CAAC,MAAM,KAAM,MAAM,GAAG;AAAA,EAClC,WAAY,CAAC,MAAM,MAAM,MAAM,GAAG;AAAA,EAClC,WAAY,CAAC,MAAM,MAAM,MAAM,GAAG;AAAA,EAClC,SAAY,CAAC,KAAM,KAAM,KAAM,GAAG;AAAA,EAClC,SAAY,CAAC,KAAM,KAAM,KAAM,GAAG;AAAA,EAClC,WAAY,CAAC,KAAM,KAAM,KAAM,GAAG;AAAA,EAClC,WAAY,CAAC,KAAM,KAAM,KAAM,GAAG;AAAA,EAClC,aAAa,CAAC,KAAK,MAAM,KAAM,CAAG;AAAA,EAClC,aAAa,CAAC,KAAK,KAAM,KAAM,GAAG;AAAA,EAClC,aAAa,CAAC,KAAK,KAAM,KAAM,GAAG;AACtC;AAEO,IAAM,YAAmB,CAAC,MAAM,KAAM,MAAM,GAAG;AAC/C,IAAM,kBAAyB,CAAC,MAAM,KAAM,KAAM,GAAG;AACrD,IAAM,iBAAwB,CAAC,KAAM,KAAM,MAAM,GAAG;AACpD,IAAM,YAAmB,CAAC,KAAK,KAAK,KAAK,GAAG;AAC5C,IAAM,kBAAyB,CAAC,MAAM,MAAM,MAAM,CAAG;AACrD,IAAM,kBAAyB,CAAC,GAAK,GAAK,GAAK,GAAG;AAElD,IAAM,mBAAmB;AAEzB,SAAS,cAAc,OAAyC;AACnE,MAAI,CAAC;AAAO,WAAO,CAAC,KAAK,KAAK,KAAK,GAAG;AACtC,SAAO,aAAa,KAAK,KAAK,CAAC,KAAK,KAAK,KAAK,GAAG;AACrD;AAEO,SAAS,YAAY,QAAyB;AACjD,QAAM,WAAW,OAAO,KAAK,OAAK,MAAM,UAAU,MAAM,MAAM;AAC9D,QAAM,UAAU,OAAO,KAAK,OAAK,MAAM,UAAU,MAAM,MAAM;AAC7D,MAAI,YAAY;AAAS,WAAO;AAChC,MAAI;AAAU,WAAO;AACrB,MAAI;AAAS,WAAO;AACpB,SAAO;AACX;;;ACxCA,IAAM,aAAa,KAAK,KAAK;AAE7B,SAAS,IAAI,GAAiB;AAC1B,SAAO,IAAI,KAAK,EAAE,GAAG,EAAE,CAAC;AAC5B;AAGA,SAAS,YAAY,MAAc,QAAgB,QAAsB;AACrE,QAAM,MAAM,EAAE,KAAK,KAAK,KAAK;AAC7B,QAAM,MAAM,KAAK,IAAI,GAAG;AACxB,QAAM,MAAM,KAAK,IAAI,GAAG;AACxB,SAAO,IAAI;AAAA,IACP,KAAK,IAAI,SAAS,MAAM,SAAS;AAAA,IACjC,KAAK,IAAI,SAAS,MAAM,SAAS;AAAA,EACrC;AACJ;AAGA,SAAS,aAAa,MAAc,OAAe,IAAY,IAAkB;AAC7E,QAAM,SAAS,EAAE,MAAM,KAAK,KAAK;AACjC,QAAM,KAAK,KAAK,IAAI,MAAM,GAAG,KAAK,KAAK,IAAI,MAAM;AACjD,QAAM,KAAK,KAAK,KAAK,KAAK;AAC1B,QAAM,KAAK,KAAK,KAAK,KAAK;AAC1B,SAAO,YAAY,MAAM,MAAM,IAAI,IAAI,MAAM,IAAI,EAAE;AACvD;AAGA,SAAS,YAAY,OAAe,KAAa,KAAa,WAAW,IAAY;AACjF,QAAM,KAAK,MAAM,GAAG,KAAK,MAAM;AAC/B,QAAM,KAAK,IAAI,GAAG,KAAK,IAAI;AAC3B,QAAM,KAAK,IAAI,GAAG,KAAK,IAAI;AAE3B,QAAM,IAAI,KAAK,MAAM,KAAK,MAAM,MAAM,KAAK,MAAM,MAAM,KAAK;AAC5D,MAAI,KAAK,IAAI,CAAC,IAAI,OAAO;AACrB,WAAO,CAAC,IAAI,KAAK,IAAI,EAAE,GAAG,IAAI,KAAK,IAAI,EAAE,GAAG,IAAI,KAAK,IAAI,EAAE,CAAC;AAAA,EAChE;AAEA,QAAM,OAAO,KAAK,KAAK,KAAK,OAAO,KAAK,OAAO,KAAK,KAAK,KAAK,OAAO,KAAK,OAAO,KAAK,KAAK,KAAK,OAAO,KAAK,OAAO;AACnH,QAAM,OAAO,KAAK,KAAK,KAAK,OAAO,KAAK,OAAO,KAAK,KAAK,KAAK,OAAO,KAAK,OAAO,KAAK,KAAK,KAAK,OAAO,KAAK,OAAO;AACnH,QAAM,SAAS,KAAK,MAAM,KAAK,OAAO,KAAK,KAAK,OAAO,CAAC;AACxD,QAAM,aAAa,KAAK,MAAM,KAAK,IAAI,KAAK,EAAE;AAC9C,QAAM,WAAW,KAAK,MAAM,KAAK,IAAI,KAAK,EAAE;AAC5C,QAAM,WAAW,KAAK,MAAM,KAAK,IAAI,KAAK,EAAE;AAE5C,MAAI,MAAM,WAAW;AACrB,SAAO,MAAM,KAAK;AAAI,WAAO,IAAI,KAAK;AACtC,SAAO,MAAM,CAAC,KAAK;AAAI,WAAO,IAAI,KAAK;AAEvC,QAAM,YAAY,MAAM;AACxB,MAAI,QAAQ,WAAW;AACvB,MAAI,WAAW;AACX,WAAO,QAAQ;AAAG,eAAS,IAAI,KAAK;AAAA,EACxC,OAAO;AACH,WAAO,QAAQ;AAAG,eAAS,IAAI,KAAK;AAAA,EACxC;AAEA,QAAM,SAAiB,CAAC;AACxB,WAAS,IAAI,GAAG,KAAK,UAAU,KAAK;AAChC,UAAM,IAAI,IAAI;AACd,UAAM,QAAQ,aAAa,QAAQ;AACnC,WAAO,KAAK,IAAI,KAAK,KAAK,SAAS,KAAK,IAAI,KAAK,GAAG,KAAK,SAAS,KAAK,IAAI,KAAK,CAAC,CAAC;AAAA,EACtF;AACA,SAAO;AACX;AAGO,SAAS,SAAS,UAAoB,OAAoB,cAAkC;AAC/F,QAAM,SAAS,gBAAgB,oBAAI,IAAY;AAC/C,WAAS,eAAe;AACxB,MAAI,CAAC,OAAO,IAAI,WAAW;AAAG,oBAAgB,UAAU,KAAK;AAC7D,aAAW,UAAU,OAAO,MAAM;AAClC,cAAY,UAAU,OAAO,MAAM;AACnC,MAAI,CAAC,OAAO,IAAI,MAAM;AAAG,cAAU,UAAU,KAAK;AAClD,aAAW,MAAM,MAAM,YAAY;AAC/B,mBAAe,UAAU,IAAI,MAAM;AAAA,EACvC;AACJ;AAEA,SAAS,gBAAgB,UAAoB,OAAoB;AAC7D,QAAM,QAAQ,SAAS,YAAY,WAAW;AAC9C,QAAM,CAAC,GAAG,GAAG,GAAG,CAAC,IAAI,cAAc,WAAW;AAE9C,aAAW,QAAQ,MAAM,MAAM,OAAO;AAClC,QAAI,KAAK,SAAS,UAAU,KAAK,SAAS,KAAK,KAAK;AAChD,YAAM,SAAS,aAAa,CAAC,IAAI,KAAK,KAAK,GAAG,IAAI,KAAK,GAAG,CAAC,GAAG,MAAM,GAAG,GAAG,GAAG,CAAC;AAAA,IAClF,WAAW,KAAK,SAAS,SAAS,KAAK,SAAS,KAAK,OAAO,KAAK,KAAK;AAClE,YAAM,SAAS,aAAa,YAAY,KAAK,OAAO,KAAK,KAAK,KAAK,GAAG,GAAG,MAAM,GAAG,GAAG,GAAG,CAAC;AAAA,IAC7F,WAAW,KAAK,SAAS,YAAY,KAAK,UAAU,KAAK,KAAK;AAC1D,YAAM,KAAK,KAAK,OAAO,GAAG,KAAK,KAAK,OAAO;AAC3C,YAAM,MAAM,KAAK,MAAM,KAAK,IAAI,IAAI,OAAO,KAAK,KAAK,IAAI,IAAI,OAAO,CAAC;AACrE,YAAM,MAAc,CAAC;AACrB,eAAS,IAAI,GAAG,KAAK,IAAI,KAAK;AAC1B,cAAM,QAAS,IAAI,KAAM,IAAI,KAAK;AAClC,YAAI,KAAK,IAAI,KAAK,KAAK,MAAM,KAAK,IAAI,KAAK,GAAG,KAAK,MAAM,KAAK,IAAI,KAAK,CAAC,CAAC;AAAA,MAC7E;AACA,YAAM,SAAS,aAAa,KAAK,MAAM,GAAG,GAAG,GAAG,CAAC;AAAA,IACrD,WAAW,KAAK,SAAS,UAAU,KAAK,SAAS,KAAK,KAAK;AACvD,YAAM,IAAI,KAAK,OAAO,IAAI,KAAK;AAC/B,YAAM,SAAS,aAAa;AAAA,QACxB,IAAI,KAAK,EAAE,GAAG,EAAE,CAAC;AAAA,QAAG,IAAI,KAAK,EAAE,GAAG,EAAE,CAAC;AAAA,QAAG,IAAI,KAAK,EAAE,GAAG,EAAE,CAAC;AAAA,QAAG,IAAI,KAAK,EAAE,GAAG,EAAE,CAAC;AAAA,QAAG,IAAI,KAAK,EAAE,GAAG,EAAE,CAAC;AAAA,MACrG,GAAG,MAAM,GAAG,GAAG,GAAG,CAAC;AAAA,IACvB;AAAA,EACJ;AACA,WAAS,UAAU;AACvB;AAEA,SAAS,WAAW,UAAoB,OAAoB,QAAqB;AAC7E,aAAW,QAAQ,MAAM,OAAO;AAC5B,eAAW,UAAU,KAAK,iBAAiB;AACvC,UAAI,OAAO,IAAI,OAAO,KAAK;AAAG;AAC9B,YAAM,CAAC,GAAG,GAAG,CAAC,IAAI,cAAc,OAAO,KAAK;AAC5C,YAAM,QAAQ,SAAS,YAAY,QAAQ,KAAK,QAAQ,EAAE,IAAI,OAAO,KAAK,EAAE;AAC5E,YAAM,MAAM,OAAO,OAAO,IAAI,GAAG;AACjC,UAAI,IAAI,UAAU,GAAG;AACjB,cAAM,SAAS,YAAY,KAAK,GAAG,GAAG,GAAG,gBAAgB;AAAA,MAC7D;AACA,eAAS,UAAU;AAAA,IACvB;AAAA,EACJ;AACJ;AAEA,SAAS,YAAY,UAAoB,OAAoB,QAAqB;AAC9E,QAAM,UAAU,oBAAI,IAA0B;AAC9C,aAAW,SAAS,MAAM,QAAQ;AAC9B,UAAM,KAAK,MAAM,SAAS;AAC1B,QAAI,OAAO,IAAI,EAAE;AAAG;AACpB,QAAI,MAAM,QAAQ,IAAI,EAAE;AACxB,QAAI,CAAC,KAAK;AAAE,YAAM,CAAC;AAAG,cAAQ,IAAI,IAAI,GAAG;AAAA,IAAG;AAC5C,QAAI,KAAK,KAAK;AAAA,EAClB;AACA,aAAW,CAAC,WAAW,MAAM,KAAK,SAAS;AACvC,UAAM,CAAC,GAAG,GAAG,GAAG,CAAC,IAAI,cAAc,SAAS;AAC5C,UAAM,QAAQ,SAAS,YAAY,UAAU,SAAS,EAAE;AACxD,eAAW,SAAS,QAAQ;AACxB,YAAM,SAAS,aAAa,CAAC,IAAI,MAAM,KAAK,GAAG,IAAI,MAAM,GAAG,CAAC,GAAG,MAAM,OAAO,GAAG,GAAG,GAAG,CAAC;AAAA,IAC3F;AACA,aAAS,UAAU;AAAA,EACvB;AACA,MAAI,MAAM,KAAK,SAAS,GAAG;AACvB,UAAM,aAAa,oBAAI,IAA+B;AACtD,eAAW,OAAO,MAAM,MAAM;AAC1B,YAAM,KAAK,IAAI,SAAS;AACxB,UAAI,OAAO,IAAI,EAAE;AAAG;AACpB,UAAI,MAAM,WAAW,IAAI,EAAE;AAC3B,UAAI,CAAC,KAAK;AAAE,cAAM,CAAC;AAAG,mBAAW,IAAI,IAAI,GAAG;AAAA,MAAG;AAC/C,UAAI,KAAK,GAAG;AAAA,IAChB;AACA,eAAW,CAAC,WAAW,IAAI,KAAK,YAAY;AACxC,YAAM,CAAC,GAAG,GAAG,GAAG,CAAC,IAAI,cAAc,SAAS;AAC5C,YAAM,QAAQ,SAAS,YAAY,cAAc,SAAS,EAAE;AAC5D,iBAAW,OAAO,MAAM;AACpB,cAAM,SAAS,aAAa,YAAY,IAAI,OAAO,IAAI,KAAK,IAAI,GAAG,GAAG,IAAI,OAAO,GAAG,GAAG,GAAG,CAAC;AAAA,MAC/F;AACA,eAAS,UAAU;AAAA,IACvB;AAAA,EACJ;AACJ;AAEA,SAAS,UAAU,UAAoB,OAAoB;AACvD,MAAI,MAAM,KAAK,WAAW;AAAG;AAC7B,QAAM,QAAQ,SAAS,YAAY,MAAM;AACzC,aAAW,OAAO,MAAM,MAAM;AAC1B,UAAM,CAAC,IAAI,IAAI,IAAI,EAAE,IAAI;AACzB,UAAM,SAAS,WAAW,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,OAAO,GAAG,IAAI,IAAI,IAAI,EAAE;AAC1E,UAAM,CAAC,IAAI,IAAI,IAAI,EAAE,IAAI;AACzB,UAAM,SAAS,WAAW,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,IAAI,QAAQ,GAAG,IAAI,IAAI,IAAI,EAAE;AAAA,EAC/E;AACA,WAAS,UAAU;AACvB;AAEA,SAAS,eAAe,UAAoB,IAAoB,QAAqB;AACjF,QAAM,kBAAkB,oBAAI,IAA4B;AACxD,aAAW,WAAW,GAAG,UAAU;AAC/B,UAAM,KAAK,QAAQ,SAAS;AAC5B,QAAI,OAAO,IAAI,EAAE;AAAG;AACpB,QAAI,MAAM,gBAAgB,IAAI,EAAE;AAChC,QAAI,CAAC,KAAK;AAAE,YAAM,CAAC;AAAG,sBAAgB,IAAI,IAAI,GAAG;AAAA,IAAG;AACpD,QAAI,KAAK,OAAO;AAAA,EACpB;AACA,aAAW,CAAC,WAAW,QAAQ,KAAK,iBAAiB;AACjD,UAAM,CAAC,GAAG,GAAG,GAAG,CAAC,IAAI,cAAc,SAAS;AAC5C,UAAM,QAAQ,SAAS,YAAY,MAAM,GAAG,IAAI,IAAI,SAAS,EAAE;AAC/D,eAAW,WAAW,UAAU;AAC5B,mBAAa,OAAO,GAAG,IAAI,SAAS,GAAG,GAAG,GAAG,CAAC;AAAA,IAClD;AACA,aAAS,UAAU;AAAA,EACvB;AACA,MAAI,GAAG,KAAK,SAAS,GAAG;AAEpB,UAAM,aAAa,GAAG,KAAK,KAAK,SAAO,IAAI,OAAO,KAAK,OAAK,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC;AAC3E,QAAI,YAAY;AACZ,YAAM,QAAQ,SAAS,YAAY,MAAM,GAAG,IAAI,OAAO;AACvD,iBAAW,OAAO,GAAG,MAAM;AACvB,YAAI,IAAI,OAAO,KAAK,OAAK,CAAC,OAAO,IAAI,CAAC,CAAC,GAAG;AACtC,mBAAS,OAAO,GAAG,IAAI,GAAG;AAAA,QAC9B;AAAA,MACJ;AACA,eAAS,UAAU;AAAA,IACvB;AAAA,EACJ;AACJ;AAEA,SAAS,aAAa,OAAoB,MAAc,SAAuB,GAAW,GAAW,GAAW,GAAW;AACvH,QAAM,IAAI,QAAQ,SAAS;AAE3B,MAAI,QAAQ,SAAS,UAAU,QAAQ,SAAS,QAAQ,KAAK;AACzD,UAAM,KAAK,YAAY,MAAM,QAAQ,MAAM,GAAG,QAAQ,MAAM,CAAC;AAC7D,UAAM,KAAK,YAAY,MAAM,QAAQ,IAAI,GAAG,QAAQ,IAAI,CAAC;AACzD,UAAM,SAAS,aAAa,CAAC,IAAI,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;AAAA,EACvD,WAAW,QAAQ,SAAS,SAAS,QAAQ,SAAS,QAAQ,OAAO,QAAQ,KAAK;AAC9E,UAAM,WAAW,YAAY,QAAQ,OAAO,QAAQ,KAAK,QAAQ,GAAG;AACpE,UAAM,WAAW,SAAS,IAAI,OAAK,YAAY,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AAC9D,UAAM,SAAS,aAAa,UAAU,GAAG,GAAG,GAAG,GAAG,CAAC;AAAA,EACvD,WAAW,QAAQ,SAAS,YAAY,QAAQ,UAAU,QAAQ,KAAK;AACnE,UAAM,KAAK,QAAQ,OAAO,GAAG,KAAK,QAAQ,OAAO;AACjD,UAAM,MAAM,KAAK,MAAM,QAAQ,IAAI,IAAI,OAAO,KAAK,QAAQ,IAAI,IAAI,OAAO,CAAC;AAC3E,UAAM,MAAc,CAAC;AACrB,aAAS,IAAI,GAAG,KAAK,IAAI,KAAK;AAC1B,YAAM,QAAS,IAAI,KAAM,IAAI,KAAK;AAClC,UAAI,KAAK,IAAI,KAAK,KAAK,MAAM,KAAK,IAAI,KAAK,GAAG,KAAK,MAAM,KAAK,IAAI,KAAK,CAAC,CAAC;AAAA,IAC7E;AACA,UAAM,SAAS,aAAa,IAAI,IAAI,OAAK,YAAY,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;AAAA,EACxF,WAAW,QAAQ,SAAS,UAAU,QAAQ,SAAS,QAAQ,KAAK;AAChE,UAAM,IAAI,QAAQ,OAAO,IAAI,QAAQ;AACrC,UAAM,UAAU;AAAA,MACZ,YAAY,MAAM,EAAE,GAAG,EAAE,CAAC;AAAA,MAAG,YAAY,MAAM,EAAE,GAAG,EAAE,CAAC;AAAA,MACvD,YAAY,MAAM,EAAE,GAAG,EAAE,CAAC;AAAA,MAAG,YAAY,MAAM,EAAE,GAAG,EAAE,CAAC;AAAA,MACvD,YAAY,MAAM,EAAE,GAAG,EAAE,CAAC;AAAA,IAC9B;AACA,UAAM,SAAS,aAAa,SAAS,GAAG,GAAG,GAAG,GAAG,CAAC;AAAA,EACtD,WAAW,QAAQ,SAAS,aAAa,QAAQ,QAAQ;AACrD,UAAM,WAAW,QAAQ,OAAO,IAAI,OAAK,YAAY,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AACpE,QAAI,SAAS,UAAU,GAAG;AACtB,eAAS,KAAK,SAAS,CAAC,EAAG,KAAK,CAAC;AACjC,YAAM,SAAS,aAAa,UAAU,GAAG,GAAG,GAAG,GAAG,CAAC;AAAA,IACvD;AAAA,EACJ;AACJ;AAEA,SAAS,SAAS,OAAoB,MAAc,KAAe;AAC/D,QAAM,CAAC,IAAI,IAAI,IAAI,EAAE,IAAI,YAAY,IAAI,MAAM;AAC/C,QAAM,KAAK,IAAI,KAAK,IAAI;AACxB,QAAM,KAAK,IAAI,KAAK,IAAI;AAExB,MAAI,IAAI,UAAU,UAAU;AACxB,UAAM,SAAS,YAAY,MAAM,IAAI,GAAG,GAAG,IAAI,GAAG,CAAC;AACnD,UAAM,SAAS,WAAW,OAAO,GAAG,OAAO,GAAG,IAAI,IAAI,IAAI,IAAI,EAAE;AAAA,EACpE,WAAW,IAAI,UAAU,QAAQ;AAC7B,UAAM,WAAW,KAAK,IAAI,IAAI,EAAE;AAChC,UAAM,YAAY,KAAK,IAAI,IAAI,EAAE;AACjC,UAAM,YAAY,WAAW;AAC7B,QAAI,IAAU;AACd,QAAI,MAAM,IAAI;AACV,WAAK,aAAa,MAAM,IAAI,IAAI,CAAC,WAAW,CAAC;AAC7C,WAAK,aAAa,MAAM,IAAI,IAAI,WAAW,CAAC;AAAA,IAChD,OAAO;AACH,WAAK,aAAa,MAAM,IAAI,IAAI,GAAG,CAAC,SAAS;AAC7C,WAAK,aAAa,MAAM,IAAI,IAAI,GAAG,SAAS;AAAA,IAChD;AACA,UAAM,SAAS,aAAa,CAAC,IAAI,EAAE,GAAG,YAAY,GAAG,IAAI,IAAI,IAAI,EAAE;AAAA,EACvE,OAAO;AACH,UAAM,UAAU;AAAA,MACZ,aAAa,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE;AAAA,MAAG,aAAa,MAAM,IAAI,IAAI,IAAI,CAAC,EAAE;AAAA,MACxE,aAAa,MAAM,IAAI,IAAI,IAAI,EAAE;AAAA,MAAG,aAAa,MAAM,IAAI,IAAI,CAAC,IAAI,EAAE;AAAA,IAC1E;AACA,UAAM,SAAS,YAAY,SAAS,IAAI,IAAI,IAAI,EAAE;AAAA,EACtD;AAEA,MAAI,IAAI,SAAS,IAAI,SAAS,aAAa;AACvC,UAAM,SAAS,YAAY,MAAM,IAAI,GAAG,GAAG,IAAI,GAAG,CAAC;AACnD,UAAM,UAAU,IAAI,MAAM,UAAU,IAAI,KAAK,IAAI,OAAO;AACxD,UAAM,SAAS,WAAW,OAAO,GAAG,OAAO,GAAG,QAAQ,MAAM,MAAM,MAAM,CAAG;AAAA,EAC/E;AACJ;AAGO,SAAS,eAAe,UAAoB,IAAiC;AAChF,QAAM,QAAQ,SAAS,YAAY,WAAW;AAC9C,QAAM,CAAC,GAAG,GAAG,GAAG,CAAC,IAAI;AAErB,QAAM,YAAoB,CAAC;AAC3B,aAAW,OAAO,GAAG,MAAM;AACvB,UAAM,SAAS,YAAY,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,CAAC;AACpD,UAAM,KAAK,IAAI,KAAK,IAAI,GAAG,KAAK,IAAI,KAAK,IAAI;AAC7C,cAAU,KAAK,OAAO,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AAC7C,cAAU,KAAK,OAAO,IAAI,IAAI,KAAK,IAAI,EAAE,CAAC,CAAC;AAAA,EAC/C;AACA,aAAW,WAAW,GAAG,UAAU;AAC/B,QAAI,QAAQ;AAAO,gBAAU,KAAK,YAAY,GAAG,IAAI,QAAQ,MAAM,GAAG,QAAQ,MAAM,CAAC,CAAC;AACtF,QAAI,QAAQ;AAAK,gBAAU,KAAK,YAAY,GAAG,IAAI,QAAQ,IAAI,GAAG,QAAQ,IAAI,CAAC,CAAC;AAChF,QAAI,QAAQ;AAAQ,gBAAU,KAAK,YAAY,GAAG,IAAI,QAAQ,OAAO,GAAG,QAAQ,OAAO,CAAC,CAAC;AAAA,EAC7F;AAEA,MAAI,UAAU,SAAS,GAAG;AACtB,UAAM,OAAO,KAAK,YAAY,SAAS,EAAE,KAAK,GAAG;AACjD,UAAM,SAAS,YAAY;AAAA,MACvB,IAAI,KAAK,KAAK,GAAG,KAAK,CAAC;AAAA,MAAG,IAAI,KAAK,KAAK,IAAI,KAAK,CAAC;AAAA,MAClD,IAAI,KAAK,KAAK,IAAI,KAAK,EAAE;AAAA,MAAG,IAAI,KAAK,KAAK,GAAG,KAAK,EAAE;AAAA,IACxD,GAAG,GAAG,GAAG,GAAG,CAAC;AAAA,EACjB;AAEA,WAAS,UAAU;AACnB,SAAO;AACX;AAGO,SAAS,YAAY,OAA0B;AAClD,QAAM,SAAiB,CAAC;AACxB,aAAW,QAAQ,MAAM,MAAM,OAAO;AAClC,QAAI,KAAK;AAAO,aAAO,KAAK,IAAI,KAAK,KAAK,CAAC;AAC3C,QAAI,KAAK;AAAK,aAAO,KAAK,IAAI,KAAK,GAAG,CAAC;AACvC,QAAI,KAAK;AAAK,aAAO,KAAK,IAAI,KAAK,GAAG,CAAC;AACvC,QAAI,KAAK;AAAQ,aAAO,KAAK,IAAI,KAAK,MAAM,CAAC;AAAA,EACjD;AACA,aAAW,MAAM,MAAM,YAAY;AAC/B,WAAO,KAAK,IAAI,KAAK,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;AACtC,eAAW,OAAO,GAAG,MAAM;AACvB,aAAO,KAAK,YAAY,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,CAAC,CAAC;AAAA,IACtD;AAAA,EACJ;AACA,aAAW,SAAS,MAAM,QAAQ;AAC9B,WAAO,KAAK,IAAI,MAAM,KAAK,CAAC;AAC5B,WAAO,KAAK,IAAI,MAAM,GAAG,CAAC;AAAA,EAC9B;AACA,aAAW,OAAO,MAAM,MAAM;AAC1B,WAAO,KAAK,IAAI,IAAI,EAAE,CAAC;AAAA,EAC3B;AACA,MAAI,OAAO,WAAW;AAAG,WAAO,IAAI,KAAK,GAAG,GAAG,KAAK,GAAG;AACvD,SAAO,KAAK,YAAY,MAAM,EAAE,KAAK,CAAC;AAC1C;;;AC3UA,IAAMC,cAAa,KAAK,KAAK;AAE7B,SAASC,aAAY,MAAc,QAAgB,QAAsB;AACrE,QAAM,MAAM,EAAE,KAAK,KAAK,KAAKD;AAC7B,QAAM,MAAM,KAAK,IAAI,GAAG;AACxB,QAAM,MAAM,KAAK,IAAI,GAAG;AACxB,SAAO,IAAI;AAAA,IACP,KAAK,IAAI,SAAS,MAAM,SAAS;AAAA,IACjC,KAAK,IAAI,SAAS,MAAM,SAAS;AAAA,EACrC;AACJ;AAGO,SAAS,cAAc,IAA0B;AACpD,QAAM,SAAiB,CAAC;AACxB,aAAW,OAAO,GAAG,MAAM;AACvB,UAAM,SAASC,aAAY,GAAG,IAAI,IAAI,GAAG,GAAG,IAAI,GAAG,CAAC;AACpD,UAAM,KAAK,IAAI,KAAK,IAAI;AACxB,UAAM,KAAK,IAAI,KAAK,IAAI;AACxB,WAAO,KAAK,OAAO,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AAC1C,WAAO,KAAK,OAAO,IAAI,IAAI,KAAK,IAAI,EAAE,CAAC,CAAC;AAAA,EAC5C;AACA,aAAW,WAAW,GAAG,UAAU;AAC/B,QAAI,QAAQ;AAAO,aAAO,KAAKA,aAAY,GAAG,IAAI,QAAQ,MAAM,GAAG,QAAQ,MAAM,CAAC,CAAC;AACnF,QAAI,QAAQ;AAAK,aAAO,KAAKA,aAAY,GAAG,IAAI,QAAQ,IAAI,GAAG,QAAQ,IAAI,CAAC,CAAC;AAC7E,QAAI,QAAQ;AAAQ,aAAO,KAAKA,aAAY,GAAG,IAAI,QAAQ,OAAO,GAAG,QAAQ,OAAO,CAAC,CAAC;AACtF,QAAI,QAAQ,QAAQ;AAChB,iBAAW,KAAK,QAAQ,QAAQ;AAC5B,eAAO,KAAKA,aAAY,GAAG,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC;AAAA,MAC5C;AAAA,IACJ;AAAA,EACJ;AACA,MAAI,OAAO,WAAW,GAAG;AACrB,WAAO,IAAI,KAAK,GAAG,GAAG,IAAI,GAAG,GAAG,GAAG,IAAI,GAAG,GAAG,CAAC;AAAA,EAClD;AACA,SAAO,KAAK,YAAY,MAAM,EAAE,KAAK,GAAG;AAC5C;AAGO,SAAS,kBAAkB,UAAgB,YAAsC;AACpF,WAAS,IAAI,WAAW,SAAS,GAAG,KAAK,GAAG,KAAK;AAC7C,UAAM,OAAO,cAAc,WAAW,CAAC,CAAE;AACzC,QAAI,KAAK,eAAe,QAAQ,GAAG;AAC/B,aAAO;AAAA,IACX;AAAA,EACJ;AACA,SAAO;AACX;;;AC1CO,IAAM,SAAN,MAAa;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,QAA4B;AAAA,EAC5B;AAAA,EACA,KAAuB;AAAA;AAAA,EAGvB,kBAAkB;AAAA,EAClB,aAAa;AAAA,EACb,iBAA8B;AAAA,EAC9B,iBAAkD;AAAA,EAClD,cAAc;AAAA;AAAA,EAGd,eAA4B,oBAAI,IAAI;AAAA,EACpC,kBAAuC;AAAA;AAAA,EAGvC,kBAAwB,IAAI,KAAK,GAAG,CAAC;AAAA,EAE7C,YAAYC,SAA2BC,UAAiB;AACpD,SAAK,SAASD;AACd,SAAK,UAAUC;AACf,SAAK,WAAW,IAAI,SAASD,OAAM;AACnC,SAAK,SAAS,IAAI,QAAQ;AAC1B,SAAK,aAAa,IAAI,WAAWA,SAAQ,KAAK,QAAQ,MAAM,KAAK,cAAc,CAAC;AAEhF,SAAK,mBAAmB;AACxB,SAAK,sBAAsB;AAC3B,SAAK,mBAAmB;AACxB,SAAK,SAAS,MAAM;AACpB,SAAK,gBAAgB;AAAA,EACzB;AAAA,EAEA,MAAM,OAAO;AACT,UAAM,KAAK,cAAc;AACzB,SAAK,iBAAiB;AAAA,EAC1B;AAAA,EAEA,MAAc,gBAAgB;AAC1B,UAAM,OAAO,MAAM,MAAM,GAAG,KAAK,OAAO,mBAAmB;AAC3D,SAAK,WAAW,MAAM,KAAK,KAAK,GAAG,IAAI;AAAA,EAC3C;AAAA,EAEQ,WAAW,OAAoB,YAAY,OAAO;AACtD,SAAK,QAAQ;AACb,SAAK,MAAM;AAEX,SAAK,OAAO,gBAAgB,IAAI,KAAK,KAAK,OAAO,aAAa,KAAK,OAAO,YAAY;AACtF,QAAI,WAAW;AACX,WAAK,OAAO,OAAO,YAAY,KAAK,KAAK;AAAA,IAC7C;AACA,SAAK,cAAc;AAAA,EACvB;AAAA,EAEQ,QAAQ;AACZ,QAAI,CAAC,KAAK;AAAO;AACjB,aAAS,KAAK,UAAU,KAAK,OAAO,KAAK,YAAY;AAErD,QAAI,KAAK,mBAAmB,KAAK,KAAK,kBAAkB,KAAK,MAAM,WAAW,QAAQ;AAClF,qBAAe,KAAK,UAAU,KAAK,MAAM,WAAW,KAAK,eAAe,CAAE;AAAA,IAC9E;AAAA,EACJ;AAAA,EAEQ,mBAAmB;AACvB,UAAM,QAAQ,KAAK,QAAQ,QAAQ,SAAS,IAAI,IAAI;AACpD,SAAK,KAAK,IAAI,UAAU,KAAK;AAC7B,SAAK,GAAG,SAAS,MAAM,QAAQ,IAAI,cAAc;AACjD,SAAK,GAAG,YAAY,CAAC,UAAU;AAC3B,YAAM,MAAM,KAAK,MAAM,MAAM,IAAI;AACjC,UAAI,IAAI,SAAS,oBAAoB,IAAI,OAAO;AAC5C,aAAK,WAAW,IAAI,KAAK;AAAA,MAC7B;AAAA,IACJ;AACA,SAAK,GAAG,UAAU,CAAC,QAAQ,QAAQ,MAAM,aAAa,GAAG;AACzD,SAAK,GAAG,UAAU,MAAM;AACpB,iBAAW,MAAM,KAAK,iBAAiB,GAAG,GAAI;AAAA,IAClD;AAAA,EACJ;AAAA,EAEQ,qBAAqB;AACzB,SAAK,OAAO,iBAAiB,aAAa,CAAC,MAAkB;AACzD,UAAI,EAAE,WAAW;AAAG;AAEpB,YAAM,OAAO,KAAK,OAAO,sBAAsB;AAC/C,YAAM,YAAY,IAAI,KAAK,EAAE,UAAU,KAAK,MAAM,EAAE,UAAU,KAAK,GAAG;AACtE,YAAM,WAAW,KAAK,OAAO,gBAAgB,SAAS;AAEtD,UAAI,CAAC,KAAK;AAAO;AAEjB,YAAM,SAAS,kBAAkB,UAAU,KAAK,MAAM,UAAU;AAEhE,UAAI,UAAU,GAAG;AACb,aAAK,kBAAkB;AACvB,cAAM,KAAK,KAAK,MAAM,WAAW,MAAM;AACvC,aAAK,aAAa;AAClB,aAAK,iBAAiB;AACtB,aAAK,iBAAiB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAC/C,aAAK,qBAAqB;AAAA,MAC9B,OAAO;AACH,YAAI,KAAK,mBAAmB,GAAG;AAC3B,eAAK,kBAAkB;AACvB,eAAK,MAAM;AACX,eAAK,cAAc;AAAA,QACvB;AAAA,MACJ;AAAA,IACJ,CAAC;AAED,SAAK,OAAO,iBAAiB,aAAa,CAAC,MAAkB;AACzD,YAAM,OAAO,KAAK,OAAO,sBAAsB;AAC/C,WAAK,kBAAkB,IAAI,KAAK,EAAE,UAAU,KAAK,MAAM,EAAE,UAAU,KAAK,GAAG;AAE3E,UAAI,CAAC,KAAK,cAAc,CAAC,KAAK,SAAS,KAAK,kBAAkB;AAAG;AAEjE,YAAM,WAAW,KAAK,OAAO,gBAAgB,KAAK,eAAe;AACjE,YAAM,QAAQ,SAAS,IAAI,KAAK,cAAe;AAC/C,YAAM,KAAK,KAAK,MAAM,WAAW,KAAK,eAAe;AACrD,SAAG,GAAG,IAAI,KAAK,eAAgB,IAAI,MAAM;AACzC,SAAG,GAAG,IAAI,KAAK,eAAgB,IAAI,MAAM;AAEzC,WAAK,MAAM;AACX,WAAK,cAAc;AAAA,IACvB,CAAC;AAED,SAAK,OAAO,iBAAiB,WAAW,OAAO,MAAkB;AAC7D,UAAI,EAAE,WAAW,KAAK,CAAC,KAAK;AAAY;AACxC,WAAK,aAAa;AAElB,UAAI,CAAC,KAAK,SAAS,KAAK,kBAAkB,KAAK,CAAC,KAAK;AAAgB;AACrE,YAAM,KAAK,KAAK,MAAM,WAAW,KAAK,eAAe;AAGrD,YAAM,KAAK,GAAG,GAAG,IAAI,KAAK,eAAe;AACzC,YAAM,KAAK,GAAG,GAAG,IAAI,KAAK,eAAe;AACzC,UAAI,KAAK,IAAI,EAAE,IAAI,QAAS,KAAK,IAAI,EAAE,IAAI;AAAO;AAElD,YAAM,KAAK,cAAc,QAAQ;AAAA,QAC7B,MAAM,GAAG;AAAA,QACT,GAAG,GAAG,GAAG;AAAA,QACT,GAAG,GAAG,GAAG;AAAA,QACT,GAAG,GAAG,GAAG,KAAK;AAAA,MAClB,CAAC;AAAA,IACL,CAAC;AAAA,EACL;AAAA,EAEQ,wBAAwB;AAC5B,WAAO,iBAAiB,WAAW,OAAO,MAAqB;AAE3D,UAAI,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAAK;AAChC,YAAI,EAAE,WAAW,EAAE,WAAW,EAAE;AAAQ;AACxC,cAAM,KAAK,iBAAiB,UAAU,CAAC,QAAQ,EAAE,MAAM,GAAG,MAAM,eAAe,GAAG,EAAE;AACpF;AAAA,MACJ;AAGA,UAAI,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAAK;AAChC,YAAI,EAAE,WAAW,EAAE,WAAW,EAAE;AAAQ;AACxC,cAAM,KAAK,iBAAiB,QAAQ,CAAC,QAAQ,EAAE,MAAM,GAAG,KAAK,EAAE;AAC/D;AAAA,MACJ;AAGA,WAAK,EAAE,WAAW,EAAE,YAAY,EAAE,QAAQ,OAAO,CAAC,EAAE,UAAU;AAC1D,UAAE,eAAe;AACjB,cAAM,KAAK,aAAa,WAAW;AACnC;AAAA,MACJ;AAGA,WAAM,EAAE,WAAW,EAAE,YAAY,EAAE,QAAQ,OAAO,EAAE,aAC9C,EAAE,WAAW,EAAE,YAAY,EAAE,QAAQ,KAAM;AAC7C,UAAE,eAAe;AACjB,cAAM,KAAK,aAAa,WAAW;AACnC;AAAA,MACJ;AAAA,IACJ,CAAC;AAAA,EACL;AAAA,EAEQ,qBAAqB;AACzB,WAAO,iBAAiB,UAAU,MAAM;AACpC,WAAK,cAAc;AAAA,IACvB,CAAC;AAAA,EACL;AAAA,EAEA,MAAc,iBACV,MACA,WACF;AACE,QAAI,CAAC,KAAK,SAAS,KAAK,kBAAkB;AAAG;AAC7C,UAAM,KAAK,KAAK,MAAM,WAAW,KAAK,eAAe;AACrD,UAAM,KAAK,cAAc,MAAM,UAAU,EAAE,CAAC;AAAA,EAChD;AAAA,EAEA,MAAc,cAAc,MAAc,SAAkC;AACxE,QAAI;AACA,YAAM,OAAO,MAAM,MAAM,GAAG,KAAK,OAAO,uBAAuB;AAAA,QAC3D,QAAQ;AAAA,QACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,QAC9C,MAAM,KAAK,UAAU,EAAE,MAAM,QAAQ,CAAC;AAAA,MAC1C,CAAC;AACD,YAAM,OAAO,MAAM,KAAK,KAAK;AAC7B,UAAI,KAAK;AAAO,aAAK,WAAW,KAAK,KAAK;AAAA,IAC9C,SAAS,KAAK;AACV,cAAQ,MAAM,6BAA6B,GAAG;AAAA,IAClD;AAAA,EACJ;AAAA,EAEA,MAAc,aAAa,UAAkB;AACzC,QAAI;AACA,YAAM,OAAO,MAAM,MAAM,GAAG,KAAK,OAAO,GAAG,QAAQ,IAAI,EAAE,QAAQ,OAAO,CAAC;AACzE,YAAM,OAAO,MAAM,KAAK,KAAK;AAC7B,UAAI,KAAK;AAAO,aAAK,WAAW,KAAK,KAAK;AAAA,IAC9C,SAAS,KAAK;AACV,cAAQ,MAAM,UAAU,QAAQ,KAAK,GAAG;AAAA,IAC5C;AAAA,EACJ;AAAA;AAAA,EAIA,gBAAgB,OAAe,SAAkB;AAC7C,QAAI,SAAS;AACT,WAAK,aAAa,OAAO,KAAK;AAAA,IAClC,OAAO;AACH,WAAK,aAAa,IAAI,KAAK;AAAA,IAC/B;AACA,SAAK,MAAM;AACX,SAAK,cAAc;AAAA,EACvB;AAAA,EAEA,eAAe,OAAwB;AACnC,WAAO,CAAC,KAAK,aAAa,IAAI,KAAK;AAAA,EACvC;AAAA,EAEA,YAAsB;AAClB,QAAI,CAAC,KAAK;AAAO,aAAO,CAAC;AACzB,UAAM,SAAS,oBAAI,IAAY;AAC/B,eAAW,MAAM,KAAK,MAAM,YAAY;AACpC,aAAO,IAAI,GAAG,KAAK;AACnB,iBAAW,OAAO,GAAG,MAAM;AACvB,mBAAW,KAAK,IAAI;AAAQ,iBAAO,IAAI,CAAC;AAAA,MAC5C;AACA,iBAAW,KAAK,GAAG,UAAU;AACzB,YAAI,EAAE;AAAO,iBAAO,IAAI,EAAE,KAAK;AAAA,MACnC;AAAA,IACJ;AACA,eAAW,KAAK,KAAK,MAAM,QAAQ;AAC/B,UAAI,EAAE;AAAO,eAAO,IAAI,EAAE,KAAK;AAAA,IACnC;AACA,eAAW,KAAK,KAAK,MAAM,MAAM;AAC7B,UAAI,EAAE;AAAO,eAAO,IAAI,EAAE,KAAK;AAAA,IACnC;AACA,eAAW,KAAK,KAAK,MAAM,OAAO;AAC9B,iBAAW,MAAM,EAAE;AAAiB,eAAO,IAAI,GAAG,KAAK;AAAA,IAC3D;AACA,WAAO,IAAI,WAAW;AACtB,WAAO,IAAI,MAAM;AACjB,WAAO,CAAC,GAAG,MAAM,EAAE,KAAK;AAAA,EAC5B;AAAA,EAEA,mBAAmB,IAAgB;AAC/B,SAAK,kBAAkB;AAAA,EAC3B;AAAA,EAEQ,uBAAuB;AAC3B,SAAK,MAAM;AACX,SAAK,cAAc;AAAA,EACvB;AAAA,EAEQ,gBAAgB;AACpB,SAAK,cAAc;AAAA,EACvB;AAAA,EAEQ,kBAAkB;AACtB,UAAM,OAAO,MAAM;AACf,UAAI,KAAK,aAAa;AAClB,aAAK,cAAc;AACnB,aAAK,OAAO,gBAAgB,IAAI,KAAK,KAAK,OAAO,aAAa,KAAK,OAAO,YAAY;AACtF,aAAK,SAAS,KAAK,KAAK,OAAO,MAAM;AAAA,MACzC;AACA,4BAAsB,IAAI;AAAA,IAC9B;AACA,0BAAsB,IAAI;AAAA,EAC9B;AACJ;;;ACnSA,IAAM,SAAS,SAAS,eAAe,eAAe;AACtD,IAAI,CAAC,QAAQ;AACT,QAAM,IAAI,MAAM,yCAAyC;AAC7D;AAEA,IAAM,UAAU,OAAO,SAAS;AAChC,IAAM,SAAS,IAAI,OAAO,QAAQ,OAAO;AAEzC,SAAS,kBAAkB;AACvB,QAAM,QAAQ,SAAS,eAAe,aAAa;AACnD,MAAI,CAAC;AAAO;AACZ,QAAM,YAAY;AAElB,QAAM,SAAS,OAAO,UAAU;AAChC,aAAW,aAAa,QAAQ;AAC5B,UAAM,MAAM,SAAS,cAAc,OAAO;AAC1C,QAAI,YAAY;AAEhB,UAAM,KAAK,SAAS,cAAc,OAAO;AACzC,OAAG,OAAO;AACV,OAAG,UAAU,OAAO,eAAe,SAAS;AAC5C,OAAG,iBAAiB,UAAU,MAAM;AAChC,aAAO,gBAAgB,WAAW,GAAG,OAAO;AAAA,IAChD,CAAC;AAED,UAAM,SAAS,SAAS,cAAc,MAAM;AAC5C,WAAO,YAAY;AACnB,UAAM,CAAC,GAAG,GAAG,CAAC,IAAI,cAAc,SAAS;AACzC,WAAO,MAAM,aAAa,OAAO,KAAK,MAAM,IAAI,GAAG,CAAC,IAAI,KAAK,MAAM,IAAI,GAAG,CAAC,IAAI,KAAK,MAAM,IAAI,GAAG,CAAC;AAElG,UAAM,QAAQ,SAAS,cAAc,MAAM;AAC3C,UAAM,cAAc;AAEpB,QAAI,YAAY,EAAE;AAClB,QAAI,YAAY,MAAM;AACtB,QAAI,YAAY,KAAK;AACrB,UAAM,YAAY,GAAG;AAAA,EACzB;AACJ;AAEA,OAAO,KAAK,EAAE,KAAK,MAAM;AACrB,kBAAgB;AAChB,SAAO,mBAAmB,eAAe;AAC7C,CAAC,EAAE,MAAM,CAAC,QAAQ;AACd,UAAQ,MAAM,gCAAgC,GAAG;AACrD,CAAC;",
  "names": ["canvas", "DEG_TO_RAD", "fpTransform", "canvas", "baseUrl"]
}
