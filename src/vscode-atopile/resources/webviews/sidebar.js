import{r as a,j as e,s as xe,u as ce,a as Je,c as Ms,R as zs,A as Ps}from"./index-CKQS8q1V.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$s=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,l)=>l?l.toUpperCase():t.toLowerCase()),Ue=s=>{const n=$s(s);return n.charAt(0).toUpperCase()+n.slice(1)},es=(...s)=>s.filter((n,t,l)=>!!n&&n.trim()!==""&&l.indexOf(n)===t).join(" ").trim(),Es=s=>{for(const n in s)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Is={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=a.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:l,className:i="",children:r,iconNode:h,...u},d)=>a.createElement("svg",{ref:d,...Is,width:n,height:n,stroke:s,strokeWidth:l?Number(t)*24/Number(n):t,className:es("lucide",i),...!r&&!Es(u)&&{"aria-hidden":"true"},...u},[...h.map(([o,x])=>a.createElement(o,x)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=(s,n)=>{const t=a.forwardRef(({className:l,...i},r)=>a.createElement(Vs,{ref:r,iconNode:n,className:es(`lucide-${Bs(Ue(s))}`,`lucide-${s}`,l),...i}));return t.displayName=Ue(s),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],qs=U("arrow-right",Ls);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],Me=U("box",Fs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=[["path",{d:"M17 19a1 1 0 0 1-1-1v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2a1 1 0 0 1-1 1z",key:"trhst0"}],["path",{d:"M17 21v-2",key:"ds4u3f"}],["path",{d:"M19 14V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V10",key:"1mo9zo"}],["path",{d:"M21 21v-2",key:"eo0ou"}],["path",{d:"M3 5V3",key:"1k5hjh"}],["path",{d:"M4 10a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2a2 2 0 0 1-2 2z",key:"1dd30t"}],["path",{d:"M7 5V3",key:"1t1388"}]],ss=U("cable",Rs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],_s=U("calendar",Ts);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],re=U("check",Ds);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ee=U("chevron-down",Hs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],le=U("chevron-right",Qs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=U("circle-alert",Us);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],Ys=U("circle-arrow-up",Os);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ks=U("circle-check-big",Ws);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Gs=U("circle-check",Xs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Js=U("circle-x",Zs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ve=U("circle",en);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M11 9h4a2 2 0 0 0 2-2V3",key:"1ve2rv"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M7 21v-4a2 2 0 0 1 2-2h4",key:"1fwkro"}],["circle",{cx:"15",cy:"15",r:"2",key:"3i40o0"}]],ns=U("circuit-board",sn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qe=U("clock",nn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ts=U("copy",tn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],Fe=U("cpu",an);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=[["path",{d:"m21.12 6.4-6.05-4.06a2 2 0 0 0-2.17-.05L2.95 8.41a2 2 0 0 0-.95 1.7v5.82a2 2 0 0 0 .88 1.66l6.05 4.07a2 2 0 0 0 2.17.05l9.95-6.12a2 2 0 0 0 .95-1.7V8.06a2 2 0 0 0-.88-1.66Z",key:"1u2ovd"}],["path",{d:"M10 22v-8L2.25 9.15",key:"11pn4q"}],["path",{d:"m10 14 11.77-6.87",key:"1kt1wh"}]],rn=U("cuboid",ln);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Pe=U("download",cn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],we=U("external-link",on);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]],ye=U("file-code",dn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Oe=U("file-text",un);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Ee=U("folder-open",hn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],as=U("folder",mn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],xn=U("funnel",pn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Ye=U("git-branch",gn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],jn=U("globe",fn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],vn=U("grid-3x3",Nn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],bn=U("grip-horizontal",yn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],wn=U("hammer",kn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ce=U("hash",Cn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Se=U("layers",Sn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ge=U("loader-circle",An);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],be=U("package",Mn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Pn=U("panels-top-left",zn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],$n=U("pause",Bn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],In=U("percent",En);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Ae=U("play",Vn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ls=U("plus",Ln);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Be=U("refresh-cw",qn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ue=U("search",Fn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Tn=U("settings",Rn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],Dn=U("skip-forward",_n);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],rs=U("square",Hn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Un=U("tag",Qn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Yn=U("trash-2",On);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ie=U("triangle-alert",Wn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],he=U("x",Kn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Ne=U("zap",Xn);function je({id:s,title:n,badge:t,badgeType:l="count",errorCount:i,warningCount:r,warningMessage:h,loading:u,collapsed:d,onToggle:o,onClearFilter:x,height:p,maxHeight:g,onResizeStart:V,children:j,flexGrow:w,autoSize:k}){const f=!d&&p&&!w,P=!d&&!p&&g&&!w,C=f?{height:p,flex:"0 1 auto",minHeight:0}:P?{maxHeight:g,flex:"0 1 auto",minHeight:0}:!d&&k&&!p&&!g&&!w?{flex:"0 1 auto",minHeight:0}:void 0;return e.jsxs("div",{className:`collapsible-section ${d?"collapsed":""} ${w?"flex-grow":""} ${f?"has-height":""} ${P?"has-max-height":""}`,style:C,"data-section-id":s,children:[e.jsxs("div",{className:"section-title-bar",onClick:o,children:[e.jsx("button",{className:"section-chevron",children:d?e.jsx(le,{size:12}):e.jsx(ee,{size:12})}),e.jsx("span",{className:"section-title",children:n}),u&&e.jsx("span",{className:"section-loading",children:e.jsx(ge,{size:12,className:"animate-spin"})}),i!==void 0&&i>0&&e.jsxs("span",{className:"section-error-count",children:[e.jsx(de,{size:10}),i]}),r!==void 0&&r>0&&e.jsxs("span",{className:"section-warning-count",title:h||void 0,children:[e.jsx(ie,{size:10}),r]}),h&&(r===void 0||r===0)&&e.jsx("span",{className:"section-warning-message",title:h,children:e.jsx(ie,{size:10})}),t!==void 0&&e.jsxs("span",{className:`section-badge ${l==="filter"?"filter-badge":""}`,children:[l==="filter"&&e.jsx(xn,{size:8}),t,l==="filter"&&x&&e.jsx("button",{className:"clear-filter-btn",onClick:B=>{B.stopPropagation(),x()},title:"Clear filter",children:e.jsx(he,{size:8})})]})]}),!d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"section-body",children:j}),V&&!w&&e.jsx("div",{className:"section-resize-handle",onMouseDown:V,children:e.jsx(bn,{size:10})})]})]})}function Gn(s,n=12){switch(s){case"module":return e.jsx(Me,{size:n,className:"type-icon module"});case"interface":return e.jsx(Ne,{size:n,className:"type-icon interface"});case"component":return e.jsx(Fe,{size:n,className:"type-icon component"});case"parameter":return e.jsx(ns,{size:n,className:"type-icon parameter"})}}const Zn=a.memo(function s({symbol:n,depth:t,projectId:l,selection:i,onSelect:r,onBuild:h}){const[u,d]=a.useState(!1),[o,x]=a.useState(!1),p=n.children&&n.children.length>0,g=i.type==="symbol"&&i.symbolPath===n.path;return e.jsxs("div",{className:"symbol-node",children:[e.jsxs("div",{className:`symbol-row ${p?"expandable":""} ${g?"selected":""}`,style:{paddingLeft:`${t*4}px`},onClick:()=>{p&&d(!u),r({type:"symbol",projectId:l,symbolPath:n.path,label:n.name})},onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[p?e.jsx("button",{className:"tree-expand",onClick:V=>{V.stopPropagation(),d(!u)},children:u?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}):e.jsx("span",{className:"tree-spacer"}),Gn(n.type),e.jsx("span",{className:"symbol-name",children:n.name}),n.hasErrors&&e.jsx("span",{className:"indicator error"}),n.hasWarnings&&!n.hasErrors&&e.jsx("span",{className:"indicator warning"}),e.jsx("button",{className:"symbol-play-btn",onClick:V=>{V.stopPropagation(),h("symbol",n.path,n.name)},title:`Build ${n.name}`,children:e.jsx(Ae,{size:10})})]}),u&&p&&e.jsx("div",{className:"symbol-children",children:n.children.map((V,j)=>e.jsx(s,{symbol:V,depth:t+1,projectId:l,selection:i,onSelect:r,onBuild:h},`${V.path}-${j}`))})]})}),is={interface:{icon:ss,color:"var(--ctp-blue)",label:"Interface"},module:{icon:Me,color:"var(--ctp-green)",label:"Module"},component:{icon:Fe,color:"var(--ctp-mauve)",label:"Component"},trait:{icon:Ne,color:"var(--ctp-yellow)",label:"Trait"},parameter:{icon:Ce,color:"var(--ctp-peach)",label:"Parameter"}};function Ie({child:s,depth:n,expandedPaths:t,onToggle:l,basePath:i=""}){const r=i?`${i}.${s.name}`:s.name,h=t.has(r),u=s.children&&s.children.length>0,d=s.itemType||"interface",o=is[d],x=o.icon,p=g=>{g.stopPropagation(),u&&l(r)};return e.jsxs("div",{className:"module-tree-node",children:[e.jsxs("div",{className:`module-tree-row ${u?"expandable":""}`,style:{paddingLeft:`${n*12+4}px`},onClick:p,children:[u?e.jsx("button",{className:"module-tree-expand-btn",onClick:p,children:h?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}):e.jsx("span",{className:"module-tree-expand-spacer"}),e.jsx("span",{className:"module-tree-icon",style:{color:o.color},children:e.jsx(x,{size:12})}),e.jsx("span",{className:"module-tree-name",children:s.name}),e.jsx("span",{className:"module-tree-type",style:{color:o.color},children:s.typeName})]}),h&&u&&e.jsx("div",{className:"module-tree-children",children:s.children.map((g,V)=>e.jsx(Ie,{child:g,depth:n+1,expandedPaths:t,onToggle:l,basePath:r},`${r}-${g.name}-${V}`))})]})}function Jn({children:s,rootName:n,rootType:t}){const[l,i]=a.useState(new Set),r=h=>{i(u=>{const d=new Set(u);return d.has(h)?d.delete(h):d.add(h),d})};if(n){const u=is[t==="component"?"component":"module"],d=u.icon,o=l.has("__root__");return e.jsxs("div",{className:"module-tree",children:[e.jsxs("div",{className:"module-tree-row expandable root",onClick:()=>r("__root__"),children:[e.jsx("button",{className:"module-tree-expand-btn",children:o?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}),e.jsx("span",{className:"module-tree-icon",style:{color:u.color},children:e.jsx(d,{size:14})}),e.jsx("span",{className:"module-tree-name root-name",children:n}),e.jsx("span",{className:"module-tree-count",children:s.length})]}),o&&e.jsx("div",{className:"module-tree-children",children:s.map((x,p)=>e.jsx(Ie,{child:x,depth:1,expandedPaths:l,onToggle:r},`${x.name}-${p}`))})]})}return e.jsx("div",{className:"module-tree",children:s.map((h,u)=>e.jsx(Ie,{child:h,depth:0,expandedPaths:l,onToggle:r},`${h.name}-${u}`))})}function cs({validation:s,onApplySuggestion:n,className:t=""}){return s.isValid?null:e.jsxs("div",{className:`name-validation-dropdown ${t}`,children:[e.jsxs("div",{className:"validation-error",children:[e.jsx(de,{size:12,className:"validation-icon"}),e.jsx("span",{children:s.error})]}),s.suggestion&&e.jsxs("button",{className:"validation-suggestion",onClick:l=>{l.stopPropagation(),l.preventDefault(),n(s.suggestion)},type:"button",children:[e.jsx("span",{className:"suggestion-label",children:"Use:"}),e.jsx("code",{className:"suggestion-value",children:s.suggestion}),e.jsx(qs,{size:12,className:"suggestion-arrow"})]})]})}const et=/^[a-z][a-z0-9_-]*$/;function os(s){if(!s||s.trim()==="")return{isValid:!1,error:"Name cannot be empty",suggestion:void 0};const n=s.trim();if(et.test(n))return{isValid:!0};const t=st(n);let l="Invalid name";return/\s/.test(n)?l="Name cannot contain spaces":/^[0-9]/.test(n)?l="Name must start with a letter":/[A-Z]/.test(n)?l="Name must be lowercase":/[^a-z0-9_-]/.test(n)&&(l="Name contains invalid characters"),{isValid:!1,error:l,suggestion:t!==n?t:void 0}}function st(s){let n=s.toLowerCase().replace(/[\s_]+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-+|-+$/g,"");return/^[0-9]/.test(n)&&(n="project-"+n),n||(n="new-project"),n}function nt(){const[s,n]=a.useState(0);return a.useEffect(()=>{const t=setInterval(()=>{n(l=>l+1)},1e3);return()=>clearInterval(t)},[]),e.jsxs(e.Fragment,{children:[s,"s"]})}function tt(s){const n=Math.floor(s/3600),t=Math.floor(s%3600/60),l=Math.floor(s%60);return n>0?`${n}:${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${t}:${l.toString().padStart(2,"0")}`}function at(s){const n=s.replace(/_/g,"T").replace(/-(\d{2})-(\d{2})$/,":$1:$2");return new Date(n)}function ds(s){const n=at(s);if(isNaN(n.getTime()))return"";const l=new Date().getTime()-n.getTime(),i=Math.floor(l/1e3),r=Math.floor(i/60),h=Math.floor(r/60),u=Math.floor(h/24);return i<60?"just now":r<60?`${r}m ago`:h<24?`${h}h ago`:u===1?"yesterday":u<7?`${u}d ago`:n.toLocaleDateString()}function lt(s,n=12,t){switch(s){case"building":return e.jsx(ve,{size:n,className:"status-icon building"});case"queued":return e.jsxs("span",{className:"status-icon queued",title:t?`Queue position: ${t}`:"Queued",children:[e.jsx(qe,{size:n}),t&&e.jsx("span",{className:"queue-position",children:t})]});case"success":return e.jsx(re,{size:n,className:"status-icon success"});case"error":return e.jsx(he,{size:n,className:"status-icon error"});case"warning":return e.jsx(ie,{size:n,className:"status-icon warning"});default:return e.jsx("div",{className:"status-dot idle"})}}function rt(s,n=12){switch(s){case"running":return e.jsx(ve,{size:n,className:"stage-icon running"});case"success":return e.jsx(re,{size:n,className:"stage-icon success"});case"warning":return e.jsx(ie,{size:n,className:"stage-icon warning"});case"error":return e.jsx(he,{size:n,className:"stage-icon error"});case"skipped":return e.jsx(Dn,{size:n,className:"stage-icon skipped"});case"pending":default:return e.jsx(ve,{size:n,className:"stage-icon pending"})}}function us(s,n=12){switch(s){case"success":return e.jsx(re,{size:n,className:"status-icon success dimmed"});case"warning":return e.jsx(ie,{size:n,className:"status-icon warning dimmed"});case"error":case"failed":return e.jsx(de,{size:n,className:"status-icon error dimmed"});default:return e.jsx(ve,{size:n,className:"status-icon idle dimmed"})}}const it=a.memo(function({build:n,projectId:t,projectRoot:l,selection:i,onSelect:r,onBuild:h,onCancelBuild:u,onStageFilter:d,onUpdateBuild:o,onDeleteBuild:x,onOpenSource:p,onOpenKiCad:g,onOpenLayout:V,onOpen3D:j,availableModules:w=[],allBuilds:k=[],readOnly:f=!1}){var Qe;const[P,m]=a.useState(!1),[C,B]=a.useState(!1),[M,z]=a.useState(!1),[c,A]=a.useState(n.name),[F,N]=a.useState(n.entry),[_,Q]=a.useState(""),[D,O]=a.useState(!1),[$,Y]=a.useState(null),I=a.useRef(null),[H,K]=a.useState(null),[y,S]=a.useState(!1),[v,T]=a.useState(null),[W,J]=a.useState(n.elapsedSeconds||0),Z=n.status==="building",[E,L]=a.useState(null),[q,X]=a.useState(!1);a.useEffect(()=>{if(!Z){J(n.elapsedSeconds||n.duration||0);return}J(n.elapsedSeconds||0);const b=setInterval(()=>{J(te=>te+1)},1e3);return()=>clearInterval(b)},[Z,n.elapsedSeconds,n.duration]);const G=20,ne=()=>{if(!n.stages||n.stages.length===0)return 0;const b=n.totalStages||G;let te=0,me=0;for(const ke of n.stages){const Ss=ke.status==="success"||ke.status==="warning"||ke.status==="error"||ke.status==="skipped",As=ke.status==="running";Ss?te+=1:As&&(me+=.5)}const $e=(te+me)/b*100;return Math.min($e,100)},se=(()=>{if(n.currentStage)return n.currentStage;if(!n.stages)return null;const b=n.stages.find(te=>te.status==="running");return(b==null?void 0:b.displayName)||(b==null?void 0:b.name)||null})();a.useEffect(()=>{if(se&&se!==E){X(!0),L(se);const b=setTimeout(()=>X(!1),300);return()=>clearTimeout(b)}},[se,E]);const fe=w.filter(b=>b.type==="module"||b.type==="component").filter(b=>{if(!_)return!0;const te=_.toLowerCase();return b.name.toLowerCase().includes(te)||b.entry.toLowerCase().includes(te)||b.file.toLowerCase().includes(te)});a.useEffect(()=>{M&&I.current&&I.current.focus()},[M]);const oe=i.type==="build"&&i.buildId===`${t}:${n.id}`;a.useEffect(()=>{!oe||H!==null||y||!l||!n.entry||(S(!0),T(null),xe("getModuleChildren",{projectRoot:l,entryPoint:n.entry,maxDepth:3}).then(b=>{const te=b.result??{},me=Array.isArray(te.children)?te.children:[];K(me),S(!1)}).catch(b=>{console.warn("Failed to fetch module children:",b),T(b.message||"Failed to load module structure"),S(!1)}))},[oe,H,y,l,n.entry,n.name]);const ze=a.useMemo(()=>os(c),[c]),_e=()=>{ze.isValid&&(B(!1),o&&o(t,n.id,{name:c}))},Ns=b=>{A(b)},vs=b=>{Q(b)},De=b=>{const te=k.find(me=>me.id!==n.id&&me.entry===b.entry);if(te){Y({entry:b.entry,usedBy:te.name});return}Y(null),N(b.entry),z(!1),Q(""),o&&o(t,n.id,{entry:b.entry})},ys=()=>{$&&(N($.entry),z(!1),Q(""),Y(null),o&&o(t,n.id,{entry:$.entry}))},bs=()=>{Y(null)},He=H&&H.length>0,ks=n.symbols&&n.symbols.length>0,ws=n.stages&&n.stages.length>0,Cs=((Qe=n.entry)==null?void 0:Qe.split(":").pop())||n.name;return e.jsxs("div",{className:`build-card ${oe?"selected":""} ${Z?"building":""}`,onClick:b=>{b.stopPropagation(),r({type:"build",projectId:t,buildId:`${t}:${n.id}`,label:`${n.name}`})},children:[e.jsxs("div",{className:"build-card-header",onClick:b=>{oe&&(b.stopPropagation(),r({type:"none"}))},children:[e.jsxs("div",{className:"build-header-left",children:[f?e.jsx("div",{className:"build-status-icon",children:e.jsx(ve,{size:8,className:"status-icon idle"})}):e.jsx("div",{className:"build-status-icon",children:lt(n.status,12,n.queuePosition)}),C&&oe&&!f?e.jsxs("div",{className:"name-input-wrapper",onClick:b=>b.stopPropagation(),children:[e.jsx("input",{type:"text",className:`build-name-input ${ze.isValid?"":"invalid"}`,value:c,onChange:b=>A(b.target.value),onBlur:()=>{ze.isValid&&_e()},onKeyDown:b=>{b.key==="Enter"&&_e(),b.key==="Escape"&&(A(n.name),B(!1))},autoFocus:!0}),e.jsx(cs,{validation:ze,onApplySuggestion:Ns})]}):e.jsx("span",{className:`build-card-name ${oe&&!f?"editable":""}`,onClick:oe&&!f?b=>{b.stopPropagation(),B(!0)}:void 0,title:oe&&!f?"Click to edit build name":void 0,children:c}),Z&&se&&e.jsx("span",{className:`build-inline-stage ${q?"animating":""}`,children:se})]}),e.jsx("div",{className:"build-header-right",children:!f&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"build-indicators",children:[Z&&e.jsx("span",{className:"build-elapsed-time-inline",children:tt(W)}),!Z&&e.jsxs(e.Fragment,{children:[n.errors!==void 0&&n.errors>0&&e.jsxs("span",{className:"error-indicator clickable",onClick:b=>{b.stopPropagation(),d==null||d("",n.id,t)},title:"Click to filter problems for this build",children:[e.jsx(de,{size:12}),e.jsx("span",{children:n.errors})]}),n.warnings!==void 0&&n.warnings>0&&e.jsxs("span",{className:"warning-indicator clickable",onClick:b=>{b.stopPropagation(),d==null||d("",n.id,t)},title:"Click to filter problems for this build",children:[e.jsx(ie,{size:12}),e.jsx("span",{children:n.warnings})]}),n.duration?e.jsxs("span",{className:"build-duration",children:[n.duration.toFixed(1),"s"]}):n.lastBuild?e.jsxs("span",{className:"last-build-info",title:`Last build: ${n.lastBuild.status}`,children:[us(n.lastBuild.status,10),e.jsx("span",{className:"last-build-time",children:ds(n.lastBuild.timestamp)})]}):null]})]}),Z?e.jsx("button",{className:"build-target-cancel-btn",onClick:b=>{b.stopPropagation(),n.buildId&&u&&u(n.buildId)},title:`Cancel build ${n.name}`,children:e.jsx(rs,{size:10,fill:"currentColor"})}):oe?e.jsx("button",{className:"build-target-delete-btn",onClick:b=>{b.stopPropagation(),O(!0)},title:`Delete build ${n.name}`,children:e.jsx(Yn,{size:12})}):e.jsx("button",{className:"build-target-play-btn",onClick:b=>{b.stopPropagation(),h("build",`${t}:${n.id}`,n.name)},title:`Build ${n.name}`,children:e.jsx(Ae,{size:12})})]})})]}),!f&&D&&e.jsxs("div",{className:"build-delete-confirm",onClick:b=>b.stopPropagation(),children:[e.jsxs("span",{className:"delete-confirm-text",children:['Delete "',n.name,'"?']}),e.jsxs("div",{className:"delete-confirm-buttons",children:[e.jsx("button",{className:"delete-confirm-btn cancel",onClick:()=>O(!1),children:"Cancel"}),e.jsx("button",{className:"delete-confirm-btn confirm",onClick:()=>{O(!1),x==null||x(t,n.id)},children:"Delete"})]})]}),$&&e.jsxs("div",{className:"build-duplicate-warning",onClick:b=>b.stopPropagation(),children:[e.jsx("div",{className:"duplicate-warning-icon",children:e.jsx(ie,{size:16})}),e.jsxs("span",{className:"duplicate-warning-text",children:['This entry point is already used by "',$.usedBy,'"']}),e.jsxs("div",{className:"duplicate-warning-buttons",children:[e.jsx("button",{className:"duplicate-warning-btn cancel",onClick:bs,children:"Cancel"}),e.jsx("button",{className:"duplicate-warning-btn confirm",onClick:ys,children:"Use Anyway"})]})]}),!f&&Z&&e.jsx("div",{className:"build-progress-container",children:e.jsx("div",{className:"build-progress-bar",children:e.jsx("div",{className:"build-progress-fill",style:{width:`${ne()}%`}})})}),oe&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"build-card-entry-row",children:[e.jsx(ye,{size:12}),M?e.jsxs("div",{className:"entry-picker",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"entry-search-box",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:I,type:"text",className:"entry-search-input",value:_,onChange:b=>vs(b.target.value),onKeyDown:b=>{b.key==="Escape"&&(Q(""),z(!1),Y(null)),b.key==="Enter"&&fe.length===1&&De(fe[0])},placeholder:"Search modules..."}),e.jsx("button",{className:"entry-close-btn",onClick:()=>{Q(""),z(!1),Y(null)},children:e.jsx(he,{size:10})})]}),e.jsx("div",{className:"entry-dropdown",children:fe.length>0?fe.map(b=>e.jsxs("div",{className:`entry-option ${b.entry===F?"selected":""}`,onClick:()=>De(b),children:[e.jsx(Me,{size:10,className:`module-type-icon ${b.type}`}),e.jsx("span",{className:"entry-option-name",children:b.name}),e.jsx("span",{className:"entry-option-file",children:b.file})]},b.entry)):w.length===0?e.jsx("div",{className:"entry-empty",children:e.jsx("span",{children:"No modules found in project"})}):e.jsx("div",{className:"entry-empty",children:e.jsxs("span",{children:['No matching modules for "',_,'"']})})})]}):e.jsx("span",{className:"entry-path editable",onClick:b=>{b.stopPropagation(),z(!0),Q("")},title:"Click to change entry point",children:F}),n.duration&&e.jsxs("span",{className:"build-duration",children:[e.jsx(qe,{size:10}),n.duration.toFixed(1),"s"]})]}),ws&&e.jsxs("div",{className:"build-stages-section",children:[e.jsxs("button",{className:"stages-toggle",onClick:b=>{b.stopPropagation(),m(!P)},children:[P?e.jsx(ee,{size:12}):e.jsx(le,{size:12}),e.jsx("span",{children:"Build Stages"}),e.jsxs("span",{className:"stages-summary",children:[n.stages.filter(b=>b.status==="success").length,"/",n.stages.length," complete"]})]}),P&&e.jsx("div",{className:"build-stages-list",children:n.stages.map(b=>{const te=(b.status==="warning"||b.status==="error")&&d,me=b.duration??b.elapsedSeconds;return e.jsxs("div",{className:`stage-row ${b.status} ${te?"clickable":""}`,onClick:te?$e=>{$e.stopPropagation(),d(b.name,n.id,t)}:void 0,title:te?`Filter problems to ${b.displayName||b.name} stage`:void 0,children:[rt(b.status),e.jsx("span",{className:"stage-name",children:b.displayName||b.name}),b.message&&e.jsx("span",{className:"stage-message",children:b.message}),e.jsx("span",{className:"stage-duration",children:b.status==="running"?e.jsx(nt,{}):me!=null?`${me.toFixed(1)}s`:""})]},b.name)})})]}),e.jsxs("div",{className:"build-card-actions",children:[e.jsxs("button",{className:"build-action-btn primary",onClick:b=>{b.stopPropagation(),h("build",`${t}:${n.id}`,n.name)},title:`Build ${n.name}`,children:[e.jsx(Ae,{size:12}),e.jsx("span",{children:"Build"})]}),e.jsxs("button",{className:"build-action-btn",onClick:b=>{b.stopPropagation(),p==null||p(t,n.entry)},title:"Open Source Code",children:[e.jsx(ye,{size:12}),e.jsx("span",{children:"ato"})]}),e.jsxs("button",{className:"build-action-btn",onClick:b=>{b.stopPropagation(),g==null||g(t,n.id)},title:"Open in KiCad",children:[e.jsx(vn,{size:12}),e.jsx("span",{children:"KiCad"})]}),e.jsxs("button",{className:"build-action-btn",onClick:b=>{b.stopPropagation(),V==null||V(t,n.id)},title:"Edit Layout",children:[e.jsx(Pn,{size:12}),e.jsx("span",{children:"Layout"})]}),e.jsxs("button",{className:"build-action-btn",onClick:b=>{b.stopPropagation(),j==null||j(t,n.id)},title:"3D Preview",children:[e.jsx(rn,{size:12}),e.jsx("span",{children:"3D"})]})]}),y&&e.jsxs("div",{className:"build-card-symbols loading",children:[e.jsx(ve,{size:12,className:"spinner"}),e.jsx("span",{className:"loading-text",children:"Loading module structure..."})]}),v&&e.jsx("div",{className:"build-card-symbols error",children:e.jsxs("span",{className:"error-text",children:["Failed to load: ",v]})}),!y&&!v&&He&&e.jsx("div",{className:"build-card-symbols",children:e.jsx(Jn,{children:H,rootName:Cs})}),!y&&!v&&!He&&ks&&n.symbols[0]&&e.jsx("div",{className:"build-card-symbols",children:e.jsx(Zn,{symbol:n.symbols[0],depth:0,projectId:t,selection:i,onSelect:r,onBuild:h},n.symbols[0].path)})]})]})});function hs({builds:s,projectId:n,projectRoot:t,selection:l,onSelect:i,onBuild:r,onCancelBuild:h,onStageFilter:u,onUpdateBuild:d,onDeleteBuild:o,onOpenSource:x,onOpenKiCad:p,onOpenLayout:g,onOpen3D:V,onAddBuild:j,availableModules:w=[],readOnly:k=!1}){const[f,P]=a.useState(!0),m=s.filter(F=>F.status==="building").length,C=s.filter(F=>F.status==="queued").length,B=s.filter(F=>F.status==="error").length,M=s.filter(F=>F.status==="warning").length,z=s.filter(F=>F.status==="success").length,c=s.filter(F=>F.status==="idle").length,A=!k&&(m>0||C>0||B>0||M>0||z>0);return e.jsxs("div",{className:"builds-card",onClick:F=>F.stopPropagation(),children:[e.jsxs("div",{className:"builds-card-header",onClick:F=>{F.stopPropagation(),P(!f)},children:[e.jsx("span",{className:"builds-card-expand",children:e.jsx(ee,{size:12,className:`expand-icon ${f?"expanded":""}`})}),e.jsx(wn,{size:14,className:"builds-card-icon"}),e.jsx("span",{className:"builds-card-title",children:"Builds"}),k?e.jsx("span",{className:"builds-count",children:s.length}):e.jsxs(e.Fragment,{children:[m>0&&e.jsx("span",{className:"builds-status-badge building",title:`${m} building`,children:m}),C>0&&e.jsx("span",{className:"builds-status-badge queued",title:`${C} queued`,children:C}),B>0&&e.jsx("span",{className:"builds-status-badge error",title:`${B} failed`,children:B}),M>0&&e.jsx("span",{className:"builds-status-badge warning",title:`${M} warnings`,children:M}),z>0&&e.jsx("span",{className:"builds-status-badge success",title:`${z} passed`,children:z}),!A&&c>0&&e.jsx("span",{className:"builds-count",children:c})]})]}),f&&e.jsxs("div",{className:"builds-card-content",children:[s.map((F,N)=>e.jsx(it,{build:F,projectId:n,projectRoot:t,selection:l,onSelect:i,onBuild:r,onCancelBuild:h,onStageFilter:u,onUpdateBuild:d,onDeleteBuild:o,onOpenSource:x,onOpenKiCad:p,onOpenLayout:g,onOpen3D:V,availableModules:w,allBuilds:s,readOnly:k},`${F.id}-${N}`)),!k&&e.jsxs("button",{className:"add-build-btn",onClick:F=>{F.stopPropagation(),j==null||j(n)},title:"Add new build target",children:[e.jsx(ls,{size:12}),e.jsx("span",{children:"Add build"})]})]})]})}function ct({dependency:s,availableVersions:n=[],onVersionChange:t,onRemove:l,readOnly:i=!1}){const[r,h]=a.useState(s.version),[u,d]=a.useState(!1),o=!i&&(s.hasUpdate||s.latestVersion&&s.version!==s.latestVersion),x=n.length>0?n:s.latestVersion&&s.latestVersion!==s.version?[s.latestVersion,s.version]:[s.version],p=g=>{h(g),t==null||t(s.identifier,g)};return e.jsxs("div",{className:`dependency-item ${o?"has-update":""}`,children:[e.jsxs("div",{className:"dependency-info",children:[e.jsx(be,{size:14,className:"dependency-icon"}),e.jsx("span",{className:"dependency-name",title:s.identifier,children:s.name}),s.publisher&&s.publisher!=="atopile"&&e.jsxs("span",{className:"dependency-publisher",children:["by ",s.publisher]})]}),e.jsxs("div",{className:"dependency-actions",children:[i?e.jsx("span",{className:"dependency-version-display",title:`Version ${s.version}`,children:s.version}):e.jsx("select",{className:`dependency-version-select ${o?"update-available":""}`,value:r,onChange:g=>{g.stopPropagation(),p(g.target.value)},onClick:g=>g.stopPropagation(),title:o?`Update available: ${s.latestVersion}`:`Version ${s.version}`,children:x.map((g,V)=>e.jsxs("option",{value:g,children:[g,V===0&&o&&g===s.latestVersion?" (latest)":""]},g))}),!i&&e.jsx("button",{className:`dependency-remove-btn ${u?"removing":""}`,onClick:g=>{g.stopPropagation(),u||(d(!0),l==null||l(s.identifier))},disabled:u,title:u?"Removing...":`Remove ${s.name}`,children:u?e.jsx(ge,{size:12,className:"spin"}):e.jsx(he,{size:12})})]})]})}function ms({dependencies:s,projectId:n,onVersionChange:t,onRemove:l,readOnly:i=!1}){const[r,h]=a.useState(!1);return!s||s.length===0?null:e.jsxs("div",{className:"dependency-card",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"dependency-card-header",onClick:u=>{u.stopPropagation(),h(!r)},children:[e.jsx("span",{className:"dependency-card-expand",children:e.jsx(ee,{size:12,className:`expand-icon ${r?"expanded":""}`})}),e.jsx(be,{size:14,className:"dependency-card-icon"}),e.jsx("span",{className:"dependency-card-title",children:"Dependencies"}),e.jsx("span",{className:"dependency-count",children:s.length})]}),r&&e.jsx("div",{className:"dependency-card-content",children:s.map(u=>e.jsx(ct,{dependency:u,onVersionChange:(d,o)=>t==null?void 0:t(n,d,o),onRemove:d=>l==null?void 0:l(n,d),readOnly:i},u.identifier))})]})}function ot(s,n=12){switch(s){case"ato":return e.jsx(ye,{size:n,className:"file-icon ato"});case"py":return e.jsx(Oe,{size:n,className:"file-icon python"});default:return e.jsx(Oe,{size:n,className:"file-icon"})}}const dt=a.memo(function s({node:n,depth:t,onFileClick:l,defaultExpanded:i=!1}){const[r,h]=a.useState(i),u=n.type==="folder",d=u&&n.children&&n.children.length>0;return e.jsxs("div",{className:"file-tree-node",children:[e.jsxs("div",{className:`file-tree-row ${u?"folder":"file"} ${n.extension||""}`,style:{paddingLeft:`${t*12+4}px`},onClick:o=>{o.stopPropagation(),u?h(!r):l&&l(n.path)},children:[u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"file-tree-expand",children:r?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}),r?e.jsx(Ee,{size:14,className:"folder-icon open"}):e.jsx(as,{size:14,className:"folder-icon"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"file-tree-spacer"}),ot(n.extension,14)]}),e.jsx("span",{className:"file-tree-name",children:n.name})]}),r&&d&&e.jsx("div",{className:"file-tree-children",children:[...n.children].sort((o,x)=>o.type==="file"&&x.type==="folder"?-1:o.type==="folder"&&x.type==="file"?1:o.name.localeCompare(x.name)).map(o=>e.jsx(s,{node:o,depth:t+1,onFileClick:l,defaultExpanded:!1},o.path))})]})});function ps(s){let n=0;for(const t of s)t.type==="file"?n++:t.children&&(n+=ps(t.children));return n}const xs=a.memo(function({files:n,onFileClick:t}){const[l,i]=a.useState(!1);if(!n||n.length===0)return null;const r=[...n].sort((u,d)=>u.type==="file"&&d.type==="folder"?-1:u.type==="folder"&&d.type==="file"?1:u.name.localeCompare(d.name)),h=ps(n);return e.jsxs("div",{className:"file-explorer-card",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"file-explorer-card-header",onClick:u=>{u.stopPropagation(),i(!l)},children:[e.jsx("span",{className:"file-explorer-card-expand",children:e.jsx(ee,{size:12,className:`expand-icon ${l?"expanded":""}`})}),e.jsx(as,{size:14,className:"file-explorer-card-icon"}),e.jsx("span",{className:"file-explorer-card-title",children:"Files"}),e.jsx("span",{className:"file-count",children:h})]}),l&&e.jsx("div",{className:"file-explorer-card-content",children:r.map(u=>e.jsx(dt,{node:u,depth:0,onFileClick:t,defaultExpanded:!1},u.path))})]})});function ut(s){return s==null?"0":s>=1e6?(s/1e6).toFixed(1).replace(/\.0$/,"")+"M":s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"k":s.toString()}function ht(s,n){if(!(s.installedIn||[]).some(r=>r===n||r.endsWith(`/${n}`)||n.endsWith(r)))return{installed:!1};const i=s.latestVersion&&s.version&&s.version!==s.latestVersion;return{installed:!0,version:s.version,needsUpdate:!!i,latestVersion:s.latestVersion}}function mt({versions:s,selectedVersion:n,onVersionChange:t,latestVersion:l}){const[i,r]=a.useState(!1),h=a.useRef(null);a.useEffect(()=>{function x(p){h.current&&!h.current.contains(p.target)&&r(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const u=s.filter(x=>x&&x!=="unknown");if(u.length===0)return null;const o=(n&&n!=="unknown"?n:null)||u[0]||"";return e.jsxs("div",{className:"version-selector",ref:h,children:[e.jsxs("button",{className:"version-selector-btn",onClick:x=>{x.stopPropagation(),r(!i)},title:"Select version",children:[e.jsx("span",{className:"version-selector-value",children:o}),e.jsx(ee,{size:10})]}),i&&e.jsx("div",{className:"version-selector-menu",children:u.map(x=>e.jsxs("button",{className:`version-option ${x===n?"selected":""}`,onClick:p=>{p.stopPropagation(),t(x),r(!1)},children:[e.jsx("span",{children:x}),x===l&&e.jsx("span",{className:"latest-tag",children:"latest"}),x===n&&e.jsx(re,{size:12,className:"selected-check"})]},x))})]})}function pt({availableProjects:s,selectedProjectId:n,onSelect:t}){const[l,i]=a.useState(!1),[r,h]=a.useState(""),u=a.useRef(null),d=a.useRef(null);a.useEffect(()=>{function p(g){u.current&&!u.current.contains(g.target)&&(i(!1),h(""))}return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]),a.useEffect(()=>{l&&s.length>5&&d.current&&d.current.focus()},[l,s.length]);const o=s.find(p=>p.id===n),x=(o==null?void 0:o.name)||"project";return e.jsxs("div",{className:"project-selector",ref:u,children:[e.jsxs("button",{className:"project-selector-btn",onClick:p=>{p.stopPropagation(),i(!l)},title:`Install to: ${o==null?void 0:o.name}`,children:[e.jsx("span",{className:"project-selector-name",children:x}),e.jsx(ee,{size:10})]}),l&&e.jsxs("div",{className:"project-selector-menu",children:[e.jsx("div",{className:"dropdown-header",children:"Install to:"}),s.length>5&&e.jsxs("div",{className:"dropdown-search",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:d,type:"text",placeholder:"Filter projects...",value:r,onChange:p=>h(p.target.value),onClick:p=>p.stopPropagation()})]}),e.jsxs("div",{className:"dropdown-items",children:[s.filter(p=>p.name.toLowerCase().includes(r.toLowerCase())).map(p=>e.jsxs("button",{className:`dropdown-item ${p.id===n?"selected":""}`,onClick:g=>{g.stopPropagation(),t(p.id),i(!1)},children:[e.jsx(Se,{size:12}),e.jsx("span",{children:p.name}),p.id===n&&e.jsx(re,{size:12,className:"selected-check"})]},p.id)),s.filter(p=>p.name.toLowerCase().includes(r.toLowerCase())).length===0&&e.jsxs("div",{className:"dropdown-empty",children:['No projects match "',r,'"']})]})]})]})}const xt=a.memo(function({project:n,selection:t,onSelect:l,onBuild:i,onCancelBuild:r,onStageFilter:h,onOpenPackageDetail:u,onInstall:d,onOpenSource:o,onOpenKiCad:x,onOpenLayout:p,onOpen3D:g,availableProjects:V,isInstalling:j=!1}){var y;const[w,k]=a.useState(!1),[f,P]=a.useState(!1),[m,C]=a.useState(()=>{const S=n.latestVersion&&n.latestVersion!=="unknown"?n.latestVersion:null,v=n.version&&n.version!=="unknown"?n.version:null;return S||v||""}),[B,M]=a.useState(()=>{var S,v;return((S=V.find(T=>T.isActive))==null?void 0:S.id)||((v=V[0])==null?void 0:v.id)||""}),[z,c]=a.useState(null),[A,F]=a.useState(!1),[N,_]=a.useState(null),Q=t.type==="project"&&t.projectId===n.id,D=V.find(S=>S.id===B),O=ht(n,(D==null?void 0:D.path)||B);a.useEffect(()=>{w&&!z&&!A&&(F(!0),_(null),xe("getPackageDetails",{packageId:n.id}).then(S=>{var W;const T=(S.result??{}).details;T?(c(T),((W=T.versions)==null?void 0:W.length)>0&&(!m||m===n.version)&&C(T.versions[0].version)):_("Failed to load package details")}).catch(S=>{_(S.message||"Failed to load package details")}).finally(()=>{F(!1)}))},[w,z,A,n.id,m]);const $=S=>{S.stopPropagation(),d(n.id,B,m||void 0)},I=(((y=z==null?void 0:z.versions)==null?void 0:y.map(S=>S.version))||(n.latestVersion&&n.version&&n.latestVersion!==n.version?[n.latestVersion,n.version]:n.version?[n.version]:n.latestVersion?[n.latestVersion]:[])).filter(S=>S&&S!=="unknown"),H=((z==null?void 0:z.dependencies)||[]).map(S=>{const v=S.identifier.split("/"),T=v.length===2?v[0]:"unknown",W=v.length===2?v[1]:S.identifier;return{identifier:S.identifier,version:S.version||"latest",name:W,publisher:T}}),K=[];return e.jsxs("div",{className:`package-card ${Q?"selected":""} ${w?"expanded":""}`,onClick:()=>{Q?(k(!1),P(!1),l({type:"none"})):(k(!0),l({type:"project",projectId:n.id,label:n.name}))},children:[e.jsxs("div",{className:"package-card-header",children:[e.jsx("span",{className:"tree-expand",children:w?e.jsx(ee,{size:14}):e.jsx(le,{size:14})}),e.jsx(be,{size:16,className:"package-icon"}),e.jsx("span",{className:"package-name",children:n.name}),n.publisher&&e.jsx("span",{className:`package-publisher-tag ${n.publisher==="atopile"?"official":""}`,children:n.publisher.toLowerCase()}),n.homepage&&e.jsx("a",{href:n.homepage,className:"package-external-link",target:"_blank",rel:"noopener noreferrer",title:"Open homepage",onClick:S=>S.stopPropagation(),children:e.jsx(we,{size:12})})]}),(n.summary||n.description)&&e.jsx("div",{className:`package-card-description ${w?"":"clamped"} ${w&&!f?"clamped":""}`,onClick:S=>{w&&(S.stopPropagation(),P(!f))},children:w&&n.description||n.summary}),e.jsxs("div",{className:"package-install-bar",onClick:S=>S.stopPropagation(),children:[e.jsx(pt,{availableProjects:V,selectedProjectId:B,onSelect:M}),I.length>0&&e.jsx(mt,{versions:I,selectedVersion:m,onVersionChange:C,latestVersion:n.latestVersion}),e.jsx("button",{className:`install-btn ${j?"installing":""} ${O.installed?O.needsUpdate?"update-available":"installed":""}`,onClick:$,disabled:j,title:j?"Installing...":O.needsUpdate?`Update to ${m} in ${D==null?void 0:D.name}`:O.installed?`Installed in ${D==null?void 0:D.name}`:`Install ${m} to ${D==null?void 0:D.name}`,children:j?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:14,className:"spin"}),e.jsx("span",{children:"Installing..."})]}):O.installed?O.needsUpdate?e.jsxs(e.Fragment,{children:[e.jsx(Ys,{size:14}),e.jsx("span",{children:"Update"})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{size:14}),e.jsx("span",{children:"Installed"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:14}),e.jsx("span",{children:"Install"})]})})]}),w&&e.jsxs("div",{className:"package-expanded-content",children:[n.builds.length>0&&e.jsx(hs,{builds:n.builds,projectId:n.id,projectRoot:n.root||"",selection:t,onSelect:l,onBuild:i,onCancelBuild:r,onStageFilter:h,onOpenSource:o,onOpenKiCad:x,onOpenLayout:p,onOpen3D:g,readOnly:!0}),A&&e.jsxs("div",{className:"package-loading",children:[e.jsx(ge,{size:16,className:"spin"}),e.jsx("span",{children:"Loading package details..."})]}),N&&e.jsx("div",{className:"package-error",children:e.jsxs("span",{children:["Failed to load details: ",N]})}),z&&!A&&e.jsxs("div",{className:"package-meta-bar",children:[z.downloads!==void 0&&z.downloads>0&&e.jsxs("span",{className:"meta-item",children:[e.jsx(Pe,{size:11}),ut(z.downloads)]}),z.versionCount>0&&e.jsxs("span",{className:"meta-item",children:[z.versionCount," versions"]}),z.license&&e.jsx("span",{className:"meta-item",children:z.license})]}),z&&H.length>0&&e.jsx(ms,{dependencies:H,projectId:n.id,readOnly:!0}),z&&K.length>0&&e.jsx(xs,{files:K,onFileClick:S=>o==null?void 0:o(n.id,S)})]})]})}),gt=a.memo(function({project:n,selection:t,onSelect:l,onBuild:i,onCancelBuild:r,onStageFilter:h,onOpenPackageDetail:u,isExpanded:d,onExpandChange:o,onUpdateProject:x,onAddBuild:p,onUpdateBuild:g,onDeleteBuild:V,onProjectExpand:j,onOpenSource:w,onOpenKiCad:k,onOpenLayout:f,onOpen3D:P,onFileClick:m,onDependencyVersionChange:C,onRemoveDependency:B,availableModules:M=[],projectFiles:z=[],projectDependencies:c=[]}){const A=d,[F,N]=a.useState(!1),[_,Q]=a.useState(!1),[D,O]=a.useState(n.name),[$,Y]=a.useState(n.summary||""),I=t.type==="project"&&t.projectId===n.id,H=n.builds.reduce((R,se)=>R+(se.errors||0),0),K=n.builds.reduce((R,se)=>R+(se.warnings||0),0),y=n.builds.some(R=>R.status==="building"),S=n.builds.filter(R=>R.status==="building"),v=S.length>0?Math.max(...S.map(R=>R.elapsedSeconds||0)):0,[T,W]=a.useState(v);a.useEffect(()=>{if(!y){W(0);return}W(v);const R=setInterval(()=>{W(se=>se+1)},1e3);return()=>clearInterval(R)},[y,v]);const J=R=>{const se=Math.floor(R/3600),fe=Math.floor(R%3600/60),oe=Math.floor(R%60);return se>0?`${se}:${fe.toString().padStart(2,"0")}:${oe.toString().padStart(2,"0")}`:`${fe}:${oe.toString().padStart(2,"0")}`},Z="A new atopile project!",E=$||Z,L=!$,q=a.useMemo(()=>os(D),[D]),X=()=>{q.isValid&&(N(!1),x&&x(n.id,{name:D}),console.log("Saving name:",D))},G=R=>{O(R)},ne=()=>{Q(!1),x&&x(n.id,{summary:$}),console.log("Saving description:",$)};return e.jsxs("div",{className:`project-card ${I?"selected":""} ${A?"expanded":"collapsed"} ${y?"building":""}`,onClick:()=>{const R=!A;o(n.id,R),l({type:"project",projectId:n.id,label:n.name}),R&&j&&j(n.root)},children:[e.jsxs("div",{className:"project-card-name-row",children:[e.jsx("span",{className:"tree-expand",children:A?e.jsx(ee,{size:14}):e.jsx(le,{size:14})}),e.jsx(Se,{size:18,className:"project-icon"}),F&&A?e.jsxs("div",{className:"name-input-wrapper",onClick:R=>R.stopPropagation(),children:[e.jsx("input",{type:"text",className:`project-name-input ${q.isValid?"":"invalid"}`,value:D,onChange:R=>O(R.target.value),onBlur:()=>{q.isValid&&X()},onKeyDown:R=>{R.key==="Enter"&&X(),R.key==="Escape"&&(O(n.name),N(!1))},autoFocus:!0}),e.jsx(cs,{validation:q,onApplySuggestion:G})]}):e.jsx("span",{className:`project-card-name ${A?"editable":""}`,onClick:A?R=>{R.stopPropagation(),N(!0)}:void 0,title:A?"Click to edit name":void 0,children:D}),e.jsxs("div",{className:"project-card-actions-row",children:[e.jsxs("div",{className:"project-indicators",children:[y&&e.jsx("span",{className:"build-time-indicator",title:"Build time",children:e.jsx("span",{className:"build-time",children:J(T)})}),!y&&e.jsxs(e.Fragment,{children:[H>0&&e.jsxs("span",{className:"error-indicator",children:[e.jsx(de,{size:12}),e.jsx("span",{children:H})]}),K>0&&e.jsxs("span",{className:"warning-indicator",children:[e.jsx(ie,{size:12}),e.jsx("span",{children:K})]}),n.lastBuildTimestamp&&e.jsxs("span",{className:"last-build-info",title:`Last build: ${n.lastBuildStatus||"unknown"}`,children:[n.lastBuildStatus&&us(n.lastBuildStatus,10),e.jsx("span",{className:"last-build-time",children:ds(n.lastBuildTimestamp)})]})]})]}),y?e.jsx("button",{className:"project-build-btn-icon stop",onClick:R=>{R.stopPropagation(),n.builds.filter(se=>se.status==="building"&&se.buildId).forEach(se=>r==null?void 0:r(se.buildId))},title:`Stop all builds in ${n.name}`,children:e.jsx(rs,{size:12,fill:"currentColor"})}):e.jsx("button",{className:"project-build-btn-icon",onClick:R=>{R.stopPropagation(),i("project",n.id,n.name)},title:`Build all targets in ${n.name}`,children:e.jsx(Ae,{size:14,fill:"currentColor"})})]})]}),A&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"project-card-description",children:_?e.jsx("input",{type:"text",className:"description-input",value:$,placeholder:Z,onChange:R=>Y(R.target.value),onBlur:ne,onKeyDown:R=>{R.key==="Enter"&&ne(),R.key==="Escape"&&(Y(n.summary||""),Q(!1))},autoFocus:!0,onClick:R=>R.stopPropagation()}):e.jsx("span",{className:`description-text ${L?"placeholder":""}`,onClick:R=>{R.stopPropagation(),Q(!0)},title:"Click to edit description",children:E})}),e.jsx(hs,{builds:n.builds,projectId:n.id,projectRoot:n.root,selection:t,onSelect:l,onBuild:i,onCancelBuild:r,onStageFilter:h,onUpdateBuild:g,onDeleteBuild:V,onOpenSource:w,onOpenKiCad:k,onOpenLayout:f,onOpen3D:P,onAddBuild:p,availableModules:M}),e.jsx(xs,{files:z,onFileClick:m?R=>m(n.id,R):void 0}),e.jsx(ms,{dependencies:c,projectId:n.id,onVersionChange:C,onRemove:B})]})]})});function We({selection:s,onSelect:n,onBuild:t,onCancelBuild:l,onStageFilter:i,onOpenPackageDetail:r,onPackageInstall:h,onCreateProject:u,onProjectExpand:d,onOpenSource:o,onOpenKiCad:x,onOpenLayout:p,onOpen3D:g,onFileClick:V,onDependencyVersionChange:j,onRemoveDependency:w,onAddBuild:k,onUpdateBuild:f,onDeleteBuild:P,filterType:m="all",projects:C,projectModules:B={},projectFiles:M={},projectDependencies:z={},installingPackageIds:c=[]}){const[A,F]=a.useState(""),[N,_]=a.useState(null),Q=C&&C.length>0?C:[],D=()=>{if(u){u();return}console.warn("Create project handler not provided")},O=(v,T)=>{console.warn("Update project handler not provided",v,T)},$=v=>{if(k){k(v);return}console.warn("Add build handler not provided",v)},Y=(v,T,W)=>{if(f){f(v,T,W);return}console.warn("Update build handler not provided",v,T,W)},I=(v,T)=>{if(P){P(v,T);return}console.warn("Delete build handler not provided",v,T),s.type==="build"&&s.buildId===`${v}:${T}`&&n({type:"none"})},H=Q.filter(v=>v.type==="project").map((v,T)=>({id:v.id,name:v.name,path:v.root,isActive:T===0})),K=(v,T,W)=>{if(console.log(`Installing ${v} to ${T}${W?` @ ${W}`:""}`),h){const J=Q.find(E=>E.id===T),Z=(J==null?void 0:J.root)||T;h(v,Z,W)}else alert(`Installing ${v} to ${T}`)},y=Q.filter(v=>{if(m==="projects"&&v.type!=="project"||m==="packages"&&v.type!=="package")return!1;if(A){const T=A.toLowerCase();return[v.name,v.id,v.publisher||"",v.description||"",v.summary||"",...v.keywords||[]].join(" ").toLowerCase().includes(T)}return!0}),S=m==="packages"?'Search packages (e.g. "regulator", "sensor")...':"Search projects...";return e.jsxs("div",{className:"projects-panel",children:[e.jsxs("div",{className:"projects-toolbar",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:S,value:A,onChange:v=>{F(v.target.value),v.target.value&&(s.type!=="none"&&n({type:"none"}),N!==null&&_(null))}})]}),m==="projects"&&e.jsx("button",{className:"add-project-btn",onClick:D,title:"Create new project",children:e.jsx(ls,{size:14})})]}),e.jsxs("div",{className:"projects-tree",children:[y.filter(v=>m==="projects"&&N!==null?v.id===N:!0).map(v=>v.type==="package"?e.jsx(xt,{project:v,selection:s,onSelect:n,onBuild:t,onCancelBuild:l,onStageFilter:i,onOpenPackageDetail:r,onInstall:K,onOpenSource:o,onOpenKiCad:x,onOpenLayout:p,onOpen3D:g,availableProjects:H,isInstalling:c.includes(v.id)},v.id):e.jsx(gt,{project:v,selection:s,onSelect:n,onBuild:t,onCancelBuild:l,onStageFilter:i,onOpenPackageDetail:r,isExpanded:N===v.id,onExpandChange:(T,W)=>{_(W?T:null)},onUpdateProject:O,onAddBuild:$,onUpdateBuild:Y,onDeleteBuild:I,onProjectExpand:d,onOpenSource:o,onOpenKiCad:x,onOpenLayout:p,onOpen3D:g,onFileClick:V,onDependencyVersionChange:j,onRemoveDependency:w,availableModules:B[v.root]||[],projectFiles:M[v.root]||[],projectDependencies:z[v.root]||[]},v.id)),y.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsxs("span",{children:["No ",m==="packages"?"packages":"projects"," found"]}),A&&m==="packages"&&e.jsx("span",{className:"empty-hint",children:'Try searching for "sensor", "regulator", or "mcu"'})]})]})]})}function Re({projects:s,selectedProjectRoot:n,selectedTargetName:t,onSelectProject:l,onSelectTarget:i,placeholder:r="Select project",showAllOption:h=!0,allOptionLabel:u="All projects",disabled:d=!1}){const[o,x]=a.useState(!1),[p,g]=a.useState(""),[V,j]=a.useState(new Set),w=a.useRef(null),k=a.useRef(null);a.useEffect(()=>{if(!o)return;const c=A=>{w.current&&!w.current.contains(A.target)&&(x(!1),g(""))};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[o]),a.useEffect(()=>{o&&k.current&&setTimeout(()=>{var c;return(c=k.current)==null?void 0:c.focus()},0)},[o]);const f=p.trim()?s.filter(c=>c.name.toLowerCase().includes(p.toLowerCase())):s,P=s.find(c=>c.root===n),m=s.length>0,C=P?t?`${P.name}  ${t}`:P.name:r,B=c=>{l(c),x(!1),g(""),j(new Set)},M=()=>{!d&&m&&x(c=>!c)},z=c=>{j(A=>{const F=new Set(A);return F.has(c)?F.delete(c):F.add(c),F})};return a.useEffect(()=>{n&&j(c=>{if(c.has(n))return c;const A=new Set(c);return A.add(n),A})},[n]),a.useEffect(()=>{p&&j(new Set(f.map(c=>c.root)))},[p,f]),e.jsxs("div",{className:"install-dropdown project-dropdown",ref:w,children:[e.jsxs("button",{className:"install-btn",onClick:M,title:C,disabled:d||!m,children:[e.jsx(Se,{size:12}),e.jsx("span",{children:P?C:m?h?"All":r:"No projects"})]}),e.jsx("button",{className:"install-dropdown-toggle",onClick:c=>{c.stopPropagation(),M()},title:"Change project",disabled:d||!m,children:e.jsx(ee,{size:12})}),o&&m&&e.jsxs("div",{className:"install-dropdown-menu project-dropdown-menu",children:[e.jsx("div",{className:"dropdown-header",children:"Select project:"}),e.jsxs("div",{className:"dropdown-search",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:k,type:"text",placeholder:"Filter projects...",value:p,onChange:c=>g(c.target.value),onClick:c=>c.stopPropagation()})]}),e.jsxs("div",{className:"dropdown-items",children:[h&&e.jsxs("button",{className:`dropdown-item ${n?"":"selected"}`,onClick:c=>{c.stopPropagation(),B(null)},children:[e.jsx(Se,{size:12}),e.jsx("span",{children:u}),!n&&e.jsx(re,{size:12,className:"selected-check"})]}),f.map(c=>{var N;const A=!!(c.targets&&c.targets.length>0),F=V.has(c.root);return e.jsxs("div",{children:[e.jsxs("button",{className:`dropdown-item ${c.root===n?"selected":""}`,onClick:_=>{_.stopPropagation(),l(c.root),A&&i?z(c.root):(x(!1),g(""))},children:[A&&i?e.jsx("span",{className:"project-target-toggle",onClick:_=>{_.stopPropagation(),z(c.root)},children:F?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}):e.jsx("span",{className:"project-target-toggle-spacer"}),e.jsx(Se,{size:12}),e.jsx("span",{children:c.name}),c.badge&&e.jsx("span",{className:`status-badge ${c.badgeMuted?"muted":""}`,children:c.badge}),c.root===n&&e.jsx(re,{size:12,className:"selected-check"})]}),i&&A&&F?e.jsx("div",{className:"project-targets",children:(N=c.targets)==null?void 0:N.map(_=>e.jsxs("button",{className:`dropdown-item target-item ${c.root===n&&_.name===t?"selected":""}`,onClick:Q=>{Q.stopPropagation(),i(c.root,_.name),x(!1),g(""),j(new Set)},children:[e.jsx("span",{children:_.name}),c.root===n&&_.name===t&&e.jsx(re,{size:12,className:"selected-check"})]},`${c.root}-${_.name}`))}):null]},c.root)}),f.length===0&&p&&e.jsxs("div",{className:"dropdown-empty",children:['No projects match "',p,'"']})]})]})]})}function ft(s){const n=new Map;for(const t of s){const l=t.file||"(no file)";n.has(l)||n.set(l,[]),n.get(l).push(t)}for(const[,t]of n)t.sort((l,i)=>l.level==="error"&&i.level==="warning"?-1:l.level==="warning"&&i.level==="error"?1:0);return n}function jt({problems:s,projects:n=[],selectedProjectRoot:t,onSelectProject:l,onProblemClick:i}){const[r,h]=a.useState(new Set),[u,d]=a.useState(""),o=a.useMemo(()=>{if(!u.trim())return s;const f=u.toLowerCase();return s.filter(P=>{var m,C;return P.message.toLowerCase().includes(f)||((m=P.file)==null?void 0:m.toLowerCase().includes(f))||((C=P.stage)==null?void 0:C.toLowerCase().includes(f))})},[s,u]),x=o.filter(f=>f.level==="error").length,p=a.useMemo(()=>ft(o),[o]),g=n.length>0,V=f=>{h(P=>{const m=new Set(P);return m.has(f)?m.delete(f):m.add(f),m})},j=s.length===0,w=!j&&o.length===0,k=()=>e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[x>0&&e.jsx("div",{className:"problems-summary-inline",children:e.jsxs("span",{className:"problems-count error",children:[e.jsx(de,{size:12}),x]})}),e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Filter problems...",value:u,onChange:f=>d(f.target.value)}),u&&e.jsx("button",{className:"search-clear",onClick:()=>d(""),title:"Clear search",children:e.jsx(he,{size:12})})]}),g&&l&&e.jsx(Re,{projects:n,selectedProjectRoot:t,onSelectProject:l,showAllOption:!0,allOptionLabel:"All projects"})]})});return j||w?e.jsxs("div",{className:"problems-panel empty","data-testid":"problems-panel",children:[k(),e.jsxs("div",{className:"problems-empty-state",children:[e.jsx(de,{size:24,className:"problems-empty-icon"}),e.jsx("span",{className:"problems-empty-text",children:w?"No matching problems":"No problems"})]})]}):e.jsxs("div",{className:"problems-panel","data-testid":"problems-panel",children:[k(),e.jsx("div",{className:"problems-list",children:Array.from(p.entries()).map(([f,P])=>{const m=r.has(f),C=P.filter(M=>M.level==="error").length,B=P.filter(M=>M.level==="warning").length;return e.jsxs("div",{className:`problems-file-group ${m?"collapsed":""}`,children:[e.jsxs("div",{className:"problems-file-header",onClick:()=>V(f),children:[e.jsx("span",{className:"problems-file-expand",children:m?e.jsx(le,{size:12}):e.jsx(ee,{size:12})}),e.jsx(ye,{size:12}),e.jsx("span",{className:"problems-file-name",title:f,children:f.split("/").pop()||f}),e.jsx("span",{className:"problems-file-path",title:f,children:f}),e.jsxs("span",{className:"problems-file-counts",children:[C>0&&e.jsx("span",{className:"problems-file-count error",children:C}),B>0&&e.jsx("span",{className:"problems-file-count warning",children:B})]})]}),!m&&e.jsx("div",{className:"problems-file-items",children:P.map(M=>e.jsxs("div",{className:`problem-item ${M.level} ${M.file?"clickable":""}`,onClick:()=>M.file&&(i==null?void 0:i(M)),title:M.file?`Click to go to ${M.file}:${M.line||1}`:void 0,children:[e.jsx("span",{className:"problem-icon",children:M.level==="error"?e.jsx(de,{size:12}):e.jsx(ie,{size:12})}),e.jsx("span",{className:"problem-message",children:M.message}),M.line&&e.jsxs("span",{className:"problem-location",children:["[",M.line,M.column?`:${M.column}`:"","]"]}),M.stage&&e.jsx("span",{className:"problem-source",children:M.stage})]},M.id))})]},f)})})]})}function Nt(s){return s.itemType||"interface"}const Ve={interface:{icon:ss,color:"var(--ctp-blue)",label:"Interface"},module:{icon:Me,color:"var(--ctp-green)",label:"Module"},component:{icon:Fe,color:"var(--ctp-mauve)",label:"Component"},trait:{icon:Ne,color:"var(--ctp-yellow)",label:"Trait"},parameter:{icon:Ce,color:"var(--ctp-peach)",label:"Parameter"}};function Ke({item:s,isSelected:n,onSelect:t,expandedPaths:l,onToggleChild:i}){var x;const r=Ve[s.type],h=r.icon,u=async p=>{try{await navigator.clipboard.writeText(p)}catch(g){console.warn("Failed to copy usage text",g)}},d=(p,g)=>{var P;const V=(((P=p.children)==null?void 0:P.length)??0)>0,j=l.has(g),w=Nt(p),k=Ve[w],f=k.icon;return e.jsxs("div",{className:"stdlib-child-node",children:[e.jsxs("div",{className:`stdlib-child-row${V?" expandable":""}`,onClick:()=>V?i(g):void 0,children:[V?e.jsx("button",{className:"expand-btn",onClick:()=>i(g),children:j?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}):e.jsx("span",{className:"expand-spacer"}),e.jsx("span",{className:"stdlib-child-icon",style:{color:k.color},children:e.jsx(f,{size:12})}),e.jsx("span",{className:"stdlib-child-name",children:p.name}),e.jsx("span",{className:"stdlib-child-type",children:p.type})]}),V&&j&&e.jsx("div",{className:"stdlib-child-children",children:p.children.map(m=>d(m,`${g}.${m.name}`))})]},g)},o=(((x=s.children)==null?void 0:x.length)??0)>0;return e.jsxs("div",{className:`stdlib-card${n?" selected":""}`,onClick:t,children:[e.jsxs("div",{className:"stdlib-card-header",children:[o&&e.jsx("span",{className:"stdlib-expand-icon",children:n?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}),e.jsx("span",{className:"stdlib-type-icon",style:{color:r.color},children:e.jsx(h,{size:14})}),e.jsx("span",{className:"stdlib-card-name",children:s.name}),e.jsx("span",{className:"stdlib-type-badge",style:{background:r.color,color:"var(--ctp-base)"},children:r.label})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"stdlib-card-description",children:s.description}),o&&e.jsx("div",{className:"stdlib-card-children",children:s.children.map(p=>d(p,p.name))}),s.usage&&e.jsxs("div",{className:"stdlib-card-usage",children:[e.jsxs("div",{className:"usage-header",children:[e.jsx("span",{children:"Usage"}),e.jsxs("button",{className:"copy-btn",onClick:p=>{p.stopPropagation(),u(s.usage||"")},children:[e.jsx(ts,{size:12}),"Copy"]})]}),e.jsx("pre",{className:"usage-code",children:s.usage})]})]})]})}function vt({items:s,isLoading:n=!1,onOpenDetail:t,onRefresh:l}){const[i,r]=a.useState(""),[h,u]=a.useState(null),[d,o]=a.useState(new Map),[x,p]=a.useState(new Set(["interface","module","trait","component"])),g=s||[],V=i.trim().length>0,j=m=>{p(C=>{const B=new Set(C);return B.has(m)?B.delete(m):B.add(m),B})},w=(m,C)=>{o(B=>{const M=new Map(B),z=M.get(m)||new Set,c=new Set(z);return c.has(C)?c.delete(C):c.add(C),M.set(m,c),M})},k=g.filter(m=>{if(i){const C=i.toLowerCase(),B=M=>M?M.some(z=>z.name.toLowerCase().includes(C)||z.type.toLowerCase().includes(C)||B(z.children)):!1;return m.name.toLowerCase().includes(C)||m.description.toLowerCase().includes(C)||B(m.children)}return!0}),f=k.reduce((m,C)=>(m[C.type]||(m[C.type]=[]),m[C.type].push(C),m),{}),P=["interface","module","trait","component"];return n?e.jsxs("div",{className:"stdlib-panel",children:[e.jsx("div",{className:"stdlib-toolbar",children:e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:"Search standard library...",disabled:!0})]})}),e.jsx("div",{className:"stdlib-list",children:e.jsxs("div",{className:"stdlib-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading standard library..."})]})})]}):e.jsxs("div",{className:"stdlib-panel",children:[e.jsx("div",{className:"stdlib-toolbar",children:e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:"Search standard library...",value:i,onChange:m=>r(m.target.value)})]})}),e.jsxs("div",{className:"stdlib-list",children:[V?e.jsx("div",{className:"stdlib-search-results",children:k.length===0?e.jsxs("div",{className:"stdlib-empty",children:[e.jsx(ue,{size:24}),e.jsxs("span",{children:['No results for "',i,'"']})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"search-results-count",children:[k.length," result",k.length!==1?"s":""]}),k.map(m=>e.jsx(Ke,{item:m,isSelected:h===m.id,onSelect:()=>u(h===m.id?null:m.id),expandedPaths:d.get(m.id)||new Set,onToggleChild:C=>w(m.id,C)},m.id))]})}):P.map(m=>{const C=f[m];if(!C||C.length===0)return null;const B=Ve[m],M=B.icon,z=x.has(m);return e.jsxs("div",{className:`stdlib-group ${z?"collapsed":""}`,children:[e.jsxs("button",{className:"stdlib-group-header",onClick:()=>j(m),style:{"--group-color":B.color},children:[e.jsx("span",{className:"group-chevron",children:z?e.jsx(le,{size:12}):e.jsx(ee,{size:12})}),e.jsx("span",{className:"group-icon",style:{color:B.color},children:e.jsx(M,{size:12})}),e.jsxs("span",{className:"group-label",children:[B.label,"s"]}),e.jsxs("span",{className:"group-count",children:["(",C.length,")"]})]}),!z&&e.jsx("div",{className:"stdlib-group-items",children:C.map(c=>e.jsx(Ke,{item:c,isSelected:h===c.id,onSelect:()=>u(h===c.id?null:c.id),expandedPaths:d.get(c.id)||new Set,onToggleChild:A=>w(c.id,A)},c.id))})]},m)}),k.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{children:"No items found"}),i&&e.jsx("span",{className:"empty-hint",children:'Try "I2C", "Resistor", or "power"'})]})]})]})}function yt(s,n,t,l=""){const i=s.length,r=n.length;if(i+r<=t)return[s,n];const u=l.length,d=Math.floor(t/2);let o=s,x=n;if(i<=d&&r>t-i){const p=t-i;p>u?x=n.slice(0,p-u)+l:x=l.slice(0,p)}else if(r<=d&&i>t-r){const p=t-r;p>u?o=s.slice(0,p-u)+l:o=l.slice(0,p)}else{const p=d-u;p>0?(i>d&&(o=s.slice(0,p)+l),r>d&&(x=n.slice(0,p)+l)):(o=l.slice(0,d),x=l.slice(0,d))}return[o,x]}const bt="data:image/png;base64,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";function kt(s){switch(s){case"voltage":return e.jsx(Ne,{size:12,className:"var-icon voltage"});case"current":return e.jsx(Ne,{size:12,className:"var-icon current"});case"resistance":return e.jsx(Ce,{size:12,className:"var-icon resistance"});case"capacitance":return e.jsx(Ce,{size:12,className:"var-icon capacitance"});case"ratio":case"percentage":return e.jsx(In,{size:12,className:"var-icon ratio"});case"frequency":return e.jsx(Be,{size:12,className:"var-icon frequency"});case"power":return e.jsx(Ne,{size:12,className:"var-icon power"});default:return e.jsx(Ce,{size:12,className:"var-icon"})}}function wt(s){switch(s){case"module":return e.jsx(Me,{size:14,className:"node-type-icon module"});case"interface":return e.jsx(Ne,{size:14,className:"node-type-icon interface"});case"component":return e.jsx(ns,{size:14,className:"node-type-icon component"})}}const Ct=a.memo(function({variable:n,onCopy:t}){const[l,i]=a.useState(!1),r=()=>{let o=`${n.name}: `;n.spec&&(o+=`${n.spec}${n.specTolerance||""}`),n.actual&&(o+=`  ${n.actual}${n.actualTolerance||""}`),n.unit&&(o+=` ${n.unit}`),t(o),i(!0),setTimeout(()=>i(!1),1500)},h=n.spec!==void 0,u=n.actual!==void 0,d=n.meetsSpec===!1;return e.jsxs("div",{className:`variable-table-row ${d?"error":""}`,onClick:r,title:"Click to copy",children:[e.jsxs("div",{className:"var-col-name",children:[kt(n.type),e.jsx("span",{className:"var-name-text",children:n.name})]}),e.jsx("div",{className:"var-col-spec",children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"var-spec-value",children:n.spec}),n.specTolerance&&e.jsx("span",{className:"var-tolerance",children:n.specTolerance})]}):e.jsx("span",{className:"var-empty",children:""})}),e.jsx("div",{className:`var-col-actual ${d?"error":u?"ok":""}`,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"var-actual-value",children:n.actual}),n.actualTolerance&&e.jsx("span",{className:"var-tolerance",children:n.actualTolerance})]}):e.jsx("span",{className:"var-empty",children:""})}),e.jsxs("div",{className:"var-col-status",children:[d&&e.jsx(ie,{size:12,className:"status-error"}),l&&e.jsx(re,{size:12,className:"status-copied"})]})]})});function Te(s,n){if(n==="all")return!0;const t=s||"derived";return n==="user"?t==="user":n==="computed"?t==="derived":n==="picked"?t==="picked"||t==="datasheet":!0}function gs(s,n){var t,l;return n?s.name.toLowerCase().includes(n)||(((t=s.spec)==null?void 0:t.toLowerCase().includes(n))??!1)||(((l=s.actual)==null?void 0:l.toLowerCase().includes(n))??!1):!0}function fs(s,n,t){var i,r;return!!(n&&s.name.toLowerCase().includes(n)||((i=s.variables)==null?void 0:i.some(h=>Te(h.source,t)&&gs(h,n)))||(r=s.children)!=null&&r.some(h=>fs(h,n,t)))}const St=a.memo(function s({node:n,depth:t,searchQuery:l,sourceFilter:i,expandedNodes:r,onToggleExpand:h,onCopyValue:u}){var k;const d=r.has(n.path),o=n.children&&n.children.length>0||n.variables&&n.variables.length>0,x=l.toLowerCase(),p=a.useMemo(()=>n.variables?n.variables.filter(f=>Te(f.source,i)&&gs(f,x)):[],[n.variables,i,x]);if(!a.useMemo(()=>!l&&i==="all"?!0:fs(n,x,i),[n,l,i,x]))return null;const V=t>0?" ".repeat(t):"",[j,w]=n.typeName?yt(n.name,n.typeName,35):[n.name.length>35?n.name.slice(0,32)+"":n.name,""];return e.jsxs("div",{className:`variable-tree-node depth-${Math.min(t,4)}`,children:[e.jsxs("div",{className:`variable-node-header ${d?"expanded":""}`,onClick:()=>h(n.path),children:[o?e.jsx("span",{className:"tree-expand",children:d?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}):e.jsx("span",{className:"tree-expand-spacer"}),t>0&&e.jsx("span",{className:"depth-indicator",children:V}),wt(n.type),e.jsx("span",{className:"node-name",title:n.name,children:j}),n.typeName&&e.jsx("span",{className:"node-type-name",title:n.typeName,children:w}),n.variables&&n.variables.length>0&&e.jsx("span",{className:"var-count",children:n.variables.length})]}),d&&e.jsxs("div",{className:"variable-node-content",children:[p.length>0&&e.jsxs("div",{className:"variables-table",children:[e.jsxs("div",{className:"variables-table-header",children:[e.jsx("div",{className:"var-col-name",children:"Parameter"}),e.jsx("div",{className:"var-col-spec",children:"Spec"}),e.jsx("div",{className:"var-col-actual",children:"Actual"}),e.jsx("div",{className:"var-col-status"})]}),p.map((f,P)=>e.jsx(Ct,{variable:f,onCopy:u},`${n.path}-${f.name}-${P}`))]}),(k=n.children)==null?void 0:k.map((f,P)=>e.jsx(s,{node:f,depth:t+1,searchQuery:l,sourceFilter:i,expandedNodes:r,onToggleExpand:h,onCopyValue:u},`${f.path}-${P}`))]})]})});function At({variablesData:s,isLoading:n=!1,error:t=null,projects:l,selectedProjectRoot:i,selectedTargetNames:r,onSelectProject:h,onSelectTarget:u}){const[d,o]=a.useState(""),[x,p]=a.useState(new Set),[g,V]=a.useState(null),[j,w]=a.useState({}),k="all",[f,P]=a.useState(null);a.useEffect(()=>{if(!l||l.length===0){w({});return}let N=!1;return Promise.all(l.map(async _=>{try{const D=(await xe("getVariablesTargets",{projectRoot:_.root})).result??{},O=Array.isArray(D.targets)?D.targets:[];return[_.root,O]}catch{return[_.root,[]]}})).then(_=>{if(N)return;const Q={};for(const[D,O]of _)Q[D]=[...O];w(Q)}),()=>{N=!0}},[l]);const m=a.useMemo(()=>l?[...l].sort((N,_)=>{var O,$;const Q=(((O=j[N.root])==null?void 0:O.length)??0)>0,D=((($=j[_.root])==null?void 0:$.length)??0)>0;return Q!==D?Q?-1:1:N.name.localeCompare(_.name)}):[],[l,j]),C=a.useMemo(()=>m.map(N=>{var Q,D;const _=(((Q=j[N.root])==null?void 0:Q.length)??0)>0;return{id:N.root,name:N.name,root:N.root,targets:((D=N.targets)==null?void 0:D.map(O=>({name:O.name})))??[],badge:_?void 0:"no variables",badgeMuted:!0}}),[m,j]),B=!!(l&&(m.length>0||i)),M=(s==null?void 0:s.nodes)||[];a.useEffect(()=>{const N=s==null?void 0:s.version;N&&N!==f&&(p(new Set),P(N))},[s==null?void 0:s.version,f]);const z=a.useCallback(N=>{p(_=>{const Q=new Set(_);return Q.has(N)?Q.delete(N):Q.add(N),Q})},[]),c=a.useCallback(N=>{navigator.clipboard.writeText(N),V(N),setTimeout(()=>V(null),2e3)},[]),A=a.useMemo(()=>{const N=_=>{let Q=0;for(const D of _){if(D.variables)for(const O of D.variables)Te(O.source,k)&&Q++;D.children&&(Q+=N(D.children))}return Q};return N(M)},[M,k]),F=(()=>{if(!(s!=null&&s.build_id))return null;const N=s.build_id.match(/^build-(\d+)-/);return N?`#${N[1]}`:s.build_id.substring(0,12)})();return e.jsxs("div",{className:"variables-panel",children:[e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Search variables...",value:d,onChange:N=>o(N.target.value)})]}),B&&e.jsx(Re,{projects:C,selectedProjectRoot:i,selectedTargetName:(r==null?void 0:r[0])||null,onSelectProject:h||(()=>{}),onSelectTarget:u,showAllOption:!1,placeholder:"Select project"})]})}),e.jsxs("div",{className:"variables-tree",children:[n&&e.jsxs("div",{className:"variables-loading",children:[e.jsx(ge,{size:24,className:"spinner"}),e.jsx("span",{children:"Loading variables..."})]}),t&&!n&&e.jsxs("div",{className:"variables-error",children:[e.jsx(ie,{size:16}),e.jsx("span",{children:t})]}),!n&&!t&&M.length===0&&e.jsxs("div",{className:"variables-empty",children:[e.jsx("span",{children:"No variables found."}),e.jsx("span",{className:"hint",children:'Run "ato build" to generate variable data.'})]}),!n&&!t&&M.map((N,_)=>e.jsx(St,{node:N,depth:0,searchQuery:d,sourceFilter:k,expandedNodes:x,onToggleExpand:z,onCopyValue:c},`${N.path}-${_}`))]}),e.jsxs("div",{className:"variables-status",children:[e.jsxs("span",{children:[A," variables"]}),F&&e.jsxs("span",{className:"build-id-badge",title:`Build: ${s==null?void 0:s.build_id}`,children:["build ",F]}),g&&e.jsxs("span",{className:"copied-toast",children:[e.jsx(re,{size:10}),"Copied: ",g]})]})]})}function js(s){const n=s.split("::");return(n.length>1?n[1]:s).split("|")[0]}function Mt(s){if(!s)return null;const t=(s.split("|")[0]??s).split("::")[0];return t.endsWith(".ato")?t:null}function Xe(s){const n=js(s),t=n.split(".");return t.length<=1?n:t.slice(1).join(".")}function zt(s){var r;const n=s.usages.map(h=>h.designator),t=s.unitCost??void 0,l=t!==void 0?t*s.quantity:void 0,i=s.stock;return{id:s.id,designators:n,type:s.type,value:s.value,package:s.package,manufacturer:s.manufacturer??void 0,mpn:s.mpn??void 0,lcsc:s.lcsc??void 0,description:s.description??void 0,quantity:s.quantity,unitCost:t,totalCost:l,inStock:i!=null?i>0:void 0,stockQuantity:i??void 0,parameters:s.parameters,source:s.source,path:(r=s.usages[0])==null?void 0:r.address,usages:s.usages.map(h=>({path:h.address,designator:h.designator}))}}function Pt(s){switch(s){case"resistor":return"R";case"capacitor":return"C";case"inductor":return"L";case"ic":return"IC";case"connector":return"J";case"led":return"LED";case"diode":return"D";case"transistor":return"Q";case"crystal":return"Y";default:return"X"}}function Le(s){return s<.01?`$${s.toFixed(4)}`:s<1?`$${s.toFixed(3)}`:`$${s.toFixed(2)}`}function Bt(s){const n=new Map;for(const t of s){const l=js(t.path),i=l.split(".");let r,h;i.length>=3?(r=i.slice(0,-1).join("."),h=i[i.length-2]):i.length===2?(r=i[0],h=i[0]):(r=l,h=l),n.has(r)||n.set(r,{parentPath:r,parentLabel:h,instances:[]}),n.get(r).instances.push(t)}return Array.from(n.values())}function $t(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(0)}K`:s.toString()}const Et=a.memo(function({component:n,isExpanded:t,onToggle:l,onCopy:i,onGoToSource:r}){const[h,u]=a.useState(null),[d,o]=a.useState(()=>new Set),x=(j,w,k)=>{k.stopPropagation(),i(w),u(j),setTimeout(()=>u(null),1500)},p=(j,w)=>{j.stopPropagation();const k=Mt(w.path);k&&r(k,w.line)},g=(j,w)=>{w.stopPropagation(),o(k=>{const f=new Set(k);return f.has(j)?f.delete(j):f.add(j),f})},V=n.usages?Bt(n.usages):[];return e.jsxs("div",{className:`bom-row ${t?"expanded":""}`,onClick:l,children:[e.jsxs("div",{className:"bom-row-header",children:[e.jsx("span",{className:"bom-expand",children:t?e.jsx(ee,{size:12}):e.jsx(le,{size:12})}),e.jsx("span",{className:`bom-type-badge type-${n.type}`,children:Pt(n.type)}),e.jsx("span",{className:"bom-value",children:n.value}),n.mpn&&e.jsx("span",{className:"bom-mpn",title:n.mpn,children:n.mpn}),e.jsxs("span",{className:"bom-quantity",children:["",n.quantity]}),n.totalCost!==void 0&&e.jsx("span",{className:"bom-cost",children:Le(n.totalCost)}),n.inStock===!1&&e.jsx(ie,{size:12,className:"bom-stock-warning"})]}),t&&e.jsxs("div",{className:"bom-row-details",children:[e.jsx("table",{className:"bom-detail-table",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Manufacturer"}),e.jsx("td",{className:"detail-cell-value",children:n.manufacturer||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Package"}),e.jsx("td",{className:"detail-cell-value",children:n.package})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"LCSC"}),e.jsx("td",{className:"detail-cell-value",children:n.lcsc?e.jsxs("span",{className:"lcsc-link",onClick:j=>x("lcsc",n.lcsc,j),children:[e.jsx("span",{className:"mono",children:n.lcsc}),e.jsx("button",{type:"button",className:"external-link",onClick:j=>{j.stopPropagation(),window.open(`https://www.lcsc.com/product-detail/${n.lcsc}.html`,"_blank","noopener,noreferrer")},"aria-label":"Open LCSC part in browser",children:e.jsx(we,{size:10})}),h==="lcsc"?e.jsx(re,{size:10,className:"copy-icon copied"}):e.jsx(ts,{size:10,className:"copy-icon"})]}):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Stock"}),e.jsx("td",{className:`detail-cell-value ${n.inStock===!1?"out-of-stock":"in-stock"}`,children:n.inStock===!1?e.jsxs("span",{className:"stock-out",children:[e.jsx(ie,{size:10})," Out of stock"]}):n.lcscLoading&&n.stockQuantity==null?e.jsxs("span",{className:"inline-loading",children:[e.jsx(Be,{size:10,className:"loading-spinner"})," Fetching..."]}):n.stockQuantity?$t(n.stockQuantity):"In stock"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Unit Cost"}),e.jsx("td",{className:"detail-cell-value cost",children:n.unitCost!=null?Le(n.unitCost):n.lcscLoading?e.jsxs("span",{className:"inline-loading",children:[e.jsx(Be,{size:10,className:"loading-spinner"})," Fetching..."]}):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Source"}),e.jsx("td",{className:"detail-cell-value",children:e.jsx("span",{className:`source-badge source-${n.source}`,children:n.source==="picked"?"Auto-picked":n.source==="specified"?"Specified":"Manual"})})]})]})}),V.length>0&&e.jsxs("div",{className:"bom-usages-tree",children:[e.jsxs("div",{className:"usages-header",children:[e.jsx("span",{children:"Used in design"}),e.jsxs("span",{className:"usages-count",children:[n.quantity," instance",n.quantity!==1?"s":""]})]}),e.jsx("div",{className:"usage-groups",children:V.map(j=>e.jsx("div",{className:"usage-group",children:j.instances.length>1?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"usage-group-header",onClick:w=>g(j.parentPath,w),children:[e.jsx("span",{className:"usage-expand",children:d.has(j.parentPath)?e.jsx(ee,{size:11}):e.jsx(le,{size:11})}),e.jsx("span",{className:"usage-module-name",children:j.parentLabel}),e.jsxs("span",{className:"usage-count-badge",children:["",j.instances.length]})]}),d.has(j.parentPath)&&e.jsx("div",{className:"usage-instances",children:j.instances.map((w,k)=>{const f=Xe(w.path);return e.jsxs("div",{className:"usage-instance",onClick:P=>p(P,w),title:w.path,children:[e.jsx("span",{className:"usage-designator",children:w.designator}),e.jsx("span",{className:"usage-leaf",children:f}),e.jsx(we,{size:9,className:"usage-goto"})]},k)})})]}):e.jsxs("div",{className:"usage-single",onClick:w=>p(w,j.instances[0]),title:j.instances[0].path,children:[e.jsx("span",{className:"usage-designator",children:j.instances[0].designator}),e.jsx("span",{className:"usage-module-path",children:Xe(j.instances[0].path)}),e.jsx(we,{size:10,className:"usage-goto"})]})},j.parentPath))})]})]})]})});function It({bomData:s,isLoading:n=!1,error:t=null,onGoToSource:l,projects:i,selectedProjectRoot:r,selectedTargetNames:h,onSelectProject:u,onSelectTarget:d}){const[o,x]=a.useState(""),[p,g]=a.useState(new Set),[V,j]=a.useState(null),[w,k]=a.useState({}),[f,P]=a.useState({}),[m,C]=a.useState(new Set),[B,M]=a.useState(null),[z,c]=a.useState(null),A=a.useRef(0),F=a.useRef(null),N=(h==null?void 0:h[0])??null;a.useEffect(()=>{if(!i||i.length===0){k({});return}let E=!1;return Promise.all(i.map(async L=>{try{const X=(await xe("getBomTargets",{projectRoot:L.root})).result??{},G=Array.isArray(X.targets)?X.targets:[];return[L.root,G]}catch{return[L.root,[]]}})).then(L=>{if(E)return;const q={};for(const[X,G]of L)q[X]=[...G];k(q)}),()=>{E=!0}},[i]);const _=a.useMemo(()=>i?[...i].sort((E,L)=>{var G,ne;const q=(((G=w[E.root])==null?void 0:G.length)??0)>0,X=(((ne=w[L.root])==null?void 0:ne.length)??0)>0;return q!==X?q?-1:1:E.name.localeCompare(L.name)}):[],[i,w]),Q=a.useMemo(()=>_.map(E=>{var q,X;const L=(((q=w[E.root])==null?void 0:q.length)??0)>0;return{id:E.root,name:E.name,root:E.root,targets:((X=E.targets)==null?void 0:X.map(G=>({name:G.name})))??[],badge:L?void 0:"no BOM",badgeMuted:!0}}),[_,w]);a.useEffect(()=>{if(!r){M(null),c(null),F.current=null;return}xe("getBuildsByProject",{projectRoot:r,target:N??void 0,limit:1}).then(E=>{const L=E.result??{},q=Array.isArray(L.builds)?L.builds[0]:null;M(q?{build_id:q.build_id,started_at:q.started_at,completed_at:q.completed_at??(q.started_at&&q.duration?q.started_at+q.duration:void 0)}:null)}).catch(E=>{console.warn("Failed to load build info",E),M(null)})},[r,N]),a.useEffect(()=>{if(!(B!=null&&B.build_id))return;const E=B.completed_at??B.started_at;!E||!(Date.now()/1e3-E>24*60*60)||F.current!==B.build_id&&c(B.build_id)},[B]);const D=a.useMemo(()=>{var L;if(!((L=s==null?void 0:s.components)!=null&&L.length))return[];const E=new Set;for(const q of s.components)q.lcsc&&E.add(q.lcsc);return Array.from(E)},[s==null?void 0:s.components]),O=a.useMemo(()=>{var L;if(!((L=s==null?void 0:s.components)!=null&&L.length))return[];const E=new Set;for(const q of s.components)q.lcsc&&(q.unitCost!=null&&q.stock!=null||E.add(q.lcsc));return Array.from(E)},[s==null?void 0:s.components]);a.useEffect(()=>{const E=!!z,L=E?D:O;if(L.length===0)return;const q=E?L:L.filter(G=>!(G in f));if(q.length===0)return;const X=++A.current;C(G=>{const ne=new Set(G);for(const R of q)ne.add(R);return ne}),xe("fetchLcscParts",{lcscIds:q,projectRoot:r??void 0,target:N??void 0}).then(G=>{if(X!==A.current)return;const R=(G.result??{}).parts||{};P(se=>({...se,...R}))}).catch(G=>{X===A.current&&console.warn("Failed to fetch LCSC data",G)}).finally(()=>{C(G=>{const ne=new Set(G);for(const R of q)ne.delete(R);return ne}),E&&(B!=null&&B.build_id)&&(F.current=B.build_id,c(null))})},[O,D,f,z,B,r,N]);const $=a.useMemo(()=>s!=null&&s.components?s.components.map(E=>{const L=zt(E);if(!E.lcsc)return L;const q=f[E.lcsc];return L.lcscLoading=m.has(E.lcsc),q&&(L.unitCost==null&&q.unit_cost!=null&&(L.unitCost=q.unit_cost,L.totalCost=q.unit_cost*L.quantity),L.inStock==null&&(L.inStock=q.stock>0,L.stockQuantity=q.stock),!L.description&&q.description&&(L.description=q.description),!L.manufacturer&&q.manufacturer&&(L.manufacturer=q.manufacturer),!L.mpn&&q.mpn&&(L.mpn=q.mpn)),L}):[],[s==null?void 0:s.components,f]),Y=(s==null?void 0:s.components)&&s.components.length>0,I=a.useCallback(E=>{g(L=>{const q=new Set(L);return q.has(E)?q.delete(E):q.add(E),q})},[]),H=a.useCallback(E=>{navigator.clipboard.writeText(E),j(E),setTimeout(()=>j(null),2e3)},[]),K=a.useCallback((E,L)=>{l?l(E,L):console.log(`Navigate to: ${E}${L?`:${L}`:""}`)},[l]),y=e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Search value, MPN...",value:o,onChange:E=>x(E.target.value)})]}),e.jsx(Re,{projects:Q,selectedProjectRoot:r,selectedTargetName:(h==null?void 0:h[0])||null,onSelectProject:u||(()=>{}),onSelectTarget:d,showAllOption:!1,placeholder:"Select project"})]})}),S=a.useMemo(()=>{const E=o.toLowerCase();return $.filter(L=>{var q,X,G,ne;return E?L.value.toLowerCase().includes(E)||((q=L.mpn)==null?void 0:q.toLowerCase().includes(E))||((X=L.lcsc)==null?void 0:X.toLowerCase().includes(E))||((G=L.manufacturer)==null?void 0:G.toLowerCase().includes(E))||((ne=L.description)==null?void 0:ne.toLowerCase().includes(E)):!0}).sort((L,q)=>(q.totalCost||0)-(L.totalCost||0))},[$,o]),{totalComponents:v,totalCost:T,uniqueParts:W,outOfStock:J}=a.useMemo(()=>{let E=0,L=0,q=0;for(const X of $)E+=X.quantity,L+=X.totalCost||0,X.inStock===!1&&q++;return{totalComponents:E,totalCost:L,uniqueParts:$.length,outOfStock:q}},[$]),Z=(()=>{if(!(s!=null&&s.build_id))return null;const E=s.build_id.match(/^build-(\d+)-/);return E?`#${E[1]}`:s.build_id.substring(0,12)})();if(n)return e.jsxs("div",{className:"bom-panel",children:[y,e.jsxs("div",{className:"bom-loading",children:[e.jsx(Be,{size:24,className:"loading-spinner"}),e.jsx("span",{children:"Loading BOM..."})]})]});if(t){const E=t.includes("404")||t.includes("not found")||t.includes("Run 'ato build'");return e.jsxs("div",{className:"bom-panel",children:[y,e.jsx("div",{className:"bom-empty-state",children:E?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"empty-title",children:"No BOM data available"}),e.jsx("span",{className:"empty-description",children:"Run a build to generate the Bill of Materials"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:24}),e.jsx("span",{children:t})]})})]})}return Y?e.jsxs("div",{className:"bom-panel",children:[e.jsxs("div",{className:"bom-summary",children:[e.jsxs("div",{className:"bom-summary-item",children:[e.jsx("span",{className:"summary-value",children:W}),e.jsx("span",{className:"summary-label",children:"unique"})]}),e.jsxs("div",{className:"bom-summary-item",children:[e.jsx("span",{className:"summary-value",children:v}),e.jsx("span",{className:"summary-label",children:"total"})]}),e.jsxs("div",{className:"bom-summary-item primary",children:[e.jsx("span",{className:"summary-value",children:Le(T)}),e.jsx("span",{className:"summary-label",children:"cost"})]}),J>0&&e.jsxs("div",{className:"bom-summary-item warning",children:[e.jsx(ie,{size:12}),e.jsx("span",{className:"summary-value",children:J}),e.jsx("span",{className:"summary-label",children:"out of stock"})]}),Z&&e.jsxs("div",{className:"bom-summary-item muted",title:`Build: ${s==null?void 0:s.build_id}`,children:[e.jsx("span",{className:"summary-value",children:Z}),e.jsx("span",{className:"summary-label",children:"build"})]})]}),y,e.jsxs("div",{className:"bom-list",children:[S.map(E=>e.jsx(Et,{component:E,isExpanded:p.has(E.id),onToggle:()=>I(E.id),onCopy:H,onGoToSource:K},E.id)),S.length===0&&e.jsxs("div",{className:"bom-empty",children:[e.jsx(be,{size:24}),e.jsx("span",{children:"No components found"})]})]}),V&&e.jsxs("div",{className:"bom-toast",children:[e.jsx(re,{size:10}),"Copied: ",V]})]}):e.jsxs("div",{className:"bom-panel",children:[y,e.jsxs("div",{className:"bom-empty-state",children:[e.jsx("span",{className:"empty-title",children:"No BOM data available"}),e.jsx("span",{className:"empty-description",children:"Select a project and run a build to generate the Bill of Materials"})]})]})}function Vt(s){return s==null?"0":s>=1e6?(s/1e6).toFixed(1).replace(/\.0$/,"")+"M":s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"k":s.toString()}function Lt(s){if(!s)return"Unknown";try{const n=new Date(s),l=new Date().getTime()-n.getTime(),i=Math.floor(l/(1e3*60*60*24));return i<1?"Today":i===1?"Yesterday":i<7?`${i} days ago`:i<30?`${Math.floor(i/7)} weeks ago`:i<365?`${Math.floor(i/30)} months ago`:n.toLocaleDateString()}catch{return s}}function qt({package:s,packageDetails:n,isLoading:t,isInstalling:l,installError:i,error:r,onClose:h,onInstall:u,onBuild:d}){var f,P,m;const o=n,x=(o==null?void 0:o.versions)||((f=s.availableVersions)==null?void 0:f.map(C=>({version:C.version,releasedAt:C.released,requiresAtopile:void 0,size:void 0})))||[],p=((P=x[0])==null?void 0:P.version)||"",[g,V]=a.useState(p||(o==null?void 0:o.version)||s.version||"");a.useEffect(()=>{var C;x.length&&(!g||g===(o==null?void 0:o.installedVersion)||g===s.version)&&V(((C=x[0])==null?void 0:C.version)||g)},[x,o==null?void 0:o.installedVersion,s.version,g]);const j=(o==null?void 0:o.description)||(o==null?void 0:o.summary)||s.description,w=(o==null?void 0:o.installed)??s.installed,k=(o==null?void 0:o.installedVersion)||s.version;return e.jsxs("div",{className:"package-detail-panel",children:[e.jsxs("div",{className:"detail-panel-header",children:[e.jsxs("div",{className:"detail-header-left",children:[e.jsx(be,{size:20,className:"detail-package-icon"}),e.jsxs("div",{className:"detail-header-info",children:[e.jsx("h2",{className:"detail-package-name",children:s.name}),e.jsxs("div",{className:"detail-package-meta",children:[((o==null?void 0:o.version)||s.version)&&e.jsxs("span",{className:"detail-version",children:[e.jsx(Un,{size:12}),"v",(o==null?void 0:o.version)||s.version]}),w&&e.jsxs("span",{className:"detail-installed",children:[e.jsx(Ks,{size:12}),"Installed",k?` (v${k})`:""]})]})]})]}),e.jsx("button",{className:"detail-close-btn",onClick:h,children:e.jsx(he,{size:18})})]}),t&&e.jsxs("div",{className:"detail-panel-loading",children:[e.jsx(ge,{size:24,className:"spin"}),e.jsx("span",{children:"Loading package details..."})]}),r&&!t&&e.jsxs("div",{className:"detail-panel-error",children:[e.jsx(de,{size:16}),e.jsx("span",{children:r})]}),e.jsxs("div",{className:"detail-panel-content",children:[j&&e.jsx("section",{className:"detail-section",children:e.jsx("p",{className:"detail-description",children:j})}),e.jsxs("section",{className:"detail-section detail-actions",children:[e.jsxs("div",{className:"detail-install-row",children:[x.length>0?e.jsx("select",{className:"detail-version-select",value:g,onChange:C=>V(C.target.value),children:x.map((C,B)=>e.jsxs("option",{value:C.version,children:["v",C.version,B===0?" (latest)":""]},C.version))}):t?e.jsx("select",{className:"detail-version-select",disabled:!0,children:e.jsx("option",{children:"Loading versions..."})}):e.jsx("select",{className:"detail-version-select",disabled:!0,children:e.jsxs("option",{children:["v",s.version||"unknown"]})}),e.jsx("button",{className:`detail-install-btn ${w?"update":"install"} ${l?"installing":""}`,onClick:()=>u(g||(o==null?void 0:o.version)||s.version||""),disabled:t||l,children:l?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:14,className:"animate-spin"}),"Installing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:14}),w?"Update":"Install"]})}),e.jsxs("button",{className:"detail-build-btn",onClick:()=>d(),title:"Build this package (installs if needed)",disabled:t||l,children:[e.jsx(Ae,{size:14}),"Build"]})]}),i&&e.jsxs("div",{className:"detail-install-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:i})]}),x.length>0&&e.jsxs("div",{className:"detail-version-info",children:[e.jsx(_s,{size:12}),"Released: ",Lt((m=x.find(C=>C.version===g))==null?void 0:m.releasedAt)]})]}),e.jsxs("section",{className:"detail-section",children:[e.jsxs("h3",{className:"detail-section-title",children:[e.jsx(ye,{size:14}),"Exported Symbols"]}),e.jsx("p",{className:"muted",children:"Symbol introspection coming soon"})]}),e.jsxs("section",{className:"detail-section",children:[e.jsxs("h3",{className:"detail-section-title",children:[e.jsx(ye,{size:14}),"Usage Example"]}),e.jsx("pre",{className:"detail-code-block",children:`from "${s.fullName}/${s.name}.ato" import RP2040

module MyBoard:
    mcu = new RP2040

    # Connect interfaces
    power ~ mcu.power
    i2c ~ mcu.i2c`})]})]}),e.jsxs("div",{className:"detail-panel-footer",children:[e.jsxs("div",{className:"detail-footer-stats",children:[(o==null?void 0:o.publisher)&&e.jsx("span",{className:"footer-stat",children:o.publisher}),o&&e.jsxs("span",{className:"footer-stat",children:[e.jsx(Pe,{size:12}),Vt(o.downloads)]}),(o==null?void 0:o.license)&&e.jsx("span",{className:"footer-stat",children:o.license})]}),s.homepage&&e.jsxs("a",{href:s.homepage,className:"footer-browser-btn",target:"_blank",rel:"noopener",title:"Open in browser",children:[e.jsx(jn,{size:14}),e.jsx("span",{children:"Open"}),e.jsx(we,{size:10})]})]})]})}function Ft(s){if(s<60)return`${Math.floor(s)}s`;const n=Math.floor(s/60),t=Math.floor(s%60);if(n<60)return`${n}m ${t}s`;const l=Math.floor(n/60),i=n%60;return`${l}h ${i}m`}function Rt(s){const n=s.split("/");return n[n.length-1]||s}function Tt(s){if(!s.stages||s.stages.length===0)return null;const n=s.stages.find(l=>l.status==="running");if(n)return{name:n.displayName||n.name,elapsed:n.elapsedSeconds};const t=[...s.stages].reverse().find(l=>l.status==="success"||l.status==="failed"||l.status==="error");return t?{name:t.displayName||t.name}:null}function _t({build:s,onCancel:n}){const[t,l]=a.useState(s.elapsedSeconds||0);a.useEffect(()=>{if(s.status!=="building"){l(s.elapsedSeconds||0);return}const x=s.startedAt*1e3,p=()=>{l((Date.now()-x)/1e3)};p();const g=setInterval(p,1e3);return()=>clearInterval(g)},[s.status,s.startedAt,s.elapsedSeconds]);const i=Rt(s.projectRoot),r=s.targets.length>0?s.targets.length===1?s.targets[0]:s.targets.join(", "):s.entry||"default",h=Tt(s),u={queued:e.jsx($n,{className:"status-icon queued",size:12}),building:e.jsx(ve,{className:"status-icon building",size:12}),success:e.jsx(Gs,{className:"status-icon success",size:12}),failed:e.jsx(Js,{className:"status-icon failed",size:12}),cancelled:e.jsx(de,{className:"status-icon cancelled",size:12})}[s.status],d=s.status==="building",o=s.status==="queued"||s.status==="building";return e.jsxs("div",{className:`queue-item ${s.status}`,children:[e.jsxs("div",{className:"queue-item-main",children:[u,e.jsxs("div",{className:"queue-item-info",children:[e.jsxs("span",{className:"queue-item-name",title:`${i}:${r}`,children:[i,e.jsxs("span",{className:"queue-item-target",children:[":",r]})]}),h&&s.status==="building"&&e.jsx("span",{className:"queue-item-stage",title:h.name,children:h.name})]}),e.jsxs("div",{className:"queue-item-meta",children:[o&&e.jsxs("span",{className:"queue-item-time",children:[e.jsx(qe,{size:10}),Ft(t)]}),o&&e.jsx("button",{className:`queue-item-cancel${d?" building":""}`,onClick:n,title:"Cancel build",children:e.jsx(he,{size:12})})]})]}),s.error&&s.status==="failed"&&e.jsxs("div",{className:"queue-item-error",title:s.error,children:[s.error.substring(0,50),"..."]})]})}function Dt({builds:s,onCancelBuild:n}){return s.length===0?e.jsx("div",{className:"queue-empty",children:e.jsx("span",{children:"No active builds"})}):e.jsx("div",{className:"build-queue-panel",children:s.map(t=>e.jsx(_t,{build:t,onCancel:()=>n(t.buildId)},t.buildId))})}function Ge(s,n,t,l){if(!s||!Array.isArray(s))return;let i=s.find(r=>{if(r.status!=="building"&&r.status!=="queued")return!1;if(l&&r.projectRoot&&r.projectRoot===l)return!0;if((r.projectName||(r.projectRoot?r.projectRoot.split("/").pop():null))!==n)return!1;const u=r.targets||[];return u.length>0?u.includes(t):r.name===t});return i||(i=s.find(r=>(r.status==="building"||r.status==="queued")&&r.name===t&&(r.projectName===n||r.projectName===null)&&(!l||!r.projectRoot||r.projectRoot===l))),i}function Ht(s,n){if(!s||!s.includes(":"))return null;const[t,l]=s.split(":");if(!l)return null;const i=(n||[]).filter(r=>r.entry!==s).map(r=>({name:r.name,type:r.type,path:r.entry,children:[]})).sort((r,h)=>{const u={module:0,component:1,interface:2,parameter:3},d=(u[r.type]||99)-(u[h.type]||99);return d!==0?d:r.name.localeCompare(h.name)});return{name:l,type:"module",path:s,children:i}}function Ze(s){return s?s==="failed"?"error":s==="interrupted"||s==="building"||s==="queued"?"idle":s:"idle"}function Qt({state:s,selection:n,activeStageFilter:t}){const l=a.useMemo(()=>{var w;if(!((w=s==null?void 0:s.projects)!=null&&w.length))return[];const j=[...(s==null?void 0:s.queuedBuilds)||[],...(s==null?void 0:s.builds)||[]];return s.projects.map(k=>{var B,M,z;const f=((B=s.projectModules)==null?void 0:B[k.root])||[],P=k.targets.map(c=>{var D,O,$,Y,I,H;const A=Ge(j,k.name,c.name,k.root),F=Ht(c.entry,f),N=A!=null&&A.stages&&A.stages.length>0?A.stages:null,_=(D=c.lastBuild)==null?void 0:D.stages,Q=N||_||[];return{id:c.name,name:c.name,entry:c.entry,status:(A==null?void 0:A.status)==="failed"?"error":(A==null?void 0:A.status)||Ze((O=c.lastBuild)==null?void 0:O.status),warnings:(A==null?void 0:A.warnings)??(($=c.lastBuild)==null?void 0:$.warnings),errors:(A==null?void 0:A.errors)??((Y=c.lastBuild)==null?void 0:Y.errors),elapsedSeconds:A==null?void 0:A.elapsedSeconds,duration:(I=c.lastBuild)==null?void 0:I.elapsedSeconds,buildId:A==null?void 0:A.buildId,stages:Q.map(K=>({...K,status:K.status==="failed"?"error":K.status})),symbols:F?[F]:[],queuePosition:A==null?void 0:A.queuePosition,lastBuild:c.lastBuild?{status:Ze(c.lastBuild.status),timestamp:c.lastBuild.timestamp,elapsedSeconds:c.lastBuild.elapsedSeconds,warnings:c.lastBuild.warnings,errors:c.lastBuild.errors,stages:(H=c.lastBuild.stages)==null?void 0:H.map(K=>({name:K.name,displayName:K.displayName,status:K.status==="failed"?"error":K.status,elapsedSeconds:K.elapsedSeconds}))}:void 0}});let m,C;for(const c of P){const A=c.status!=="idle"?c.status:(M=c.lastBuild)==null?void 0:M.status,F=(z=c.lastBuild)==null?void 0:z.timestamp;A==="error"||A==="failed"?m="error":A==="warning"&&m!=="error"?m="warning":A==="success"&&!m&&(m="success"),F&&(!C||F>C)&&(C=F)}return{id:k.root,name:k.name,type:"project",root:k.root,builds:P,lastBuildStatus:m,lastBuildTimestamp:C}})},[s==null?void 0:s.projects,s==null?void 0:s.builds,s==null?void 0:s.projectModules]),i=a.useMemo(()=>{var w;if(!((w=s==null?void 0:s.packages)!=null&&w.length))return[];const j=[...(s==null?void 0:s.queuedBuilds)||[],...(s==null?void 0:s.builds)||[]];return s.packages.filter(k=>k&&k.identifier&&k.name).map(k=>{var B,M;const P=["default","usage"].map(z=>{const c=Ge(j,k.name,z);return{id:z,name:z,entry:`${k.name||"unknown"}.ato:${(k.name||"unknown").replace(/-/g,"_")}`,status:(c==null?void 0:c.status)||"idle",buildId:c==null?void 0:c.buildId,elapsedSeconds:c==null?void 0:c.elapsedSeconds,warnings:c==null?void 0:c.warnings,errors:c==null?void 0:c.errors,stages:(c==null?void 0:c.stages)||[],queuePosition:c==null?void 0:c.queuePosition,lastBuild:c&&(c.status==="success"||c.status==="failed"||c.status==="warning")&&c.startedAt?{status:c.status==="failed"?"error":c.status,timestamp:new Date((c.startedAt+(c.elapsedSeconds||0))*1e3).toISOString(),elapsedSeconds:c.elapsedSeconds,warnings:c.warnings||0,errors:c.errors||0}:void 0}});let m,C;for(const z of P){const c=z.status!=="idle"?z.status:(B=z.lastBuild)==null?void 0:B.status,A=(M=z.lastBuild)==null?void 0:M.timestamp;c==="error"||c==="failed"?m="error":c==="warning"&&m!=="error"?m="warning":c==="success"&&!m&&(m="success"),A&&(!C||A>C)&&(C=A)}return{id:k.identifier,name:k.name,type:"package",path:`packages/${k.identifier}`,version:k.version||void 0,latestVersion:k.latestVersion,installed:k.installed??!1,installedIn:k.installedIn||[],publisher:k.publisher||void 0,summary:k.summary||k.description||"",description:k.description||k.summary||"",homepage:k.homepage,repository:k.repository,license:k.license,keywords:k.keywords||[],downloads:k.downloads,versionCount:k.versionCount,builds:P,lastBuildStatus:m,lastBuildTimestamp:C}})},[s==null?void 0:s.packages,s==null?void 0:s.builds]),r=[...l,...i];let h=0,u=0;for(const j of r)j.type==="package"?u++:h++;const d=(s==null?void 0:s.queuedBuilds)||[],o=a.useMemo(()=>new Map(r.map(j=>[j.id,j])),[r]),x=(s==null?void 0:s.problems)||[],p=a.useMemo(()=>{const j=s==null?void 0:s.problemFilter,w=f=>f.toLowerCase().replace(/[-_\s]+/g,""),k=(f,P)=>{if(f===P)return!0;const m=w(f),C=w(P);return!!(m===C||m.includes(C)||C.includes(m))};return x.filter(f=>{if(t){if(t.stageName&&(!f.stage||!k(t.stageName,f.stage))||t.buildId&&f.buildName&&f.buildName!==t.buildId)return!1;if(t.projectId&&f.projectName){const P=o.get(t.projectId);if(P&&f.projectName!==P.name)return!1}return!0}if(n.type==="project"&&n.projectId){const P=o.get(n.projectId);if(P&&f.projectName&&f.projectName!==P.name)return!1}else if(n.type==="build"&&n.projectId&&n.buildId){const P=o.get(n.projectId);if(P&&f.projectName&&f.projectName!==P.name||f.buildName&&f.buildName!==n.buildId)return!1}return j?!(j.levels&&j.levels.length>0&&!j.levels.includes(f.level)||j.buildNames&&j.buildNames.length>0&&f.buildName&&!j.buildNames.includes(f.buildName)||j.stageIds&&j.stageIds.length>0&&f.stage&&!j.stageIds.includes(f.stage)):!0})},[x,s==null?void 0:s.problemFilter,t,n,o]);let g=0,V=0;for(const j of p)j.level==="error"?g++:j.level==="warning"&&V++;return{projects:r,projectCount:h,packageCount:u,queuedBuilds:d,projectsById:o,problems:x,filteredProblems:p,totalErrors:g,totalWarnings:V}}function Ut({selectedProjectRoot:s,selectedTargetName:n,collapsedSections:t,sectionHeights:l,setSectionHeights:i,setCollapsedSections:r,containerRef:h,action:u}){const d=a.useRef(0),o=a.useRef(0);a.useEffect(()=>{const x=p=>{const g=p.detail;if(!(g!=null&&g.sectionId)||!(g!=null&&g.type))return;const V=g.sectionId;r(j=>{const w=new Set(j);return g.type==="openSection"?w.delete(V):g.type==="closeSection"?w.add(V):g.type==="toggleSection"&&(w.has(V)?w.delete(V):w.add(V)),w})};return window.addEventListener("atopile:ui_action",x),()=>window.removeEventListener("atopile:ui_action",x)},[r]),a.useEffect(()=>{const x=setTimeout(()=>{u("refreshProblems"),u("refreshPackages"),u("refreshStdlib")},100);return()=>clearTimeout(x)},[u]),a.useEffect(()=>{if(!s){ce.getState().setBomData(null),ce.getState().setBomError(null);return}if(!n)return;const x=++d.current;ce.getState().setLoadingBom(!0),ce.getState().setBomError(null),u("refreshBOM",{projectRoot:s,target:n,requestId:x})},[s,n]),a.useEffect(()=>{if(!s){ce.getState().setVariablesData(null),ce.getState().setVariablesError(null);return}if(!n)return;const x=++o.current;ce.getState().setLoadingVariables(!0),ce.getState().setVariablesError(null),u("fetchVariables",{projectRoot:s,target:n,requestId:x})},[s,n]),a.useEffect(()=>{const x=h.current;if(!x)return;const p=["projects","packages","problems","stdlib","variables","bom"];let g=null;const V=()=>{const f=x.clientHeight;let P=0,m=null;for(const B of p){if(t.has(B))continue;const M=x.querySelector(`[data-section-id="${B}"]`);if(!M)continue;const z=M.querySelector(".section-body"),c=M.querySelector(".section-title-bar");if(c&&(P+=c.offsetHeight),z){const F=z.offsetHeight,N=z.scrollHeight;P+=F,N>F+5&&!m&&(m={id:B,neededHeight:N-F,currentHeight:M.offsetHeight})}const A=M.querySelector(".section-resize-handle");A&&(P+=A.offsetHeight),P+=1}const C=f-P;if(C>20&&m){const B=Math.min(C,m.neededHeight),M=m.currentHeight+B,z=l[m.id];(!z||Math.abs(z-M)>5)&&i(c=>({...c,[m.id]:M}))}},j=()=>{g!==null&&clearTimeout(g),g=setTimeout(V,100)},w=setTimeout(V,150),k=new ResizeObserver(j);return k.observe(x),()=>{clearTimeout(w),g!==null&&clearTimeout(g),k.disconnect()}},[t,l,i,h])}function Ot({projects:s,state:n,sectionHeights:t,setSectionHeights:l,setCollapsedSections:i,setSelection:r,setSelectedPackage:h,setActiveStageFilter:u,action:d}){const o=a.useRef(null),x=a.useRef(0),p=a.useRef(0),g=a.useRef(null),V=y=>{i(S=>{const v=new Set(S);return v.has(y)?v.delete(y):v.add(y),v})},j=y=>{if(r(y),y.type==="project"||y.type==="build"||y.type==="symbol"){const S=s.find(T=>T.id===y.projectId),v=(S==null?void 0:S.root)||(S==null?void 0:S.path);v&&(ce.getState().setSelectedTargets([]),d("setSelectedTargets",{targetNames:[]}),d("selectProject",{projectRoot:v}))}},w=y=>{ce.getState().selectProject(y),ce.getState().setSelectedTargets([]),d("selectProject",{projectRoot:y}),d("setSelectedTargets",{targetNames:[]})},k=(y,S)=>{ce.getState().selectProject(y),ce.getState().setSelectedTargets([S]),d("selectProject",{projectRoot:y}),d("setSelectedTargets",{targetNames:[S]})},f=(y,S,v)=>{d("build",{level:y,id:S,label:v})},P=y=>{d("cancelBuild",{buildId:y})},m=y=>{d("cancelBuild",{buildId:y})},C=(y,S,v)=>{u({stageName:y||void 0,buildId:S,projectId:v}),i(T=>{const W=new Set(T);return W.delete("problems"),W})},B=()=>{u(null)},M=y=>{h(y),d("getPackageDetails",{packageId:y.fullName})},z=(y,S,v)=>{d("installPackage",{packageId:y,projectRoot:S,version:v})},c=(y,S)=>{d("createProject",{parentDirectory:y,name:S})},A=y=>{var W,J,Z;const S=(W=n==null?void 0:n.projectModules)==null?void 0:W[y];y&&(!S||S.length===0)&&d("fetchModules",{projectRoot:y});const v=(J=n==null?void 0:n.projectFiles)==null?void 0:J[y];y&&(!v||v.length===0)&&d("fetchFiles",{projectRoot:y});const T=(Z=n==null?void 0:n.projectDependencies)==null?void 0:Z[y];y&&(!T||T.length===0)&&d("fetchDependencies",{projectRoot:y})},F=(y,S)=>{d("openSource",{projectId:y,entry:S})},N=(y,S)=>{d("openKiCad",{projectId:y,buildId:S})},_=(y,S)=>{d("openLayout",{projectId:y,buildId:S})},Q=(y,S)=>{d("open3D",{projectId:y,buildId:S})},D=async y=>{var L,q,X,G,ne;const S=((L=n==null?void 0:n.projectModules)==null?void 0:L[y])||[],v=S.find(R=>R.name==="App"||R.type==="module")||S[0],T=(v==null?void 0:v.entry)||"main.ato:App",W=((X=(q=n==null?void 0:n.projects)==null?void 0:q.find(R=>R.root===y))==null?void 0:X.targets)||[],J=new Set(W.map(R=>R.name));let Z="new-build",E=1;for(;J.has(Z);)Z=`new-build-${E}`,E++;try{const R=await xe("addBuildTarget",{project_root:y,name:Z,entry:T});(G=R.result)!=null&&G.success?d("refreshProjects"):console.error("Failed to add build target:",(ne=R.result)==null?void 0:ne.message)}catch(R){console.error("Failed to add build target:",R)}},O=async(y,S,v)=>{var Z,E;const T=S,W=v.name!==T?v.name:void 0,J=v.entry;try{const L=await xe("updateBuildTarget",{project_root:y,old_name:T,new_name:W,new_entry:J});(Z=L.result)!=null&&Z.success?d("refreshProjects"):console.error("Failed to update build target:",(E=L.result)==null?void 0:E.message)}catch(L){console.error("Failed to update build target:",L)}},$=async(y,S)=>{var v,T;try{const W=await xe("deleteBuildTarget",{project_root:y,name:S});(v=W.result)!=null&&v.success?d("refreshProjects"):console.error("Failed to delete build target:",(T=W.result)==null?void 0:T.message)}catch(W){console.error("Failed to delete build target:",W)}},Y=async(y,S,v)=>{var T,W;try{const J=await xe("updateDependencyVersion",{project_root:y,identifier:S,new_version:v});(T=J.result)!=null&&T.success?d("fetchDependencies",{projectRoot:y}):console.error("Failed to update dependency version:",(W=J.result)==null?void 0:W.message)}catch(J){console.error("Failed to update dependency version:",J)}},I=a.useCallback(y=>{o.current&&(g.current!==null&&cancelAnimationFrame(g.current),g.current=requestAnimationFrame(()=>{const S=y.clientY-x.current,v=Math.max(100,p.current+S);l(T=>({...T,[o.current]:v})),g.current=null}))},[l]),H=a.useCallback(()=>{g.current!==null&&(cancelAnimationFrame(g.current),g.current=null),o.current=null,document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",H)},[I]),K=a.useCallback((y,S)=>{if(S.preventDefault(),o.current=y,x.current=S.clientY,t[y])p.current=t[y];else{const v=S.target.closest(".collapsible-section");p.current=v?v.getBoundingClientRect().height:200}document.addEventListener("mousemove",I),document.addEventListener("mouseup",H)},[t,I,H]);return{toggleSection:V,handleSelect:j,handleBuild:f,handleCancelBuild:P,handleCancelQueuedBuild:m,handleStageFilter:C,clearStageFilter:B,handleOpenPackageDetail:M,handlePackageInstall:z,handleCreateProject:c,handleProjectExpand:A,handleOpenSource:F,handleOpenKiCad:N,handleOpenLayout:_,handleOpen3D:Q,handleAddBuild:D,handleUpdateBuild:O,handleDeleteBuild:$,handleDependencyVersionChange:Y,handleSelectProject:w,handleSelectTarget:k,handleResizeStart:K}}const ae=(s,n)=>{if(s==="openUrl"&&n&&"url"in n){const t=n.url;if(t){window.open(t,"_blank","noopener,noreferrer");return}}Je(s,n)};function Yt({logoUri:s,version:n,atopile:t,developerMode:l}){var F,N,_,Q,D,O;const[i,r]=a.useState(!1),h=a.useRef(null),u=typeof navigator<"u"&&navigator.hardwareConcurrency||4,[d,o]=a.useState(!0),[x,p]=a.useState(u),[g,V]=a.useState(u),[j,w]=a.useState(""),[k,f]=a.useState(!1),P=a.useRef(null),[m,C]=a.useState({isValidating:!1,valid:null,version:null,error:null}),B=a.useRef(null),[M,z]=a.useState({type:null,value:null}),c=(((F=t==null?void 0:t.availableVersions)==null?void 0:F.length)??0)===0;a.useEffect(()=>{if(M.type==="version"&&(t==null?void 0:t.currentVersion)===M.value){z({type:null,value:null});return}if(M.type==="branch"&&(t==null?void 0:t.branch)===M.value){z({type:null,value:null});return}if(M.type!==null){const $=setTimeout(()=>{z({type:null,value:null})},6e4);return()=>clearTimeout($)}},[t==null?void 0:t.currentVersion,t==null?void 0:t.branch,M]),a.useEffect(()=>{c&&(t==null?void 0:t.source)==="release"&&(z({type:null,value:null}),ae("setAtopileSource",{source:"branch"}))},[c,t==null?void 0:t.source]);const A=(t==null?void 0:t.isInstalling)||M.type!==null;return a.useEffect(()=>{if(!i)return;const $=Y=>{h.current&&!h.current.contains(Y.target)&&r(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[i]),a.useEffect(()=>{i&&ae("getMaxConcurrentSetting")},[i]),a.useEffect(()=>{if(!k)return;const $=Y=>{P.current&&!P.current.contains(Y.target)&&f(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[k]),a.useEffect(()=>{if((t==null?void 0:t.source)!=="local"||!(t!=null&&t.localPath)){C({isValidating:!1,valid:null,version:null,error:null});return}return B.current&&clearTimeout(B.current),C($=>({...$,isValidating:!0})),B.current=setTimeout(()=>{ae("validateAtopilePath",{path:t.localPath})},500),()=>{B.current&&clearTimeout(B.current)}},[t==null?void 0:t.source,t==null?void 0:t.localPath]),a.useEffect(()=>{const $=Y=>{const I=Y.detail,H=I==null?void 0:I.result;H!=null&&H.setting&&(o(H.setting.use_default),p(H.setting.custom_value||H.setting.default_value),V(H.setting.default_value)),(I==null?void 0:I.action)==="validateAtopilePath"&&H&&C({isValidating:!1,valid:H.valid??!1,version:H.version??null,error:H.error??null})};return window.addEventListener("atopile:action_result",$),()=>window.removeEventListener("atopile:action_result",$)},[]),e.jsxs("div",{className:"panel-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("img",{className:"logo",src:s||bt,alt:"atopile"}),e.jsx("span",{children:"atopile"}),n&&e.jsxs("span",{className:"version-badge",children:["v",n]})]}),e.jsx("div",{className:"header-actions",children:e.jsxs("div",{className:"settings-dropdown-container",ref:h,children:[e.jsx("button",{className:`icon-btn${i?" active":""}`,onClick:()=>r(!i),title:"Settings",children:e.jsx(Tn,{size:14})}),i&&e.jsxs("div",{className:"settings-dropdown",children:[(t==null?void 0:t.error)&&e.jsxs("div",{className:"settings-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:t.error})]}),c&&e.jsxs("div",{className:"settings-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:"No compatible release found. Select a branch or local install."})]}),e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Source"})}),e.jsxs("div",{className:"settings-source-buttons",children:[e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="release"?" active":""}${c?" disabled":""}`,onClick:()=>{c||(z({type:null,value:null}),ae("setAtopileSource",{source:"release"}))},title:"Use a released version from PyPI",disabled:c,children:[e.jsx(be,{size:12}),"Release"]}),e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="branch"?" active":""}`,onClick:()=>{z({type:null,value:null}),ae("setAtopileSource",{source:"branch"})},title:"Use a git branch from GitHub",children:[e.jsx(Ye,{size:12}),"Branch"]}),e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="local"?" active":""}`,onClick:()=>{z({type:null,value:null}),ae("setAtopileSource",{source:"local"})},title:"Use a local installation",children:[e.jsx(Ee,{size:12}),"Local"]})]})]}),(t==null?void 0:t.source)==="release"&&!c&&e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Version"})}),e.jsxs("div",{className:"settings-select-wrapper",children:[e.jsx("select",{className:"settings-select",value:(t==null?void 0:t.currentVersion)||"",onChange:$=>{const Y=$.target.value;Y!==(t==null?void 0:t.currentVersion)&&z({type:"version",value:Y}),ae("setAtopileVersion",{version:Y})},children:((t==null?void 0:t.availableVersions)||[]).slice(0,20).map($=>{var Y;return e.jsxs("option",{value:$,children:[$,$===((Y=t==null?void 0:t.availableVersions)==null?void 0:Y[0])?" (latest)":""]},$)})}),e.jsx(ee,{size:12,className:"select-chevron"})]}),A&&e.jsxs("div",{className:"install-status",children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:((N=t==null?void 0:t.installProgress)==null?void 0:N.message)||(M.type==="version"?`Installing v${M.value}...`:"Installing...")}),e.jsx("button",{className:"install-cancel-btn",onClick:()=>{z({type:null,value:null}),ae("setAtopileInstalling",{installing:!1})},title:"Cancel installation",children:e.jsx(he,{size:10})})]})]}),(t==null?void 0:t.source)==="branch"&&e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Branch"})}),e.jsxs("div",{className:"branch-search-container",ref:P,children:[e.jsxs("div",{className:"branch-search-input-wrapper",children:[e.jsx(ue,{size:12,className:"branch-search-icon"}),e.jsx("input",{type:"text",className:"branch-search-input",placeholder:"Search branches...",value:j,onChange:$=>{w($.target.value),f(!0)},onFocus:()=>f(!0)}),(t==null?void 0:t.branch)&&!j&&e.jsx("span",{className:"branch-current-value",children:t.branch})]}),k&&e.jsxs("div",{className:"branch-dropdown",children:[((t==null?void 0:t.availableBranches)||["main","develop"]).filter($=>!j||$.toLowerCase().includes(j.toLowerCase())).slice(0,15).map($=>e.jsxs("button",{className:`branch-option${$===(t==null?void 0:t.branch)?" active":""}`,onClick:()=>{$!==(t==null?void 0:t.branch)&&z({type:"branch",value:$}),ae("setAtopieBranch",{branch:$}),w(""),f(!1)},children:[e.jsx(Ye,{size:12}),e.jsx("span",{children:$}),$==="main"&&e.jsx("span",{className:"branch-tag",children:"default"})]},$)),j&&!((t==null?void 0:t.availableBranches)||[]).some($=>$.toLowerCase().includes(j.toLowerCase()))&&e.jsxs("div",{className:"branch-no-results",children:['No branches match "',j,'"']})]})]}),e.jsxs("span",{className:"settings-hint",children:["Installs from git+https://github.com/atopile/atopile.git@",(t==null?void 0:t.branch)||"main"]}),A&&e.jsxs("div",{className:"install-status",children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:((_=t==null?void 0:t.installProgress)==null?void 0:_.message)||(M.type==="branch"?`Installing ${M.value}...`:"Installing...")}),e.jsx("button",{className:"install-cancel-btn",onClick:()=>{z({type:null,value:null}),ae("setAtopileInstalling",{installing:!1})},title:"Cancel installation",children:e.jsx(he,{size:10})})]})]}),(t==null?void 0:t.source)==="local"&&e.jsxs("div",{className:"settings-group local-path-section",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Local Path"})}),(((Q=t==null?void 0:t.detectedInstallations)==null?void 0:Q.length)??0)>0&&e.jsxs("div",{className:"detected-installations",children:[e.jsx("span",{className:"detected-label",children:"Detected:"}),(D=t==null?void 0:t.detectedInstallations)==null?void 0:D.map(($,Y)=>e.jsxs("button",{className:`detected-item${(t==null?void 0:t.localPath)===$.path?" active":""}`,onClick:()=>ae("setAtopileLocalPath",{path:$.path}),title:$.path,children:[e.jsx("span",{className:"detected-source",children:$.source}),$.version&&e.jsxs("span",{className:"detected-version",children:["v",$.version]})]},Y))]}),e.jsxs("div",{className:"settings-path-input",children:[e.jsx("input",{type:"text",className:`settings-input${m.valid===!0?" valid":""}${m.valid===!1?" invalid":""}`,placeholder:"/path/to/atopile or ato",value:(t==null?void 0:t.localPath)||"",onChange:$=>{ae("setAtopileLocalPath",{path:$.target.value})}}),e.jsx("button",{className:"path-browse-btn",onClick:()=>ae("browseAtopilePath"),title:"Browse...",children:e.jsx(Ee,{size:12})})]}),(t==null?void 0:t.localPath)&&e.jsx("div",{className:`path-validation-status${m.valid===!0?" valid":""}${m.valid===!1?" invalid":""}`,children:m.isValidating?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:"Validating..."})]}):m.valid===!0?e.jsxs(e.Fragment,{children:[e.jsx(re,{size:12}),e.jsxs("span",{children:["Found atopile",m.version?` v${m.version}`:""]})]}):m.valid===!1?e.jsxs(e.Fragment,{children:[e.jsx(he,{size:12}),e.jsx("span",{children:m.error||"Invalid path"})]}):null})]}),!(t!=null&&t.isInstalling)&&(t==null?void 0:t.currentVersion)&&e.jsxs("div",{className:"settings-status",children:[e.jsx(re,{size:12,className:"status-ok"}),e.jsx("span",{children:t.source==="local"?`Using local: ${((O=t.localPath)==null?void 0:O.split("/").pop())||"atopile"}`:`v${t.currentVersion} installed`})]}),e.jsx("div",{className:"settings-group",children:e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label-title",children:"Parallel builds"}),e.jsx("div",{className:"settings-inline-control",children:d?e.jsxs("button",{className:"settings-value-btn",onClick:()=>o(!1),title:"Click to set custom limit",children:["Auto (",g,")"]}):e.jsxs("div",{className:"settings-custom-input",children:[e.jsx("input",{type:"number",className:"settings-input small",min:1,max:32,value:x,onChange:$=>{const Y=Math.max(1,Math.min(32,parseInt($.target.value)||1));p(Y),ae("setMaxConcurrentSetting",{useDefault:!1,customValue:Y})}}),e.jsx("button",{className:"settings-reset-btn",onClick:()=>{o(!0),ae("setMaxConcurrentSetting",{useDefault:!0,customValue:null})},title:"Reset to auto",children:"Auto"})]})})]})}),e.jsx("div",{className:"settings-divider"}),e.jsx("div",{className:"settings-section-header",children:"Developer"}),e.jsxs("div",{className:"settings-group",children:[e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label-title",children:"Show all problems"}),e.jsx("div",{className:"settings-inline-control",children:e.jsxs("label",{className:"settings-toggle",children:[e.jsx("input",{type:"checkbox",checked:l||!1,onChange:$=>ae("setDeveloperMode",{enabled:$.target.checked})}),e.jsx("span",{className:"settings-toggle-slider"})]})})]}),e.jsx("div",{className:"settings-hint",children:"Show internal developer messages in Problems panel"})]})]})]})})]})}const pe=(s,n)=>{if(s==="openUrl"&&n&&"url"in n){const t=n.url;if(t){window.open(t,"_blank","noopener,noreferrer");return}}Je(s,n)};function Wt(){var _,Q,D,O,$,Y;const s=ce(I=>I),n=(s==null?void 0:s.selectedProjectRoot)??null,t=(s==null?void 0:s.selectedTargetNames)??[],l=a.useMemo(()=>{var H,K,y;if(!n)return null;if(t.length>0)return t[0];const I=(H=s==null?void 0:s.projects)==null?void 0:H.find(S=>S.root===n);return((y=(K=I==null?void 0:I.targets)==null?void 0:K[0])==null?void 0:y.name)??null},[n,t,s==null?void 0:s.projects]),[i,r]=a.useState({type:"none"}),[h,u]=a.useState(new Set(["buildQueue","problems","stdlib","variables","bom"])),[d,o]=a.useState({}),[x,p]=a.useState(null),[g,V]=a.useState(null),j=a.useRef(null),{projects:w,projectCount:k,packageCount:f,queuedBuilds:P,filteredProblems:m,totalErrors:C,totalWarnings:B}=Qt({state:s,selection:i,activeStageFilter:g}),A=Math.max(40,Math.max(1,P.length)*34+12),F=Math.min(240,A);Ut({selectedProjectRoot:n,selectedTargetName:l,collapsedSections:h,sectionHeights:d,setSectionHeights:o,setCollapsedSections:u,containerRef:j,action:pe});const N=Ot({projects:w,state:s,sectionHeights:d,setSectionHeights:o,setCollapsedSections:u,setSelection:r,setSelectedPackage:p,setActiveStageFilter:V,action:pe});return s?e.jsxs("div",{className:`unified-layout ${x?"package-detail-open":""}`,children:[e.jsx(Yt,{logoUri:s==null?void 0:s.logoUri,version:s==null?void 0:s.version,atopile:s==null?void 0:s.atopile,developerMode:s==null?void 0:s.developerMode}),e.jsxs("div",{className:"panel-sections",ref:j,children:[e.jsx(je,{id:"projects",title:"Projects",badge:k,loading:s==null?void 0:s.isLoadingProjects,collapsed:h.has("projects"),onToggle:()=>N.toggleSection("projects"),height:d.projects,maxHeight:d.projects?void 0:350,onResizeStart:I=>N.handleResizeStart("projects",I),children:e.jsx(We,{selection:i,onSelect:N.handleSelect,onBuild:N.handleBuild,onCancelBuild:N.handleCancelBuild,onStageFilter:N.handleStageFilter,onCreateProject:N.handleCreateProject,onProjectExpand:N.handleProjectExpand,onOpenSource:N.handleOpenSource,onOpenKiCad:N.handleOpenKiCad,onOpenLayout:N.handleOpenLayout,onOpen3D:N.handleOpen3D,onFileClick:(I,H)=>{const K=w.find(y=>y.id===I);if(K){const y=`${K.root}/${H}`;pe("openFile",{file:y})}},onAddBuild:N.handleAddBuild,onUpdateBuild:N.handleUpdateBuild,onDeleteBuild:N.handleDeleteBuild,filterType:"projects",projects:w,projectModules:(s==null?void 0:s.projectModules)||{},projectFiles:(s==null?void 0:s.projectFiles)||{},projectDependencies:(s==null?void 0:s.projectDependencies)||{},onDependencyVersionChange:N.handleDependencyVersionChange,onRemoveDependency:(I,H)=>{pe("removePackage",{projectRoot:I,packageId:H})}})}),e.jsx(je,{id:"buildQueue",title:"Build Queue",badge:P.length>0?P.length:void 0,badgeType:"count",collapsed:h.has("buildQueue"),onToggle:()=>N.toggleSection("buildQueue"),height:h.has("buildQueue")?void 0:d.buildQueue,maxHeight:d.buildQueue?void 0:F,onResizeStart:I=>N.handleResizeStart("buildQueue",I),children:e.jsx(Dt,{builds:P,onCancelBuild:N.handleCancelQueuedBuild})}),e.jsx(je,{id:"packages",title:"Packages",badge:f,loading:s==null?void 0:s.isLoadingPackages,warningMessage:(s==null?void 0:s.packagesError)||null,collapsed:h.has("packages"),onToggle:()=>N.toggleSection("packages"),height:d.packages,maxHeight:d.packages?void 0:350,onResizeStart:I=>N.handleResizeStart("packages",I),children:e.jsx(We,{selection:i,onSelect:N.handleSelect,onBuild:N.handleBuild,onCancelBuild:N.handleCancelBuild,onStageFilter:N.handleStageFilter,onOpenPackageDetail:N.handleOpenPackageDetail,onPackageInstall:N.handlePackageInstall,onOpenSource:N.handleOpenSource,onOpenKiCad:N.handleOpenKiCad,onOpenLayout:N.handleOpenLayout,onOpen3D:N.handleOpen3D,filterType:"packages",projects:w,installingPackageIds:s==null?void 0:s.installingPackageIds})}),e.jsx(je,{id:"problems",title:g?`Problems: ${g.stageName||g.buildId||"Filtered"}`:"Problems",badge:g?m.length:C+B,badgeType:g?"filter":"count",errorCount:g?void 0:C,warningCount:g?void 0:B,collapsed:h.has("problems"),onToggle:()=>N.toggleSection("problems"),onClearFilter:g?N.clearStageFilter:void 0,height:h.has("problems")?void 0:d.problems,onResizeStart:I=>N.handleResizeStart("problems",I),children:e.jsx(jt,{problems:m,projects:((_=s==null?void 0:s.projects)==null?void 0:_.map(I=>({id:I.root,name:I.name,root:I.root})))||[],selectedProjectRoot:n,onSelectProject:N.handleSelectProject,onProblemClick:I=>{pe("openFile",{file:I.file,line:I.line,column:I.column})}})}),e.jsx(je,{id:"stdlib",title:"Standard Library",badge:((Q=s==null?void 0:s.stdlibItems)==null?void 0:Q.length)||0,collapsed:h.has("stdlib"),onToggle:()=>N.toggleSection("stdlib"),height:h.has("stdlib")?void 0:d.stdlib,autoSize:!0,onResizeStart:I=>N.handleResizeStart("stdlib",I),children:e.jsx(vt,{items:s==null?void 0:s.stdlibItems,isLoading:s==null?void 0:s.isLoadingStdlib,onRefresh:()=>pe("refreshStdlib")})}),e.jsx(je,{id:"variables",title:"Variables",badge:(()=>{const I=s==null?void 0:s.currentVariablesData;if(!(I!=null&&I.nodes))return 0;const H=K=>{var S;let y=0;for(const v of K)y+=((S=v.variables)==null?void 0:S.length)||0,v.children&&(y+=H(v.children));return y};return H(I.nodes)})(),collapsed:h.has("variables"),onToggle:()=>N.toggleSection("variables"),height:h.has("variables")?void 0:d.variables,onResizeStart:I=>N.handleResizeStart("variables",I),children:e.jsx(At,{variablesData:s==null?void 0:s.currentVariablesData,isLoading:s==null?void 0:s.isLoadingVariables,error:s==null?void 0:s.variablesError,projects:s==null?void 0:s.projects,selectedProjectRoot:s==null?void 0:s.selectedProjectRoot,selectedTargetNames:s==null?void 0:s.selectedTargetNames,onSelectProject:N.handleSelectProject,onSelectTarget:N.handleSelectTarget})}),e.jsx(je,{id:"bom",title:"BOM",badge:((O=(D=s==null?void 0:s.bomData)==null?void 0:D.components)==null?void 0:O.length)??0,warningCount:($=s==null?void 0:s.bomData)!=null&&$.components?s.bomData.components.filter(I=>I.stock!==null&&I.stock===0).length:0,collapsed:h.has("bom"),onToggle:()=>N.toggleSection("bom"),height:h.has("bom")?void 0:d.bom,onResizeStart:I=>N.handleResizeStart("bom",I),children:e.jsx(It,{bomData:s==null?void 0:s.bomData,isLoading:s==null?void 0:s.isLoadingBom,error:s==null?void 0:s.bomError,projects:s==null?void 0:s.projects,selectedProjectRoot:s==null?void 0:s.selectedProjectRoot,selectedTargetNames:s==null?void 0:s.selectedTargetNames,onSelectProject:N.handleSelectProject,onSelectTarget:N.handleSelectTarget,onGoToSource:(I,H)=>{pe("openFile",{file:I,line:H})}})})]}),x&&e.jsx("div",{className:"detail-panel-container",children:e.jsx(qt,{package:x,packageDetails:(s==null?void 0:s.selectedPackageDetails)||null,isLoading:(s==null?void 0:s.isLoadingPackageDetails)||!1,isInstalling:((Y=s==null?void 0:s.installingPackageIds)==null?void 0:Y.includes(x.fullName))||!1,installError:(s==null?void 0:s.installError)||null,error:(s==null?void 0:s.packageDetailsError)||null,onClose:()=>{p(null),pe("clearPackageDetails")},onInstall:I=>{var K,y;const H=(s==null?void 0:s.selectedProjectRoot)||((y=(K=s==null?void 0:s.projects)==null?void 0:K[0])==null?void 0:y.root);H&&pe("installPackage",{packageId:x.fullName,projectRoot:H,version:I})},onBuild:I=>{var K,y;const H=(s==null?void 0:s.selectedProjectRoot)||((y=(K=s==null?void 0:s.projects)==null?void 0:K[0])==null?void 0:y.root);H&&pe("buildPackage",{packageId:x.fullName,projectRoot:H,entry:I})}})})]}):e.jsx("div",{className:"sidebar loading",children:"Loading..."})}const Kt="atopile-theme-preference";function Xt(){if(typeof window>"u")return"system";const s=localStorage.getItem(Kt);return s==="dark"||s==="light"||s==="system"?s:"system"}function Gt(){if(typeof window>"u")return;const s=Xt();document.documentElement.setAttribute("data-theme",s)}Gt();Ms.createRoot(document.getElementById("root")).render(e.jsx(zs.StrictMode,{children:e.jsx(Ps,{children:e.jsx(Wt,{})})}));
