import{r as a,j as e,s as xe,u as ne,a as Je,c as Ms,R as zs,A as Ps}from"./index-Brj0cfJr.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Bs=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,l)=>l?l.toUpperCase():t.toLowerCase()),Ue=s=>{const n=Bs(s);return n.charAt(0).toUpperCase()+n.slice(1)},es=(...s)=>s.filter((n,t,l)=>!!n&&n.trim()!==""&&l.indexOf(n)===t).join(" ").trim(),$s=s=>{for(const n in s)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Is={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=a.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:l,className:r="",children:c,iconNode:h,...p},o)=>a.createElement("svg",{ref:o,...Is,width:n,height:n,stroke:s,strokeWidth:l?Number(t)*24/Number(n):t,className:es("lucide",r),...!c&&!$s(p)&&{"aria-hidden":"true"},...p},[...h.map(([i,x])=>a.createElement(i,x)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=(s,n)=>{const t=a.forwardRef(({className:l,...r},c)=>a.createElement(Vs,{ref:c,iconNode:n,className:es(`lucide-${Es(Ue(s))}`,`lucide-${s}`,l),...r}));return t.displayName=Ue(s),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],qs=U("arrow-right",Ls);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],Me=U("box",Fs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=[["path",{d:"M17 19a1 1 0 0 1-1-1v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2a1 1 0 0 1-1 1z",key:"trhst0"}],["path",{d:"M17 21v-2",key:"ds4u3f"}],["path",{d:"M19 14V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V10",key:"1mo9zo"}],["path",{d:"M21 21v-2",key:"eo0ou"}],["path",{d:"M3 5V3",key:"1k5hjh"}],["path",{d:"M4 10a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2a2 2 0 0 1-2 2z",key:"1dd30t"}],["path",{d:"M7 5V3",key:"1t1388"}]],ss=U("cable",Rs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],_s=U("calendar",Ts);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ie=U("check",Ds);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ee=U("chevron-down",Hs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],re=U("chevron-right",Qs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=U("circle-alert",Us);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],Os=U("circle-arrow-up",Ys);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ks=U("circle-check-big",Ws);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Gs=U("circle-check",Xs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Js=U("circle-x",Zs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ve=U("circle",en);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M11 9h4a2 2 0 0 0 2-2V3",key:"1ve2rv"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M7 21v-4a2 2 0 0 1 2-2h4",key:"1fwkro"}],["circle",{cx:"15",cy:"15",r:"2",key:"3i40o0"}]],ns=U("circuit-board",sn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],qe=U("clock",nn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ts=U("copy",tn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],Fe=U("cpu",an);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=[["path",{d:"m21.12 6.4-6.05-4.06a2 2 0 0 0-2.17-.05L2.95 8.41a2 2 0 0 0-.95 1.7v5.82a2 2 0 0 0 .88 1.66l6.05 4.07a2 2 0 0 0 2.17.05l9.95-6.12a2 2 0 0 0 .95-1.7V8.06a2 2 0 0 0-.88-1.66Z",key:"1u2ovd"}],["path",{d:"M10 22v-8L2.25 9.15",key:"11pn4q"}],["path",{d:"m10 14 11.77-6.87",key:"1kt1wh"}]],rn=U("cuboid",ln);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Pe=U("download",cn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],we=U("external-link",on);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]],ye=U("file-code",dn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ye=U("file-text",un);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],$e=U("folder-open",hn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],as=U("folder",mn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],xn=U("funnel",pn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Oe=U("git-branch",gn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],jn=U("globe",fn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],vn=U("grid-3x3",Nn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],bn=U("grip-horizontal",yn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],wn=U("hammer",kn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ce=U("hash",Cn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Se=U("layers",Sn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ge=U("loader-circle",An);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],be=U("package",Mn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Pn=U("panels-top-left",zn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Bn=U("pause",En);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],In=U("percent",$n);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Ae=U("play",Vn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ls=U("plus",Ln);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ee=U("refresh-cw",qn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ue=U("search",Fn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Tn=U("settings",Rn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],Dn=U("skip-forward",_n);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],rs=U("square",Hn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Un=U("tag",Qn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],On=U("trash-2",Yn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ce=U("triangle-alert",Wn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],he=U("x",Kn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Ne=U("zap",Xn);function je({id:s,title:n,badge:t,badgeType:l="count",errorCount:r,warningCount:c,warningMessage:h,loading:p,collapsed:o,onToggle:i,onClearFilter:x,height:m,maxHeight:v,onResizeStart:M,children:N,flexGrow:g}){const z=!o&&m&&!g,f=!o&&!m&&v&&!g,C=z?{height:m,flex:"0 0 auto"}:f?{maxHeight:v,flex:"0 0 auto"}:void 0;return e.jsxs("div",{className:`collapsible-section ${o?"collapsed":""} ${g?"flex-grow":""} ${z?"has-height":""} ${f?"has-max-height":""}`,style:C,"data-section-id":s,children:[e.jsxs("div",{className:"section-title-bar",onClick:i,children:[e.jsx("button",{className:"section-chevron",children:o?e.jsx(re,{size:12}):e.jsx(ee,{size:12})}),e.jsx("span",{className:"section-title",children:n}),p&&e.jsx("span",{className:"section-loading",children:e.jsx(ge,{size:12,className:"animate-spin"})}),r!==void 0&&r>0&&e.jsxs("span",{className:"section-error-count",children:[e.jsx(de,{size:10}),r]}),c!==void 0&&c>0&&e.jsxs("span",{className:"section-warning-count",title:h||void 0,children:[e.jsx(ce,{size:10}),c]}),h&&(c===void 0||c===0)&&e.jsx("span",{className:"section-warning-message",title:h,children:e.jsx(ce,{size:10})}),t!==void 0&&e.jsxs("span",{className:`section-badge ${l==="filter"?"filter-badge":""}`,children:[l==="filter"&&e.jsx(xn,{size:8}),t,l==="filter"&&x&&e.jsx("button",{className:"clear-filter-btn",onClick:j=>{j.stopPropagation(),x()},title:"Clear filter",children:e.jsx(he,{size:8})})]})]}),!o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"section-body",children:N}),M&&!g&&e.jsx("div",{className:"section-resize-handle",onMouseDown:M,children:e.jsx(bn,{size:10})})]})]})}function Gn(s,n=12){switch(s){case"module":return e.jsx(Me,{size:n,className:"type-icon module"});case"interface":return e.jsx(Ne,{size:n,className:"type-icon interface"});case"component":return e.jsx(Fe,{size:n,className:"type-icon component"});case"parameter":return e.jsx(ns,{size:n,className:"type-icon parameter"})}}const Zn=a.memo(function s({symbol:n,depth:t,projectId:l,selection:r,onSelect:c,onBuild:h}){const[p,o]=a.useState(!1),[i,x]=a.useState(!1),m=n.children&&n.children.length>0,v=r.type==="symbol"&&r.symbolPath===n.path;return e.jsxs("div",{className:"symbol-node",children:[e.jsxs("div",{className:`symbol-row ${m?"expandable":""} ${v?"selected":""}`,style:{paddingLeft:`${t*4}px`},onClick:()=>{m&&o(!p),c({type:"symbol",projectId:l,symbolPath:n.path,label:n.name})},onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[m?e.jsx("button",{className:"tree-expand",onClick:M=>{M.stopPropagation(),o(!p)},children:p?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"tree-spacer"}),Gn(n.type),e.jsx("span",{className:"symbol-name",children:n.name}),n.hasErrors&&e.jsx("span",{className:"indicator error"}),n.hasWarnings&&!n.hasErrors&&e.jsx("span",{className:"indicator warning"}),e.jsx("button",{className:"symbol-play-btn",onClick:M=>{M.stopPropagation(),h("symbol",n.path,n.name)},title:`Build ${n.name}`,children:e.jsx(Ae,{size:10})})]}),p&&m&&e.jsx("div",{className:"symbol-children",children:n.children.map((M,N)=>e.jsx(s,{symbol:M,depth:t+1,projectId:l,selection:r,onSelect:c,onBuild:h},`${M.path}-${N}`))})]})}),is={interface:{icon:ss,color:"var(--ctp-blue)",label:"Interface"},module:{icon:Me,color:"var(--ctp-green)",label:"Module"},component:{icon:Fe,color:"var(--ctp-mauve)",label:"Component"},trait:{icon:Ne,color:"var(--ctp-yellow)",label:"Trait"},parameter:{icon:Ce,color:"var(--ctp-peach)",label:"Parameter"}};function Ie({child:s,depth:n,expandedPaths:t,onToggle:l,basePath:r=""}){const c=r?`${r}.${s.name}`:s.name,h=t.has(c),p=s.children&&s.children.length>0,o=s.itemType||"interface",i=is[o],x=i.icon,m=v=>{v.stopPropagation(),p&&l(c)};return e.jsxs("div",{className:"module-tree-node",children:[e.jsxs("div",{className:`module-tree-row ${p?"expandable":""}`,style:{paddingLeft:`${n*12+4}px`},onClick:m,children:[p?e.jsx("button",{className:"module-tree-expand-btn",onClick:m,children:h?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"module-tree-expand-spacer"}),e.jsx("span",{className:"module-tree-icon",style:{color:i.color},children:e.jsx(x,{size:12})}),e.jsx("span",{className:"module-tree-name",children:s.name}),e.jsx("span",{className:"module-tree-type",style:{color:i.color},children:s.typeName})]}),h&&p&&e.jsx("div",{className:"module-tree-children",children:s.children.map((v,M)=>e.jsx(Ie,{child:v,depth:n+1,expandedPaths:t,onToggle:l,basePath:c},`${c}-${v.name}-${M}`))})]})}function Jn({children:s,rootName:n,rootType:t}){const[l,r]=a.useState(new Set),c=h=>{r(p=>{const o=new Set(p);return o.has(h)?o.delete(h):o.add(h),o})};if(n){const p=is[t==="component"?"component":"module"],o=p.icon,i=l.has("__root__");return e.jsxs("div",{className:"module-tree",children:[e.jsxs("div",{className:"module-tree-row expandable root",onClick:()=>c("__root__"),children:[e.jsx("button",{className:"module-tree-expand-btn",children:i?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}),e.jsx("span",{className:"module-tree-icon",style:{color:p.color},children:e.jsx(o,{size:14})}),e.jsx("span",{className:"module-tree-name root-name",children:n}),e.jsx("span",{className:"module-tree-count",children:s.length})]}),i&&e.jsx("div",{className:"module-tree-children",children:s.map((x,m)=>e.jsx(Ie,{child:x,depth:1,expandedPaths:l,onToggle:c},`${x.name}-${m}`))})]})}return e.jsx("div",{className:"module-tree",children:s.map((h,p)=>e.jsx(Ie,{child:h,depth:0,expandedPaths:l,onToggle:c},`${h.name}-${p}`))})}function cs({validation:s,onApplySuggestion:n,className:t=""}){return s.isValid?null:e.jsxs("div",{className:`name-validation-dropdown ${t}`,children:[e.jsxs("div",{className:"validation-error",children:[e.jsx(de,{size:12,className:"validation-icon"}),e.jsx("span",{children:s.error})]}),s.suggestion&&e.jsxs("button",{className:"validation-suggestion",onClick:l=>{l.stopPropagation(),l.preventDefault(),n(s.suggestion)},type:"button",children:[e.jsx("span",{className:"suggestion-label",children:"Use:"}),e.jsx("code",{className:"suggestion-value",children:s.suggestion}),e.jsx(qs,{size:12,className:"suggestion-arrow"})]})]})}const et=/^[a-z][a-z0-9_-]*$/;function os(s){if(!s||s.trim()==="")return{isValid:!1,error:"Name cannot be empty",suggestion:void 0};const n=s.trim();if(et.test(n))return{isValid:!0};const t=st(n);let l="Invalid name";return/\s/.test(n)?l="Name cannot contain spaces":/^[0-9]/.test(n)?l="Name must start with a letter":/[A-Z]/.test(n)?l="Name must be lowercase":/[^a-z0-9_-]/.test(n)&&(l="Name contains invalid characters"),{isValid:!1,error:l,suggestion:t!==n?t:void 0}}function st(s){let n=s.toLowerCase().replace(/[\s_]+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-+|-+$/g,"");return/^[0-9]/.test(n)&&(n="project-"+n),n||(n="new-project"),n}function nt(){const[s,n]=a.useState(0);return a.useEffect(()=>{const t=setInterval(()=>{n(l=>l+1)},1e3);return()=>clearInterval(t)},[]),e.jsxs(e.Fragment,{children:[s,"s"]})}function tt(s){const n=Math.floor(s/3600),t=Math.floor(s%3600/60),l=Math.floor(s%60);return n>0?`${n}:${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${t}:${l.toString().padStart(2,"0")}`}function at(s){const n=s.replace(/_/g,"T").replace(/-(\d{2})-(\d{2})$/,":$1:$2");return new Date(n)}function ds(s){const n=at(s);if(isNaN(n.getTime()))return"";const l=new Date().getTime()-n.getTime(),r=Math.floor(l/1e3),c=Math.floor(r/60),h=Math.floor(c/60),p=Math.floor(h/24);return r<60?"just now":c<60?`${c}m ago`:h<24?`${h}h ago`:p===1?"yesterday":p<7?`${p}d ago`:n.toLocaleDateString()}function lt(s,n=12,t){switch(s){case"building":return e.jsx(ve,{size:n,className:"status-icon building"});case"queued":return e.jsxs("span",{className:"status-icon queued",title:t?`Queue position: ${t}`:"Queued",children:[e.jsx(qe,{size:n}),t&&e.jsx("span",{className:"queue-position",children:t})]});case"success":return e.jsx(ie,{size:n,className:"status-icon success"});case"error":return e.jsx(he,{size:n,className:"status-icon error"});case"warning":return e.jsx(ce,{size:n,className:"status-icon warning"});default:return e.jsx("div",{className:"status-dot idle"})}}function rt(s,n=12){switch(s){case"running":return e.jsx(ve,{size:n,className:"stage-icon running"});case"success":return e.jsx(ie,{size:n,className:"stage-icon success"});case"warning":return e.jsx(ce,{size:n,className:"stage-icon warning"});case"error":return e.jsx(he,{size:n,className:"stage-icon error"});case"skipped":return e.jsx(Dn,{size:n,className:"stage-icon skipped"});case"pending":default:return e.jsx(ve,{size:n,className:"stage-icon pending"})}}function us(s,n=12){switch(s){case"success":return e.jsx(ie,{size:n,className:"status-icon success dimmed"});case"warning":return e.jsx(ce,{size:n,className:"status-icon warning dimmed"});case"error":case"failed":return e.jsx(de,{size:n,className:"status-icon error dimmed"});default:return e.jsx(ve,{size:n,className:"status-icon idle dimmed"})}}const it=a.memo(function({build:n,projectId:t,projectRoot:l,selection:r,onSelect:c,onBuild:h,onCancelBuild:p,onStageFilter:o,onUpdateBuild:i,onDeleteBuild:x,onOpenSource:m,onOpenKiCad:v,onOpenLayout:M,onOpen3D:N,availableModules:g=[],allBuilds:z=[],readOnly:f=!1}){var Qe;const[C,j]=a.useState(!1),[$,B]=a.useState(!1),[S,u]=a.useState(!1),[d,F]=a.useState(n.name),[T,y]=a.useState(n.entry),[_,Q]=a.useState(""),[H,Y]=a.useState(!1),[P,O]=a.useState(null),I=a.useRef(null),[R,G]=a.useState(null),[b,A]=a.useState(!1),[k,D]=a.useState(null),[W,J]=a.useState(n.elapsedSeconds||0),Z=n.status==="building",[E,V]=a.useState(null),[L,K]=a.useState(!1);a.useEffect(()=>{if(!Z){J(n.elapsedSeconds||n.duration||0);return}J(n.elapsedSeconds||0);const w=setInterval(()=>{J(ae=>ae+1)},1e3);return()=>clearInterval(w)},[Z,n.elapsedSeconds,n.duration]);const X=20,te=()=>{if(!n.stages||n.stages.length===0)return 0;const w=n.totalStages||X;let ae=0,me=0;for(const ke of n.stages){const Ss=ke.status==="success"||ke.status==="warning"||ke.status==="error"||ke.status==="skipped",As=ke.status==="running";Ss?ae+=1:As&&(me+=.5)}const Be=(ae+me)/w*100;return Math.min(Be,100)},se=(()=>{if(n.currentStage)return n.currentStage;if(!n.stages)return null;const w=n.stages.find(ae=>ae.status==="running");return(w==null?void 0:w.displayName)||(w==null?void 0:w.name)||null})();a.useEffect(()=>{if(se&&se!==E){K(!0),V(se);const w=setTimeout(()=>K(!1),300);return()=>clearTimeout(w)}},[se,E]);const fe=g.filter(w=>w.type==="module"||w.type==="component").filter(w=>{if(!_)return!0;const ae=_.toLowerCase();return w.name.toLowerCase().includes(ae)||w.entry.toLowerCase().includes(ae)||w.file.toLowerCase().includes(ae)});a.useEffect(()=>{S&&I.current&&I.current.focus()},[S]);const oe=r.type==="build"&&r.buildId===`${t}:${n.id}`;a.useEffect(()=>{!oe||R!==null||b||!l||!n.entry||(A(!0),D(null),xe("getModuleChildren",{projectRoot:l,entryPoint:n.entry,maxDepth:3}).then(w=>{const ae=w.result??{},me=Array.isArray(ae.children)?ae.children:[];G(me),A(!1)}).catch(w=>{console.warn("Failed to fetch module children:",w),D(w.message||"Failed to load module structure"),A(!1)}))},[oe,R,b,l,n.entry,n.name]);const ze=a.useMemo(()=>os(d),[d]),_e=()=>{ze.isValid&&(B(!1),i&&i(t,n.id,{name:d}))},Ns=w=>{F(w)},vs=w=>{Q(w)},De=w=>{const ae=z.find(me=>me.id!==n.id&&me.entry===w.entry);if(ae){O({entry:w.entry,usedBy:ae.name});return}O(null),y(w.entry),u(!1),Q(""),i&&i(t,n.id,{entry:w.entry})},ys=()=>{P&&(y(P.entry),u(!1),Q(""),O(null),i&&i(t,n.id,{entry:P.entry}))},bs=()=>{O(null)},He=R&&R.length>0,ks=n.symbols&&n.symbols.length>0,ws=n.stages&&n.stages.length>0,Cs=((Qe=n.entry)==null?void 0:Qe.split(":").pop())||n.name;return e.jsxs("div",{className:`build-card ${oe?"selected":""} ${Z?"building":""}`,onClick:w=>{w.stopPropagation(),c({type:"build",projectId:t,buildId:`${t}:${n.id}`,label:`${n.name}`})},children:[e.jsxs("div",{className:"build-card-header",onClick:w=>{oe&&(w.stopPropagation(),c({type:"none"}))},children:[e.jsxs("div",{className:"build-header-left",children:[f?e.jsx("div",{className:"build-status-icon",children:e.jsx(ve,{size:8,className:"status-icon idle"})}):e.jsx("div",{className:"build-status-icon",children:lt(n.status,12,n.queuePosition)}),$&&oe&&!f?e.jsxs("div",{className:"name-input-wrapper",onClick:w=>w.stopPropagation(),children:[e.jsx("input",{type:"text",className:`build-name-input ${ze.isValid?"":"invalid"}`,value:d,onChange:w=>F(w.target.value),onBlur:()=>{ze.isValid&&_e()},onKeyDown:w=>{w.key==="Enter"&&_e(),w.key==="Escape"&&(F(n.name),B(!1))},autoFocus:!0}),e.jsx(cs,{validation:ze,onApplySuggestion:Ns})]}):e.jsx("span",{className:`build-card-name ${oe&&!f?"editable":""}`,onClick:oe&&!f?w=>{w.stopPropagation(),B(!0)}:void 0,title:oe&&!f?"Click to edit build name":void 0,children:d}),!f&&Z&&se&&e.jsx("span",{className:`build-inline-stage ${L?"animating":""}`,children:se})]}),e.jsx("div",{className:"build-header-right",children:!f&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"build-indicators",children:[Z&&e.jsx("span",{className:"build-elapsed-time-inline",children:tt(W)}),!Z&&e.jsxs(e.Fragment,{children:[n.errors!==void 0&&n.errors>0&&e.jsxs("span",{className:"error-indicator clickable",onClick:w=>{w.stopPropagation(),o==null||o("",n.id,t)},title:"Click to filter problems for this build",children:[e.jsx(de,{size:12}),e.jsx("span",{children:n.errors})]}),n.warnings!==void 0&&n.warnings>0&&e.jsxs("span",{className:"warning-indicator clickable",onClick:w=>{w.stopPropagation(),o==null||o("",n.id,t)},title:"Click to filter problems for this build",children:[e.jsx(ce,{size:12}),e.jsx("span",{children:n.warnings})]}),n.duration?e.jsxs("span",{className:"build-duration",children:[n.duration.toFixed(1),"s"]}):n.lastBuild?e.jsxs("span",{className:"last-build-info",title:`Last build: ${n.lastBuild.status}`,children:[us(n.lastBuild.status,10),e.jsx("span",{className:"last-build-time",children:ds(n.lastBuild.timestamp)})]}):null]})]}),Z?e.jsx("button",{className:"build-target-cancel-btn",onClick:w=>{w.stopPropagation(),n.buildId&&p&&p(n.buildId)},title:`Cancel build ${n.name}`,children:e.jsx(rs,{size:10,fill:"currentColor"})}):oe?e.jsx("button",{className:"build-target-delete-btn",onClick:w=>{w.stopPropagation(),Y(!0)},title:`Delete build ${n.name}`,children:e.jsx(On,{size:12})}):e.jsx("button",{className:"build-target-play-btn",onClick:w=>{w.stopPropagation(),h("build",`${t}:${n.id}`,n.name)},title:`Build ${n.name}`,children:e.jsx(Ae,{size:12})})]})})]}),!f&&H&&e.jsxs("div",{className:"build-delete-confirm",onClick:w=>w.stopPropagation(),children:[e.jsxs("span",{className:"delete-confirm-text",children:['Delete "',n.name,'"?']}),e.jsxs("div",{className:"delete-confirm-buttons",children:[e.jsx("button",{className:"delete-confirm-btn cancel",onClick:()=>Y(!1),children:"Cancel"}),e.jsx("button",{className:"delete-confirm-btn confirm",onClick:()=>{Y(!1),x==null||x(t,n.id)},children:"Delete"})]})]}),P&&e.jsxs("div",{className:"build-duplicate-warning",onClick:w=>w.stopPropagation(),children:[e.jsx("div",{className:"duplicate-warning-icon",children:e.jsx(ce,{size:16})}),e.jsxs("span",{className:"duplicate-warning-text",children:['This entry point is already used by "',P.usedBy,'"']}),e.jsxs("div",{className:"duplicate-warning-buttons",children:[e.jsx("button",{className:"duplicate-warning-btn cancel",onClick:bs,children:"Cancel"}),e.jsx("button",{className:"duplicate-warning-btn confirm",onClick:ys,children:"Use Anyway"})]})]}),!f&&Z&&e.jsx("div",{className:"build-progress-container",children:e.jsx("div",{className:"build-progress-bar",children:e.jsx("div",{className:"build-progress-fill",style:{width:`${te()}%`}})})}),oe&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"build-card-entry-row",children:[e.jsx(ye,{size:12}),S?e.jsxs("div",{className:"entry-picker",onClick:w=>w.stopPropagation(),children:[e.jsxs("div",{className:"entry-search-box",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:I,type:"text",className:"entry-search-input",value:_,onChange:w=>vs(w.target.value),onKeyDown:w=>{w.key==="Escape"&&(Q(""),u(!1),O(null)),w.key==="Enter"&&fe.length===1&&De(fe[0])},placeholder:"Search modules..."}),e.jsx("button",{className:"entry-close-btn",onClick:()=>{Q(""),u(!1),O(null)},children:e.jsx(he,{size:10})})]}),e.jsx("div",{className:"entry-dropdown",children:fe.length>0?fe.map(w=>e.jsxs("div",{className:`entry-option ${w.entry===T?"selected":""}`,onClick:()=>De(w),children:[e.jsx(Me,{size:10,className:`module-type-icon ${w.type}`}),e.jsx("span",{className:"entry-option-name",children:w.name}),e.jsx("span",{className:"entry-option-file",children:w.file})]},w.entry)):g.length===0?e.jsx("div",{className:"entry-empty",children:e.jsx("span",{children:"No modules found in project"})}):e.jsx("div",{className:"entry-empty",children:e.jsxs("span",{children:['No matching modules for "',_,'"']})})})]}):e.jsx("span",{className:"entry-path editable",onClick:w=>{w.stopPropagation(),u(!0),Q("")},title:"Click to change entry point",children:T}),n.duration&&e.jsxs("span",{className:"build-duration",children:[e.jsx(qe,{size:10}),n.duration.toFixed(1),"s"]})]}),ws&&e.jsxs("div",{className:"build-stages-section",children:[e.jsxs("button",{className:"stages-toggle",onClick:w=>{w.stopPropagation(),j(!C)},children:[C?e.jsx(ee,{size:12}):e.jsx(re,{size:12}),e.jsx("span",{children:"Build Stages"}),e.jsxs("span",{className:"stages-summary",children:[n.stages.filter(w=>w.status==="success").length,"/",n.stages.length," complete"]})]}),C&&e.jsx("div",{className:"build-stages-list",children:n.stages.map(w=>{const ae=(w.status==="warning"||w.status==="error")&&o,me=w.duration??w.elapsedSeconds;return e.jsxs("div",{className:`stage-row ${w.status} ${ae?"clickable":""}`,onClick:ae?Be=>{Be.stopPropagation(),o(w.name,n.id,t)}:void 0,title:ae?`Filter problems to ${w.displayName||w.name} stage`:void 0,children:[rt(w.status),e.jsx("span",{className:"stage-name",children:w.displayName||w.name}),w.message&&e.jsx("span",{className:"stage-message",children:w.message}),e.jsx("span",{className:"stage-duration",children:w.status==="running"?e.jsx(nt,{}):me!=null?`${me.toFixed(1)}s`:""})]},w.name)})})]}),e.jsxs("div",{className:"build-card-actions",children:[e.jsxs("button",{className:"build-action-btn primary",onClick:w=>{w.stopPropagation(),h("build",`${t}:${n.id}`,n.name)},title:`Build ${n.name}`,children:[e.jsx(Ae,{size:12}),e.jsx("span",{children:"Build"})]}),e.jsxs("button",{className:"build-action-btn",onClick:w=>{w.stopPropagation(),m==null||m(t,n.entry)},title:"Open Source Code",children:[e.jsx(ye,{size:12}),e.jsx("span",{children:"ato"})]}),e.jsxs("button",{className:"build-action-btn",onClick:w=>{w.stopPropagation(),v==null||v(t,n.id)},title:"Open in KiCad",children:[e.jsx(vn,{size:12}),e.jsx("span",{children:"KiCad"})]}),e.jsxs("button",{className:"build-action-btn",onClick:w=>{w.stopPropagation(),M==null||M(t,n.id)},title:"Edit Layout",children:[e.jsx(Pn,{size:12}),e.jsx("span",{children:"Layout"})]}),e.jsxs("button",{className:"build-action-btn",onClick:w=>{w.stopPropagation(),N==null||N(t,n.id)},title:"3D Preview",children:[e.jsx(rn,{size:12}),e.jsx("span",{children:"3D"})]})]}),b&&e.jsxs("div",{className:"build-card-symbols loading",children:[e.jsx(ve,{size:12,className:"spinner"}),e.jsx("span",{className:"loading-text",children:"Loading module structure..."})]}),k&&e.jsx("div",{className:"build-card-symbols error",children:e.jsxs("span",{className:"error-text",children:["Failed to load: ",k]})}),!b&&!k&&He&&e.jsx("div",{className:"build-card-symbols",children:e.jsx(Jn,{children:R,rootName:Cs})}),!b&&!k&&!He&&ks&&n.symbols[0]&&e.jsx("div",{className:"build-card-symbols",children:e.jsx(Zn,{symbol:n.symbols[0],depth:0,projectId:t,selection:r,onSelect:c,onBuild:h},n.symbols[0].path)})]})]})});function hs({builds:s,projectId:n,projectRoot:t,selection:l,onSelect:r,onBuild:c,onCancelBuild:h,onStageFilter:p,onUpdateBuild:o,onDeleteBuild:i,onOpenSource:x,onOpenKiCad:m,onOpenLayout:v,onOpen3D:M,onAddBuild:N,availableModules:g=[],readOnly:z=!1}){const[f,C]=a.useState(!0),j=s.filter(T=>T.status==="building").length,$=s.filter(T=>T.status==="queued").length,B=s.filter(T=>T.status==="error").length,S=s.filter(T=>T.status==="warning").length,u=s.filter(T=>T.status==="success").length,d=s.filter(T=>T.status==="idle").length,F=!z&&(j>0||$>0||B>0||S>0||u>0);return e.jsxs("div",{className:"builds-card",onClick:T=>T.stopPropagation(),children:[e.jsxs("div",{className:"builds-card-header",onClick:T=>{T.stopPropagation(),C(!f)},children:[e.jsx("span",{className:"builds-card-expand",children:e.jsx(ee,{size:12,className:`expand-icon ${f?"expanded":""}`})}),e.jsx(wn,{size:14,className:"builds-card-icon"}),e.jsx("span",{className:"builds-card-title",children:"Builds"}),z?e.jsx("span",{className:"builds-count",children:s.length}):e.jsxs(e.Fragment,{children:[j>0&&e.jsx("span",{className:"builds-status-badge building",title:`${j} building`,children:j}),$>0&&e.jsx("span",{className:"builds-status-badge queued",title:`${$} queued`,children:$}),B>0&&e.jsx("span",{className:"builds-status-badge error",title:`${B} failed`,children:B}),S>0&&e.jsx("span",{className:"builds-status-badge warning",title:`${S} warnings`,children:S}),u>0&&e.jsx("span",{className:"builds-status-badge success",title:`${u} passed`,children:u}),!F&&d>0&&e.jsx("span",{className:"builds-count",children:d})]})]}),f&&e.jsxs("div",{className:"builds-card-content",children:[s.map((T,y)=>e.jsx(it,{build:T,projectId:n,projectRoot:t,selection:l,onSelect:r,onBuild:c,onCancelBuild:h,onStageFilter:p,onUpdateBuild:o,onDeleteBuild:i,onOpenSource:x,onOpenKiCad:m,onOpenLayout:v,onOpen3D:M,availableModules:g,allBuilds:s,readOnly:z},`${T.id}-${y}`)),!z&&e.jsxs("button",{className:"add-build-btn",onClick:T=>{T.stopPropagation(),N==null||N(n)},title:"Add new build target",children:[e.jsx(ls,{size:12}),e.jsx("span",{children:"Add build"})]})]})]})}function ct({dependency:s,availableVersions:n=[],onVersionChange:t,onRemove:l,readOnly:r=!1}){const[c,h]=a.useState(s.version),[p,o]=a.useState(!1),i=!r&&(s.hasUpdate||s.latestVersion&&s.version!==s.latestVersion),x=n.length>0?n:s.latestVersion&&s.latestVersion!==s.version?[s.latestVersion,s.version]:[s.version],m=v=>{h(v),t==null||t(s.identifier,v)};return e.jsxs("div",{className:`dependency-item ${i?"has-update":""}`,children:[e.jsxs("div",{className:"dependency-info",children:[e.jsx(be,{size:14,className:"dependency-icon"}),e.jsx("span",{className:"dependency-name",title:s.identifier,children:s.name}),s.publisher&&s.publisher!=="atopile"&&e.jsxs("span",{className:"dependency-publisher",children:["by ",s.publisher]})]}),e.jsxs("div",{className:"dependency-actions",children:[r?e.jsx("span",{className:"dependency-version-display",title:`Version ${s.version}`,children:s.version}):e.jsx("select",{className:`dependency-version-select ${i?"update-available":""}`,value:c,onChange:v=>{v.stopPropagation(),m(v.target.value)},onClick:v=>v.stopPropagation(),title:i?`Update available: ${s.latestVersion}`:`Version ${s.version}`,children:x.map((v,M)=>e.jsxs("option",{value:v,children:[v,M===0&&i&&v===s.latestVersion?" (latest)":""]},v))}),!r&&e.jsx("button",{className:`dependency-remove-btn ${p?"removing":""}`,onClick:v=>{v.stopPropagation(),p||(o(!0),l==null||l(s.identifier))},disabled:p,title:p?"Removing...":`Remove ${s.name}`,children:p?e.jsx(ge,{size:12,className:"spin"}):e.jsx(he,{size:12})})]})]})}function ms({dependencies:s,projectId:n,onVersionChange:t,onRemove:l,readOnly:r=!1}){const[c,h]=a.useState(!1);return!s||s.length===0?null:e.jsxs("div",{className:"dependency-card",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"dependency-card-header",onClick:p=>{p.stopPropagation(),h(!c)},children:[e.jsx("span",{className:"dependency-card-expand",children:e.jsx(ee,{size:12,className:`expand-icon ${c?"expanded":""}`})}),e.jsx(be,{size:14,className:"dependency-card-icon"}),e.jsx("span",{className:"dependency-card-title",children:"Dependencies"}),e.jsx("span",{className:"dependency-count",children:s.length})]}),c&&e.jsx("div",{className:"dependency-card-content",children:s.map(p=>e.jsx(ct,{dependency:p,onVersionChange:(o,i)=>t==null?void 0:t(n,o,i),onRemove:o=>l==null?void 0:l(n,o),readOnly:r},p.identifier))})]})}function ot(s,n=12){switch(s){case"ato":return e.jsx(ye,{size:n,className:"file-icon ato"});case"py":return e.jsx(Ye,{size:n,className:"file-icon python"});default:return e.jsx(Ye,{size:n,className:"file-icon"})}}const dt=a.memo(function s({node:n,depth:t,onFileClick:l,defaultExpanded:r=!1}){const[c,h]=a.useState(r),p=n.type==="folder",o=p&&n.children&&n.children.length>0;return e.jsxs("div",{className:"file-tree-node",children:[e.jsxs("div",{className:`file-tree-row ${p?"folder":"file"} ${n.extension||""}`,style:{paddingLeft:`${t*12+4}px`},onClick:i=>{i.stopPropagation(),p?h(!c):l&&l(n.path)},children:[p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"file-tree-expand",children:c?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}),c?e.jsx($e,{size:14,className:"folder-icon open"}):e.jsx(as,{size:14,className:"folder-icon"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"file-tree-spacer"}),ot(n.extension,14)]}),e.jsx("span",{className:"file-tree-name",children:n.name})]}),c&&o&&e.jsx("div",{className:"file-tree-children",children:[...n.children].sort((i,x)=>i.type==="file"&&x.type==="folder"?-1:i.type==="folder"&&x.type==="file"?1:i.name.localeCompare(x.name)).map(i=>e.jsx(s,{node:i,depth:t+1,onFileClick:l,defaultExpanded:!1},i.path))})]})});function ps(s){let n=0;for(const t of s)t.type==="file"?n++:t.children&&(n+=ps(t.children));return n}const xs=a.memo(function({files:n,onFileClick:t}){const[l,r]=a.useState(!1);if(!n||n.length===0)return null;const c=[...n].sort((p,o)=>p.type==="file"&&o.type==="folder"?-1:p.type==="folder"&&o.type==="file"?1:p.name.localeCompare(o.name)),h=ps(n);return e.jsxs("div",{className:"file-explorer-card",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"file-explorer-card-header",onClick:p=>{p.stopPropagation(),r(!l)},children:[e.jsx("span",{className:"file-explorer-card-expand",children:e.jsx(ee,{size:12,className:`expand-icon ${l?"expanded":""}`})}),e.jsx(as,{size:14,className:"file-explorer-card-icon"}),e.jsx("span",{className:"file-explorer-card-title",children:"Files"}),e.jsx("span",{className:"file-count",children:h})]}),l&&e.jsx("div",{className:"file-explorer-card-content",children:c.map(p=>e.jsx(dt,{node:p,depth:0,onFileClick:t,defaultExpanded:!1},p.path))})]})});function ut(s){return s==null?"0":s>=1e6?(s/1e6).toFixed(1).replace(/\.0$/,"")+"M":s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"k":s.toString()}function ht(s,n){if(!(s.installedIn||[]).some(c=>c===n||c.endsWith(`/${n}`)||n.endsWith(c)))return{installed:!1};const r=s.latestVersion&&s.version&&s.version!==s.latestVersion;return{installed:!0,version:s.version,needsUpdate:!!r,latestVersion:s.latestVersion}}function mt({versions:s,selectedVersion:n,onVersionChange:t,latestVersion:l}){const[r,c]=a.useState(!1),h=a.useRef(null);a.useEffect(()=>{function x(m){h.current&&!h.current.contains(m.target)&&c(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const p=s.filter(x=>x&&x!=="unknown");if(p.length===0)return null;const i=(n&&n!=="unknown"?n:null)||p[0]||"";return e.jsxs("div",{className:"version-selector",ref:h,children:[e.jsxs("button",{className:"version-selector-btn",onClick:x=>{x.stopPropagation(),c(!r)},title:"Select version",children:[e.jsx("span",{className:"version-selector-value",children:i}),e.jsx(ee,{size:10})]}),r&&e.jsx("div",{className:"version-selector-menu",children:p.map(x=>e.jsxs("button",{className:`version-option ${x===n?"selected":""}`,onClick:m=>{m.stopPropagation(),t(x),c(!1)},children:[e.jsx("span",{children:x}),x===l&&e.jsx("span",{className:"latest-tag",children:"latest"}),x===n&&e.jsx(ie,{size:12,className:"selected-check"})]},x))})]})}function pt({availableProjects:s,selectedProjectId:n,onSelect:t}){const[l,r]=a.useState(!1),[c,h]=a.useState(""),p=a.useRef(null),o=a.useRef(null);a.useEffect(()=>{function m(v){p.current&&!p.current.contains(v.target)&&(r(!1),h(""))}return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]),a.useEffect(()=>{l&&s.length>5&&o.current&&o.current.focus()},[l,s.length]);const i=s.find(m=>m.id===n),x=(i==null?void 0:i.name)||"project";return e.jsxs("div",{className:"project-selector",ref:p,children:[e.jsxs("button",{className:"project-selector-btn",onClick:m=>{m.stopPropagation(),r(!l)},title:`Install to: ${i==null?void 0:i.name}`,children:[e.jsx("span",{className:"project-selector-name",children:x}),e.jsx(ee,{size:10})]}),l&&e.jsxs("div",{className:"project-selector-menu",children:[e.jsx("div",{className:"dropdown-header",children:"Install to:"}),s.length>5&&e.jsxs("div",{className:"dropdown-search",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:o,type:"text",placeholder:"Filter projects...",value:c,onChange:m=>h(m.target.value),onClick:m=>m.stopPropagation()})]}),e.jsxs("div",{className:"dropdown-items",children:[s.filter(m=>m.name.toLowerCase().includes(c.toLowerCase())).map(m=>e.jsxs("button",{className:`dropdown-item ${m.id===n?"selected":""}`,onClick:v=>{v.stopPropagation(),t(m.id),r(!1)},children:[e.jsx(Se,{size:12}),e.jsx("span",{children:m.name}),m.id===n&&e.jsx(ie,{size:12,className:"selected-check"})]},m.id)),s.filter(m=>m.name.toLowerCase().includes(c.toLowerCase())).length===0&&e.jsxs("div",{className:"dropdown-empty",children:['No projects match "',c,'"']})]})]})]})}const xt=a.memo(function({project:n,selection:t,onSelect:l,onBuild:r,onCancelBuild:c,onStageFilter:h,onOpenPackageDetail:p,onInstall:o,onOpenSource:i,onOpenKiCad:x,onOpenLayout:m,onOpen3D:v,availableProjects:M,isInstalling:N=!1}){var b;const[g,z]=a.useState(!1),[f,C]=a.useState(!1),[j,$]=a.useState(()=>{const A=n.version&&n.version!=="unknown"?n.version:null,k=n.latestVersion&&n.latestVersion!=="unknown"?n.latestVersion:null;return A||k||""}),[B,S]=a.useState(()=>{var A,k;return((A=M.find(D=>D.isActive))==null?void 0:A.id)||((k=M[0])==null?void 0:k.id)||""}),[u,d]=a.useState(null),[F,T]=a.useState(!1),[y,_]=a.useState(null),Q=t.type==="project"&&t.projectId===n.id,H=M.find(A=>A.id===B),Y=ht(n,(H==null?void 0:H.path)||B);a.useEffect(()=>{g&&!u&&!F&&(T(!0),_(null),xe("getPackageDetails",{packageId:n.id}).then(A=>{var W;const D=(A.result??{}).details;D?(d(D),((W=D.versions)==null?void 0:W.length)>0&&!j&&$(D.versions[0].version)):_("Failed to load package details")}).catch(A=>{_(A.message||"Failed to load package details")}).finally(()=>{T(!1)}))},[g,u,F,n.id,j]);const P=A=>{A.stopPropagation(),o(n.id,B,j||void 0)},I=(((b=u==null?void 0:u.versions)==null?void 0:b.map(A=>A.version))||(n.latestVersion&&n.version&&n.latestVersion!==n.version?[n.latestVersion,n.version]:n.version?[n.version]:n.latestVersion?[n.latestVersion]:[])).filter(A=>A&&A!=="unknown"),R=((u==null?void 0:u.dependencies)||[]).map(A=>{const k=A.identifier.split("/"),D=k.length===2?k[0]:"unknown",W=k.length===2?k[1]:A.identifier;return{identifier:A.identifier,version:A.version||"latest",name:W,publisher:D}}),G=[];return e.jsxs("div",{className:`package-card ${Q?"selected":""} ${g?"expanded":""}`,onClick:()=>{Q?(z(!1),C(!1),l({type:"none"})):(z(!0),l({type:"project",projectId:n.id,label:n.name}))},children:[e.jsxs("div",{className:"package-card-header",children:[e.jsx("span",{className:"tree-expand",children:g?e.jsx(ee,{size:14}):e.jsx(re,{size:14})}),e.jsx(be,{size:16,className:"package-icon"}),e.jsx("span",{className:"package-name",children:n.name}),n.publisher&&e.jsx("span",{className:`package-publisher-tag ${n.publisher==="atopile"?"official":""}`,children:n.publisher.toLowerCase()}),n.homepage&&e.jsx("a",{href:n.homepage,className:"package-external-link",target:"_blank",rel:"noopener noreferrer",title:"Open homepage",onClick:A=>A.stopPropagation(),children:e.jsx(we,{size:12})})]}),(n.summary||n.description)&&e.jsx("div",{className:`package-card-description ${g?"":"clamped"} ${g&&!f?"clamped":""}`,onClick:A=>{g&&(A.stopPropagation(),C(!f))},children:g&&n.description||n.summary}),e.jsxs("div",{className:"package-install-bar",onClick:A=>A.stopPropagation(),children:[e.jsx(pt,{availableProjects:M,selectedProjectId:B,onSelect:S}),I.length>0&&e.jsx(mt,{versions:I,selectedVersion:j,onVersionChange:$,latestVersion:n.latestVersion}),e.jsx("button",{className:`install-btn ${N?"installing":""} ${Y.installed?Y.needsUpdate?"update-available":"installed":""}`,onClick:P,disabled:N,title:N?"Installing...":Y.needsUpdate?`Update to ${j} in ${H==null?void 0:H.name}`:Y.installed?`Installed in ${H==null?void 0:H.name}`:`Install ${j} to ${H==null?void 0:H.name}`,children:N?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:14,className:"spin"}),e.jsx("span",{children:"Installing..."})]}):Y.installed?Y.needsUpdate?e.jsxs(e.Fragment,{children:[e.jsx(Os,{size:14}),e.jsx("span",{children:"Update"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:14}),e.jsx("span",{children:"Installed"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:14}),e.jsx("span",{children:"Install"})]})})]}),g&&e.jsxs("div",{className:"package-expanded-content",children:[n.builds.length>0&&e.jsx(hs,{builds:n.builds,projectId:n.id,projectRoot:n.root||"",selection:t,onSelect:l,onBuild:r,onCancelBuild:c,onStageFilter:h,onOpenSource:i,onOpenKiCad:x,onOpenLayout:m,onOpen3D:v,readOnly:!0}),F&&e.jsxs("div",{className:"package-loading",children:[e.jsx(ge,{size:16,className:"spin"}),e.jsx("span",{children:"Loading package details..."})]}),y&&e.jsx("div",{className:"package-error",children:e.jsxs("span",{children:["Failed to load details: ",y]})}),u&&!F&&e.jsxs("div",{className:"package-meta-bar",children:[u.downloads!==void 0&&u.downloads>0&&e.jsxs("span",{className:"meta-item",children:[e.jsx(Pe,{size:11}),ut(u.downloads)]}),u.versionCount>0&&e.jsxs("span",{className:"meta-item",children:[u.versionCount," versions"]}),u.license&&e.jsx("span",{className:"meta-item",children:u.license})]}),u&&R.length>0&&e.jsx(ms,{dependencies:R,projectId:n.id,readOnly:!0}),u&&G.length>0&&e.jsx(xs,{files:G,onFileClick:A=>i==null?void 0:i(n.id,A)})]})]})}),gt=a.memo(function({project:n,selection:t,onSelect:l,onBuild:r,onCancelBuild:c,onStageFilter:h,onOpenPackageDetail:p,isExpanded:o,onExpandChange:i,onUpdateProject:x,onAddBuild:m,onUpdateBuild:v,onDeleteBuild:M,onProjectExpand:N,onOpenSource:g,onOpenKiCad:z,onOpenLayout:f,onOpen3D:C,onFileClick:j,onDependencyVersionChange:$,onRemoveDependency:B,availableModules:S=[],projectFiles:u=[],projectDependencies:d=[]}){const F=o,[T,y]=a.useState(!1),[_,Q]=a.useState(!1),[H,Y]=a.useState(n.name),[P,O]=a.useState(n.summary||""),I=t.type==="project"&&t.projectId===n.id,R=n.builds.reduce((q,se)=>q+(se.errors||0),0),G=n.builds.reduce((q,se)=>q+(se.warnings||0),0),b=n.builds.some(q=>q.status==="building"),A=n.builds.filter(q=>q.status==="building"),k=A.length>0?Math.max(...A.map(q=>q.elapsedSeconds||0)):0,[D,W]=a.useState(k);a.useEffect(()=>{if(!b){W(0);return}W(k);const q=setInterval(()=>{W(se=>se+1)},1e3);return()=>clearInterval(q)},[b,k]);const J=q=>{const se=Math.floor(q/3600),fe=Math.floor(q%3600/60),oe=Math.floor(q%60);return se>0?`${se}:${fe.toString().padStart(2,"0")}:${oe.toString().padStart(2,"0")}`:`${fe}:${oe.toString().padStart(2,"0")}`},Z="A new atopile project!",E=P||Z,V=!P,L=a.useMemo(()=>os(H),[H]),K=()=>{L.isValid&&(y(!1),x&&x(n.id,{name:H}),console.log("Saving name:",H))},X=q=>{Y(q)},te=()=>{Q(!1),x&&x(n.id,{summary:P}),console.log("Saving description:",P)};return e.jsxs("div",{className:`project-card ${I?"selected":""} ${F?"expanded":"collapsed"} ${b?"building":""}`,onClick:()=>{const q=!F;i(n.id,q),l({type:"project",projectId:n.id,label:n.name}),q&&N&&N(n.root)},children:[e.jsxs("div",{className:"project-card-name-row",children:[e.jsx("span",{className:"tree-expand",children:F?e.jsx(ee,{size:14}):e.jsx(re,{size:14})}),e.jsx(Se,{size:18,className:"project-icon"}),T&&F?e.jsxs("div",{className:"name-input-wrapper",onClick:q=>q.stopPropagation(),children:[e.jsx("input",{type:"text",className:`project-name-input ${L.isValid?"":"invalid"}`,value:H,onChange:q=>Y(q.target.value),onBlur:()=>{L.isValid&&K()},onKeyDown:q=>{q.key==="Enter"&&K(),q.key==="Escape"&&(Y(n.name),y(!1))},autoFocus:!0}),e.jsx(cs,{validation:L,onApplySuggestion:X})]}):e.jsx("span",{className:`project-card-name ${F?"editable":""}`,onClick:F?q=>{q.stopPropagation(),y(!0)}:void 0,title:F?"Click to edit name":void 0,children:H}),e.jsxs("div",{className:"project-card-actions-row",children:[e.jsxs("div",{className:"project-indicators",children:[b&&e.jsx("span",{className:"build-time-indicator",title:"Build time",children:e.jsx("span",{className:"build-time",children:J(D)})}),!b&&e.jsxs(e.Fragment,{children:[R>0&&e.jsxs("span",{className:"error-indicator",children:[e.jsx(de,{size:12}),e.jsx("span",{children:R})]}),G>0&&e.jsxs("span",{className:"warning-indicator",children:[e.jsx(ce,{size:12}),e.jsx("span",{children:G})]}),n.lastBuildTimestamp&&e.jsxs("span",{className:"last-build-info",title:`Last build: ${n.lastBuildStatus||"unknown"}`,children:[n.lastBuildStatus&&us(n.lastBuildStatus,10),e.jsx("span",{className:"last-build-time",children:ds(n.lastBuildTimestamp)})]})]})]}),b?e.jsx("button",{className:"project-build-btn-icon stop",onClick:q=>{q.stopPropagation(),n.builds.filter(se=>se.status==="building"&&se.buildId).forEach(se=>c==null?void 0:c(se.buildId))},title:`Stop all builds in ${n.name}`,children:e.jsx(rs,{size:12,fill:"currentColor"})}):e.jsx("button",{className:"project-build-btn-icon",onClick:q=>{q.stopPropagation(),r("project",n.id,n.name)},title:`Build all targets in ${n.name}`,children:e.jsx(Ae,{size:14,fill:"currentColor"})})]})]}),F&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"project-card-description",children:_?e.jsx("input",{type:"text",className:"description-input",value:P,placeholder:Z,onChange:q=>O(q.target.value),onBlur:te,onKeyDown:q=>{q.key==="Enter"&&te(),q.key==="Escape"&&(O(n.summary||""),Q(!1))},autoFocus:!0,onClick:q=>q.stopPropagation()}):e.jsx("span",{className:`description-text ${V?"placeholder":""}`,onClick:q=>{q.stopPropagation(),Q(!0)},title:"Click to edit description",children:E})}),e.jsx(hs,{builds:n.builds,projectId:n.id,projectRoot:n.root,selection:t,onSelect:l,onBuild:r,onCancelBuild:c,onStageFilter:h,onUpdateBuild:v,onDeleteBuild:M,onOpenSource:g,onOpenKiCad:z,onOpenLayout:f,onOpen3D:C,onAddBuild:m,availableModules:S}),e.jsx(xs,{files:u,onFileClick:j?q=>j(n.id,q):void 0}),e.jsx(ms,{dependencies:d,projectId:n.id,onVersionChange:$,onRemove:B})]})]})});function We({selection:s,onSelect:n,onBuild:t,onCancelBuild:l,onStageFilter:r,onOpenPackageDetail:c,onPackageInstall:h,onCreateProject:p,onProjectExpand:o,onOpenSource:i,onOpenKiCad:x,onOpenLayout:m,onOpen3D:v,onFileClick:M,onDependencyVersionChange:N,onRemoveDependency:g,onAddBuild:z,onUpdateBuild:f,onDeleteBuild:C,filterType:j="all",projects:$,projectModules:B={},projectFiles:S={},projectDependencies:u={},installingPackageIds:d=[]}){const[F,T]=a.useState(""),[y,_]=a.useState(null),Q=$&&$.length>0?$:[],H=()=>{if(p){p();return}console.warn("Create project handler not provided")},Y=(k,D)=>{console.warn("Update project handler not provided",k,D)},P=k=>{if(z){z(k);return}console.warn("Add build handler not provided",k)},O=(k,D,W)=>{if(f){f(k,D,W);return}console.warn("Update build handler not provided",k,D,W)},I=(k,D)=>{if(C){C(k,D);return}console.warn("Delete build handler not provided",k,D),s.type==="build"&&s.buildId===`${k}:${D}`&&n({type:"none"})},R=Q.filter(k=>k.type==="project").map((k,D)=>({id:k.id,name:k.name,path:k.root,isActive:D===0})),G=(k,D,W)=>{if(console.log(`Installing ${k} to ${D}${W?` @ ${W}`:""}`),h){const J=Q.find(E=>E.id===D),Z=(J==null?void 0:J.root)||D;h(k,Z,W)}else alert(`Installing ${k} to ${D}`)},b=Q.filter(k=>{if(j==="projects"&&k.type!=="project"||j==="packages"&&k.type!=="package")return!1;if(F){const D=F.toLowerCase();return[k.name,k.id,k.publisher||"",k.description||"",k.summary||"",...k.keywords||[]].join(" ").toLowerCase().includes(D)}return!0}),A=j==="packages"?'Search packages (e.g. "regulator", "sensor")...':"Search projects...";return e.jsxs("div",{className:"projects-panel",children:[e.jsxs("div",{className:"projects-toolbar",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:A,value:F,onChange:k=>{T(k.target.value),k.target.value&&(s.type!=="none"&&n({type:"none"}),y!==null&&_(null))}})]}),j==="projects"&&e.jsx("button",{className:"add-project-btn",onClick:H,title:"Create new project",children:e.jsx(ls,{size:14})})]}),e.jsxs("div",{className:"projects-tree",children:[b.filter(k=>j==="projects"&&y!==null?k.id===y:!0).map(k=>k.type==="package"?e.jsx(xt,{project:k,selection:s,onSelect:n,onBuild:t,onCancelBuild:l,onStageFilter:r,onOpenPackageDetail:c,onInstall:G,onOpenSource:i,onOpenKiCad:x,onOpenLayout:m,onOpen3D:v,availableProjects:R,isInstalling:d.includes(k.id)},k.id):e.jsx(gt,{project:k,selection:s,onSelect:n,onBuild:t,onCancelBuild:l,onStageFilter:r,onOpenPackageDetail:c,isExpanded:y===k.id,onExpandChange:(D,W)=>{_(W?D:null)},onUpdateProject:Y,onAddBuild:P,onUpdateBuild:O,onDeleteBuild:I,onProjectExpand:o,onOpenSource:i,onOpenKiCad:x,onOpenLayout:m,onOpen3D:v,onFileClick:M,onDependencyVersionChange:N,onRemoveDependency:g,availableModules:B[k.root]||[],projectFiles:S[k.root]||[],projectDependencies:u[k.root]||[]},k.id)),b.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsxs("span",{children:["No ",j==="packages"?"packages":"projects"," found"]}),F&&j==="packages"&&e.jsx("span",{className:"empty-hint",children:'Try searching for "sensor", "regulator", or "mcu"'})]})]})]})}function Re({projects:s,selectedProjectRoot:n,selectedTargetName:t,onSelectProject:l,onSelectTarget:r,placeholder:c="Select project",showAllOption:h=!0,allOptionLabel:p="All projects",disabled:o=!1}){const[i,x]=a.useState(!1),[m,v]=a.useState(""),[M,N]=a.useState(new Set),g=a.useRef(null),z=a.useRef(null);a.useEffect(()=>{if(!i)return;const d=F=>{g.current&&!g.current.contains(F.target)&&(x(!1),v(""))};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[i]),a.useEffect(()=>{i&&z.current&&setTimeout(()=>{var d;return(d=z.current)==null?void 0:d.focus()},0)},[i]);const f=m.trim()?s.filter(d=>d.name.toLowerCase().includes(m.toLowerCase())):s,C=s.find(d=>d.root===n),j=s.length>0,$=C?t?`${C.name}  ${t}`:C.name:c,B=d=>{l(d),x(!1),v(""),N(new Set)},S=()=>{!o&&j&&x(d=>!d)},u=d=>{N(F=>{const T=new Set(F);return T.has(d)?T.delete(d):T.add(d),T})};return a.useEffect(()=>{n&&N(d=>{if(d.has(n))return d;const F=new Set(d);return F.add(n),F})},[n]),a.useEffect(()=>{m&&N(new Set(f.map(d=>d.root)))},[m,f]),e.jsxs("div",{className:"install-dropdown project-dropdown",ref:g,children:[e.jsxs("button",{className:"install-btn",onClick:S,title:$,disabled:o||!j,children:[e.jsx(Se,{size:12}),e.jsx("span",{children:C?$:j?h?"All":c:"No projects"})]}),e.jsx("button",{className:"install-dropdown-toggle",onClick:d=>{d.stopPropagation(),S()},title:"Change project",disabled:o||!j,children:e.jsx(ee,{size:12})}),i&&j&&e.jsxs("div",{className:"install-dropdown-menu project-dropdown-menu",children:[e.jsx("div",{className:"dropdown-header",children:"Select project:"}),e.jsxs("div",{className:"dropdown-search",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:z,type:"text",placeholder:"Filter projects...",value:m,onChange:d=>v(d.target.value),onClick:d=>d.stopPropagation()})]}),e.jsxs("div",{className:"dropdown-items",children:[h&&e.jsxs("button",{className:`dropdown-item ${n?"":"selected"}`,onClick:d=>{d.stopPropagation(),B(null)},children:[e.jsx(Se,{size:12}),e.jsx("span",{children:p}),!n&&e.jsx(ie,{size:12,className:"selected-check"})]}),f.map(d=>{var y;const F=!!(d.targets&&d.targets.length>0),T=M.has(d.root);return e.jsxs("div",{children:[e.jsxs("button",{className:`dropdown-item ${d.root===n?"selected":""}`,onClick:_=>{_.stopPropagation(),l(d.root),F&&r?u(d.root):(x(!1),v(""))},children:[F&&r?e.jsx("span",{className:"project-target-toggle",onClick:_=>{_.stopPropagation(),u(d.root)},children:T?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"project-target-toggle-spacer"}),e.jsx(Se,{size:12}),e.jsx("span",{children:d.name}),d.badge&&e.jsx("span",{className:`status-badge ${d.badgeMuted?"muted":""}`,children:d.badge}),d.root===n&&e.jsx(ie,{size:12,className:"selected-check"})]}),r&&F&&T?e.jsx("div",{className:"project-targets",children:(y=d.targets)==null?void 0:y.map(_=>e.jsxs("button",{className:`dropdown-item target-item ${d.root===n&&_.name===t?"selected":""}`,onClick:Q=>{Q.stopPropagation(),r(d.root,_.name),x(!1),v(""),N(new Set)},children:[e.jsx("span",{children:_.name}),d.root===n&&_.name===t&&e.jsx(ie,{size:12,className:"selected-check"})]},`${d.root}-${_.name}`))}):null]},d.root)}),f.length===0&&m&&e.jsxs("div",{className:"dropdown-empty",children:['No projects match "',m,'"']})]})]})]})}function ft(s){const n=new Map;for(const t of s){const l=t.file||"(no file)";n.has(l)||n.set(l,[]),n.get(l).push(t)}for(const[,t]of n)t.sort((l,r)=>l.level==="error"&&r.level==="warning"?-1:l.level==="warning"&&r.level==="error"?1:0);return n}function jt({problems:s,projects:n=[],selectedProjectRoot:t,onSelectProject:l,onProblemClick:r}){const[c,h]=a.useState(new Set),[p,o]=a.useState(""),i=a.useMemo(()=>{if(!p.trim())return s;const f=p.toLowerCase();return s.filter(C=>{var j,$;return C.message.toLowerCase().includes(f)||((j=C.file)==null?void 0:j.toLowerCase().includes(f))||(($=C.stage)==null?void 0:$.toLowerCase().includes(f))})},[s,p]),x=i.filter(f=>f.level==="error").length,m=a.useMemo(()=>ft(i),[i]),v=n.length>0,M=f=>{h(C=>{const j=new Set(C);return j.has(f)?j.delete(f):j.add(f),j})},N=s.length===0,g=!N&&i.length===0,z=()=>e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[x>0&&e.jsx("div",{className:"problems-summary-inline",children:e.jsxs("span",{className:"problems-count error",children:[e.jsx(de,{size:12}),x]})}),e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Filter problems...",value:p,onChange:f=>o(f.target.value)}),p&&e.jsx("button",{className:"search-clear",onClick:()=>o(""),title:"Clear search",children:e.jsx(he,{size:12})})]}),v&&l&&e.jsx(Re,{projects:n,selectedProjectRoot:t,onSelectProject:l,showAllOption:!0,allOptionLabel:"All projects"})]})});return N||g?e.jsxs("div",{className:"problems-panel empty","data-testid":"problems-panel",children:[z(),e.jsxs("div",{className:"problems-empty-state",children:[e.jsx(de,{size:24,className:"problems-empty-icon"}),e.jsx("span",{className:"problems-empty-text",children:g?"No matching problems":"No problems"})]})]}):e.jsxs("div",{className:"problems-panel","data-testid":"problems-panel",children:[z(),e.jsx("div",{className:"problems-list",children:Array.from(m.entries()).map(([f,C])=>{const j=c.has(f),$=C.filter(S=>S.level==="error").length,B=C.filter(S=>S.level==="warning").length;return e.jsxs("div",{className:`problems-file-group ${j?"collapsed":""}`,children:[e.jsxs("div",{className:"problems-file-header",onClick:()=>M(f),children:[e.jsx("span",{className:"problems-file-expand",children:j?e.jsx(re,{size:12}):e.jsx(ee,{size:12})}),e.jsx(ye,{size:12}),e.jsx("span",{className:"problems-file-name",title:f,children:f.split("/").pop()||f}),e.jsx("span",{className:"problems-file-path",title:f,children:f}),e.jsxs("span",{className:"problems-file-counts",children:[$>0&&e.jsx("span",{className:"problems-file-count error",children:$}),B>0&&e.jsx("span",{className:"problems-file-count warning",children:B})]})]}),!j&&e.jsx("div",{className:"problems-file-items",children:C.map(S=>e.jsxs("div",{className:`problem-item ${S.level} ${S.file?"clickable":""}`,onClick:()=>S.file&&(r==null?void 0:r(S)),title:S.file?`Click to go to ${S.file}:${S.line||1}`:void 0,children:[e.jsx("span",{className:"problem-icon",children:S.level==="error"?e.jsx(de,{size:12}):e.jsx(ce,{size:12})}),e.jsx("span",{className:"problem-message",children:S.message}),S.line&&e.jsxs("span",{className:"problem-location",children:["[",S.line,S.column?`:${S.column}`:"","]"]}),S.stage&&e.jsx("span",{className:"problem-source",children:S.stage})]},S.id))})]},f)})})]})}function Nt(s){return s.itemType||"interface"}const Ve={interface:{icon:ss,color:"var(--ctp-blue)",label:"Interface"},module:{icon:Me,color:"var(--ctp-green)",label:"Module"},component:{icon:Fe,color:"var(--ctp-mauve)",label:"Component"},trait:{icon:Ne,color:"var(--ctp-yellow)",label:"Trait"},parameter:{icon:Ce,color:"var(--ctp-peach)",label:"Parameter"}};function Ke({item:s,isSelected:n,onSelect:t,expandedPaths:l,onToggleChild:r}){var x;const c=Ve[s.type],h=c.icon,p=async m=>{try{await navigator.clipboard.writeText(m)}catch(v){console.warn("Failed to copy usage text",v)}},o=(m,v)=>{var C;const M=(((C=m.children)==null?void 0:C.length)??0)>0,N=l.has(v),g=Nt(m),z=Ve[g],f=z.icon;return e.jsxs("div",{className:"stdlib-child-node",children:[e.jsxs("div",{className:`stdlib-child-row${M?" expandable":""}`,onClick:()=>M?r(v):void 0,children:[M?e.jsx("button",{className:"expand-btn",onClick:()=>r(v),children:N?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"expand-spacer"}),e.jsx("span",{className:"stdlib-child-icon",style:{color:z.color},children:e.jsx(f,{size:12})}),e.jsx("span",{className:"stdlib-child-name",children:m.name}),e.jsx("span",{className:"stdlib-child-type",children:m.type})]}),M&&N&&e.jsx("div",{className:"stdlib-child-children",children:m.children.map(j=>o(j,`${v}.${j.name}`))})]},v)},i=(((x=s.children)==null?void 0:x.length)??0)>0;return e.jsxs("div",{className:`stdlib-card${n?" selected":""}`,onClick:t,children:[e.jsxs("div",{className:"stdlib-card-header",children:[i&&e.jsx("span",{className:"stdlib-expand-icon",children:n?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}),e.jsx("span",{className:"stdlib-type-icon",style:{color:c.color},children:e.jsx(h,{size:14})}),e.jsx("span",{className:"stdlib-card-name",children:s.name}),e.jsx("span",{className:"stdlib-type-badge",style:{background:c.color,color:"var(--ctp-base)"},children:c.label})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"stdlib-card-description",children:s.description}),i&&e.jsx("div",{className:"stdlib-card-children",children:s.children.map(m=>o(m,m.name))}),s.usage&&e.jsxs("div",{className:"stdlib-card-usage",children:[e.jsxs("div",{className:"usage-header",children:[e.jsx("span",{children:"Usage"}),e.jsxs("button",{className:"copy-btn",onClick:m=>{m.stopPropagation(),p(s.usage||"")},children:[e.jsx(ts,{size:12}),"Copy"]})]}),e.jsx("pre",{className:"usage-code",children:s.usage})]})]})]})}function vt({items:s,isLoading:n=!1,onOpenDetail:t,onRefresh:l}){const[r,c]=a.useState(""),[h,p]=a.useState(null),[o,i]=a.useState(new Map),[x,m]=a.useState(new Set(["interface","module","trait","component"])),v=s||[],M=r.trim().length>0,N=j=>{m($=>{const B=new Set($);return B.has(j)?B.delete(j):B.add(j),B})},g=(j,$)=>{i(B=>{const S=new Map(B),u=S.get(j)||new Set,d=new Set(u);return d.has($)?d.delete($):d.add($),S.set(j,d),S})},z=v.filter(j=>{if(r){const $=r.toLowerCase(),B=S=>S?S.some(u=>u.name.toLowerCase().includes($)||u.type.toLowerCase().includes($)||B(u.children)):!1;return j.name.toLowerCase().includes($)||j.description.toLowerCase().includes($)||B(j.children)}return!0}),f=z.reduce((j,$)=>(j[$.type]||(j[$.type]=[]),j[$.type].push($),j),{}),C=["interface","module","trait","component"];return n?e.jsxs("div",{className:"stdlib-panel",children:[e.jsx("div",{className:"stdlib-toolbar",children:e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:"Search standard library...",disabled:!0})]})}),e.jsx("div",{className:"stdlib-list",children:e.jsxs("div",{className:"stdlib-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading standard library..."})]})})]}):e.jsxs("div",{className:"stdlib-panel",children:[e.jsx("div",{className:"stdlib-toolbar",children:e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:"Search standard library...",value:r,onChange:j=>c(j.target.value)})]})}),e.jsxs("div",{className:"stdlib-list",children:[M?e.jsx("div",{className:"stdlib-search-results",children:z.length===0?e.jsxs("div",{className:"stdlib-empty",children:[e.jsx(ue,{size:24}),e.jsxs("span",{children:['No results for "',r,'"']})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"search-results-count",children:[z.length," result",z.length!==1?"s":""]}),z.map(j=>e.jsx(Ke,{item:j,isSelected:h===j.id,onSelect:()=>p(h===j.id?null:j.id),expandedPaths:o.get(j.id)||new Set,onToggleChild:$=>g(j.id,$)},j.id))]})}):C.map(j=>{const $=f[j];if(!$||$.length===0)return null;const B=Ve[j],S=B.icon,u=x.has(j);return e.jsxs("div",{className:`stdlib-group ${u?"collapsed":""}`,children:[e.jsxs("button",{className:"stdlib-group-header",onClick:()=>N(j),style:{"--group-color":B.color},children:[e.jsx("span",{className:"group-chevron",children:u?e.jsx(re,{size:12}):e.jsx(ee,{size:12})}),e.jsx("span",{className:"group-icon",style:{color:B.color},children:e.jsx(S,{size:12})}),e.jsxs("span",{className:"group-label",children:[B.label,"s"]}),e.jsxs("span",{className:"group-count",children:["(",$.length,")"]})]}),!u&&e.jsx("div",{className:"stdlib-group-items",children:$.map(d=>e.jsx(Ke,{item:d,isSelected:h===d.id,onSelect:()=>p(h===d.id?null:d.id),expandedPaths:o.get(d.id)||new Set,onToggleChild:F=>g(d.id,F)},d.id))})]},j)}),z.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{children:"No items found"}),r&&e.jsx("span",{className:"empty-hint",children:'Try "I2C", "Resistor", or "power"'})]})]})]})}function yt(s,n,t,l=""){const r=s.length,c=n.length;if(r+c<=t)return[s,n];const p=l.length,o=Math.floor(t/2);let i=s,x=n;if(r<=o&&c>t-r){const m=t-r;m>p?x=n.slice(0,m-p)+l:x=l.slice(0,m)}else if(c<=o&&r>t-c){const m=t-c;m>p?i=s.slice(0,m-p)+l:i=l.slice(0,m)}else{const m=o-p;m>0?(r>o&&(i=s.slice(0,m)+l),c>o&&(x=n.slice(0,m)+l)):(i=l.slice(0,o),x=l.slice(0,o))}return[i,x]}const bt="data:image/png;base64,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";function kt(s){switch(s){case"voltage":return e.jsx(Ne,{size:12,className:"var-icon voltage"});case"current":return e.jsx(Ne,{size:12,className:"var-icon current"});case"resistance":return e.jsx(Ce,{size:12,className:"var-icon resistance"});case"capacitance":return e.jsx(Ce,{size:12,className:"var-icon capacitance"});case"ratio":case"percentage":return e.jsx(In,{size:12,className:"var-icon ratio"});case"frequency":return e.jsx(Ee,{size:12,className:"var-icon frequency"});case"power":return e.jsx(Ne,{size:12,className:"var-icon power"});default:return e.jsx(Ce,{size:12,className:"var-icon"})}}function wt(s){switch(s){case"module":return e.jsx(Me,{size:14,className:"node-type-icon module"});case"interface":return e.jsx(Ne,{size:14,className:"node-type-icon interface"});case"component":return e.jsx(ns,{size:14,className:"node-type-icon component"})}}const Ct=a.memo(function({variable:n,onCopy:t}){const[l,r]=a.useState(!1),c=()=>{let i=`${n.name}: `;n.spec&&(i+=`${n.spec}${n.specTolerance||""}`),n.actual&&(i+=`  ${n.actual}${n.actualTolerance||""}`),n.unit&&(i+=` ${n.unit}`),t(i),r(!0),setTimeout(()=>r(!1),1500)},h=n.spec!==void 0,p=n.actual!==void 0,o=n.meetsSpec===!1;return e.jsxs("div",{className:`variable-table-row ${o?"error":""}`,onClick:c,title:"Click to copy",children:[e.jsxs("div",{className:"var-col-name",children:[kt(n.type),e.jsx("span",{className:"var-name-text",children:n.name})]}),e.jsx("div",{className:"var-col-spec",children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"var-spec-value",children:n.spec}),n.specTolerance&&e.jsx("span",{className:"var-tolerance",children:n.specTolerance})]}):e.jsx("span",{className:"var-empty",children:""})}),e.jsx("div",{className:`var-col-actual ${o?"error":p?"ok":""}`,children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"var-actual-value",children:n.actual}),n.actualTolerance&&e.jsx("span",{className:"var-tolerance",children:n.actualTolerance})]}):e.jsx("span",{className:"var-empty",children:""})}),e.jsxs("div",{className:"var-col-status",children:[o&&e.jsx(ce,{size:12,className:"status-error"}),l&&e.jsx(ie,{size:12,className:"status-copied"})]})]})});function Te(s,n){if(n==="all")return!0;const t=s||"derived";return n==="user"?t==="user":n==="computed"?t==="derived":n==="picked"?t==="picked"||t==="datasheet":!0}function gs(s,n){var t,l;return n?s.name.toLowerCase().includes(n)||(((t=s.spec)==null?void 0:t.toLowerCase().includes(n))??!1)||(((l=s.actual)==null?void 0:l.toLowerCase().includes(n))??!1):!0}function fs(s,n,t){var r,c;return!!(n&&s.name.toLowerCase().includes(n)||((r=s.variables)==null?void 0:r.some(h=>Te(h.source,t)&&gs(h,n)))||(c=s.children)!=null&&c.some(h=>fs(h,n,t)))}const St=a.memo(function s({node:n,depth:t,searchQuery:l,sourceFilter:r,expandedNodes:c,onToggleExpand:h,onCopyValue:p}){var z;const o=c.has(n.path),i=n.children&&n.children.length>0||n.variables&&n.variables.length>0,x=l.toLowerCase(),m=a.useMemo(()=>n.variables?n.variables.filter(f=>Te(f.source,r)&&gs(f,x)):[],[n.variables,r,x]);if(!a.useMemo(()=>!l&&r==="all"?!0:fs(n,x,r),[n,l,r,x]))return null;const M=t>0?" ".repeat(t):"",[N,g]=n.typeName?yt(n.name,n.typeName,35):[n.name.length>35?n.name.slice(0,32)+"":n.name,""];return e.jsxs("div",{className:`variable-tree-node depth-${Math.min(t,4)}`,children:[e.jsxs("div",{className:`variable-node-header ${o?"expanded":""}`,onClick:()=>h(n.path),children:[i?e.jsx("span",{className:"tree-expand",children:o?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"tree-expand-spacer"}),t>0&&e.jsx("span",{className:"depth-indicator",children:M}),wt(n.type),e.jsx("span",{className:"node-name",title:n.name,children:N}),n.typeName&&e.jsx("span",{className:"node-type-name",title:n.typeName,children:g}),n.variables&&n.variables.length>0&&e.jsx("span",{className:"var-count",children:n.variables.length})]}),o&&e.jsxs("div",{className:"variable-node-content",children:[m.length>0&&e.jsxs("div",{className:"variables-table",children:[e.jsxs("div",{className:"variables-table-header",children:[e.jsx("div",{className:"var-col-name",children:"Parameter"}),e.jsx("div",{className:"var-col-spec",children:"Spec"}),e.jsx("div",{className:"var-col-actual",children:"Actual"}),e.jsx("div",{className:"var-col-status"})]}),m.map((f,C)=>e.jsx(Ct,{variable:f,onCopy:p},`${n.path}-${f.name}-${C}`))]}),(z=n.children)==null?void 0:z.map((f,C)=>e.jsx(s,{node:f,depth:t+1,searchQuery:l,sourceFilter:r,expandedNodes:c,onToggleExpand:h,onCopyValue:p},`${f.path}-${C}`))]})]})});function At({variablesData:s,isLoading:n=!1,error:t=null,projects:l,selectedProjectRoot:r,selectedTargetNames:c,onSelectProject:h,onSelectTarget:p}){const[o,i]=a.useState(""),[x,m]=a.useState(new Set),[v,M]=a.useState(null),[N,g]=a.useState({}),z="all",[f,C]=a.useState(null);a.useEffect(()=>{if(!l||l.length===0){g({});return}let y=!1;return Promise.all(l.map(async _=>{try{const H=(await xe("getVariablesTargets",{projectRoot:_.root})).result??{},Y=Array.isArray(H.targets)?H.targets:[];return[_.root,Y]}catch{return[_.root,[]]}})).then(_=>{if(y)return;const Q={};for(const[H,Y]of _)Q[H]=[...Y];g(Q)}),()=>{y=!0}},[l]);const j=a.useMemo(()=>l?[...l].sort((y,_)=>{var Y,P;const Q=(((Y=N[y.root])==null?void 0:Y.length)??0)>0,H=(((P=N[_.root])==null?void 0:P.length)??0)>0;return Q!==H?Q?-1:1:y.name.localeCompare(_.name)}):[],[l,N]),$=a.useMemo(()=>j.map(y=>{var Q,H;const _=(((Q=N[y.root])==null?void 0:Q.length)??0)>0;return{id:y.root,name:y.name,root:y.root,targets:((H=y.targets)==null?void 0:H.map(Y=>({name:Y.name})))??[],badge:_?void 0:"no variables",badgeMuted:!0}}),[j,N]),B=!!(l&&(j.length>0||r)),S=(s==null?void 0:s.nodes)||[];a.useEffect(()=>{const y=s==null?void 0:s.version;S.length>0&&y&&y!==f&&(m(new Set(S.map(_=>_.path))),C(y))},[S,s==null?void 0:s.version,f]);const u=a.useCallback(y=>{m(_=>{const Q=new Set(_);return Q.has(y)?Q.delete(y):Q.add(y),Q})},[]),d=a.useCallback(y=>{navigator.clipboard.writeText(y),M(y),setTimeout(()=>M(null),2e3)},[]),F=a.useMemo(()=>{const y=_=>{let Q=0;for(const H of _){if(H.variables)for(const Y of H.variables)Te(Y.source,z)&&Q++;H.children&&(Q+=y(H.children))}return Q};return y(S)},[S,z]),T=(()=>{if(!(s!=null&&s.build_id))return null;const y=s.build_id.match(/^build-(\d+)-/);return y?`#${y[1]}`:s.build_id.substring(0,12)})();return e.jsxs("div",{className:"variables-panel",children:[e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Search variables...",value:o,onChange:y=>i(y.target.value)})]}),B&&e.jsx(Re,{projects:$,selectedProjectRoot:r,selectedTargetName:(c==null?void 0:c[0])||null,onSelectProject:h||(()=>{}),onSelectTarget:p,showAllOption:!1,placeholder:"Select project"})]})}),e.jsxs("div",{className:"variables-tree",children:[n&&e.jsxs("div",{className:"variables-loading",children:[e.jsx(ge,{size:24,className:"spinner"}),e.jsx("span",{children:"Loading variables..."})]}),t&&!n&&e.jsxs("div",{className:"variables-error",children:[e.jsx(ce,{size:16}),e.jsx("span",{children:t})]}),!n&&!t&&S.length===0&&e.jsxs("div",{className:"variables-empty",children:[e.jsx("span",{children:"No variables found."}),e.jsx("span",{className:"hint",children:'Run "ato build" to generate variable data.'})]}),!n&&!t&&S.map((y,_)=>e.jsx(St,{node:y,depth:0,searchQuery:o,sourceFilter:z,expandedNodes:x,onToggleExpand:u,onCopyValue:d},`${y.path}-${_}`))]}),e.jsxs("div",{className:"variables-status",children:[e.jsxs("span",{children:[F," variables"]}),T&&e.jsxs("span",{className:"build-id-badge",title:`Build: ${s==null?void 0:s.build_id}`,children:["build ",T]}),v&&e.jsxs("span",{className:"copied-toast",children:[e.jsx(ie,{size:10}),"Copied: ",v]})]})]})}function js(s){const n=s.split("::");return(n.length>1?n[1]:s).split("|")[0]}function Xe(s){const n=js(s),t=n.split(".");return t.length<=1?n:t.slice(1).join(".")}function Mt(s){var c;const n=s.usages.map(h=>h.designator),t=s.unitCost??void 0,l=t!==void 0?t*s.quantity:void 0,r=s.stock;return{id:s.id,designators:n,type:s.type,value:s.value,package:s.package,manufacturer:s.manufacturer??void 0,mpn:s.mpn??void 0,lcsc:s.lcsc??void 0,description:s.description??void 0,quantity:s.quantity,unitCost:t,totalCost:l,inStock:r!=null?r>0:void 0,stockQuantity:r??void 0,parameters:s.parameters,source:s.source,path:(c=s.usages[0])==null?void 0:c.address,usages:s.usages.map(h=>({path:h.address,designator:h.designator}))}}function zt(s){switch(s){case"resistor":return"R";case"capacitor":return"C";case"inductor":return"L";case"ic":return"IC";case"connector":return"J";case"led":return"LED";case"diode":return"D";case"transistor":return"Q";case"crystal":return"Y";default:return"X"}}function Le(s){return s<.01?`$${s.toFixed(4)}`:s<1?`$${s.toFixed(3)}`:`$${s.toFixed(2)}`}function Pt(s){const n=new Map;for(const t of s){const l=js(t.path),r=l.split(".");let c,h;r.length>=3?(c=r.slice(0,-1).join("."),h=r[r.length-2]):r.length===2?(c=r[0],h=r[0]):(c=l,h=l),n.has(c)||n.set(c,{parentPath:c,parentLabel:h,instances:[]}),n.get(c).instances.push(t)}return Array.from(n.values())}function Et(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(0)}K`:s.toString()}const Bt=a.memo(function({component:n,isExpanded:t,onToggle:l,onCopy:r,onGoToSource:c}){const[h,p]=a.useState(null),[o,i]=a.useState(()=>new Set),x=(N,g,z)=>{z.stopPropagation(),r(g),p(N),setTimeout(()=>p(null),1500)},m=(N,g)=>{N.stopPropagation(),c(g.path,g.line)},v=(N,g)=>{g.stopPropagation(),i(z=>{const f=new Set(z);return f.has(N)?f.delete(N):f.add(N),f})},M=n.usages?Pt(n.usages):[];return e.jsxs("div",{className:`bom-row ${t?"expanded":""}`,onClick:l,children:[e.jsxs("div",{className:"bom-row-header",children:[e.jsx("span",{className:"bom-expand",children:t?e.jsx(ee,{size:12}):e.jsx(re,{size:12})}),e.jsx("span",{className:`bom-type-badge type-${n.type}`,children:zt(n.type)}),e.jsx("span",{className:"bom-value",children:n.value}),n.mpn&&e.jsx("span",{className:"bom-mpn",title:n.mpn,children:n.mpn}),e.jsxs("span",{className:"bom-quantity",children:["",n.quantity]}),n.totalCost!==void 0&&e.jsx("span",{className:"bom-cost",children:Le(n.totalCost)}),n.inStock===!1&&e.jsx(ce,{size:12,className:"bom-stock-warning"})]}),t&&e.jsxs("div",{className:"bom-row-details",children:[e.jsx("table",{className:"bom-detail-table",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Manufacturer"}),e.jsx("td",{className:"detail-cell-value",children:n.manufacturer||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Package"}),e.jsx("td",{className:"detail-cell-value",children:n.package})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"LCSC"}),e.jsx("td",{className:"detail-cell-value",children:n.lcsc?e.jsxs("span",{className:"lcsc-link",onClick:N=>x("lcsc",n.lcsc,N),children:[e.jsx("span",{className:"mono",children:n.lcsc}),e.jsx("a",{href:`https://www.lcsc.com/product-detail/${n.lcsc}.html`,target:"_blank",rel:"noopener noreferrer",onClick:N=>N.stopPropagation(),className:"external-link",children:e.jsx(we,{size:10})}),h==="lcsc"?e.jsx(ie,{size:10,className:"copy-icon copied"}):e.jsx(ts,{size:10,className:"copy-icon"})]}):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Stock"}),e.jsx("td",{className:`detail-cell-value ${n.inStock===!1?"out-of-stock":"in-stock"}`,children:n.inStock===!1?e.jsxs("span",{className:"stock-out",children:[e.jsx(ce,{size:10})," Out of stock"]}):n.lcscLoading&&n.stockQuantity==null?e.jsxs("span",{className:"inline-loading",children:[e.jsx(Ee,{size:10,className:"loading-spinner"})," Fetching..."]}):n.stockQuantity?Et(n.stockQuantity):"In stock"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Unit Cost"}),e.jsx("td",{className:"detail-cell-value cost",children:n.unitCost!=null?Le(n.unitCost):n.lcscLoading?e.jsxs("span",{className:"inline-loading",children:[e.jsx(Ee,{size:10,className:"loading-spinner"})," Fetching..."]}):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Source"}),e.jsx("td",{className:"detail-cell-value",children:e.jsx("span",{className:`source-badge source-${n.source}`,children:n.source==="picked"?"Auto-picked":n.source==="specified"?"Specified":"Manual"})})]})]})}),M.length>0&&e.jsxs("div",{className:"bom-usages-tree",children:[e.jsxs("div",{className:"usages-header",children:[e.jsx("span",{children:"Used in design"}),e.jsxs("span",{className:"usages-count",children:[n.quantity," instance",n.quantity!==1?"s":""]})]}),e.jsx("div",{className:"usage-groups",children:M.map(N=>e.jsx("div",{className:"usage-group",children:N.instances.length>1?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"usage-group-header",onClick:g=>v(N.parentPath,g),children:[e.jsx("span",{className:"usage-expand",children:o.has(N.parentPath)?e.jsx(ee,{size:11}):e.jsx(re,{size:11})}),e.jsx("span",{className:"usage-module-name",children:N.parentLabel}),e.jsxs("span",{className:"usage-count-badge",children:["",N.instances.length]})]}),o.has(N.parentPath)&&e.jsx("div",{className:"usage-instances",children:N.instances.map((g,z)=>{const f=Xe(g.path);return e.jsxs("div",{className:"usage-instance",onClick:C=>m(C,g),title:g.path,children:[e.jsx("span",{className:"usage-designator",children:g.designator}),e.jsx("span",{className:"usage-leaf",children:f}),e.jsx(we,{size:9,className:"usage-goto"})]},z)})})]}):e.jsxs("div",{className:"usage-single",onClick:g=>m(g,N.instances[0]),title:N.instances[0].path,children:[e.jsx("span",{className:"usage-designator",children:N.instances[0].designator}),e.jsx("span",{className:"usage-module-path",children:Xe(N.instances[0].path)}),e.jsx(we,{size:10,className:"usage-goto"})]})},N.parentPath))})]})]})]})});function $t({bomData:s,isLoading:n=!1,error:t=null,onGoToSource:l,projects:r,selectedProjectRoot:c,selectedTargetNames:h,onSelectProject:p,onSelectTarget:o}){const[i,x]=a.useState(""),[m,v]=a.useState(new Set),[M,N]=a.useState(null),[g,z]=a.useState({}),[f,C]=a.useState({}),[j,$]=a.useState(new Set),[B,S]=a.useState(null),[u,d]=a.useState(null),F=a.useRef(0),T=a.useRef(null),y=(h==null?void 0:h[0])??null;a.useEffect(()=>{if(!r||r.length===0){z({});return}let E=!1;return Promise.all(r.map(async V=>{try{const K=(await xe("getBomTargets",{projectRoot:V.root})).result??{},X=Array.isArray(K.targets)?K.targets:[];return[V.root,X]}catch{return[V.root,[]]}})).then(V=>{if(E)return;const L={};for(const[K,X]of V)L[K]=[...X];z(L)}),()=>{E=!0}},[r]);const _=a.useMemo(()=>r?[...r].sort((E,V)=>{var X,te;const L=(((X=g[E.root])==null?void 0:X.length)??0)>0,K=(((te=g[V.root])==null?void 0:te.length)??0)>0;return L!==K?L?-1:1:E.name.localeCompare(V.name)}):[],[r,g]),Q=a.useMemo(()=>_.map(E=>{var L,K;const V=(((L=g[E.root])==null?void 0:L.length)??0)>0;return{id:E.root,name:E.name,root:E.root,targets:((K=E.targets)==null?void 0:K.map(X=>({name:X.name})))??[],badge:V?void 0:"no BOM",badgeMuted:!0}}),[_,g]);a.useEffect(()=>{if(!c){S(null),d(null),T.current=null;return}xe("getBuildsByProject",{projectRoot:c,target:y??void 0,limit:1}).then(E=>{const V=E.result??{},L=Array.isArray(V.builds)?V.builds[0]:null;S(L?{build_id:L.build_id,started_at:L.started_at,completed_at:L.completed_at??(L.started_at&&L.duration?L.started_at+L.duration:void 0)}:null)}).catch(E=>{console.warn("Failed to load build info",E),S(null)})},[c,y]),a.useEffect(()=>{if(!(B!=null&&B.build_id))return;const E=B.completed_at??B.started_at;!E||!(Date.now()/1e3-E>24*60*60)||T.current!==B.build_id&&d(B.build_id)},[B]);const H=a.useMemo(()=>{var V;if(!((V=s==null?void 0:s.components)!=null&&V.length))return[];const E=new Set;for(const L of s.components)L.lcsc&&E.add(L.lcsc);return Array.from(E)},[s==null?void 0:s.components]),Y=a.useMemo(()=>{var V;if(!((V=s==null?void 0:s.components)!=null&&V.length))return[];const E=new Set;for(const L of s.components)L.lcsc&&(L.unitCost!=null&&L.stock!=null||E.add(L.lcsc));return Array.from(E)},[s==null?void 0:s.components]);a.useEffect(()=>{const E=!!u,V=E?H:Y;if(V.length===0)return;const L=E?V:V.filter(X=>!(X in f));if(L.length===0)return;const K=++F.current;$(X=>{const te=new Set(X);for(const q of L)te.add(q);return te}),xe("fetchLcscParts",{lcscIds:L,projectRoot:c??void 0,target:y??void 0}).then(X=>{if(K!==F.current)return;const q=(X.result??{}).parts||{};C(se=>({...se,...q}))}).catch(X=>{K===F.current&&console.warn("Failed to fetch LCSC data",X)}).finally(()=>{$(X=>{const te=new Set(X);for(const q of L)te.delete(q);return te}),E&&(B!=null&&B.build_id)&&(T.current=B.build_id,d(null))})},[Y,H,f,u,B,c,y]);const P=a.useMemo(()=>s!=null&&s.components?s.components.map(E=>{const V=Mt(E);if(!E.lcsc)return V;const L=f[E.lcsc];return V.lcscLoading=j.has(E.lcsc),L&&(V.unitCost==null&&L.unit_cost!=null&&(V.unitCost=L.unit_cost,V.totalCost=L.unit_cost*V.quantity),V.inStock==null&&(V.inStock=L.stock>0,V.stockQuantity=L.stock),!V.description&&L.description&&(V.description=L.description),!V.manufacturer&&L.manufacturer&&(V.manufacturer=L.manufacturer),!V.mpn&&L.mpn&&(V.mpn=L.mpn)),V}):[],[s==null?void 0:s.components,f]),O=(s==null?void 0:s.components)&&s.components.length>0,I=a.useCallback(E=>{v(V=>{const L=new Set(V);return L.has(E)?L.delete(E):L.add(E),L})},[]),R=a.useCallback(E=>{navigator.clipboard.writeText(E),N(E),setTimeout(()=>N(null),2e3)},[]),G=a.useCallback((E,V)=>{l?l(E,V):console.log(`Navigate to: ${E}${V?`:${V}`:""}`)},[l]),b=e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Search value, MPN...",value:i,onChange:E=>x(E.target.value)})]}),e.jsx(Re,{projects:Q,selectedProjectRoot:c,selectedTargetName:(h==null?void 0:h[0])||null,onSelectProject:p||(()=>{}),onSelectTarget:o,showAllOption:!1,placeholder:"Select project"})]})}),A=a.useMemo(()=>{const E=i.toLowerCase();return P.filter(V=>{var L,K,X,te;return E?V.value.toLowerCase().includes(E)||((L=V.mpn)==null?void 0:L.toLowerCase().includes(E))||((K=V.lcsc)==null?void 0:K.toLowerCase().includes(E))||((X=V.manufacturer)==null?void 0:X.toLowerCase().includes(E))||((te=V.description)==null?void 0:te.toLowerCase().includes(E)):!0}).sort((V,L)=>(L.totalCost||0)-(V.totalCost||0))},[P,i]),{totalComponents:k,totalCost:D,uniqueParts:W,outOfStock:J}=a.useMemo(()=>{let E=0,V=0,L=0;for(const K of P)E+=K.quantity,V+=K.totalCost||0,K.inStock===!1&&L++;return{totalComponents:E,totalCost:V,uniqueParts:P.length,outOfStock:L}},[P]),Z=(()=>{if(!(s!=null&&s.build_id))return null;const E=s.build_id.match(/^build-(\d+)-/);return E?`#${E[1]}`:s.build_id.substring(0,12)})();if(n)return e.jsxs("div",{className:"bom-panel",children:[b,e.jsxs("div",{className:"bom-loading",children:[e.jsx(Ee,{size:24,className:"loading-spinner"}),e.jsx("span",{children:"Loading BOM..."})]})]});if(t){const E=t.includes("404")||t.includes("not found")||t.includes("Run 'ato build'");return e.jsxs("div",{className:"bom-panel",children:[b,e.jsx("div",{className:"bom-empty-state",children:E?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"empty-title",children:"No BOM data available"}),e.jsx("span",{className:"empty-description",children:"Run a build to generate the Bill of Materials"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{size:24}),e.jsx("span",{children:t})]})})]})}return O?e.jsxs("div",{className:"bom-panel",children:[e.jsxs("div",{className:"bom-summary",children:[e.jsxs("div",{className:"bom-summary-item",children:[e.jsx("span",{className:"summary-value",children:W}),e.jsx("span",{className:"summary-label",children:"unique"})]}),e.jsxs("div",{className:"bom-summary-item",children:[e.jsx("span",{className:"summary-value",children:k}),e.jsx("span",{className:"summary-label",children:"total"})]}),e.jsxs("div",{className:"bom-summary-item primary",children:[e.jsx("span",{className:"summary-value",children:Le(D)}),e.jsx("span",{className:"summary-label",children:"cost"})]}),J>0&&e.jsxs("div",{className:"bom-summary-item warning",children:[e.jsx(ce,{size:12}),e.jsx("span",{className:"summary-value",children:J}),e.jsx("span",{className:"summary-label",children:"out of stock"})]}),Z&&e.jsxs("div",{className:"bom-summary-item muted",title:`Build: ${s==null?void 0:s.build_id}`,children:[e.jsx("span",{className:"summary-value",children:Z}),e.jsx("span",{className:"summary-label",children:"build"})]})]}),b,e.jsxs("div",{className:"bom-list",children:[A.map(E=>e.jsx(Bt,{component:E,isExpanded:m.has(E.id),onToggle:()=>I(E.id),onCopy:R,onGoToSource:G},E.id)),A.length===0&&e.jsxs("div",{className:"bom-empty",children:[e.jsx(be,{size:24}),e.jsx("span",{children:"No components found"})]})]}),M&&e.jsxs("div",{className:"bom-toast",children:[e.jsx(ie,{size:10}),"Copied: ",M]})]}):e.jsxs("div",{className:"bom-panel",children:[b,e.jsxs("div",{className:"bom-empty-state",children:[e.jsx("span",{className:"empty-title",children:"No BOM data available"}),e.jsx("span",{className:"empty-description",children:"Select a project and run a build to generate the Bill of Materials"})]})]})}function It(s){return s==null?"0":s>=1e6?(s/1e6).toFixed(1).replace(/\.0$/,"")+"M":s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"k":s.toString()}function Vt(s){if(!s)return"Unknown";try{const n=new Date(s),l=new Date().getTime()-n.getTime(),r=Math.floor(l/(1e3*60*60*24));return r<1?"Today":r===1?"Yesterday":r<7?`${r} days ago`:r<30?`${Math.floor(r/7)} weeks ago`:r<365?`${Math.floor(r/30)} months ago`:n.toLocaleDateString()}catch{return s}}function Lt({package:s,packageDetails:n,isLoading:t,isInstalling:l,installError:r,error:c,onClose:h,onInstall:p,onBuild:o}){var z,f;const i=n,x=(i==null?void 0:i.versions)||((z=s.availableVersions)==null?void 0:z.map(C=>({version:C.version,releasedAt:C.released,requiresAtopile:void 0,size:void 0})))||[],[m,v]=a.useState((i==null?void 0:i.version)||s.version||"");a.useEffect(()=>{i!=null&&i.version&&v(i.version)},[i==null?void 0:i.version]);const M=(i==null?void 0:i.description)||(i==null?void 0:i.summary)||s.description,N=(i==null?void 0:i.installed)??s.installed,g=(i==null?void 0:i.installedVersion)||s.version;return e.jsxs("div",{className:"package-detail-panel",children:[e.jsxs("div",{className:"detail-panel-header",children:[e.jsxs("div",{className:"detail-header-left",children:[e.jsx(be,{size:20,className:"detail-package-icon"}),e.jsxs("div",{className:"detail-header-info",children:[e.jsx("h2",{className:"detail-package-name",children:s.name}),e.jsxs("div",{className:"detail-package-meta",children:[((i==null?void 0:i.version)||s.version)&&e.jsxs("span",{className:"detail-version",children:[e.jsx(Un,{size:12}),"v",(i==null?void 0:i.version)||s.version]}),N&&e.jsxs("span",{className:"detail-installed",children:[e.jsx(Ks,{size:12}),"Installed",g?` (v${g})`:""]})]})]})]}),e.jsx("button",{className:"detail-close-btn",onClick:h,children:e.jsx(he,{size:18})})]}),t&&e.jsxs("div",{className:"detail-panel-loading",children:[e.jsx(ge,{size:24,className:"spin"}),e.jsx("span",{children:"Loading package details..."})]}),c&&!t&&e.jsxs("div",{className:"detail-panel-error",children:[e.jsx(de,{size:16}),e.jsx("span",{children:c})]}),e.jsxs("div",{className:"detail-panel-content",children:[M&&e.jsx("section",{className:"detail-section",children:e.jsx("p",{className:"detail-description",children:M})}),e.jsxs("section",{className:"detail-section detail-actions",children:[e.jsxs("div",{className:"detail-install-row",children:[x.length>0?e.jsx("select",{className:"detail-version-select",value:m,onChange:C=>v(C.target.value),children:x.map((C,j)=>e.jsxs("option",{value:C.version,children:["v",C.version,j===0?" (latest)":""]},C.version))}):t?e.jsx("select",{className:"detail-version-select",disabled:!0,children:e.jsx("option",{children:"Loading versions..."})}):e.jsx("select",{className:"detail-version-select",disabled:!0,children:e.jsxs("option",{children:["v",s.version||"unknown"]})}),e.jsx("button",{className:`detail-install-btn ${N?"update":"install"} ${l?"installing":""}`,onClick:()=>p(m||(i==null?void 0:i.version)||s.version||""),disabled:t||l,children:l?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:14,className:"animate-spin"}),"Installing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:14}),N?"Update":"Install"]})}),e.jsxs("button",{className:"detail-build-btn",onClick:()=>o(),title:"Build this package (installs if needed)",disabled:t||l,children:[e.jsx(Ae,{size:14}),"Build"]})]}),r&&e.jsxs("div",{className:"detail-install-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:r})]}),x.length>0&&e.jsxs("div",{className:"detail-version-info",children:[e.jsx(_s,{size:12}),"Released: ",Vt((f=x.find(C=>C.version===m))==null?void 0:f.releasedAt)]})]}),e.jsxs("section",{className:"detail-section",children:[e.jsxs("h3",{className:"detail-section-title",children:[e.jsx(ye,{size:14}),"Exported Symbols"]}),e.jsx("p",{className:"muted",children:"Symbol introspection coming soon"})]}),e.jsxs("section",{className:"detail-section",children:[e.jsxs("h3",{className:"detail-section-title",children:[e.jsx(ye,{size:14}),"Usage Example"]}),e.jsx("pre",{className:"detail-code-block",children:`from "${s.fullName}/${s.name}.ato" import RP2040

module MyBoard:
    mcu = new RP2040

    # Connect interfaces
    power ~ mcu.power
    i2c ~ mcu.i2c`})]})]}),e.jsxs("div",{className:"detail-panel-footer",children:[e.jsxs("div",{className:"detail-footer-stats",children:[(i==null?void 0:i.publisher)&&e.jsx("span",{className:"footer-stat",children:i.publisher}),i&&e.jsxs("span",{className:"footer-stat",children:[e.jsx(Pe,{size:12}),It(i.downloads)]}),(i==null?void 0:i.license)&&e.jsx("span",{className:"footer-stat",children:i.license})]}),s.homepage&&e.jsxs("a",{href:s.homepage,className:"footer-browser-btn",target:"_blank",rel:"noopener",title:"Open in browser",children:[e.jsx(jn,{size:14}),e.jsx("span",{children:"Open"}),e.jsx(we,{size:10})]})]})]})}function qt(s){if(s<60)return`${Math.floor(s)}s`;const n=Math.floor(s/60),t=Math.floor(s%60);if(n<60)return`${n}m ${t}s`;const l=Math.floor(n/60),r=n%60;return`${l}h ${r}m`}function Ft(s){const n=s.split("/");return n[n.length-1]||s}function Rt(s){if(!s.stages||s.stages.length===0)return null;const n=s.stages.find(l=>l.status==="running");if(n)return{name:n.displayName||n.name,elapsed:n.elapsedSeconds};const t=[...s.stages].reverse().find(l=>l.status==="success"||l.status==="failed"||l.status==="error");return t?{name:t.displayName||t.name}:null}function Tt({build:s,onCancel:n}){const[t,l]=a.useState(s.elapsedSeconds||0);a.useEffect(()=>{if(s.status!=="building"){l(s.elapsedSeconds||0);return}const x=s.startedAt*1e3,m=()=>{l((Date.now()-x)/1e3)};m();const v=setInterval(m,1e3);return()=>clearInterval(v)},[s.status,s.startedAt,s.elapsedSeconds]);const r=Ft(s.projectRoot),c=s.targets.length>0?s.targets.length===1?s.targets[0]:s.targets.join(", "):s.entry||"default",h=Rt(s),p={queued:e.jsx(Bn,{className:"status-icon queued",size:12}),building:e.jsx(ve,{className:"status-icon building",size:12}),success:e.jsx(Gs,{className:"status-icon success",size:12}),failed:e.jsx(Js,{className:"status-icon failed",size:12}),cancelled:e.jsx(de,{className:"status-icon cancelled",size:12})}[s.status],o=s.status==="building",i=s.status==="queued"||s.status==="building";return e.jsxs("div",{className:`queue-item ${s.status}`,children:[e.jsxs("div",{className:"queue-item-main",children:[p,e.jsxs("div",{className:"queue-item-info",children:[e.jsxs("span",{className:"queue-item-name",title:`${r}:${c}`,children:[r,e.jsxs("span",{className:"queue-item-target",children:[":",c]})]}),h&&s.status==="building"&&e.jsx("span",{className:"queue-item-stage",title:h.name,children:h.name})]}),e.jsxs("div",{className:"queue-item-meta",children:[i&&e.jsxs("span",{className:"queue-item-time",children:[e.jsx(qe,{size:10}),qt(t)]}),i&&e.jsx("button",{className:`queue-item-cancel${o?" building":""}`,onClick:n,title:"Cancel build",children:e.jsx(he,{size:12})})]})]}),s.error&&s.status==="failed"&&e.jsxs("div",{className:"queue-item-error",title:s.error,children:[s.error.substring(0,50),"..."]})]})}function _t({builds:s,onCancelBuild:n}){return s.length===0?e.jsx("div",{className:"queue-empty",children:e.jsx("span",{children:"No active builds"})}):e.jsx("div",{className:"build-queue-panel",children:s.map(t=>e.jsx(Tt,{build:t,onCancel:()=>n(t.buildId)},t.buildId))})}function Ge(s,n,t){if(!s||!Array.isArray(s))return;let l=s.find(r=>{if(r.status!=="building"&&r.status!=="queued"||(r.projectName||(r.projectRoot?r.projectRoot.split("/").pop():null))!==n)return!1;const h=r.targets||[];return h.length>0?h.includes(t):r.name===t});return l||(l=s.find(r=>(r.status==="building"||r.status==="queued")&&r.name===t&&(r.projectName===n||r.projectName===null))),l}function Dt(s,n){if(!s||!s.includes(":"))return null;const[t,l]=s.split(":");if(!l)return null;const r=(n||[]).filter(c=>c.entry!==s).map(c=>({name:c.name,type:c.type,path:c.entry,children:[]})).sort((c,h)=>{const p={module:0,component:1,interface:2,parameter:3},o=(p[c.type]||99)-(p[h.type]||99);return o!==0?o:c.name.localeCompare(h.name)});return{name:l,type:"module",path:s,children:r}}function Ze(s){return s?s==="failed"?"error":s==="interrupted"||s==="building"||s==="queued"?"idle":s:"idle"}function Ht({state:s,selection:n,activeStageFilter:t}){const l=a.useMemo(()=>{var N;return(N=s==null?void 0:s.projects)!=null&&N.length?s.projects.map(g=>{var $,B,S;const z=(($=s.projectModules)==null?void 0:$[g.root])||[],f=g.targets.map(u=>{var Q,H,Y,P,O,I;const d=Ge(s.builds,g.name,u.name),F=Dt(u.entry,z),T=d!=null&&d.stages&&d.stages.length>0?d.stages:null,y=(Q=u.lastBuild)==null?void 0:Q.stages,_=T||y||[];return{id:u.name,name:u.name,entry:u.entry,status:(d==null?void 0:d.status)==="failed"?"error":(d==null?void 0:d.status)||Ze((H=u.lastBuild)==null?void 0:H.status),warnings:(d==null?void 0:d.warnings)??((Y=u.lastBuild)==null?void 0:Y.warnings),errors:(d==null?void 0:d.errors)??((P=u.lastBuild)==null?void 0:P.errors),elapsedSeconds:d==null?void 0:d.elapsedSeconds,duration:(O=u.lastBuild)==null?void 0:O.elapsedSeconds,buildId:d==null?void 0:d.buildId,stages:_.map(R=>({...R,status:R.status==="failed"?"error":R.status})),symbols:F?[F]:[],queuePosition:d==null?void 0:d.queuePosition,lastBuild:u.lastBuild?{status:Ze(u.lastBuild.status),timestamp:u.lastBuild.timestamp,elapsedSeconds:u.lastBuild.elapsedSeconds,warnings:u.lastBuild.warnings,errors:u.lastBuild.errors,stages:(I=u.lastBuild.stages)==null?void 0:I.map(R=>({name:R.name,displayName:R.displayName,status:R.status==="failed"?"error":R.status,elapsedSeconds:R.elapsedSeconds}))}:void 0}});let C,j;for(const u of f){const d=u.status!=="idle"?u.status:(B=u.lastBuild)==null?void 0:B.status,F=(S=u.lastBuild)==null?void 0:S.timestamp;d==="error"||d==="failed"?C="error":d==="warning"&&C!=="error"?C="warning":d==="success"&&!C&&(C="success"),F&&(!j||F>j)&&(j=F)}return{id:g.root,name:g.name,type:"project",root:g.root,builds:f,lastBuildStatus:C,lastBuildTimestamp:j}}):[]},[s==null?void 0:s.projects,s==null?void 0:s.builds,s==null?void 0:s.projectModules]),r=a.useMemo(()=>{var N;return(N=s==null?void 0:s.packages)!=null&&N.length?s.packages.filter(g=>g&&g.identifier&&g.name).map(g=>{var $,B;const f=["default","usage"].map(S=>{const u=Ge(s.builds,g.name,S);return{id:S,name:S,entry:`${g.name||"unknown"}.ato:${(g.name||"unknown").replace(/-/g,"_")}`,status:(u==null?void 0:u.status)||"idle",buildId:u==null?void 0:u.buildId,elapsedSeconds:u==null?void 0:u.elapsedSeconds,warnings:u==null?void 0:u.warnings,errors:u==null?void 0:u.errors,stages:(u==null?void 0:u.stages)||[],queuePosition:u==null?void 0:u.queuePosition,lastBuild:u&&(u.status==="success"||u.status==="failed"||u.status==="warning")&&u.startedAt?{status:u.status==="failed"?"error":u.status,timestamp:new Date((u.startedAt+(u.elapsedSeconds||0))*1e3).toISOString(),elapsedSeconds:u.elapsedSeconds,warnings:u.warnings||0,errors:u.errors||0}:void 0}});let C,j;for(const S of f){const u=S.status!=="idle"?S.status:($=S.lastBuild)==null?void 0:$.status,d=(B=S.lastBuild)==null?void 0:B.timestamp;u==="error"||u==="failed"?C="error":u==="warning"&&C!=="error"?C="warning":u==="success"&&!C&&(C="success"),d&&(!j||d>j)&&(j=d)}return{id:g.identifier,name:g.name,type:"package",path:`packages/${g.identifier}`,version:g.version||void 0,latestVersion:g.latestVersion,installed:g.installed??!1,installedIn:g.installedIn||[],publisher:g.publisher||void 0,summary:g.summary||g.description||"",description:g.description||g.summary||"",homepage:g.homepage,repository:g.repository,license:g.license,keywords:g.keywords||[],downloads:g.downloads,versionCount:g.versionCount,builds:f,lastBuildStatus:C,lastBuildTimestamp:j}}):[]},[s==null?void 0:s.packages,s==null?void 0:s.builds]),c=[...l,...r];let h=0,p=0;for(const N of c)N.type==="package"?p++:h++;const o=(s==null?void 0:s.queuedBuilds)||[],i=a.useMemo(()=>new Map(c.map(N=>[N.id,N])),[c]),x=(s==null?void 0:s.problems)||[],m=a.useMemo(()=>{const N=s==null?void 0:s.problemFilter,g=f=>f.toLowerCase().replace(/[-_\s]+/g,""),z=(f,C)=>{if(f===C)return!0;const j=g(f),$=g(C);return!!(j===$||j.includes($)||$.includes(j))};return x.filter(f=>{if(t){if(t.stageName&&(!f.stage||!z(t.stageName,f.stage))||t.buildId&&f.buildName&&f.buildName!==t.buildId)return!1;if(t.projectId&&f.projectName){const C=i.get(t.projectId);if(C&&f.projectName!==C.name)return!1}return!0}if(n.type==="project"&&n.projectId){const C=i.get(n.projectId);if(C&&f.projectName&&f.projectName!==C.name)return!1}else if(n.type==="build"&&n.projectId&&n.buildId){const C=i.get(n.projectId);if(C&&f.projectName&&f.projectName!==C.name||f.buildName&&f.buildName!==n.buildId)return!1}return N?!(N.levels&&N.levels.length>0&&!N.levels.includes(f.level)||N.buildNames&&N.buildNames.length>0&&f.buildName&&!N.buildNames.includes(f.buildName)||N.stageIds&&N.stageIds.length>0&&f.stage&&!N.stageIds.includes(f.stage)):!0})},[x,s==null?void 0:s.problemFilter,t,n,i]);let v=0,M=0;for(const N of m)N.level==="error"?v++:N.level==="warning"&&M++;return{projects:c,projectCount:h,packageCount:p,queuedBuilds:o,projectsById:i,problems:x,filteredProblems:m,totalErrors:v,totalWarnings:M}}function Qt({selectedProjectRoot:s,selectedTargetName:n,collapsedSections:t,sectionHeights:l,setSectionHeights:r,setCollapsedSections:c,containerRef:h,action:p}){const o=a.useRef(0),i=a.useRef(0);a.useEffect(()=>{const x=m=>{const v=m.detail;if(!(v!=null&&v.sectionId)||!(v!=null&&v.type))return;const M=v.sectionId;c(N=>{const g=new Set(N);return v.type==="openSection"?g.delete(M):v.type==="closeSection"?g.add(M):v.type==="toggleSection"&&(g.has(M)?g.delete(M):g.add(M)),g})};return window.addEventListener("atopile:ui_action",x),()=>window.removeEventListener("atopile:ui_action",x)},[c]),a.useEffect(()=>{const x=setTimeout(()=>{p("refreshProblems"),p("refreshPackages"),p("refreshStdlib")},100);return()=>clearTimeout(x)},[p]),a.useEffect(()=>{if(!s){ne.getState().setBomData(null),ne.getState().setBomError(null);return}if(!n)return;const x=++o.current;ne.getState().setLoadingBom(!0),ne.getState().setBomError(null),p("refreshBOM",{projectRoot:s,target:n,requestId:x})},[s,n]),a.useEffect(()=>{if(!s){ne.getState().setVariablesData(null),ne.getState().setVariablesError(null);return}if(!n)return;const x=++i.current;ne.getState().setLoadingVariables(!0),ne.getState().setVariablesError(null),p("fetchVariables",{projectRoot:s,target:n,requestId:x})},[s,n]),a.useEffect(()=>{const x=new Map,m=v=>{var N,g;const M=v.detail;if((M==null?void 0:M.action)==="installPackage"){const z=(N=M.payload)==null?void 0:N.packageId;if(M.result&&!M.result.success&&M.result.error){if(z){ne.getState().setInstallError(z,M.result.error);const f=x.get(z);f&&(clearTimeout(f),x.delete(z))}}else if((g=M.result)!=null&&g.success&&z){const f=x.get(z);f&&clearTimeout(f);const C=setTimeout(()=>{ne.getState().installingPackageIds.includes(z)&&(console.log("[install-debug] Timeout fallback: clearing stuck package:",z),ne.getState().removeInstallingPackage(z)),x.delete(z)},6e4);x.set(z,C)}}};return window.addEventListener("atopile:action_result",m),()=>{window.removeEventListener("atopile:action_result",m),x.forEach(v=>clearTimeout(v)),x.clear()}},[]),a.useEffect(()=>{const x=ne.subscribe((m,v)=>{const M=m.installingPackageIds;M.length!==0&&m.packages!==v.packages&&m.packages&&M.forEach(N=>{const g=m.packages.find(z=>z.identifier===N);g!=null&&g.installed&&ne.getState().removeInstallingPackage(N)})});return()=>x()},[]),a.useEffect(()=>{const x=h.current;if(!x)return;const m=["projects","packages","problems","stdlib","variables","bom"];let v=null;const M=()=>{const f=x.clientHeight;let C=0,j=null;for(const B of m){if(t.has(B))continue;const S=x.querySelector(`[data-section-id="${B}"]`);if(!S)continue;const u=S.querySelector(".section-body"),d=S.querySelector(".section-title-bar");if(d&&(C+=d.offsetHeight),u){const T=u.offsetHeight,y=u.scrollHeight;C+=T,y>T+5&&!j&&(j={id:B,neededHeight:y-T,currentHeight:S.offsetHeight})}const F=S.querySelector(".section-resize-handle");F&&(C+=F.offsetHeight),C+=1}const $=f-C;if($>20&&j){const B=Math.min($,j.neededHeight),S=j.currentHeight+B,u=l[j.id];(!u||Math.abs(u-S)>5)&&r(d=>({...d,[j.id]:S}))}},N=()=>{v!==null&&clearTimeout(v),v=setTimeout(M,100)},g=setTimeout(M,150),z=new ResizeObserver(N);return z.observe(x),()=>{clearTimeout(g),v!==null&&clearTimeout(v),z.disconnect()}},[t,l,r,h])}function Ut({projects:s,state:n,sectionHeights:t,setSectionHeights:l,setCollapsedSections:r,setSelection:c,setSelectedPackage:h,setActiveStageFilter:p,action:o}){const i=a.useRef(null),x=a.useRef(0),m=a.useRef(0),v=a.useRef(null),M=b=>{r(A=>{const k=new Set(A);return k.has(b)?k.delete(b):k.add(b),k})},N=b=>{if(c(b),b.type==="project"||b.type==="build"||b.type==="symbol"){const A=s.find(D=>D.id===b.projectId),k=(A==null?void 0:A.root)||(A==null?void 0:A.path);k&&(ne.getState().setSelectedTargets([]),o("setSelectedTargets",{targetNames:[]}),o("selectProject",{projectRoot:k}))}},g=b=>{ne.getState().selectProject(b),ne.getState().setSelectedTargets([]),o("selectProject",{projectRoot:b}),o("setSelectedTargets",{targetNames:[]})},z=(b,A)=>{ne.getState().selectProject(b),ne.getState().setSelectedTargets([A]),o("selectProject",{projectRoot:b}),o("setSelectedTargets",{targetNames:[A]})},f=(b,A,k)=>{o("build",{level:b,id:A,label:k})},C=b=>{o("cancelBuild",{buildId:b})},j=b=>{o("cancelBuild",{buildId:b})},$=(b,A,k)=>{p({stageName:b||void 0,buildId:A,projectId:k}),r(D=>{const W=new Set(D);return W.delete("problems"),W})},B=()=>{p(null)},S=b=>{h(b),o("getPackageDetails",{packageId:b.fullName})},u=(b,A,k)=>{ne.getState().addInstallingPackage(b),o("installPackage",{packageId:b,projectRoot:A,version:k})},d=(b,A)=>{o("createProject",{parentDirectory:b,name:A})},F=b=>{var W,J,Z;const A=(W=n==null?void 0:n.projectModules)==null?void 0:W[b];b&&(!A||A.length===0)&&o("fetchModules",{projectRoot:b});const k=(J=n==null?void 0:n.projectFiles)==null?void 0:J[b];b&&(!k||k.length===0)&&o("fetchFiles",{projectRoot:b});const D=(Z=n==null?void 0:n.projectDependencies)==null?void 0:Z[b];b&&(!D||D.length===0)&&o("fetchDependencies",{projectRoot:b})},T=(b,A)=>{o("openSource",{projectId:b,entry:A})},y=(b,A)=>{o("openKiCad",{projectId:b,buildId:A})},_=(b,A)=>{o("openLayout",{projectId:b,buildId:A})},Q=(b,A)=>{o("open3D",{projectId:b,buildId:A})},H=async b=>{var V,L,K,X,te;const A=((V=n==null?void 0:n.projectModules)==null?void 0:V[b])||[],k=A.find(q=>q.name==="App"||q.type==="module")||A[0],D=(k==null?void 0:k.entry)||"main.ato:App",W=((K=(L=n==null?void 0:n.projects)==null?void 0:L.find(q=>q.root===b))==null?void 0:K.targets)||[],J=new Set(W.map(q=>q.name));let Z="new-build",E=1;for(;J.has(Z);)Z=`new-build-${E}`,E++;try{const q=await xe("addBuildTarget",{project_root:b,name:Z,entry:D});(X=q.result)!=null&&X.success?o("refreshProjects"):console.error("Failed to add build target:",(te=q.result)==null?void 0:te.message)}catch(q){console.error("Failed to add build target:",q)}},Y=async(b,A,k)=>{var Z,E;const D=A,W=k.name!==D?k.name:void 0,J=k.entry;try{const V=await xe("updateBuildTarget",{project_root:b,old_name:D,new_name:W,new_entry:J});(Z=V.result)!=null&&Z.success?o("refreshProjects"):console.error("Failed to update build target:",(E=V.result)==null?void 0:E.message)}catch(V){console.error("Failed to update build target:",V)}},P=async(b,A)=>{var k,D;try{const W=await xe("deleteBuildTarget",{project_root:b,name:A});(k=W.result)!=null&&k.success?o("refreshProjects"):console.error("Failed to delete build target:",(D=W.result)==null?void 0:D.message)}catch(W){console.error("Failed to delete build target:",W)}},O=async(b,A,k)=>{var D,W;try{const J=await xe("updateDependencyVersion",{project_root:b,identifier:A,new_version:k});(D=J.result)!=null&&D.success?o("fetchDependencies",{projectRoot:b}):console.error("Failed to update dependency version:",(W=J.result)==null?void 0:W.message)}catch(J){console.error("Failed to update dependency version:",J)}},I=a.useCallback(b=>{i.current&&(v.current!==null&&cancelAnimationFrame(v.current),v.current=requestAnimationFrame(()=>{const A=b.clientY-x.current,k=Math.max(100,m.current+A);l(D=>({...D,[i.current]:k})),v.current=null}))},[l]),R=a.useCallback(()=>{v.current!==null&&(cancelAnimationFrame(v.current),v.current=null),i.current=null,document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",R)},[I]),G=a.useCallback((b,A)=>{if(A.preventDefault(),i.current=b,x.current=A.clientY,t[b])m.current=t[b];else{const k=A.target.closest(".collapsible-section");m.current=k?k.getBoundingClientRect().height:200}document.addEventListener("mousemove",I),document.addEventListener("mouseup",R)},[t,I,R]);return{toggleSection:M,handleSelect:N,handleBuild:f,handleCancelBuild:C,handleCancelQueuedBuild:j,handleStageFilter:$,clearStageFilter:B,handleOpenPackageDetail:S,handlePackageInstall:u,handleCreateProject:d,handleProjectExpand:F,handleOpenSource:T,handleOpenKiCad:y,handleOpenLayout:_,handleOpen3D:Q,handleAddBuild:H,handleUpdateBuild:Y,handleDeleteBuild:P,handleDependencyVersionChange:O,handleSelectProject:g,handleSelectTarget:z,handleResizeStart:G}}const le=(s,n)=>{if(s==="openUrl"&&n&&"url"in n){const t=n.url;if(t){window.open(t,"_blank","noopener,noreferrer");return}}Je(s,n)};function Yt({logoUri:s,version:n,atopile:t,developerMode:l}){var T,y,_,Q,H,Y;const[r,c]=a.useState(!1),h=a.useRef(null),p=typeof navigator<"u"&&navigator.hardwareConcurrency||4,[o,i]=a.useState(!0),[x,m]=a.useState(p),[v,M]=a.useState(p),[N,g]=a.useState(""),[z,f]=a.useState(!1),C=a.useRef(null),[j,$]=a.useState({isValidating:!1,valid:null,version:null,error:null}),B=a.useRef(null),[S,u]=a.useState({type:null,value:null}),d=(((T=t==null?void 0:t.availableVersions)==null?void 0:T.length)??0)===0;a.useEffect(()=>{if(S.type==="version"&&(t==null?void 0:t.currentVersion)===S.value){u({type:null,value:null});return}if(S.type==="branch"&&(t==null?void 0:t.branch)===S.value){u({type:null,value:null});return}if(S.type!==null){const P=setTimeout(()=>{u({type:null,value:null})},6e4);return()=>clearTimeout(P)}},[t==null?void 0:t.currentVersion,t==null?void 0:t.branch,S]),a.useEffect(()=>{d&&(t==null?void 0:t.source)==="release"&&(u({type:null,value:null}),le("setAtopileSource",{source:"branch"}))},[d,t==null?void 0:t.source]);const F=(t==null?void 0:t.isInstalling)||S.type!==null;return a.useEffect(()=>{if(!r)return;const P=O=>{h.current&&!h.current.contains(O.target)&&c(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[r]),a.useEffect(()=>{r&&le("getMaxConcurrentSetting")},[r]),a.useEffect(()=>{if(!z)return;const P=O=>{C.current&&!C.current.contains(O.target)&&f(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[z]),a.useEffect(()=>{if((t==null?void 0:t.source)!=="local"||!(t!=null&&t.localPath)){$({isValidating:!1,valid:null,version:null,error:null});return}return B.current&&clearTimeout(B.current),$(P=>({...P,isValidating:!0})),B.current=setTimeout(()=>{le("validateAtopilePath",{path:t.localPath})},500),()=>{B.current&&clearTimeout(B.current)}},[t==null?void 0:t.source,t==null?void 0:t.localPath]),a.useEffect(()=>{const P=O=>{const I=O.detail,R=I==null?void 0:I.result;R!=null&&R.setting&&(i(R.setting.use_default),m(R.setting.custom_value||R.setting.default_value),M(R.setting.default_value)),(I==null?void 0:I.action)==="validateAtopilePath"&&R&&$({isValidating:!1,valid:R.valid??!1,version:R.version??null,error:R.error??null})};return window.addEventListener("atopile:action_result",P),()=>window.removeEventListener("atopile:action_result",P)},[]),e.jsxs("div",{className:"panel-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("img",{className:"logo",src:s||bt,alt:"atopile"}),e.jsx("span",{children:"atopile"}),n&&e.jsxs("span",{className:"version-badge",children:["v",n]})]}),e.jsx("div",{className:"header-actions",children:e.jsxs("div",{className:"settings-dropdown-container",ref:h,children:[e.jsx("button",{className:`icon-btn${r?" active":""}`,onClick:()=>c(!r),title:"Settings",children:e.jsx(Tn,{size:14})}),r&&e.jsxs("div",{className:"settings-dropdown",children:[(t==null?void 0:t.error)&&e.jsxs("div",{className:"settings-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:t.error})]}),d&&e.jsxs("div",{className:"settings-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:"No compatible release found. Select a branch or local install."})]}),e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Source"})}),e.jsxs("div",{className:"settings-source-buttons",children:[e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="release"?" active":""}${d?" disabled":""}`,onClick:()=>{d||(u({type:null,value:null}),le("setAtopileSource",{source:"release"}))},title:"Use a released version from PyPI",disabled:d,children:[e.jsx(be,{size:12}),"Release"]}),e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="branch"?" active":""}`,onClick:()=>{u({type:null,value:null}),le("setAtopileSource",{source:"branch"})},title:"Use a git branch from GitHub",children:[e.jsx(Oe,{size:12}),"Branch"]}),e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="local"?" active":""}`,onClick:()=>{u({type:null,value:null}),le("setAtopileSource",{source:"local"})},title:"Use a local installation",children:[e.jsx($e,{size:12}),"Local"]})]})]}),(t==null?void 0:t.source)==="release"&&!d&&e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Version"})}),e.jsxs("div",{className:"settings-select-wrapper",children:[e.jsx("select",{className:"settings-select",value:(t==null?void 0:t.currentVersion)||"",onChange:P=>{const O=P.target.value;O!==(t==null?void 0:t.currentVersion)&&u({type:"version",value:O}),le("setAtopileVersion",{version:O})},children:((t==null?void 0:t.availableVersions)||[]).slice(0,20).map(P=>{var O;return e.jsxs("option",{value:P,children:[P,P===((O=t==null?void 0:t.availableVersions)==null?void 0:O[0])?" (latest)":""]},P)})}),e.jsx(ee,{size:12,className:"select-chevron"})]}),F&&e.jsxs("div",{className:"install-status",children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:((y=t==null?void 0:t.installProgress)==null?void 0:y.message)||(S.type==="version"?`Installing v${S.value}...`:"Installing...")}),e.jsx("button",{className:"install-cancel-btn",onClick:()=>{u({type:null,value:null}),le("setAtopileInstalling",{installing:!1})},title:"Cancel installation",children:e.jsx(he,{size:10})})]})]}),(t==null?void 0:t.source)==="branch"&&e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Branch"})}),e.jsxs("div",{className:"branch-search-container",ref:C,children:[e.jsxs("div",{className:"branch-search-input-wrapper",children:[e.jsx(ue,{size:12,className:"branch-search-icon"}),e.jsx("input",{type:"text",className:"branch-search-input",placeholder:"Search branches...",value:N,onChange:P=>{g(P.target.value),f(!0)},onFocus:()=>f(!0)}),(t==null?void 0:t.branch)&&!N&&e.jsx("span",{className:"branch-current-value",children:t.branch})]}),z&&e.jsxs("div",{className:"branch-dropdown",children:[((t==null?void 0:t.availableBranches)||["main","develop"]).filter(P=>!N||P.toLowerCase().includes(N.toLowerCase())).slice(0,15).map(P=>e.jsxs("button",{className:`branch-option${P===(t==null?void 0:t.branch)?" active":""}`,onClick:()=>{P!==(t==null?void 0:t.branch)&&u({type:"branch",value:P}),le("setAtopieBranch",{branch:P}),g(""),f(!1)},children:[e.jsx(Oe,{size:12}),e.jsx("span",{children:P}),P==="main"&&e.jsx("span",{className:"branch-tag",children:"default"})]},P)),N&&!((t==null?void 0:t.availableBranches)||[]).some(P=>P.toLowerCase().includes(N.toLowerCase()))&&e.jsxs("div",{className:"branch-no-results",children:['No branches match "',N,'"']})]})]}),e.jsxs("span",{className:"settings-hint",children:["Installs from git+https://github.com/atopile/atopile.git@",(t==null?void 0:t.branch)||"main"]}),F&&e.jsxs("div",{className:"install-status",children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:((_=t==null?void 0:t.installProgress)==null?void 0:_.message)||(S.type==="branch"?`Installing ${S.value}...`:"Installing...")}),e.jsx("button",{className:"install-cancel-btn",onClick:()=>{u({type:null,value:null}),le("setAtopileInstalling",{installing:!1})},title:"Cancel installation",children:e.jsx(he,{size:10})})]})]}),(t==null?void 0:t.source)==="local"&&e.jsxs("div",{className:"settings-group local-path-section",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Local Path"})}),(((Q=t==null?void 0:t.detectedInstallations)==null?void 0:Q.length)??0)>0&&e.jsxs("div",{className:"detected-installations",children:[e.jsx("span",{className:"detected-label",children:"Detected:"}),(H=t==null?void 0:t.detectedInstallations)==null?void 0:H.map((P,O)=>e.jsxs("button",{className:`detected-item${(t==null?void 0:t.localPath)===P.path?" active":""}`,onClick:()=>le("setAtopileLocalPath",{path:P.path}),title:P.path,children:[e.jsx("span",{className:"detected-source",children:P.source}),P.version&&e.jsxs("span",{className:"detected-version",children:["v",P.version]})]},O))]}),e.jsxs("div",{className:"settings-path-input",children:[e.jsx("input",{type:"text",className:`settings-input${j.valid===!0?" valid":""}${j.valid===!1?" invalid":""}`,placeholder:"/path/to/atopile or ato",value:(t==null?void 0:t.localPath)||"",onChange:P=>{le("setAtopileLocalPath",{path:P.target.value})}}),e.jsx("button",{className:"path-browse-btn",onClick:()=>le("browseAtopilePath"),title:"Browse...",children:e.jsx($e,{size:12})})]}),(t==null?void 0:t.localPath)&&e.jsx("div",{className:`path-validation-status${j.valid===!0?" valid":""}${j.valid===!1?" invalid":""}`,children:j.isValidating?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:"Validating..."})]}):j.valid===!0?e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:12}),e.jsxs("span",{children:["Found atopile",j.version?` v${j.version}`:""]})]}):j.valid===!1?e.jsxs(e.Fragment,{children:[e.jsx(he,{size:12}),e.jsx("span",{children:j.error||"Invalid path"})]}):null})]}),!(t!=null&&t.isInstalling)&&(t==null?void 0:t.currentVersion)&&e.jsxs("div",{className:"settings-status",children:[e.jsx(ie,{size:12,className:"status-ok"}),e.jsx("span",{children:t.source==="local"?`Using local: ${((Y=t.localPath)==null?void 0:Y.split("/").pop())||"atopile"}`:`v${t.currentVersion} installed`})]}),e.jsx("div",{className:"settings-group",children:e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label-title",children:"Parallel builds"}),e.jsx("div",{className:"settings-inline-control",children:o?e.jsxs("button",{className:"settings-value-btn",onClick:()=>i(!1),title:"Click to set custom limit",children:["Auto (",v,")"]}):e.jsxs("div",{className:"settings-custom-input",children:[e.jsx("input",{type:"number",className:"settings-input small",min:1,max:32,value:x,onChange:P=>{const O=Math.max(1,Math.min(32,parseInt(P.target.value)||1));m(O),le("setMaxConcurrentSetting",{useDefault:!1,customValue:O})}}),e.jsx("button",{className:"settings-reset-btn",onClick:()=>{i(!0),le("setMaxConcurrentSetting",{useDefault:!0,customValue:null})},title:"Reset to auto",children:"Auto"})]})})]})}),e.jsx("div",{className:"settings-divider"}),e.jsx("div",{className:"settings-section-header",children:"Developer"}),e.jsxs("div",{className:"settings-group",children:[e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label-title",children:"Show all problems"}),e.jsx("div",{className:"settings-inline-control",children:e.jsxs("label",{className:"settings-toggle",children:[e.jsx("input",{type:"checkbox",checked:l||!1,onChange:P=>le("setDeveloperMode",{enabled:P.target.checked})}),e.jsx("span",{className:"settings-toggle-slider"})]})})]}),e.jsx("div",{className:"settings-hint",children:"Show internal developer messages in Problems panel"})]})]})]})})]})}const pe=(s,n)=>{if(s==="openUrl"&&n&&"url"in n){const t=n.url;if(t){window.open(t,"_blank","noopener,noreferrer");return}}Je(s,n)};function Ot(){var _,Q,H,Y,P,O;const s=ne(I=>I),n=(s==null?void 0:s.selectedProjectRoot)??null,t=(s==null?void 0:s.selectedTargetNames)??[],l=a.useMemo(()=>{var R,G,b;if(!n)return null;if(t.length>0)return t[0];const I=(R=s==null?void 0:s.projects)==null?void 0:R.find(A=>A.root===n);return((b=(G=I==null?void 0:I.targets)==null?void 0:G[0])==null?void 0:b.name)??null},[n,t,s==null?void 0:s.projects]),[r,c]=a.useState({type:"none"}),[h,p]=a.useState(new Set(["buildQueue","problems","stdlib","variables","bom"])),[o,i]=a.useState({}),[x,m]=a.useState(null),[v,M]=a.useState(null),N=a.useRef(null),{projects:g,projectCount:z,packageCount:f,queuedBuilds:C,filteredProblems:j,totalErrors:$,totalWarnings:B}=Ht({state:s,selection:r,activeStageFilter:v}),F=Math.max(40,Math.max(1,C.length)*34+12),T=Math.min(240,F);Qt({selectedProjectRoot:n,selectedTargetName:l,collapsedSections:h,sectionHeights:o,setSectionHeights:i,setCollapsedSections:p,containerRef:N,action:pe});const y=Ut({projects:g,state:s,sectionHeights:o,setSectionHeights:i,setCollapsedSections:p,setSelection:c,setSelectedPackage:m,setActiveStageFilter:M,action:pe});return s?e.jsxs("div",{className:`unified-layout ${x?"package-detail-open":""}`,children:[e.jsx(Yt,{logoUri:s==null?void 0:s.logoUri,version:s==null?void 0:s.version,atopile:s==null?void 0:s.atopile,developerMode:s==null?void 0:s.developerMode}),e.jsxs("div",{className:"panel-sections",ref:N,children:[e.jsx(je,{id:"projects",title:"Projects",badge:z,loading:s==null?void 0:s.isLoadingProjects,collapsed:h.has("projects"),onToggle:()=>y.toggleSection("projects"),height:o.projects,maxHeight:o.projects?void 0:350,onResizeStart:I=>y.handleResizeStart("projects",I),children:e.jsx(We,{selection:r,onSelect:y.handleSelect,onBuild:y.handleBuild,onCancelBuild:y.handleCancelBuild,onStageFilter:y.handleStageFilter,onCreateProject:y.handleCreateProject,onProjectExpand:y.handleProjectExpand,onOpenSource:y.handleOpenSource,onOpenKiCad:y.handleOpenKiCad,onOpenLayout:y.handleOpenLayout,onOpen3D:y.handleOpen3D,onFileClick:(I,R)=>{const G=g.find(b=>b.id===I);if(G){const b=`${G.root}/${R}`;pe("openFile",{file:b})}},onAddBuild:y.handleAddBuild,onUpdateBuild:y.handleUpdateBuild,onDeleteBuild:y.handleDeleteBuild,filterType:"projects",projects:g,projectModules:(s==null?void 0:s.projectModules)||{},projectFiles:(s==null?void 0:s.projectFiles)||{},projectDependencies:(s==null?void 0:s.projectDependencies)||{},onDependencyVersionChange:y.handleDependencyVersionChange,onRemoveDependency:(I,R)=>{pe("removePackage",{projectRoot:I,packageId:R})}})}),e.jsx(je,{id:"buildQueue",title:"Build Queue",badge:C.length>0?C.length:void 0,badgeType:"count",collapsed:h.has("buildQueue"),onToggle:()=>y.toggleSection("buildQueue"),height:h.has("buildQueue")?void 0:o.buildQueue,maxHeight:o.buildQueue?void 0:T,onResizeStart:I=>y.handleResizeStart("buildQueue",I),children:e.jsx(_t,{builds:C,onCancelBuild:y.handleCancelQueuedBuild})}),e.jsx(je,{id:"packages",title:"Packages",badge:f,loading:s==null?void 0:s.isLoadingPackages,warningMessage:(s==null?void 0:s.packagesError)||null,collapsed:h.has("packages"),onToggle:()=>y.toggleSection("packages"),height:o.packages,maxHeight:o.packages?void 0:350,onResizeStart:I=>y.handleResizeStart("packages",I),children:e.jsx(We,{selection:r,onSelect:y.handleSelect,onBuild:y.handleBuild,onCancelBuild:y.handleCancelBuild,onStageFilter:y.handleStageFilter,onOpenPackageDetail:y.handleOpenPackageDetail,onPackageInstall:y.handlePackageInstall,onOpenSource:y.handleOpenSource,onOpenKiCad:y.handleOpenKiCad,onOpenLayout:y.handleOpenLayout,onOpen3D:y.handleOpen3D,filterType:"packages",projects:g,installingPackageIds:s==null?void 0:s.installingPackageIds})}),e.jsx(je,{id:"problems",title:v?`Problems: ${v.stageName||v.buildId||"Filtered"}`:"Problems",badge:v?j.length:$+B,badgeType:v?"filter":"count",errorCount:v?void 0:$,warningCount:v?void 0:B,collapsed:h.has("problems"),onToggle:()=>y.toggleSection("problems"),onClearFilter:v?y.clearStageFilter:void 0,height:h.has("problems")?void 0:o.problems,onResizeStart:I=>y.handleResizeStart("problems",I),children:e.jsx(jt,{problems:j,projects:((_=s==null?void 0:s.projects)==null?void 0:_.map(I=>({id:I.root,name:I.name,root:I.root})))||[],selectedProjectRoot:n,onSelectProject:y.handleSelectProject,onProblemClick:I=>{pe("openFile",{file:I.file,line:I.line,column:I.column})}})}),e.jsx(je,{id:"stdlib",title:"Standard Library",badge:((Q=s==null?void 0:s.stdlibItems)==null?void 0:Q.length)||0,collapsed:h.has("stdlib"),onToggle:()=>y.toggleSection("stdlib"),height:h.has("stdlib")?void 0:o.stdlib,onResizeStart:I=>y.handleResizeStart("stdlib",I),children:e.jsx(vt,{items:s==null?void 0:s.stdlibItems,isLoading:s==null?void 0:s.isLoadingStdlib,onRefresh:()=>pe("refreshStdlib")})}),e.jsx(je,{id:"variables",title:"Variables",badge:(()=>{const I=s==null?void 0:s.currentVariablesData;if(!(I!=null&&I.nodes))return 0;const R=G=>{var A;let b=0;for(const k of G)b+=((A=k.variables)==null?void 0:A.length)||0,k.children&&(b+=R(k.children));return b};return R(I.nodes)})(),collapsed:h.has("variables"),onToggle:()=>y.toggleSection("variables"),height:h.has("variables")?void 0:o.variables,onResizeStart:I=>y.handleResizeStart("variables",I),children:e.jsx(At,{variablesData:s==null?void 0:s.currentVariablesData,isLoading:s==null?void 0:s.isLoadingVariables,error:s==null?void 0:s.variablesError,projects:s==null?void 0:s.projects,selectedProjectRoot:s==null?void 0:s.selectedProjectRoot,selectedTargetNames:s==null?void 0:s.selectedTargetNames,onSelectProject:y.handleSelectProject,onSelectTarget:y.handleSelectTarget})}),e.jsx(je,{id:"bom",title:"BOM",badge:((Y=(H=s==null?void 0:s.bomData)==null?void 0:H.components)==null?void 0:Y.length)??0,warningCount:(P=s==null?void 0:s.bomData)!=null&&P.components?s.bomData.components.filter(I=>I.stock!==null&&I.stock===0).length:0,collapsed:h.has("bom"),onToggle:()=>y.toggleSection("bom"),height:h.has("bom")?void 0:o.bom,onResizeStart:I=>y.handleResizeStart("bom",I),children:e.jsx($t,{bomData:s==null?void 0:s.bomData,isLoading:s==null?void 0:s.isLoadingBom,error:s==null?void 0:s.bomError,projects:s==null?void 0:s.projects,selectedProjectRoot:s==null?void 0:s.selectedProjectRoot,selectedTargetNames:s==null?void 0:s.selectedTargetNames,onSelectProject:y.handleSelectProject,onSelectTarget:y.handleSelectTarget,onGoToSource:(I,R)=>{pe("openFile",{file:I,line:R})}})})]}),x&&e.jsx("div",{className:"detail-panel-container",children:e.jsx(Lt,{package:x,packageDetails:(s==null?void 0:s.selectedPackageDetails)||null,isLoading:(s==null?void 0:s.isLoadingPackageDetails)||!1,isInstalling:((O=s==null?void 0:s.installingPackageIds)==null?void 0:O.includes(x.fullName))||!1,installError:(s==null?void 0:s.installError)||null,error:(s==null?void 0:s.packageDetailsError)||null,onClose:()=>{m(null),pe("clearPackageDetails")},onInstall:I=>{var G,b;const R=(s==null?void 0:s.selectedProjectRoot)||((b=(G=s==null?void 0:s.projects)==null?void 0:G[0])==null?void 0:b.root);R&&(ne.getState().addInstallingPackage(x.fullName),pe("installPackage",{packageId:x.fullName,projectRoot:R,version:I}))},onBuild:I=>{var G,b;const R=(s==null?void 0:s.selectedProjectRoot)||((b=(G=s==null?void 0:s.projects)==null?void 0:G[0])==null?void 0:b.root);R&&pe("buildPackage",{packageId:x.fullName,projectRoot:R,entry:I})}})})]}):e.jsx("div",{className:"sidebar loading",children:"Loading..."})}const Wt="atopile-theme-preference";function Kt(){if(typeof window>"u")return"system";const s=localStorage.getItem(Wt);return s==="dark"||s==="light"||s==="system"?s:"system"}function Xt(){if(typeof window>"u")return;const s=Kt();document.documentElement.setAttribute("data-theme",s)}Xt();Ms.createRoot(document.getElementById("root")).render(e.jsx(zs.StrictMode,{children:e.jsx(Ps,{children:e.jsx(Ot,{})})}));
