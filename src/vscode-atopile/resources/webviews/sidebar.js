import{r as a,j as e,s as xe,u as se,a as ss,c as Es,R as $s,A as Bs}from"./index-DJuVnStQ.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ls=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,t,r)=>r?r.toUpperCase():t.toLowerCase()),Oe=s=>{const n=Ls(s);return n.charAt(0).toUpperCase()+n.slice(1)},ns=(...s)=>s.filter((n,t,r)=>!!n&&n.trim()!==""&&r.indexOf(n)===t).join(" ").trim(),Vs=s=>{for(const n in s)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qs={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=a.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:l="",children:c,iconNode:o,...h},d)=>a.createElement("svg",{ref:d,...qs,width:n,height:n,stroke:s,strokeWidth:r?Number(t)*24/Number(n):t,className:ns("lucide",l),...!c&&!Vs(h)&&{"aria-hidden":"true"},...h},[...o.map(([i,g])=>a.createElement(i,g)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=(s,n)=>{const t=a.forwardRef(({className:r,...l},c)=>a.createElement(Ts,{ref:c,iconNode:n,className:ns(`lucide-${Is(Oe(s))}`,`lucide-${s}`,r),...l}));return t.displayName=Oe(s),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Rs=Q("arrow-right",Fs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],Me=Q("box",_s);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M17 19a1 1 0 0 1-1-1v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2a1 1 0 0 1-1 1z",key:"trhst0"}],["path",{d:"M17 21v-2",key:"ds4u3f"}],["path",{d:"M19 14V6.5a1 1 0 0 0-7 0v11a1 1 0 0 1-7 0V10",key:"1mo9zo"}],["path",{d:"M21 21v-2",key:"eo0ou"}],["path",{d:"M3 5V3",key:"1k5hjh"}],["path",{d:"M4 10a2 2 0 0 1-2-2V6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2a2 2 0 0 1-2 2z",key:"1dd30t"}],["path",{d:"M7 5V3",key:"1t1388"}]],ts=Q("cable",Ds);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Qs=Q("calendar",Hs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ie=Q("check",Us);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],J=Q("chevron-down",Ys);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],re=Q("chevron-right",Os);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],de=Q("circle-alert",Ws);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],Xs=Q("circle-arrow-up",Ks);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Zs=Q("circle-check-big",Gs);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],en=Q("circle-check",Js);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],nn=Q("circle-x",sn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ve=Q("circle",tn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M11 9h4a2 2 0 0 0 2-2V3",key:"1ve2rv"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M7 21v-4a2 2 0 0 1 2-2h4",key:"1fwkro"}],["circle",{cx:"15",cy:"15",r:"2",key:"3i40o0"}]],as=Q("circuit-board",an);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Fe=Q("clock",ln);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ls=Q("copy",rn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],Re=Q("cpu",cn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=[["path",{d:"m21.12 6.4-6.05-4.06a2 2 0 0 0-2.17-.05L2.95 8.41a2 2 0 0 0-.95 1.7v5.82a2 2 0 0 0 .88 1.66l6.05 4.07a2 2 0 0 0 2.17.05l9.95-6.12a2 2 0 0 0 .95-1.7V8.06a2 2 0 0 0-.88-1.66Z",key:"1u2ovd"}],["path",{d:"M10 22v-8L2.25 9.15",key:"11pn4q"}],["path",{d:"m10 14 11.77-6.87",key:"1kt1wh"}]],dn=Q("cuboid",on);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Pe=Q("download",un);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],we=Q("external-link",hn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]],ye=Q("file-code",mn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],We=Q("file-text",pn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Ie=Q("folder-open",xn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],rs=Q("folder",gn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],jn=Q("funnel",fn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Ke=Q("git-branch",Nn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],yn=Q("globe",vn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],kn=Q("grid-3x3",bn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],Cn=Q("grip-horizontal",wn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],An=Q("hammer",Sn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ce=Q("hash",Mn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Se=Q("layers",zn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ge=Q("loader-circle",Pn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],$n=Q("monitor",En);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],In=Q("moon",Bn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],be=Q("package",Ln);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],qn=Q("panels-top-left",Vn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Fn=Q("pause",Tn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],_n=Q("percent",Rn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Ae=Q("play",Dn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],is=Q("plus",Hn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ee=Q("refresh-cw",Qn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ue=Q("search",Un);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],On=Q("settings",Yn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],Kn=Q("skip-forward",Wn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],cs=Q("square",Xn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gn=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Zn=Q("sun",Gn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],et=Q("tag",Jn);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],nt=Q("trash-2",st);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ce=Q("triangle-alert",tt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],he=Q("x",at);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Ne=Q("zap",lt);function je({id:s,title:n,badge:t,badgeType:r="count",errorCount:l,warningCount:c,warningMessage:o,loading:h,collapsed:d,onToggle:i,onClearFilter:g,height:m,maxHeight:v,onResizeStart:z,children:y,flexGrow:f}){const M=!d&&m&&!f,j=!d&&!m&&v&&!f,C=M?{height:m,flex:"0 0 auto"}:j?{maxHeight:v,flex:"0 0 auto"}:void 0;return e.jsxs("div",{className:`collapsible-section ${d?"collapsed":""} ${f?"flex-grow":""} ${M?"has-height":""} ${j?"has-max-height":""}`,style:C,"data-section-id":s,children:[e.jsxs("div",{className:"section-title-bar",onClick:i,children:[e.jsx("button",{className:"section-chevron",children:d?e.jsx(re,{size:12}):e.jsx(J,{size:12})}),e.jsx("span",{className:"section-title",children:n}),h&&e.jsx("span",{className:"section-loading",children:e.jsx(ge,{size:12,className:"animate-spin"})}),l!==void 0&&l>0&&e.jsxs("span",{className:"section-error-count",children:[e.jsx(de,{size:10}),l]}),c!==void 0&&c>0&&e.jsxs("span",{className:"section-warning-count",title:o||void 0,children:[e.jsx(ce,{size:10}),c]}),o&&(c===void 0||c===0)&&e.jsx("span",{className:"section-warning-message",title:o,children:e.jsx(ce,{size:10})}),t!==void 0&&e.jsxs("span",{className:`section-badge ${r==="filter"?"filter-badge":""}`,children:[r==="filter"&&e.jsx(jn,{size:8}),t,r==="filter"&&g&&e.jsx("button",{className:"clear-filter-btn",onClick:N=>{N.stopPropagation(),g()},title:"Clear filter",children:e.jsx(he,{size:8})})]})]}),!d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"section-body",children:y}),z&&!f&&e.jsx("div",{className:"section-resize-handle",onMouseDown:z,children:e.jsx(Cn,{size:10})})]})]})}function rt(s,n=12){switch(s){case"module":return e.jsx(Me,{size:n,className:"type-icon module"});case"interface":return e.jsx(Ne,{size:n,className:"type-icon interface"});case"component":return e.jsx(Re,{size:n,className:"type-icon component"});case"parameter":return e.jsx(as,{size:n,className:"type-icon parameter"})}}const it=a.memo(function s({symbol:n,depth:t,projectId:r,selection:l,onSelect:c,onBuild:o}){const[h,d]=a.useState(!1),[i,g]=a.useState(!1),m=n.children&&n.children.length>0,v=l.type==="symbol"&&l.symbolPath===n.path;return e.jsxs("div",{className:"symbol-node",children:[e.jsxs("div",{className:`symbol-row ${m?"expandable":""} ${v?"selected":""}`,style:{paddingLeft:`${t*4}px`},onClick:()=>{m&&d(!h),c({type:"symbol",projectId:r,symbolPath:n.path,label:n.name})},onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[m?e.jsx("button",{className:"tree-expand",onClick:z=>{z.stopPropagation(),d(!h)},children:h?e.jsx(J,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"tree-spacer"}),rt(n.type),e.jsx("span",{className:"symbol-name",children:n.name}),n.hasErrors&&e.jsx("span",{className:"indicator error"}),n.hasWarnings&&!n.hasErrors&&e.jsx("span",{className:"indicator warning"}),e.jsx("button",{className:"symbol-play-btn",onClick:z=>{z.stopPropagation(),o("symbol",n.path,n.name)},title:`Build ${n.name}`,children:e.jsx(Ae,{size:10})})]}),h&&m&&e.jsx("div",{className:"symbol-children",children:n.children.map((z,y)=>e.jsx(s,{symbol:z,depth:t+1,projectId:r,selection:l,onSelect:c,onBuild:o},`${z.path}-${y}`))})]})}),os={interface:{icon:ts,color:"var(--ctp-blue)",label:"Interface"},module:{icon:Me,color:"var(--ctp-green)",label:"Module"},component:{icon:Re,color:"var(--ctp-mauve)",label:"Component"},trait:{icon:Ne,color:"var(--ctp-yellow)",label:"Trait"},parameter:{icon:Ce,color:"var(--ctp-peach)",label:"Parameter"}};function Le({child:s,depth:n,expandedPaths:t,onToggle:r,basePath:l=""}){const c=l?`${l}.${s.name}`:s.name,o=t.has(c),h=s.children&&s.children.length>0,d=s.itemType||"interface",i=os[d],g=i.icon,m=v=>{v.stopPropagation(),h&&r(c)};return e.jsxs("div",{className:"module-tree-node",children:[e.jsxs("div",{className:`module-tree-row ${h?"expandable":""}`,style:{paddingLeft:`${n*12+4}px`},onClick:m,children:[h?e.jsx("button",{className:"module-tree-expand-btn",onClick:m,children:o?e.jsx(J,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"module-tree-expand-spacer"}),e.jsx("span",{className:"module-tree-icon",style:{color:i.color},children:e.jsx(g,{size:12})}),e.jsx("span",{className:"module-tree-name",children:s.name}),e.jsx("span",{className:"module-tree-type",style:{color:i.color},children:s.typeName})]}),o&&h&&e.jsx("div",{className:"module-tree-children",children:s.children.map((v,z)=>e.jsx(Le,{child:v,depth:n+1,expandedPaths:t,onToggle:r,basePath:c},`${c}-${v.name}-${z}`))})]})}function ct({children:s,rootName:n,rootType:t}){const[r,l]=a.useState(new Set),c=o=>{l(h=>{const d=new Set(h);return d.has(o)?d.delete(o):d.add(o),d})};if(n){const h=os[t==="component"?"component":"module"],d=h.icon,i=r.has("__root__");return e.jsxs("div",{className:"module-tree",children:[e.jsxs("div",{className:"module-tree-row expandable root",onClick:()=>c("__root__"),children:[e.jsx("button",{className:"module-tree-expand-btn",children:i?e.jsx(J,{size:12}):e.jsx(re,{size:12})}),e.jsx("span",{className:"module-tree-icon",style:{color:h.color},children:e.jsx(d,{size:14})}),e.jsx("span",{className:"module-tree-name root-name",children:n}),e.jsx("span",{className:"module-tree-count",children:s.length})]}),i&&e.jsx("div",{className:"module-tree-children",children:s.map((g,m)=>e.jsx(Le,{child:g,depth:1,expandedPaths:r,onToggle:c},`${g.name}-${m}`))})]})}return e.jsx("div",{className:"module-tree",children:s.map((o,h)=>e.jsx(Le,{child:o,depth:0,expandedPaths:r,onToggle:c},`${o.name}-${h}`))})}function ds({validation:s,onApplySuggestion:n,className:t=""}){return s.isValid?null:e.jsxs("div",{className:`name-validation-dropdown ${t}`,children:[e.jsxs("div",{className:"validation-error",children:[e.jsx(de,{size:12,className:"validation-icon"}),e.jsx("span",{children:s.error})]}),s.suggestion&&e.jsxs("button",{className:"validation-suggestion",onClick:r=>{r.stopPropagation(),r.preventDefault(),n(s.suggestion)},type:"button",children:[e.jsx("span",{className:"suggestion-label",children:"Use:"}),e.jsx("code",{className:"suggestion-value",children:s.suggestion}),e.jsx(Rs,{size:12,className:"suggestion-arrow"})]})]})}const ot=/^[a-z][a-z0-9_-]*$/;function us(s){if(!s||s.trim()==="")return{isValid:!1,error:"Name cannot be empty",suggestion:void 0};const n=s.trim();if(ot.test(n))return{isValid:!0};const t=dt(n);let r="Invalid name";return/\s/.test(n)?r="Name cannot contain spaces":/^[0-9]/.test(n)?r="Name must start with a letter":/[A-Z]/.test(n)?r="Name must be lowercase":/[^a-z0-9_-]/.test(n)&&(r="Name contains invalid characters"),{isValid:!1,error:r,suggestion:t!==n?t:void 0}}function dt(s){let n=s.toLowerCase().replace(/[\s_]+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-+|-+$/g,"");return/^[0-9]/.test(n)&&(n="project-"+n),n||(n="new-project"),n}function ut(){const[s,n]=a.useState(0);return a.useEffect(()=>{const t=setInterval(()=>{n(r=>r+1)},1e3);return()=>clearInterval(t)},[]),e.jsxs(e.Fragment,{children:[s,"s"]})}function ht(s){const n=Math.floor(s/3600),t=Math.floor(s%3600/60),r=Math.floor(s%60);return n>0?`${n}:${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:`${t}:${r.toString().padStart(2,"0")}`}function mt(s){const n=s.replace(/_/g,"T").replace(/-(\d{2})-(\d{2})$/,":$1:$2");return new Date(n)}function hs(s){const n=mt(s);if(isNaN(n.getTime()))return"";const r=new Date().getTime()-n.getTime(),l=Math.floor(r/1e3),c=Math.floor(l/60),o=Math.floor(c/60),h=Math.floor(o/24);return l<60?"just now":c<60?`${c}m ago`:o<24?`${o}h ago`:h===1?"yesterday":h<7?`${h}d ago`:n.toLocaleDateString()}function pt(s,n=12,t){switch(s){case"building":return e.jsx(ve,{size:n,className:"status-icon building"});case"queued":return e.jsxs("span",{className:"status-icon queued",title:t?`Queue position: ${t}`:"Queued",children:[e.jsx(Fe,{size:n}),t&&e.jsx("span",{className:"queue-position",children:t})]});case"success":return e.jsx(ie,{size:n,className:"status-icon success"});case"error":return e.jsx(he,{size:n,className:"status-icon error"});case"warning":return e.jsx(ce,{size:n,className:"status-icon warning"});default:return e.jsx("div",{className:"status-dot idle"})}}function xt(s,n=12){switch(s){case"running":return e.jsx(ve,{size:n,className:"stage-icon running"});case"success":return e.jsx(ie,{size:n,className:"stage-icon success"});case"warning":return e.jsx(ce,{size:n,className:"stage-icon warning"});case"error":return e.jsx(he,{size:n,className:"stage-icon error"});case"skipped":return e.jsx(Kn,{size:n,className:"stage-icon skipped"});case"pending":default:return e.jsx(ve,{size:n,className:"stage-icon pending"})}}function ms(s,n=12){switch(s){case"success":return e.jsx(ie,{size:n,className:"status-icon success dimmed"});case"warning":return e.jsx(ce,{size:n,className:"status-icon warning dimmed"});case"error":case"failed":return e.jsx(de,{size:n,className:"status-icon error dimmed"});default:return e.jsx(ve,{size:n,className:"status-icon idle dimmed"})}}const gt=a.memo(function({build:n,projectId:t,projectRoot:r,selection:l,onSelect:c,onBuild:o,onCancelBuild:h,onStageFilter:d,onUpdateBuild:i,onDeleteBuild:g,onOpenSource:m,onOpenKiCad:v,onOpenLayout:z,onOpen3D:y,availableModules:f=[],allBuilds:M=[],readOnly:j=!1}){var Ye;const[C,N]=a.useState(!1),[$,P]=a.useState(!1),[p,x]=a.useState(!1),[u,V]=a.useState(n.name),[F,B]=a.useState(n.entry),[_,S]=a.useState(""),[T,H]=a.useState(!1),[U,X]=a.useState(null),I=a.useRef(null),[Y,ne]=a.useState(null),[w,A]=a.useState(!1),[k,D]=a.useState(null),[O,Z]=a.useState(n.elapsedSeconds||0),G=n.status==="building",[E,L]=a.useState(null),[q,W]=a.useState(!1);a.useEffect(()=>{if(!G){Z(n.elapsedSeconds||n.duration||0);return}Z(n.elapsedSeconds||0);const b=setInterval(()=>{Z(ae=>ae+1)},1e3);return()=>clearInterval(b)},[G,n.elapsedSeconds,n.duration]);const K=20,te=()=>{if(!n.stages||n.stages.length===0)return 0;const b=n.totalStages||K;let ae=0,me=0;for(const ke of n.stages){const zs=ke.status==="success"||ke.status==="warning"||ke.status==="error"||ke.status==="skipped",Ps=ke.status==="running";zs?ae+=1:Ps&&(me+=.5)}const $e=(ae+me)/b*100;return Math.min($e,100)},ee=(()=>{if(n.currentStage)return n.currentStage;if(!n.stages)return null;const b=n.stages.find(ae=>ae.status==="running");return(b==null?void 0:b.displayName)||(b==null?void 0:b.name)||null})();a.useEffect(()=>{if(ee&&ee!==E){W(!0),L(ee);const b=setTimeout(()=>W(!1),300);return()=>clearTimeout(b)}},[ee,E]);const fe=f.filter(b=>b.type==="module"||b.type==="component").filter(b=>{if(!_)return!0;const ae=_.toLowerCase();return b.name.toLowerCase().includes(ae)||b.entry.toLowerCase().includes(ae)||b.file.toLowerCase().includes(ae)});a.useEffect(()=>{p&&I.current&&I.current.focus()},[p]);const oe=l.type==="build"&&l.buildId===`${t}:${n.id}`;a.useEffect(()=>{!oe||Y!==null||w||!r||!n.entry||(A(!0),D(null),xe("getModuleChildren",{projectRoot:r,entryPoint:n.entry,maxDepth:3}).then(b=>{const ae=b.result??{},me=Array.isArray(ae.children)?ae.children:[];ne(me),A(!1)}).catch(b=>{console.warn("Failed to fetch module children:",b),D(b.message||"Failed to load module structure"),A(!1)}))},[oe,Y,w,r,n.entry,n.name]);const ze=a.useMemo(()=>us(u),[u]),He=()=>{ze.isValid&&(P(!1),i&&i(t,n.id,{name:u}))},bs=b=>{V(b)},ks=b=>{S(b)},Qe=b=>{const ae=M.find(me=>me.id!==n.id&&me.entry===b.entry);if(ae){X({entry:b.entry,usedBy:ae.name});return}X(null),B(b.entry),x(!1),S(""),i&&i(t,n.id,{entry:b.entry})},ws=()=>{U&&(B(U.entry),x(!1),S(""),X(null),i&&i(t,n.id,{entry:U.entry}))},Cs=()=>{X(null)},Ue=Y&&Y.length>0,Ss=n.symbols&&n.symbols.length>0,As=n.stages&&n.stages.length>0,Ms=((Ye=n.entry)==null?void 0:Ye.split(":").pop())||n.name;return e.jsxs("div",{className:`build-card ${oe?"selected":""} ${G?"building":""}`,onClick:b=>{b.stopPropagation(),c({type:"build",projectId:t,buildId:`${t}:${n.id}`,label:`${n.name}`})},children:[e.jsxs("div",{className:"build-card-header",onClick:b=>{oe&&(b.stopPropagation(),c({type:"none"}))},children:[e.jsxs("div",{className:"build-header-left",children:[j?e.jsx("div",{className:"build-status-icon",children:e.jsx(ve,{size:8,className:"status-icon idle"})}):e.jsx("div",{className:"build-status-icon",children:pt(n.status,12,n.queuePosition)}),$&&oe&&!j?e.jsxs("div",{className:"name-input-wrapper",onClick:b=>b.stopPropagation(),children:[e.jsx("input",{type:"text",className:`build-name-input ${ze.isValid?"":"invalid"}`,value:u,onChange:b=>V(b.target.value),onBlur:()=>{ze.isValid&&He()},onKeyDown:b=>{b.key==="Enter"&&He(),b.key==="Escape"&&(V(n.name),P(!1))},autoFocus:!0}),e.jsx(ds,{validation:ze,onApplySuggestion:bs})]}):e.jsx("span",{className:`build-card-name ${oe&&!j?"editable":""}`,onClick:oe&&!j?b=>{b.stopPropagation(),P(!0)}:void 0,title:oe&&!j?"Click to edit build name":void 0,children:u}),!j&&G&&ee&&e.jsx("span",{className:`build-inline-stage ${q?"animating":""}`,children:ee})]}),e.jsx("div",{className:"build-header-right",children:!j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"build-indicators",children:[G&&e.jsx("span",{className:"build-elapsed-time-inline",children:ht(O)}),!G&&e.jsxs(e.Fragment,{children:[n.errors!==void 0&&n.errors>0&&e.jsxs("span",{className:"error-indicator clickable",onClick:b=>{b.stopPropagation(),d==null||d("",n.id,t)},title:"Click to filter problems for this build",children:[e.jsx(de,{size:12}),e.jsx("span",{children:n.errors})]}),n.warnings!==void 0&&n.warnings>0&&e.jsxs("span",{className:"warning-indicator clickable",onClick:b=>{b.stopPropagation(),d==null||d("",n.id,t)},title:"Click to filter problems for this build",children:[e.jsx(ce,{size:12}),e.jsx("span",{children:n.warnings})]}),n.duration?e.jsxs("span",{className:"build-duration",children:[n.duration.toFixed(1),"s"]}):n.lastBuild?e.jsxs("span",{className:"last-build-info",title:`Last build: ${n.lastBuild.status}`,children:[ms(n.lastBuild.status,10),e.jsx("span",{className:"last-build-time",children:hs(n.lastBuild.timestamp)})]}):null]})]}),G?e.jsx("button",{className:"build-target-cancel-btn",onClick:b=>{b.stopPropagation(),n.buildId&&h&&h(n.buildId)},title:`Cancel build ${n.name}`,children:e.jsx(cs,{size:10,fill:"currentColor"})}):oe?e.jsx("button",{className:"build-target-delete-btn",onClick:b=>{b.stopPropagation(),H(!0)},title:`Delete build ${n.name}`,children:e.jsx(nt,{size:12})}):e.jsx("button",{className:"build-target-play-btn",onClick:b=>{b.stopPropagation(),o("build",`${t}:${n.id}`,n.name)},title:`Build ${n.name}`,children:e.jsx(Ae,{size:12})})]})})]}),!j&&T&&e.jsxs("div",{className:"build-delete-confirm",onClick:b=>b.stopPropagation(),children:[e.jsxs("span",{className:"delete-confirm-text",children:['Delete "',n.name,'"?']}),e.jsxs("div",{className:"delete-confirm-buttons",children:[e.jsx("button",{className:"delete-confirm-btn cancel",onClick:()=>H(!1),children:"Cancel"}),e.jsx("button",{className:"delete-confirm-btn confirm",onClick:()=>{H(!1),g==null||g(t,n.id)},children:"Delete"})]})]}),U&&e.jsxs("div",{className:"build-duplicate-warning",onClick:b=>b.stopPropagation(),children:[e.jsx("div",{className:"duplicate-warning-icon",children:e.jsx(ce,{size:16})}),e.jsxs("span",{className:"duplicate-warning-text",children:['This entry point is already used by "',U.usedBy,'"']}),e.jsxs("div",{className:"duplicate-warning-buttons",children:[e.jsx("button",{className:"duplicate-warning-btn cancel",onClick:Cs,children:"Cancel"}),e.jsx("button",{className:"duplicate-warning-btn confirm",onClick:ws,children:"Use Anyway"})]})]}),!j&&G&&e.jsx("div",{className:"build-progress-container",children:e.jsx("div",{className:"build-progress-bar",children:e.jsx("div",{className:"build-progress-fill",style:{width:`${te()}%`}})})}),oe&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"build-card-entry-row",children:[e.jsx(ye,{size:12}),p?e.jsxs("div",{className:"entry-picker",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"entry-search-box",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:I,type:"text",className:"entry-search-input",value:_,onChange:b=>ks(b.target.value),onKeyDown:b=>{b.key==="Escape"&&(S(""),x(!1),X(null)),b.key==="Enter"&&fe.length===1&&Qe(fe[0])},placeholder:"Search modules..."}),e.jsx("button",{className:"entry-close-btn",onClick:()=>{S(""),x(!1),X(null)},children:e.jsx(he,{size:10})})]}),e.jsx("div",{className:"entry-dropdown",children:fe.length>0?fe.map(b=>e.jsxs("div",{className:`entry-option ${b.entry===F?"selected":""}`,onClick:()=>Qe(b),children:[e.jsx(Me,{size:10,className:`module-type-icon ${b.type}`}),e.jsx("span",{className:"entry-option-name",children:b.name}),e.jsx("span",{className:"entry-option-file",children:b.file})]},b.entry)):f.length===0?e.jsx("div",{className:"entry-empty",children:e.jsx("span",{children:"No modules found in project"})}):e.jsx("div",{className:"entry-empty",children:e.jsxs("span",{children:['No matching modules for "',_,'"']})})})]}):e.jsx("span",{className:"entry-path editable",onClick:b=>{b.stopPropagation(),x(!0),S("")},title:"Click to change entry point",children:F}),n.duration&&e.jsxs("span",{className:"build-duration",children:[e.jsx(Fe,{size:10}),n.duration.toFixed(1),"s"]})]}),As&&e.jsxs("div",{className:"build-stages-section",children:[e.jsxs("button",{className:"stages-toggle",onClick:b=>{b.stopPropagation(),N(!C)},children:[C?e.jsx(J,{size:12}):e.jsx(re,{size:12}),e.jsx("span",{children:"Build Stages"}),e.jsxs("span",{className:"stages-summary",children:[n.stages.filter(b=>b.status==="success").length,"/",n.stages.length," complete"]})]}),C&&e.jsx("div",{className:"build-stages-list",children:n.stages.map(b=>{const ae=(b.status==="warning"||b.status==="error")&&d,me=b.duration??b.elapsedSeconds;return e.jsxs("div",{className:`stage-row ${b.status} ${ae?"clickable":""}`,onClick:ae?$e=>{$e.stopPropagation(),d(b.name,n.id,t)}:void 0,title:ae?`Filter problems to ${b.displayName||b.name} stage`:void 0,children:[xt(b.status),e.jsx("span",{className:"stage-name",children:b.displayName||b.name}),b.message&&e.jsx("span",{className:"stage-message",children:b.message}),e.jsx("span",{className:"stage-duration",children:b.status==="running"?e.jsx(ut,{}):me!=null?`${me.toFixed(1)}s`:""})]},b.name)})})]}),e.jsxs("div",{className:"build-card-actions",children:[e.jsxs("button",{className:"build-action-btn primary",onClick:b=>{b.stopPropagation(),o("build",`${t}:${n.id}`,n.name)},title:`Build ${n.name}`,children:[e.jsx(Ae,{size:12}),e.jsx("span",{children:"Build"})]}),e.jsxs("button",{className:"build-action-btn",onClick:b=>{b.stopPropagation(),m==null||m(t,n.entry)},title:"Open Source Code",children:[e.jsx(ye,{size:12}),e.jsx("span",{children:"ato"})]}),e.jsxs("button",{className:"build-action-btn",onClick:b=>{b.stopPropagation(),v==null||v(t,n.id)},title:"Open in KiCad",children:[e.jsx(kn,{size:12}),e.jsx("span",{children:"KiCad"})]}),e.jsxs("button",{className:"build-action-btn",onClick:b=>{b.stopPropagation(),z==null||z(t,n.id)},title:"Edit Layout",children:[e.jsx(qn,{size:12}),e.jsx("span",{children:"Layout"})]}),e.jsxs("button",{className:"build-action-btn",onClick:b=>{b.stopPropagation(),y==null||y(t,n.id)},title:"3D Preview",children:[e.jsx(dn,{size:12}),e.jsx("span",{children:"3D"})]})]}),w&&e.jsxs("div",{className:"build-card-symbols loading",children:[e.jsx(ve,{size:12,className:"spinner"}),e.jsx("span",{className:"loading-text",children:"Loading module structure..."})]}),k&&e.jsx("div",{className:"build-card-symbols error",children:e.jsxs("span",{className:"error-text",children:["Failed to load: ",k]})}),!w&&!k&&Ue&&e.jsx("div",{className:"build-card-symbols",children:e.jsx(ct,{children:Y,rootName:Ms})}),!w&&!k&&!Ue&&Ss&&n.symbols[0]&&e.jsx("div",{className:"build-card-symbols",children:e.jsx(it,{symbol:n.symbols[0],depth:0,projectId:t,selection:l,onSelect:c,onBuild:o},n.symbols[0].path)})]})]})});function ps({builds:s,projectId:n,projectRoot:t,selection:r,onSelect:l,onBuild:c,onCancelBuild:o,onStageFilter:h,onUpdateBuild:d,onDeleteBuild:i,onOpenSource:g,onOpenKiCad:m,onOpenLayout:v,onOpen3D:z,onAddBuild:y,availableModules:f=[],readOnly:M=!1}){const[j,C]=a.useState(!0),N=s.filter(F=>F.status==="building").length,$=s.filter(F=>F.status==="queued").length,P=s.filter(F=>F.status==="error").length,p=s.filter(F=>F.status==="warning").length,x=s.filter(F=>F.status==="success").length,u=s.filter(F=>F.status==="idle").length,V=!M&&(N>0||$>0||P>0||p>0||x>0);return e.jsxs("div",{className:"builds-card",onClick:F=>F.stopPropagation(),children:[e.jsxs("div",{className:"builds-card-header",onClick:F=>{F.stopPropagation(),C(!j)},children:[e.jsx("span",{className:"builds-card-expand",children:e.jsx(J,{size:12,className:`expand-icon ${j?"expanded":""}`})}),e.jsx(An,{size:14,className:"builds-card-icon"}),e.jsx("span",{className:"builds-card-title",children:"Builds"}),M?e.jsx("span",{className:"builds-count",children:s.length}):e.jsxs(e.Fragment,{children:[N>0&&e.jsx("span",{className:"builds-status-badge building",title:`${N} building`,children:N}),$>0&&e.jsx("span",{className:"builds-status-badge queued",title:`${$} queued`,children:$}),P>0&&e.jsx("span",{className:"builds-status-badge error",title:`${P} failed`,children:P}),p>0&&e.jsx("span",{className:"builds-status-badge warning",title:`${p} warnings`,children:p}),x>0&&e.jsx("span",{className:"builds-status-badge success",title:`${x} passed`,children:x}),!V&&u>0&&e.jsx("span",{className:"builds-count",children:u})]})]}),j&&e.jsxs("div",{className:"builds-card-content",children:[s.map((F,B)=>e.jsx(gt,{build:F,projectId:n,projectRoot:t,selection:r,onSelect:l,onBuild:c,onCancelBuild:o,onStageFilter:h,onUpdateBuild:d,onDeleteBuild:i,onOpenSource:g,onOpenKiCad:m,onOpenLayout:v,onOpen3D:z,availableModules:f,allBuilds:s,readOnly:M},`${F.id}-${B}`)),!M&&e.jsxs("button",{className:"add-build-btn",onClick:F=>{F.stopPropagation(),y==null||y(n)},title:"Add new build target",children:[e.jsx(is,{size:12}),e.jsx("span",{children:"Add build"})]})]})]})}function ft({dependency:s,availableVersions:n=[],onVersionChange:t,onRemove:r,readOnly:l=!1}){const[c,o]=a.useState(s.version),[h,d]=a.useState(!1),i=!l&&(s.hasUpdate||s.latestVersion&&s.version!==s.latestVersion),g=n.length>0?n:s.latestVersion&&s.latestVersion!==s.version?[s.latestVersion,s.version]:[s.version],m=v=>{o(v),t==null||t(s.identifier,v)};return e.jsxs("div",{className:`dependency-item ${i?"has-update":""}`,children:[e.jsxs("div",{className:"dependency-info",children:[e.jsx(be,{size:14,className:"dependency-icon"}),e.jsx("span",{className:"dependency-name",title:s.identifier,children:s.name}),s.publisher&&s.publisher!=="atopile"&&e.jsxs("span",{className:"dependency-publisher",children:["by ",s.publisher]})]}),e.jsxs("div",{className:"dependency-actions",children:[l?e.jsx("span",{className:"dependency-version-display",title:`Version ${s.version}`,children:s.version}):e.jsx("select",{className:`dependency-version-select ${i?"update-available":""}`,value:c,onChange:v=>{v.stopPropagation(),m(v.target.value)},onClick:v=>v.stopPropagation(),title:i?`Update available: ${s.latestVersion}`:`Version ${s.version}`,children:g.map((v,z)=>e.jsxs("option",{value:v,children:[v,z===0&&i&&v===s.latestVersion?" (latest)":""]},v))}),!l&&e.jsx("button",{className:`dependency-remove-btn ${h?"removing":""}`,onClick:v=>{v.stopPropagation(),h||(d(!0),r==null||r(s.identifier))},disabled:h,title:h?"Removing...":`Remove ${s.name}`,children:h?e.jsx(ge,{size:12,className:"spin"}):e.jsx(he,{size:12})})]})]})}function xs({dependencies:s,projectId:n,onVersionChange:t,onRemove:r,readOnly:l=!1}){const[c,o]=a.useState(!1);return!s||s.length===0?null:e.jsxs("div",{className:"dependency-card",onClick:h=>h.stopPropagation(),children:[e.jsxs("div",{className:"dependency-card-header",onClick:h=>{h.stopPropagation(),o(!c)},children:[e.jsx("span",{className:"dependency-card-expand",children:e.jsx(J,{size:12,className:`expand-icon ${c?"expanded":""}`})}),e.jsx(be,{size:14,className:"dependency-card-icon"}),e.jsx("span",{className:"dependency-card-title",children:"Dependencies"}),e.jsx("span",{className:"dependency-count",children:s.length})]}),c&&e.jsx("div",{className:"dependency-card-content",children:s.map(h=>e.jsx(ft,{dependency:h,onVersionChange:(d,i)=>t==null?void 0:t(n,d,i),onRemove:d=>r==null?void 0:r(n,d),readOnly:l},h.identifier))})]})}function jt(s,n=12){switch(s){case"ato":return e.jsx(ye,{size:n,className:"file-icon ato"});case"py":return e.jsx(We,{size:n,className:"file-icon python"});default:return e.jsx(We,{size:n,className:"file-icon"})}}const Nt=a.memo(function s({node:n,depth:t,onFileClick:r,defaultExpanded:l=!1}){const[c,o]=a.useState(l),h=n.type==="folder",d=h&&n.children&&n.children.length>0;return e.jsxs("div",{className:"file-tree-node",children:[e.jsxs("div",{className:`file-tree-row ${h?"folder":"file"} ${n.extension||""}`,style:{paddingLeft:`${t*12+4}px`},onClick:i=>{i.stopPropagation(),h?o(!c):r&&r(n.path)},children:[h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"file-tree-expand",children:c?e.jsx(J,{size:12}):e.jsx(re,{size:12})}),c?e.jsx(Ie,{size:14,className:"folder-icon open"}):e.jsx(rs,{size:14,className:"folder-icon"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"file-tree-spacer"}),jt(n.extension,14)]}),e.jsx("span",{className:"file-tree-name",children:n.name})]}),c&&d&&e.jsx("div",{className:"file-tree-children",children:[...n.children].sort((i,g)=>i.type==="file"&&g.type==="folder"?-1:i.type==="folder"&&g.type==="file"?1:i.name.localeCompare(g.name)).map(i=>e.jsx(s,{node:i,depth:t+1,onFileClick:r,defaultExpanded:!1},i.path))})]})});function gs(s){let n=0;for(const t of s)t.type==="file"?n++:t.children&&(n+=gs(t.children));return n}const fs=a.memo(function({files:n,onFileClick:t}){const[r,l]=a.useState(!1);if(!n||n.length===0)return null;const c=[...n].sort((h,d)=>h.type==="file"&&d.type==="folder"?-1:h.type==="folder"&&d.type==="file"?1:h.name.localeCompare(d.name)),o=gs(n);return e.jsxs("div",{className:"file-explorer-card",onClick:h=>h.stopPropagation(),children:[e.jsxs("div",{className:"file-explorer-card-header",onClick:h=>{h.stopPropagation(),l(!r)},children:[e.jsx("span",{className:"file-explorer-card-expand",children:e.jsx(J,{size:12,className:`expand-icon ${r?"expanded":""}`})}),e.jsx(rs,{size:14,className:"file-explorer-card-icon"}),e.jsx("span",{className:"file-explorer-card-title",children:"Files"}),e.jsx("span",{className:"file-count",children:o})]}),r&&e.jsx("div",{className:"file-explorer-card-content",children:c.map(h=>e.jsx(Nt,{node:h,depth:0,onFileClick:t,defaultExpanded:!1},h.path))})]})});function vt(s){return s==null?"0":s>=1e6?(s/1e6).toFixed(1).replace(/\.0$/,"")+"M":s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"k":s.toString()}function yt(s,n){if(!(s.installedIn||[]).some(c=>c===n||c.endsWith(`/${n}`)||n.endsWith(c)))return{installed:!1};const l=s.latestVersion&&s.version&&s.version!==s.latestVersion;return{installed:!0,version:s.version,needsUpdate:!!l,latestVersion:s.latestVersion}}function bt({versions:s,selectedVersion:n,onVersionChange:t,latestVersion:r}){const[l,c]=a.useState(!1),o=a.useRef(null);a.useEffect(()=>{function g(m){o.current&&!o.current.contains(m.target)&&c(!1)}return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const h=s.filter(g=>g&&g!=="unknown");if(h.length===0)return null;const i=(n&&n!=="unknown"?n:null)||h[0]||"";return e.jsxs("div",{className:"version-selector",ref:o,children:[e.jsxs("button",{className:"version-selector-btn",onClick:g=>{g.stopPropagation(),c(!l)},title:"Select version",children:[e.jsx("span",{className:"version-selector-value",children:i}),e.jsx(J,{size:10})]}),l&&e.jsx("div",{className:"version-selector-menu",children:h.map(g=>e.jsxs("button",{className:`version-option ${g===n?"selected":""}`,onClick:m=>{m.stopPropagation(),t(g),c(!1)},children:[e.jsx("span",{children:g}),g===r&&e.jsx("span",{className:"latest-tag",children:"latest"}),g===n&&e.jsx(ie,{size:12,className:"selected-check"})]},g))})]})}function kt({availableProjects:s,selectedProjectId:n,onSelect:t}){const[r,l]=a.useState(!1),[c,o]=a.useState(""),h=a.useRef(null),d=a.useRef(null);a.useEffect(()=>{function m(v){h.current&&!h.current.contains(v.target)&&(l(!1),o(""))}return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]),a.useEffect(()=>{r&&s.length>5&&d.current&&d.current.focus()},[r,s.length]);const i=s.find(m=>m.id===n),g=(i==null?void 0:i.name)||"project";return e.jsxs("div",{className:"project-selector",ref:h,children:[e.jsxs("button",{className:"project-selector-btn",onClick:m=>{m.stopPropagation(),l(!r)},title:`Install to: ${i==null?void 0:i.name}`,children:[e.jsx("span",{className:"project-selector-name",children:g}),e.jsx(J,{size:10})]}),r&&e.jsxs("div",{className:"project-selector-menu",children:[e.jsx("div",{className:"dropdown-header",children:"Install to:"}),s.length>5&&e.jsxs("div",{className:"dropdown-search",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:d,type:"text",placeholder:"Filter projects...",value:c,onChange:m=>o(m.target.value),onClick:m=>m.stopPropagation()})]}),e.jsxs("div",{className:"dropdown-items",children:[s.filter(m=>m.name.toLowerCase().includes(c.toLowerCase())).map(m=>e.jsxs("button",{className:`dropdown-item ${m.id===n?"selected":""}`,onClick:v=>{v.stopPropagation(),t(m.id),l(!1)},children:[e.jsx(Se,{size:12}),e.jsx("span",{children:m.name}),m.id===n&&e.jsx(ie,{size:12,className:"selected-check"})]},m.id)),s.filter(m=>m.name.toLowerCase().includes(c.toLowerCase())).length===0&&e.jsxs("div",{className:"dropdown-empty",children:['No projects match "',c,'"']})]})]})]})}const wt=a.memo(function({project:n,selection:t,onSelect:r,onBuild:l,onCancelBuild:c,onStageFilter:o,onOpenPackageDetail:h,onInstall:d,onOpenSource:i,onOpenKiCad:g,onOpenLayout:m,onOpen3D:v,availableProjects:z,isInstalling:y=!1}){var w;const[f,M]=a.useState(!1),[j,C]=a.useState(!1),[N,$]=a.useState(()=>{const A=n.version&&n.version!=="unknown"?n.version:null,k=n.latestVersion&&n.latestVersion!=="unknown"?n.latestVersion:null;return A||k||""}),[P,p]=a.useState(()=>{var A,k;return((A=z.find(D=>D.isActive))==null?void 0:A.id)||((k=z[0])==null?void 0:k.id)||""}),[x,u]=a.useState(null),[V,F]=a.useState(!1),[B,_]=a.useState(null),S=t.type==="project"&&t.projectId===n.id,T=z.find(A=>A.id===P),H=yt(n,(T==null?void 0:T.path)||P);a.useEffect(()=>{f&&!x&&!V&&(F(!0),_(null),xe("getPackageDetails",{packageId:n.id}).then(A=>{var O;const D=(A.result??{}).details;D?(u(D),((O=D.versions)==null?void 0:O.length)>0&&!N&&$(D.versions[0].version)):_("Failed to load package details")}).catch(A=>{_(A.message||"Failed to load package details")}).finally(()=>{F(!1)}))},[f,x,V,n.id,N]);const U=A=>{A.stopPropagation(),d(n.id,P,N||void 0)},I=(((w=x==null?void 0:x.versions)==null?void 0:w.map(A=>A.version))||(n.latestVersion&&n.version&&n.latestVersion!==n.version?[n.latestVersion,n.version]:n.version?[n.version]:n.latestVersion?[n.latestVersion]:[])).filter(A=>A&&A!=="unknown"),Y=((x==null?void 0:x.dependencies)||[]).map(A=>{const k=A.identifier.split("/"),D=k.length===2?k[0]:"unknown",O=k.length===2?k[1]:A.identifier;return{identifier:A.identifier,version:A.version||"latest",name:O,publisher:D}}),ne=[];return e.jsxs("div",{className:`package-card ${S?"selected":""} ${f?"expanded":""}`,onClick:()=>{S?(M(!1),C(!1),r({type:"none"})):(M(!0),r({type:"project",projectId:n.id,label:n.name}))},children:[e.jsxs("div",{className:"package-card-header",children:[e.jsx("span",{className:"tree-expand",children:f?e.jsx(J,{size:14}):e.jsx(re,{size:14})}),e.jsx(be,{size:16,className:"package-icon"}),e.jsx("span",{className:"package-name",children:n.name}),n.publisher&&e.jsx("span",{className:`package-publisher-tag ${n.publisher==="atopile"?"official":""}`,children:n.publisher.toLowerCase()}),n.homepage&&e.jsx("a",{href:n.homepage,className:"package-external-link",target:"_blank",rel:"noopener noreferrer",title:"Open homepage",onClick:A=>A.stopPropagation(),children:e.jsx(we,{size:12})})]}),(n.summary||n.description)&&e.jsx("div",{className:`package-card-description ${f?"":"clamped"} ${f&&!j?"clamped":""}`,onClick:A=>{f&&(A.stopPropagation(),C(!j))},children:f&&n.description||n.summary}),e.jsxs("div",{className:"package-install-bar",onClick:A=>A.stopPropagation(),children:[e.jsx(kt,{availableProjects:z,selectedProjectId:P,onSelect:p}),I.length>0&&e.jsx(bt,{versions:I,selectedVersion:N,onVersionChange:$,latestVersion:n.latestVersion}),e.jsx("button",{className:`install-btn ${y?"installing":""} ${H.installed?H.needsUpdate?"update-available":"installed":""}`,onClick:U,disabled:y,title:y?"Installing...":H.needsUpdate?`Update to ${N} in ${T==null?void 0:T.name}`:H.installed?`Installed in ${T==null?void 0:T.name}`:`Install ${N} to ${T==null?void 0:T.name}`,children:y?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:14,className:"spin"}),e.jsx("span",{children:"Installing..."})]}):H.installed?H.needsUpdate?e.jsxs(e.Fragment,{children:[e.jsx(Xs,{size:14}),e.jsx("span",{children:"Update"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:14}),e.jsx("span",{children:"Installed"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:14}),e.jsx("span",{children:"Install"})]})})]}),f&&e.jsxs("div",{className:"package-expanded-content",children:[n.builds.length>0&&e.jsx(ps,{builds:n.builds,projectId:n.id,projectRoot:n.root||"",selection:t,onSelect:r,onBuild:l,onCancelBuild:c,onStageFilter:o,onOpenSource:i,onOpenKiCad:g,onOpenLayout:m,onOpen3D:v,readOnly:!0}),V&&e.jsxs("div",{className:"package-loading",children:[e.jsx(ge,{size:16,className:"spin"}),e.jsx("span",{children:"Loading package details..."})]}),B&&e.jsx("div",{className:"package-error",children:e.jsxs("span",{children:["Failed to load details: ",B]})}),x&&!V&&e.jsxs("div",{className:"package-meta-bar",children:[x.downloads!==void 0&&x.downloads>0&&e.jsxs("span",{className:"meta-item",children:[e.jsx(Pe,{size:11}),vt(x.downloads)]}),x.versionCount>0&&e.jsxs("span",{className:"meta-item",children:[x.versionCount," versions"]}),x.license&&e.jsx("span",{className:"meta-item",children:x.license})]}),x&&Y.length>0&&e.jsx(xs,{dependencies:Y,projectId:n.id,readOnly:!0}),x&&ne.length>0&&e.jsx(fs,{files:ne,onFileClick:A=>i==null?void 0:i(n.id,A)})]})]})}),Ct=a.memo(function({project:n,selection:t,onSelect:r,onBuild:l,onCancelBuild:c,onStageFilter:o,onOpenPackageDetail:h,isExpanded:d,onExpandChange:i,onUpdateProject:g,onAddBuild:m,onUpdateBuild:v,onDeleteBuild:z,onProjectExpand:y,onOpenSource:f,onOpenKiCad:M,onOpenLayout:j,onOpen3D:C,onFileClick:N,onDependencyVersionChange:$,onRemoveDependency:P,availableModules:p=[],projectFiles:x=[],projectDependencies:u=[]}){const V=d,[F,B]=a.useState(!1),[_,S]=a.useState(!1),[T,H]=a.useState(n.name),[U,X]=a.useState(n.summary||""),I=t.type==="project"&&t.projectId===n.id,Y=n.builds.reduce((R,ee)=>R+(ee.errors||0),0),ne=n.builds.reduce((R,ee)=>R+(ee.warnings||0),0),w=n.builds.some(R=>R.status==="building"),A=n.builds.filter(R=>R.status==="building"),k=A.length>0?Math.max(...A.map(R=>R.elapsedSeconds||0)):0,[D,O]=a.useState(k);a.useEffect(()=>{if(!w){O(0);return}O(k);const R=setInterval(()=>{O(ee=>ee+1)},1e3);return()=>clearInterval(R)},[w,k]);const Z=R=>{const ee=Math.floor(R/3600),fe=Math.floor(R%3600/60),oe=Math.floor(R%60);return ee>0?`${ee}:${fe.toString().padStart(2,"0")}:${oe.toString().padStart(2,"0")}`:`${fe}:${oe.toString().padStart(2,"0")}`},G="A new atopile project!",E=U||G,L=!U,q=a.useMemo(()=>us(T),[T]),W=()=>{q.isValid&&(B(!1),g&&g(n.id,{name:T}),console.log("Saving name:",T))},K=R=>{H(R)},te=()=>{S(!1),g&&g(n.id,{summary:U}),console.log("Saving description:",U)};return e.jsxs("div",{className:`project-card ${I?"selected":""} ${V?"expanded":"collapsed"} ${w?"building":""}`,onClick:()=>{const R=!V;i(n.id,R),r({type:"project",projectId:n.id,label:n.name}),R&&y&&y(n.root)},children:[e.jsxs("div",{className:"project-card-name-row",children:[e.jsx("span",{className:"tree-expand",children:V?e.jsx(J,{size:14}):e.jsx(re,{size:14})}),e.jsx(Se,{size:18,className:"project-icon"}),F&&V?e.jsxs("div",{className:"name-input-wrapper",onClick:R=>R.stopPropagation(),children:[e.jsx("input",{type:"text",className:`project-name-input ${q.isValid?"":"invalid"}`,value:T,onChange:R=>H(R.target.value),onBlur:()=>{q.isValid&&W()},onKeyDown:R=>{R.key==="Enter"&&W(),R.key==="Escape"&&(H(n.name),B(!1))},autoFocus:!0}),e.jsx(ds,{validation:q,onApplySuggestion:K})]}):e.jsx("span",{className:`project-card-name ${V?"editable":""}`,onClick:V?R=>{R.stopPropagation(),B(!0)}:void 0,title:V?"Click to edit name":void 0,children:T}),e.jsxs("div",{className:"project-card-actions-row",children:[e.jsxs("div",{className:"project-indicators",children:[w&&e.jsx("span",{className:"build-time-indicator",title:"Build time",children:e.jsx("span",{className:"build-time",children:Z(D)})}),!w&&e.jsxs(e.Fragment,{children:[Y>0&&e.jsxs("span",{className:"error-indicator",children:[e.jsx(de,{size:12}),e.jsx("span",{children:Y})]}),ne>0&&e.jsxs("span",{className:"warning-indicator",children:[e.jsx(ce,{size:12}),e.jsx("span",{children:ne})]}),n.lastBuildTimestamp&&e.jsxs("span",{className:"last-build-info",title:`Last build: ${n.lastBuildStatus||"unknown"}`,children:[n.lastBuildStatus&&ms(n.lastBuildStatus,10),e.jsx("span",{className:"last-build-time",children:hs(n.lastBuildTimestamp)})]})]})]}),w?e.jsx("button",{className:"project-build-btn-icon stop",onClick:R=>{R.stopPropagation(),n.builds.filter(ee=>ee.status==="building"&&ee.buildId).forEach(ee=>c==null?void 0:c(ee.buildId))},title:`Stop all builds in ${n.name}`,children:e.jsx(cs,{size:12,fill:"currentColor"})}):e.jsx("button",{className:"project-build-btn-icon",onClick:R=>{R.stopPropagation(),l("project",n.id,n.name)},title:`Build all targets in ${n.name}`,children:e.jsx(Ae,{size:14,fill:"currentColor"})})]})]}),V&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"project-card-description",children:_?e.jsx("input",{type:"text",className:"description-input",value:U,placeholder:G,onChange:R=>X(R.target.value),onBlur:te,onKeyDown:R=>{R.key==="Enter"&&te(),R.key==="Escape"&&(X(n.summary||""),S(!1))},autoFocus:!0,onClick:R=>R.stopPropagation()}):e.jsx("span",{className:`description-text ${L?"placeholder":""}`,onClick:R=>{R.stopPropagation(),S(!0)},title:"Click to edit description",children:E})}),e.jsx(ps,{builds:n.builds,projectId:n.id,projectRoot:n.root,selection:t,onSelect:r,onBuild:l,onCancelBuild:c,onStageFilter:o,onUpdateBuild:v,onDeleteBuild:z,onOpenSource:f,onOpenKiCad:M,onOpenLayout:j,onOpen3D:C,onAddBuild:m,availableModules:p}),e.jsx(fs,{files:x,onFileClick:N?R=>N(n.id,R):void 0}),e.jsx(xs,{dependencies:u,projectId:n.id,onVersionChange:$,onRemove:P})]})]})});function Xe({selection:s,onSelect:n,onBuild:t,onCancelBuild:r,onStageFilter:l,onOpenPackageDetail:c,onPackageInstall:o,onCreateProject:h,onProjectExpand:d,onOpenSource:i,onOpenKiCad:g,onOpenLayout:m,onOpen3D:v,onFileClick:z,onDependencyVersionChange:y,onRemoveDependency:f,onAddBuild:M,onUpdateBuild:j,onDeleteBuild:C,filterType:N="all",projects:$,projectModules:P={},projectFiles:p={},projectDependencies:x={},installingPackageIds:u=[]}){const[V,F]=a.useState(""),[B,_]=a.useState(null),S=$&&$.length>0?$:[],T=()=>{if(h){h();return}console.warn("Create project handler not provided")},H=(k,D)=>{console.warn("Update project handler not provided",k,D)},U=k=>{if(M){M(k);return}console.warn("Add build handler not provided",k)},X=(k,D,O)=>{if(j){j(k,D,O);return}console.warn("Update build handler not provided",k,D,O)},I=(k,D)=>{if(C){C(k,D);return}console.warn("Delete build handler not provided",k,D),s.type==="build"&&s.buildId===`${k}:${D}`&&n({type:"none"})},Y=S.filter(k=>k.type==="project").map((k,D)=>({id:k.id,name:k.name,path:k.root,isActive:D===0})),ne=(k,D,O)=>{if(console.log(`Installing ${k} to ${D}${O?` @ ${O}`:""}`),o){const Z=S.find(E=>E.id===D),G=(Z==null?void 0:Z.root)||D;o(k,G,O)}else alert(`Installing ${k} to ${D}`)},w=S.filter(k=>{if(N==="projects"&&k.type!=="project"||N==="packages"&&k.type!=="package")return!1;if(V){const D=V.toLowerCase();return[k.name,k.id,k.publisher||"",k.description||"",k.summary||"",...k.keywords||[]].join(" ").toLowerCase().includes(D)}return!0}),A=N==="packages"?'Search packages (e.g. "regulator", "sensor")...':"Search projects...";return e.jsxs("div",{className:"projects-panel",children:[e.jsxs("div",{className:"projects-toolbar",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:A,value:V,onChange:k=>{F(k.target.value),k.target.value&&(s.type!=="none"&&n({type:"none"}),B!==null&&_(null))}})]}),N==="projects"&&e.jsx("button",{className:"add-project-btn",onClick:T,title:"Create new project",children:e.jsx(is,{size:14})})]}),e.jsxs("div",{className:"projects-tree",children:[w.filter(k=>N==="projects"&&B!==null?k.id===B:!0).map(k=>k.type==="package"?e.jsx(wt,{project:k,selection:s,onSelect:n,onBuild:t,onCancelBuild:r,onStageFilter:l,onOpenPackageDetail:c,onInstall:ne,onOpenSource:i,onOpenKiCad:g,onOpenLayout:m,onOpen3D:v,availableProjects:Y,isInstalling:u.includes(k.id)},k.id):e.jsx(Ct,{project:k,selection:s,onSelect:n,onBuild:t,onCancelBuild:r,onStageFilter:l,onOpenPackageDetail:c,isExpanded:B===k.id,onExpandChange:(D,O)=>{_(O?D:null)},onUpdateProject:H,onAddBuild:U,onUpdateBuild:X,onDeleteBuild:I,onProjectExpand:d,onOpenSource:i,onOpenKiCad:g,onOpenLayout:m,onOpen3D:v,onFileClick:z,onDependencyVersionChange:y,onRemoveDependency:f,availableModules:P[k.root]||[],projectFiles:p[k.root]||[],projectDependencies:x[k.root]||[]},k.id)),w.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsxs("span",{children:["No ",N==="packages"?"packages":"projects"," found"]}),V&&N==="packages"&&e.jsx("span",{className:"empty-hint",children:'Try searching for "sensor", "regulator", or "mcu"'})]})]})]})}function _e({projects:s,selectedProjectRoot:n,selectedTargetName:t,onSelectProject:r,onSelectTarget:l,placeholder:c="Select project",showAllOption:o=!0,allOptionLabel:h="All projects",disabled:d=!1}){const[i,g]=a.useState(!1),[m,v]=a.useState(""),[z,y]=a.useState(new Set),f=a.useRef(null),M=a.useRef(null);a.useEffect(()=>{if(!i)return;const u=V=>{f.current&&!f.current.contains(V.target)&&(g(!1),v(""))};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[i]),a.useEffect(()=>{i&&M.current&&setTimeout(()=>{var u;return(u=M.current)==null?void 0:u.focus()},0)},[i]);const j=m.trim()?s.filter(u=>u.name.toLowerCase().includes(m.toLowerCase())):s,C=s.find(u=>u.root===n),N=s.length>0,$=C?t?`${C.name}  ${t}`:C.name:c,P=u=>{r(u),g(!1),v(""),y(new Set)},p=()=>{!d&&N&&g(u=>!u)},x=u=>{y(V=>{const F=new Set(V);return F.has(u)?F.delete(u):F.add(u),F})};return a.useEffect(()=>{n&&y(u=>{if(u.has(n))return u;const V=new Set(u);return V.add(n),V})},[n]),a.useEffect(()=>{m&&y(new Set(j.map(u=>u.root)))},[m,j]),e.jsxs("div",{className:"install-dropdown project-dropdown",ref:f,children:[e.jsxs("button",{className:"install-btn",onClick:p,title:$,disabled:d||!N,children:[e.jsx(Se,{size:12}),e.jsx("span",{children:C?$:N?o?"All":c:"No projects"})]}),e.jsx("button",{className:"install-dropdown-toggle",onClick:u=>{u.stopPropagation(),p()},title:"Change project",disabled:d||!N,children:e.jsx(J,{size:12})}),i&&N&&e.jsxs("div",{className:"install-dropdown-menu project-dropdown-menu",children:[e.jsx("div",{className:"dropdown-header",children:"Select project:"}),e.jsxs("div",{className:"dropdown-search",children:[e.jsx(ue,{size:10}),e.jsx("input",{ref:M,type:"text",placeholder:"Filter projects...",value:m,onChange:u=>v(u.target.value),onClick:u=>u.stopPropagation()})]}),e.jsxs("div",{className:"dropdown-items",children:[o&&e.jsxs("button",{className:`dropdown-item ${n?"":"selected"}`,onClick:u=>{u.stopPropagation(),P(null)},children:[e.jsx(Se,{size:12}),e.jsx("span",{children:h}),!n&&e.jsx(ie,{size:12,className:"selected-check"})]}),j.map(u=>{var B;const V=!!(u.targets&&u.targets.length>0),F=z.has(u.root);return e.jsxs("div",{children:[e.jsxs("button",{className:`dropdown-item ${u.root===n?"selected":""}`,onClick:_=>{_.stopPropagation(),r(u.root),V&&l?x(u.root):(g(!1),v(""))},children:[V&&l?e.jsx("span",{className:"project-target-toggle",onClick:_=>{_.stopPropagation(),x(u.root)},children:F?e.jsx(J,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"project-target-toggle-spacer"}),e.jsx(Se,{size:12}),e.jsx("span",{children:u.name}),u.badge&&e.jsx("span",{className:`status-badge ${u.badgeMuted?"muted":""}`,children:u.badge}),u.root===n&&e.jsx(ie,{size:12,className:"selected-check"})]}),l&&V&&F?e.jsx("div",{className:"project-targets",children:(B=u.targets)==null?void 0:B.map(_=>e.jsxs("button",{className:`dropdown-item target-item ${u.root===n&&_.name===t?"selected":""}`,onClick:S=>{S.stopPropagation(),l(u.root,_.name),g(!1),v(""),y(new Set)},children:[e.jsx("span",{children:_.name}),u.root===n&&_.name===t&&e.jsx(ie,{size:12,className:"selected-check"})]},`${u.root}-${_.name}`))}):null]},u.root)}),j.length===0&&m&&e.jsxs("div",{className:"dropdown-empty",children:['No projects match "',m,'"']})]})]})]})}function St(s){const n=new Map;for(const t of s){const r=t.file||"(no file)";n.has(r)||n.set(r,[]),n.get(r).push(t)}for(const[,t]of n)t.sort((r,l)=>r.level==="error"&&l.level==="warning"?-1:r.level==="warning"&&l.level==="error"?1:0);return n}function At({problems:s,projects:n=[],selectedProjectRoot:t,onSelectProject:r,onProblemClick:l}){const[c,o]=a.useState(new Set),[h,d]=a.useState(""),i=a.useMemo(()=>{if(!h.trim())return s;const j=h.toLowerCase();return s.filter(C=>{var N,$;return C.message.toLowerCase().includes(j)||((N=C.file)==null?void 0:N.toLowerCase().includes(j))||(($=C.stage)==null?void 0:$.toLowerCase().includes(j))})},[s,h]),g=i.filter(j=>j.level==="error").length,m=a.useMemo(()=>St(i),[i]),v=n.length>0,z=j=>{o(C=>{const N=new Set(C);return N.has(j)?N.delete(j):N.add(j),N})},y=s.length===0,f=!y&&i.length===0,M=()=>e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[g>0&&e.jsx("div",{className:"problems-summary-inline",children:e.jsxs("span",{className:"problems-count error",children:[e.jsx(de,{size:12}),g]})}),e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Filter problems...",value:h,onChange:j=>d(j.target.value)}),h&&e.jsx("button",{className:"search-clear",onClick:()=>d(""),title:"Clear search",children:e.jsx(he,{size:12})})]}),v&&r&&e.jsx(_e,{projects:n,selectedProjectRoot:t,onSelectProject:r,showAllOption:!0,allOptionLabel:"All projects"})]})});return y||f?e.jsxs("div",{className:"problems-panel empty","data-testid":"problems-panel",children:[M(),e.jsxs("div",{className:"problems-empty-state",children:[e.jsx(de,{size:24,className:"problems-empty-icon"}),e.jsx("span",{className:"problems-empty-text",children:f?"No matching problems":"No problems"})]})]}):e.jsxs("div",{className:"problems-panel","data-testid":"problems-panel",children:[M(),e.jsx("div",{className:"problems-list",children:Array.from(m.entries()).map(([j,C])=>{const N=c.has(j),$=C.filter(p=>p.level==="error").length,P=C.filter(p=>p.level==="warning").length;return e.jsxs("div",{className:`problems-file-group ${N?"collapsed":""}`,children:[e.jsxs("div",{className:"problems-file-header",onClick:()=>z(j),children:[e.jsx("span",{className:"problems-file-expand",children:N?e.jsx(re,{size:12}):e.jsx(J,{size:12})}),e.jsx(ye,{size:12}),e.jsx("span",{className:"problems-file-name",title:j,children:j.split("/").pop()||j}),e.jsx("span",{className:"problems-file-path",title:j,children:j}),e.jsxs("span",{className:"problems-file-counts",children:[$>0&&e.jsx("span",{className:"problems-file-count error",children:$}),P>0&&e.jsx("span",{className:"problems-file-count warning",children:P})]})]}),!N&&e.jsx("div",{className:"problems-file-items",children:C.map(p=>e.jsxs("div",{className:`problem-item ${p.level} ${p.file?"clickable":""}`,onClick:()=>p.file&&(l==null?void 0:l(p)),title:p.file?`Click to go to ${p.file}:${p.line||1}`:void 0,children:[e.jsx("span",{className:"problem-icon",children:p.level==="error"?e.jsx(de,{size:12}):e.jsx(ce,{size:12})}),e.jsx("span",{className:"problem-message",children:p.message}),p.line&&e.jsxs("span",{className:"problem-location",children:["[",p.line,p.column?`:${p.column}`:"","]"]}),p.stage&&e.jsx("span",{className:"problem-source",children:p.stage})]},p.id))})]},j)})})]})}function Mt(s){return s.itemType||"interface"}const Ve={interface:{icon:ts,color:"var(--ctp-blue)",label:"Interface"},module:{icon:Me,color:"var(--ctp-green)",label:"Module"},component:{icon:Re,color:"var(--ctp-mauve)",label:"Component"},trait:{icon:Ne,color:"var(--ctp-yellow)",label:"Trait"},parameter:{icon:Ce,color:"var(--ctp-peach)",label:"Parameter"}};function Ge({item:s,isSelected:n,onSelect:t,expandedPaths:r,onToggleChild:l}){var g;const c=Ve[s.type],o=c.icon,h=async m=>{try{await navigator.clipboard.writeText(m)}catch(v){console.warn("Failed to copy usage text",v)}},d=(m,v)=>{var C;const z=(((C=m.children)==null?void 0:C.length)??0)>0,y=r.has(v),f=Mt(m),M=Ve[f],j=M.icon;return e.jsxs("div",{className:"stdlib-child-node",children:[e.jsxs("div",{className:`stdlib-child-row${z?" expandable":""}`,onClick:()=>z?l(v):void 0,children:[z?e.jsx("button",{className:"expand-btn",onClick:()=>l(v),children:y?e.jsx(J,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"expand-spacer"}),e.jsx("span",{className:"stdlib-child-icon",style:{color:M.color},children:e.jsx(j,{size:12})}),e.jsx("span",{className:"stdlib-child-name",children:m.name}),e.jsx("span",{className:"stdlib-child-type",children:m.type})]}),z&&y&&e.jsx("div",{className:"stdlib-child-children",children:m.children.map(N=>d(N,`${v}.${N.name}`))})]},v)},i=(((g=s.children)==null?void 0:g.length)??0)>0;return e.jsxs("div",{className:`stdlib-card${n?" selected":""}`,onClick:t,children:[e.jsxs("div",{className:"stdlib-card-header",children:[i&&e.jsx("span",{className:"stdlib-expand-icon",children:n?e.jsx(J,{size:12}):e.jsx(re,{size:12})}),e.jsx("span",{className:"stdlib-type-icon",style:{color:c.color},children:e.jsx(o,{size:14})}),e.jsx("span",{className:"stdlib-card-name",children:s.name}),e.jsx("span",{className:"stdlib-type-badge",style:{background:c.color,color:"var(--ctp-base)"},children:c.label})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"stdlib-card-description",children:s.description}),i&&e.jsx("div",{className:"stdlib-card-children",children:s.children.map(m=>d(m,m.name))}),s.usage&&e.jsxs("div",{className:"stdlib-card-usage",children:[e.jsxs("div",{className:"usage-header",children:[e.jsx("span",{children:"Usage"}),e.jsxs("button",{className:"copy-btn",onClick:m=>{m.stopPropagation(),h(s.usage||"")},children:[e.jsx(ls,{size:12}),"Copy"]})]}),e.jsx("pre",{className:"usage-code",children:s.usage})]})]})]})}function zt({items:s,isLoading:n=!1,onOpenDetail:t,onRefresh:r}){const[l,c]=a.useState(""),[o,h]=a.useState(null),[d,i]=a.useState(new Map),[g,m]=a.useState(new Set(["interface","module","trait","component"])),v=s||[],z=l.trim().length>0,y=N=>{m($=>{const P=new Set($);return P.has(N)?P.delete(N):P.add(N),P})},f=(N,$)=>{i(P=>{const p=new Map(P),x=p.get(N)||new Set,u=new Set(x);return u.has($)?u.delete($):u.add($),p.set(N,u),p})},M=v.filter(N=>{if(l){const $=l.toLowerCase(),P=p=>p?p.some(x=>x.name.toLowerCase().includes($)||x.type.toLowerCase().includes($)||P(x.children)):!1;return N.name.toLowerCase().includes($)||N.description.toLowerCase().includes($)||P(N.children)}return!0}),j=M.reduce((N,$)=>(N[$.type]||(N[$.type]=[]),N[$.type].push($),N),{}),C=["interface","module","trait","component"];return n?e.jsxs("div",{className:"stdlib-panel",children:[e.jsx("div",{className:"stdlib-toolbar",children:e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:"Search standard library...",disabled:!0})]})}),e.jsx("div",{className:"stdlib-list",children:e.jsxs("div",{className:"stdlib-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("span",{children:"Loading standard library..."})]})})]}):e.jsxs("div",{className:"stdlib-panel",children:[e.jsx("div",{className:"stdlib-toolbar",children:e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:12}),e.jsx("input",{type:"text",placeholder:"Search standard library...",value:l,onChange:N=>c(N.target.value)})]})}),e.jsxs("div",{className:"stdlib-list",children:[z?e.jsx("div",{className:"stdlib-search-results",children:M.length===0?e.jsxs("div",{className:"stdlib-empty",children:[e.jsx(ue,{size:24}),e.jsxs("span",{children:['No results for "',l,'"']})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"search-results-count",children:[M.length," result",M.length!==1?"s":""]}),M.map(N=>e.jsx(Ge,{item:N,isSelected:o===N.id,onSelect:()=>h(o===N.id?null:N.id),expandedPaths:d.get(N.id)||new Set,onToggleChild:$=>f(N.id,$)},N.id))]})}):C.map(N=>{const $=j[N];if(!$||$.length===0)return null;const P=Ve[N],p=P.icon,x=g.has(N);return e.jsxs("div",{className:`stdlib-group ${x?"collapsed":""}`,children:[e.jsxs("button",{className:"stdlib-group-header",onClick:()=>y(N),style:{"--group-color":P.color},children:[e.jsx("span",{className:"group-chevron",children:x?e.jsx(re,{size:12}):e.jsx(J,{size:12})}),e.jsx("span",{className:"group-icon",style:{color:P.color},children:e.jsx(p,{size:12})}),e.jsxs("span",{className:"group-label",children:[P.label,"s"]}),e.jsxs("span",{className:"group-count",children:["(",$.length,")"]})]}),!x&&e.jsx("div",{className:"stdlib-group-items",children:$.map(u=>e.jsx(Ge,{item:u,isSelected:o===u.id,onSelect:()=>h(o===u.id?null:u.id),expandedPaths:d.get(u.id)||new Set,onToggleChild:V=>f(u.id,V)},u.id))})]},N)}),M.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsx("span",{children:"No items found"}),l&&e.jsx("span",{className:"empty-hint",children:'Try "I2C", "Resistor", or "power"'})]})]})]})}function Pt(s,n,t,r=""){const l=s.length,c=n.length;if(l+c<=t)return[s,n];const h=r.length,d=Math.floor(t/2);let i=s,g=n;if(l<=d&&c>t-l){const m=t-l;m>h?g=n.slice(0,m-h)+r:g=r.slice(0,m)}else if(c<=d&&l>t-c){const m=t-c;m>h?i=s.slice(0,m-h)+r:i=r.slice(0,m)}else{const m=d-h;m>0?(l>d&&(i=s.slice(0,m)+r),c>d&&(g=n.slice(0,m)+r)):(i=r.slice(0,d),g=r.slice(0,d))}return[i,g]}const Et="data:image/png;base64,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";function $t(s){switch(s){case"voltage":return e.jsx(Ne,{size:12,className:"var-icon voltage"});case"current":return e.jsx(Ne,{size:12,className:"var-icon current"});case"resistance":return e.jsx(Ce,{size:12,className:"var-icon resistance"});case"capacitance":return e.jsx(Ce,{size:12,className:"var-icon capacitance"});case"ratio":case"percentage":return e.jsx(_n,{size:12,className:"var-icon ratio"});case"frequency":return e.jsx(Ee,{size:12,className:"var-icon frequency"});case"power":return e.jsx(Ne,{size:12,className:"var-icon power"});default:return e.jsx(Ce,{size:12,className:"var-icon"})}}function Bt(s){switch(s){case"module":return e.jsx(Me,{size:14,className:"node-type-icon module"});case"interface":return e.jsx(Ne,{size:14,className:"node-type-icon interface"});case"component":return e.jsx(as,{size:14,className:"node-type-icon component"})}}const It=a.memo(function({variable:n,onCopy:t}){const[r,l]=a.useState(!1),c=()=>{let i=`${n.name}: `;n.spec&&(i+=`${n.spec}${n.specTolerance||""}`),n.actual&&(i+=`  ${n.actual}${n.actualTolerance||""}`),n.unit&&(i+=` ${n.unit}`),t(i),l(!0),setTimeout(()=>l(!1),1500)},o=n.spec!==void 0,h=n.actual!==void 0,d=n.meetsSpec===!1;return e.jsxs("div",{className:`variable-table-row ${d?"error":""}`,onClick:c,title:"Click to copy",children:[e.jsxs("div",{className:"var-col-name",children:[$t(n.type),e.jsx("span",{className:"var-name-text",children:n.name})]}),e.jsx("div",{className:"var-col-spec",children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"var-spec-value",children:n.spec}),n.specTolerance&&e.jsx("span",{className:"var-tolerance",children:n.specTolerance})]}):e.jsx("span",{className:"var-empty",children:""})}),e.jsx("div",{className:`var-col-actual ${d?"error":h?"ok":""}`,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"var-actual-value",children:n.actual}),n.actualTolerance&&e.jsx("span",{className:"var-tolerance",children:n.actualTolerance})]}):e.jsx("span",{className:"var-empty",children:""})}),e.jsxs("div",{className:"var-col-status",children:[d&&e.jsx(ce,{size:12,className:"status-error"}),r&&e.jsx(ie,{size:12,className:"status-copied"})]})]})});function De(s,n){if(n==="all")return!0;const t=s||"derived";return n==="user"?t==="user":n==="computed"?t==="derived":n==="picked"?t==="picked"||t==="datasheet":!0}function js(s,n){var t,r;return n?s.name.toLowerCase().includes(n)||(((t=s.spec)==null?void 0:t.toLowerCase().includes(n))??!1)||(((r=s.actual)==null?void 0:r.toLowerCase().includes(n))??!1):!0}function Ns(s,n,t){var l,c;return!!(n&&s.name.toLowerCase().includes(n)||((l=s.variables)==null?void 0:l.some(o=>De(o.source,t)&&js(o,n)))||(c=s.children)!=null&&c.some(o=>Ns(o,n,t)))}const Lt=a.memo(function s({node:n,depth:t,searchQuery:r,sourceFilter:l,expandedNodes:c,onToggleExpand:o,onCopyValue:h}){var M;const d=c.has(n.path),i=n.children&&n.children.length>0||n.variables&&n.variables.length>0,g=r.toLowerCase(),m=a.useMemo(()=>n.variables?n.variables.filter(j=>De(j.source,l)&&js(j,g)):[],[n.variables,l,g]);if(!a.useMemo(()=>!r&&l==="all"?!0:Ns(n,g,l),[n,r,l,g]))return null;const z=t>0?" ".repeat(t):"",[y,f]=n.typeName?Pt(n.name,n.typeName,35):[n.name.length>35?n.name.slice(0,32)+"":n.name,""];return e.jsxs("div",{className:`variable-tree-node depth-${Math.min(t,4)}`,children:[e.jsxs("div",{className:`variable-node-header ${d?"expanded":""}`,onClick:()=>o(n.path),children:[i?e.jsx("span",{className:"tree-expand",children:d?e.jsx(J,{size:12}):e.jsx(re,{size:12})}):e.jsx("span",{className:"tree-expand-spacer"}),t>0&&e.jsx("span",{className:"depth-indicator",children:z}),Bt(n.type),e.jsx("span",{className:"node-name",title:n.name,children:y}),n.typeName&&e.jsx("span",{className:"node-type-name",title:n.typeName,children:f}),n.variables&&n.variables.length>0&&e.jsx("span",{className:"var-count",children:n.variables.length})]}),d&&e.jsxs("div",{className:"variable-node-content",children:[m.length>0&&e.jsxs("div",{className:"variables-table",children:[e.jsxs("div",{className:"variables-table-header",children:[e.jsx("div",{className:"var-col-name",children:"Parameter"}),e.jsx("div",{className:"var-col-spec",children:"Spec"}),e.jsx("div",{className:"var-col-actual",children:"Actual"}),e.jsx("div",{className:"var-col-status"})]}),m.map((j,C)=>e.jsx(It,{variable:j,onCopy:h},`${n.path}-${j.name}-${C}`))]}),(M=n.children)==null?void 0:M.map((j,C)=>e.jsx(s,{node:j,depth:t+1,searchQuery:r,sourceFilter:l,expandedNodes:c,onToggleExpand:o,onCopyValue:h},`${j.path}-${C}`))]})]})});function Vt({variablesData:s,isLoading:n=!1,error:t=null,projects:r,selectedProjectRoot:l,selectedTargetNames:c,onSelectProject:o,onSelectTarget:h}){const[d,i]=a.useState(""),[g,m]=a.useState(new Set),[v,z]=a.useState(null),[y,f]=a.useState({}),M="all",[j,C]=a.useState(null);a.useEffect(()=>{if(!r||r.length===0){f({});return}let B=!1;return Promise.all(r.map(async _=>{try{const T=(await xe("getVariablesTargets",{projectRoot:_.root})).result??{},H=Array.isArray(T.targets)?T.targets:[];return[_.root,H]}catch{return[_.root,[]]}})).then(_=>{if(B)return;const S={};for(const[T,H]of _)S[T]=[...H];f(S)}),()=>{B=!0}},[r]);const N=a.useMemo(()=>r?[...r].sort((B,_)=>{var H,U;const S=(((H=y[B.root])==null?void 0:H.length)??0)>0,T=(((U=y[_.root])==null?void 0:U.length)??0)>0;return S!==T?S?-1:1:B.name.localeCompare(_.name)}):[],[r,y]),$=a.useMemo(()=>N.map(B=>{var S,T;const _=(((S=y[B.root])==null?void 0:S.length)??0)>0;return{id:B.root,name:B.name,root:B.root,targets:((T=B.targets)==null?void 0:T.map(H=>({name:H.name})))??[],badge:_?void 0:"no variables",badgeMuted:!0}}),[N,y]),P=!!(r&&(N.length>0||l)),p=(s==null?void 0:s.nodes)||[];a.useEffect(()=>{const B=s==null?void 0:s.version;p.length>0&&B&&B!==j&&(m(new Set(p.map(_=>_.path))),C(B))},[p,s==null?void 0:s.version,j]);const x=a.useCallback(B=>{m(_=>{const S=new Set(_);return S.has(B)?S.delete(B):S.add(B),S})},[]),u=a.useCallback(B=>{navigator.clipboard.writeText(B),z(B),setTimeout(()=>z(null),2e3)},[]),V=a.useMemo(()=>{const B=_=>{let S=0;for(const T of _){if(T.variables)for(const H of T.variables)De(H.source,M)&&S++;T.children&&(S+=B(T.children))}return S};return B(p)},[p,M]),F=(()=>{if(!(s!=null&&s.build_id))return null;const B=s.build_id.match(/^build-(\d+)-/);return B?`#${B[1]}`:s.build_id.substring(0,12)})();return e.jsxs("div",{className:"variables-panel",children:[e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Search variables...",value:d,onChange:B=>i(B.target.value)})]}),P&&e.jsx(_e,{projects:$,selectedProjectRoot:l,selectedTargetName:(c==null?void 0:c[0])||null,onSelectProject:o||(()=>{}),onSelectTarget:h,showAllOption:!1,placeholder:"Select project"})]})}),e.jsxs("div",{className:"variables-tree",children:[n&&e.jsxs("div",{className:"variables-loading",children:[e.jsx(ge,{size:24,className:"spinner"}),e.jsx("span",{children:"Loading variables..."})]}),t&&!n&&e.jsxs("div",{className:"variables-error",children:[e.jsx(ce,{size:16}),e.jsx("span",{children:t})]}),!n&&!t&&p.length===0&&e.jsxs("div",{className:"variables-empty",children:[e.jsx("span",{children:"No variables found."}),e.jsx("span",{className:"hint",children:'Run "ato build" to generate variable data.'})]}),!n&&!t&&p.map((B,_)=>e.jsx(Lt,{node:B,depth:0,searchQuery:d,sourceFilter:M,expandedNodes:g,onToggleExpand:x,onCopyValue:u},`${B.path}-${_}`))]}),e.jsxs("div",{className:"variables-status",children:[e.jsxs("span",{children:[V," variables"]}),F&&e.jsxs("span",{className:"build-id-badge",title:`Build: ${s==null?void 0:s.build_id}`,children:["build ",F]}),v&&e.jsxs("span",{className:"copied-toast",children:[e.jsx(ie,{size:10}),"Copied: ",v]})]})]})}function vs(s){const n=s.split("::");return(n.length>1?n[1]:s).split("|")[0]}function Ze(s){const n=vs(s),t=n.split(".");return t.length<=1?n:t.slice(1).join(".")}function qt(s){var c;const n=s.usages.map(o=>o.designator),t=s.unitCost??void 0,r=t!==void 0?t*s.quantity:void 0,l=s.stock;return{id:s.id,designators:n,type:s.type,value:s.value,package:s.package,manufacturer:s.manufacturer??void 0,mpn:s.mpn??void 0,lcsc:s.lcsc??void 0,description:s.description??void 0,quantity:s.quantity,unitCost:t,totalCost:r,inStock:l!=null?l>0:void 0,stockQuantity:l??void 0,parameters:s.parameters,source:s.source,path:(c=s.usages[0])==null?void 0:c.address,usages:s.usages.map(o=>({path:o.address,designator:o.designator}))}}function Tt(s){switch(s){case"resistor":return"R";case"capacitor":return"C";case"inductor":return"L";case"ic":return"IC";case"connector":return"J";case"led":return"LED";case"diode":return"D";case"transistor":return"Q";case"crystal":return"Y";default:return"X"}}function qe(s){return s<.01?`$${s.toFixed(4)}`:s<1?`$${s.toFixed(3)}`:`$${s.toFixed(2)}`}function Ft(s){const n=new Map;for(const t of s){const r=vs(t.path),l=r.split(".");let c,o;l.length>=3?(c=l.slice(0,-1).join("."),o=l[l.length-2]):l.length===2?(c=l[0],o=l[0]):(c=r,o=r),n.has(c)||n.set(c,{parentPath:c,parentLabel:o,instances:[]}),n.get(c).instances.push(t)}return Array.from(n.values())}function Rt(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(0)}K`:s.toString()}const _t=a.memo(function({component:n,isExpanded:t,onToggle:r,onCopy:l,onGoToSource:c}){const[o,h]=a.useState(null),[d,i]=a.useState(()=>new Set),g=(y,f,M)=>{M.stopPropagation(),l(f),h(y),setTimeout(()=>h(null),1500)},m=(y,f)=>{y.stopPropagation(),c(f.path,f.line)},v=(y,f)=>{f.stopPropagation(),i(M=>{const j=new Set(M);return j.has(y)?j.delete(y):j.add(y),j})},z=n.usages?Ft(n.usages):[];return e.jsxs("div",{className:`bom-row ${t?"expanded":""}`,onClick:r,children:[e.jsxs("div",{className:"bom-row-header",children:[e.jsx("span",{className:"bom-expand",children:t?e.jsx(J,{size:12}):e.jsx(re,{size:12})}),e.jsx("span",{className:`bom-type-badge type-${n.type}`,children:Tt(n.type)}),e.jsx("span",{className:"bom-value",children:n.value}),n.mpn&&e.jsx("span",{className:"bom-mpn",title:n.mpn,children:n.mpn}),e.jsxs("span",{className:"bom-quantity",children:["",n.quantity]}),n.totalCost!==void 0&&e.jsx("span",{className:"bom-cost",children:qe(n.totalCost)}),n.inStock===!1&&e.jsx(ce,{size:12,className:"bom-stock-warning"})]}),t&&e.jsxs("div",{className:"bom-row-details",children:[e.jsx("table",{className:"bom-detail-table",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Manufacturer"}),e.jsx("td",{className:"detail-cell-value",children:n.manufacturer||"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Package"}),e.jsx("td",{className:"detail-cell-value",children:n.package})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"LCSC"}),e.jsx("td",{className:"detail-cell-value",children:n.lcsc?e.jsxs("span",{className:"lcsc-link",onClick:y=>g("lcsc",n.lcsc,y),children:[e.jsx("span",{className:"mono",children:n.lcsc}),e.jsx("a",{href:`https://www.lcsc.com/product-detail/${n.lcsc}.html`,target:"_blank",rel:"noopener noreferrer",onClick:y=>y.stopPropagation(),className:"external-link",children:e.jsx(we,{size:10})}),o==="lcsc"?e.jsx(ie,{size:10,className:"copy-icon copied"}):e.jsx(ls,{size:10,className:"copy-icon"})]}):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Stock"}),e.jsx("td",{className:`detail-cell-value ${n.inStock===!1?"out-of-stock":"in-stock"}`,children:n.inStock===!1?e.jsxs("span",{className:"stock-out",children:[e.jsx(ce,{size:10})," Out of stock"]}):n.lcscLoading&&n.stockQuantity==null?e.jsxs("span",{className:"inline-loading",children:[e.jsx(Ee,{size:10,className:"loading-spinner"})," Fetching..."]}):n.stockQuantity?Rt(n.stockQuantity):"In stock"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Unit Cost"}),e.jsx("td",{className:"detail-cell-value cost",children:n.unitCost!=null?qe(n.unitCost):n.lcscLoading?e.jsxs("span",{className:"inline-loading",children:[e.jsx(Ee,{size:10,className:"loading-spinner"})," Fetching..."]}):"-"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"detail-cell-label",children:"Source"}),e.jsx("td",{className:"detail-cell-value",children:e.jsx("span",{className:`source-badge source-${n.source}`,children:n.source==="picked"?"Auto-picked":n.source==="specified"?"Specified":"Manual"})})]})]})}),z.length>0&&e.jsxs("div",{className:"bom-usages-tree",children:[e.jsxs("div",{className:"usages-header",children:[e.jsx("span",{children:"Used in design"}),e.jsxs("span",{className:"usages-count",children:[n.quantity," instance",n.quantity!==1?"s":""]})]}),e.jsx("div",{className:"usage-groups",children:z.map(y=>e.jsx("div",{className:"usage-group",children:y.instances.length>1?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"usage-group-header",onClick:f=>v(y.parentPath,f),children:[e.jsx("span",{className:"usage-expand",children:d.has(y.parentPath)?e.jsx(J,{size:11}):e.jsx(re,{size:11})}),e.jsx("span",{className:"usage-module-name",children:y.parentLabel}),e.jsxs("span",{className:"usage-count-badge",children:["",y.instances.length]})]}),d.has(y.parentPath)&&e.jsx("div",{className:"usage-instances",children:y.instances.map((f,M)=>{const j=Ze(f.path);return e.jsxs("div",{className:"usage-instance",onClick:C=>m(C,f),title:f.path,children:[e.jsx("span",{className:"usage-designator",children:f.designator}),e.jsx("span",{className:"usage-leaf",children:j}),e.jsx(we,{size:9,className:"usage-goto"})]},M)})})]}):e.jsxs("div",{className:"usage-single",onClick:f=>m(f,y.instances[0]),title:y.instances[0].path,children:[e.jsx("span",{className:"usage-designator",children:y.instances[0].designator}),e.jsx("span",{className:"usage-module-path",children:Ze(y.instances[0].path)}),e.jsx(we,{size:10,className:"usage-goto"})]})},y.parentPath))})]})]})]})});function Dt({bomData:s,isLoading:n=!1,error:t=null,onGoToSource:r,projects:l,selectedProjectRoot:c,selectedTargetNames:o,onSelectProject:h,onSelectTarget:d}){const[i,g]=a.useState(""),[m,v]=a.useState(new Set),[z,y]=a.useState(null),[f,M]=a.useState({}),[j,C]=a.useState({}),[N,$]=a.useState(new Set),[P,p]=a.useState(null),[x,u]=a.useState(null),V=a.useRef(0),F=a.useRef(null),B=(o==null?void 0:o[0])??null;a.useEffect(()=>{if(!l||l.length===0){M({});return}let E=!1;return Promise.all(l.map(async L=>{try{const W=(await xe("getBomTargets",{projectRoot:L.root})).result??{},K=Array.isArray(W.targets)?W.targets:[];return[L.root,K]}catch{return[L.root,[]]}})).then(L=>{if(E)return;const q={};for(const[W,K]of L)q[W]=[...K];M(q)}),()=>{E=!0}},[l]);const _=a.useMemo(()=>l?[...l].sort((E,L)=>{var K,te;const q=(((K=f[E.root])==null?void 0:K.length)??0)>0,W=(((te=f[L.root])==null?void 0:te.length)??0)>0;return q!==W?q?-1:1:E.name.localeCompare(L.name)}):[],[l,f]),S=a.useMemo(()=>_.map(E=>{var q,W;const L=(((q=f[E.root])==null?void 0:q.length)??0)>0;return{id:E.root,name:E.name,root:E.root,targets:((W=E.targets)==null?void 0:W.map(K=>({name:K.name})))??[],badge:L?void 0:"no BOM",badgeMuted:!0}}),[_,f]);a.useEffect(()=>{if(!c){p(null),u(null),F.current=null;return}xe("getBuildsByProject",{projectRoot:c,target:B??void 0,limit:1}).then(E=>{const L=E.result??{},q=Array.isArray(L.builds)?L.builds[0]:null;p(q?{build_id:q.build_id,started_at:q.started_at,completed_at:q.completed_at??(q.started_at&&q.duration?q.started_at+q.duration:void 0)}:null)}).catch(E=>{console.warn("Failed to load build info",E),p(null)})},[c,B]),a.useEffect(()=>{if(!(P!=null&&P.build_id))return;const E=P.completed_at??P.started_at;!E||!(Date.now()/1e3-E>24*60*60)||F.current!==P.build_id&&u(P.build_id)},[P]);const T=a.useMemo(()=>{var L;if(!((L=s==null?void 0:s.components)!=null&&L.length))return[];const E=new Set;for(const q of s.components)q.lcsc&&E.add(q.lcsc);return Array.from(E)},[s==null?void 0:s.components]),H=a.useMemo(()=>{var L;if(!((L=s==null?void 0:s.components)!=null&&L.length))return[];const E=new Set;for(const q of s.components)q.lcsc&&(q.unitCost!=null&&q.stock!=null||E.add(q.lcsc));return Array.from(E)},[s==null?void 0:s.components]);a.useEffect(()=>{const E=!!x,L=E?T:H;if(L.length===0)return;const q=E?L:L.filter(K=>!(K in j));if(q.length===0)return;const W=++V.current;$(K=>{const te=new Set(K);for(const R of q)te.add(R);return te}),xe("fetchLcscParts",{lcscIds:q,projectRoot:c??void 0,target:B??void 0}).then(K=>{if(W!==V.current)return;const R=(K.result??{}).parts||{};C(ee=>({...ee,...R}))}).catch(K=>{W===V.current&&console.warn("Failed to fetch LCSC data",K)}).finally(()=>{$(K=>{const te=new Set(K);for(const R of q)te.delete(R);return te}),E&&(P!=null&&P.build_id)&&(F.current=P.build_id,u(null))})},[H,T,j,x,P,c,B]);const U=a.useMemo(()=>s!=null&&s.components?s.components.map(E=>{const L=qt(E);if(!E.lcsc)return L;const q=j[E.lcsc];return L.lcscLoading=N.has(E.lcsc),q&&(L.unitCost==null&&q.unit_cost!=null&&(L.unitCost=q.unit_cost,L.totalCost=q.unit_cost*L.quantity),L.inStock==null&&(L.inStock=q.stock>0,L.stockQuantity=q.stock),!L.description&&q.description&&(L.description=q.description),!L.manufacturer&&q.manufacturer&&(L.manufacturer=q.manufacturer),!L.mpn&&q.mpn&&(L.mpn=q.mpn)),L}):[],[s==null?void 0:s.components,j]),X=(s==null?void 0:s.components)&&s.components.length>0,I=a.useCallback(E=>{v(L=>{const q=new Set(L);return q.has(E)?q.delete(E):q.add(E),q})},[]),Y=a.useCallback(E=>{navigator.clipboard.writeText(E),y(E),setTimeout(()=>y(null),2e3)},[]),ne=a.useCallback((E,L)=>{r?r(E,L):console.log(`Navigate to: ${E}${L?`:${L}`:""}`)},[r]),w=e.jsx("div",{className:"panel-toolbar",children:e.jsxs("div",{className:"panel-toolbar-row",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ue,{size:14}),e.jsx("input",{type:"text",placeholder:"Search value, MPN...",value:i,onChange:E=>g(E.target.value)})]}),e.jsx(_e,{projects:S,selectedProjectRoot:c,selectedTargetName:(o==null?void 0:o[0])||null,onSelectProject:h||(()=>{}),onSelectTarget:d,showAllOption:!1,placeholder:"Select project"})]})}),A=a.useMemo(()=>{const E=i.toLowerCase();return U.filter(L=>{var q,W,K,te;return E?L.value.toLowerCase().includes(E)||((q=L.mpn)==null?void 0:q.toLowerCase().includes(E))||((W=L.lcsc)==null?void 0:W.toLowerCase().includes(E))||((K=L.manufacturer)==null?void 0:K.toLowerCase().includes(E))||((te=L.description)==null?void 0:te.toLowerCase().includes(E)):!0}).sort((L,q)=>(q.totalCost||0)-(L.totalCost||0))},[U,i]),{totalComponents:k,totalCost:D,uniqueParts:O,outOfStock:Z}=a.useMemo(()=>{let E=0,L=0,q=0;for(const W of U)E+=W.quantity,L+=W.totalCost||0,W.inStock===!1&&q++;return{totalComponents:E,totalCost:L,uniqueParts:U.length,outOfStock:q}},[U]),G=(()=>{if(!(s!=null&&s.build_id))return null;const E=s.build_id.match(/^build-(\d+)-/);return E?`#${E[1]}`:s.build_id.substring(0,12)})();if(n)return e.jsxs("div",{className:"bom-panel",children:[w,e.jsxs("div",{className:"bom-loading",children:[e.jsx(Ee,{size:24,className:"loading-spinner"}),e.jsx("span",{children:"Loading BOM..."})]})]});if(t){const E=t.includes("404")||t.includes("not found")||t.includes("Run 'ato build'");return e.jsxs("div",{className:"bom-panel",children:[w,e.jsx("div",{className:"bom-empty-state",children:E?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"empty-title",children:"No BOM data available"}),e.jsx("span",{className:"empty-description",children:"Run a build to generate the Bill of Materials"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{size:24}),e.jsx("span",{children:t})]})})]})}return X?e.jsxs("div",{className:"bom-panel",children:[e.jsxs("div",{className:"bom-summary",children:[e.jsxs("div",{className:"bom-summary-item",children:[e.jsx("span",{className:"summary-value",children:O}),e.jsx("span",{className:"summary-label",children:"unique"})]}),e.jsxs("div",{className:"bom-summary-item",children:[e.jsx("span",{className:"summary-value",children:k}),e.jsx("span",{className:"summary-label",children:"total"})]}),e.jsxs("div",{className:"bom-summary-item primary",children:[e.jsx("span",{className:"summary-value",children:qe(D)}),e.jsx("span",{className:"summary-label",children:"cost"})]}),Z>0&&e.jsxs("div",{className:"bom-summary-item warning",children:[e.jsx(ce,{size:12}),e.jsx("span",{className:"summary-value",children:Z}),e.jsx("span",{className:"summary-label",children:"out of stock"})]}),G&&e.jsxs("div",{className:"bom-summary-item muted",title:`Build: ${s==null?void 0:s.build_id}`,children:[e.jsx("span",{className:"summary-value",children:G}),e.jsx("span",{className:"summary-label",children:"build"})]})]}),w,e.jsxs("div",{className:"bom-list",children:[A.map(E=>e.jsx(_t,{component:E,isExpanded:m.has(E.id),onToggle:()=>I(E.id),onCopy:Y,onGoToSource:ne},E.id)),A.length===0&&e.jsxs("div",{className:"bom-empty",children:[e.jsx(be,{size:24}),e.jsx("span",{children:"No components found"})]})]}),z&&e.jsxs("div",{className:"bom-toast",children:[e.jsx(ie,{size:10}),"Copied: ",z]})]}):e.jsxs("div",{className:"bom-panel",children:[w,e.jsxs("div",{className:"bom-empty-state",children:[e.jsx("span",{className:"empty-title",children:"No BOM data available"}),e.jsx("span",{className:"empty-description",children:"Select a project and run a build to generate the Bill of Materials"})]})]})}function Ht(s){return s==null?"0":s>=1e6?(s/1e6).toFixed(1).replace(/\.0$/,"")+"M":s>=1e3?(s/1e3).toFixed(1).replace(/\.0$/,"")+"k":s.toString()}function Qt(s){if(!s)return"Unknown";try{const n=new Date(s),r=new Date().getTime()-n.getTime(),l=Math.floor(r/(1e3*60*60*24));return l<1?"Today":l===1?"Yesterday":l<7?`${l} days ago`:l<30?`${Math.floor(l/7)} weeks ago`:l<365?`${Math.floor(l/30)} months ago`:n.toLocaleDateString()}catch{return s}}function Ut({package:s,packageDetails:n,isLoading:t,isInstalling:r,installError:l,error:c,onClose:o,onInstall:h,onBuild:d}){var M,j;const i=n,g=(i==null?void 0:i.versions)||((M=s.availableVersions)==null?void 0:M.map(C=>({version:C.version,releasedAt:C.released,requiresAtopile:void 0,size:void 0})))||[],[m,v]=a.useState((i==null?void 0:i.version)||s.version||"");a.useEffect(()=>{i!=null&&i.version&&v(i.version)},[i==null?void 0:i.version]);const z=(i==null?void 0:i.description)||(i==null?void 0:i.summary)||s.description,y=(i==null?void 0:i.installed)??s.installed,f=(i==null?void 0:i.installedVersion)||s.version;return e.jsxs("div",{className:"package-detail-panel",children:[e.jsxs("div",{className:"detail-panel-header",children:[e.jsxs("div",{className:"detail-header-left",children:[e.jsx(be,{size:20,className:"detail-package-icon"}),e.jsxs("div",{className:"detail-header-info",children:[e.jsx("h2",{className:"detail-package-name",children:s.name}),e.jsxs("div",{className:"detail-package-meta",children:[((i==null?void 0:i.version)||s.version)&&e.jsxs("span",{className:"detail-version",children:[e.jsx(et,{size:12}),"v",(i==null?void 0:i.version)||s.version]}),y&&e.jsxs("span",{className:"detail-installed",children:[e.jsx(Zs,{size:12}),"Installed",f?` (v${f})`:""]})]})]})]}),e.jsx("button",{className:"detail-close-btn",onClick:o,children:e.jsx(he,{size:18})})]}),t&&e.jsxs("div",{className:"detail-panel-loading",children:[e.jsx(ge,{size:24,className:"spin"}),e.jsx("span",{children:"Loading package details..."})]}),c&&!t&&e.jsxs("div",{className:"detail-panel-error",children:[e.jsx(de,{size:16}),e.jsx("span",{children:c})]}),e.jsxs("div",{className:"detail-panel-content",children:[z&&e.jsx("section",{className:"detail-section",children:e.jsx("p",{className:"detail-description",children:z})}),e.jsxs("section",{className:"detail-section detail-actions",children:[e.jsxs("div",{className:"detail-install-row",children:[g.length>0?e.jsx("select",{className:"detail-version-select",value:m,onChange:C=>v(C.target.value),children:g.map((C,N)=>e.jsxs("option",{value:C.version,children:["v",C.version,N===0?" (latest)":""]},C.version))}):t?e.jsx("select",{className:"detail-version-select",disabled:!0,children:e.jsx("option",{children:"Loading versions..."})}):e.jsx("select",{className:"detail-version-select",disabled:!0,children:e.jsxs("option",{children:["v",s.version||"unknown"]})}),e.jsx("button",{className:`detail-install-btn ${y?"update":"install"} ${r?"installing":""}`,onClick:()=>h(m||(i==null?void 0:i.version)||s.version||""),disabled:t||r,children:r?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:14,className:"animate-spin"}),"Installing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:14}),y?"Update":"Install"]})}),e.jsxs("button",{className:"detail-build-btn",onClick:()=>d(),title:"Build this package (installs if needed)",disabled:t||r,children:[e.jsx(Ae,{size:14}),"Build"]})]}),l&&e.jsxs("div",{className:"detail-install-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:l})]}),g.length>0&&e.jsxs("div",{className:"detail-version-info",children:[e.jsx(Qs,{size:12}),"Released: ",Qt((j=g.find(C=>C.version===m))==null?void 0:j.releasedAt)]})]}),e.jsxs("section",{className:"detail-section",children:[e.jsxs("h3",{className:"detail-section-title",children:[e.jsx(ye,{size:14}),"Exported Symbols"]}),e.jsx("p",{className:"muted",children:"Symbol introspection coming soon"})]}),e.jsxs("section",{className:"detail-section",children:[e.jsxs("h3",{className:"detail-section-title",children:[e.jsx(ye,{size:14}),"Usage Example"]}),e.jsx("pre",{className:"detail-code-block",children:`from "${s.fullName}/${s.name}.ato" import RP2040

module MyBoard:
    mcu = new RP2040

    # Connect interfaces
    power ~ mcu.power
    i2c ~ mcu.i2c`})]})]}),e.jsxs("div",{className:"detail-panel-footer",children:[e.jsxs("div",{className:"detail-footer-stats",children:[(i==null?void 0:i.publisher)&&e.jsx("span",{className:"footer-stat",children:i.publisher}),i&&e.jsxs("span",{className:"footer-stat",children:[e.jsx(Pe,{size:12}),Ht(i.downloads)]}),(i==null?void 0:i.license)&&e.jsx("span",{className:"footer-stat",children:i.license})]}),s.homepage&&e.jsxs("a",{href:s.homepage,className:"footer-browser-btn",target:"_blank",rel:"noopener",title:"Open in browser",children:[e.jsx(yn,{size:14}),e.jsx("span",{children:"Open"}),e.jsx(we,{size:10})]})]})]})}function Yt(s){if(s<60)return`${Math.floor(s)}s`;const n=Math.floor(s/60),t=Math.floor(s%60);if(n<60)return`${n}m ${t}s`;const r=Math.floor(n/60),l=n%60;return`${r}h ${l}m`}function Ot(s){const n=s.split("/");return n[n.length-1]||s}function Wt(s){if(!s.stages||s.stages.length===0)return null;const n=s.stages.find(r=>r.status==="running");if(n)return{name:n.displayName||n.name,elapsed:n.elapsedSeconds};const t=[...s.stages].reverse().find(r=>r.status==="success"||r.status==="failed"||r.status==="error");return t?{name:t.displayName||t.name}:null}function Kt({build:s,onCancel:n}){const[t,r]=a.useState(s.elapsedSeconds||0);a.useEffect(()=>{if(s.status!=="building"){r(s.elapsedSeconds||0);return}const g=s.startedAt*1e3,m=()=>{r((Date.now()-g)/1e3)};m();const v=setInterval(m,1e3);return()=>clearInterval(v)},[s.status,s.startedAt,s.elapsedSeconds]);const l=Ot(s.projectRoot),c=s.targets.length>0?s.targets.length===1?s.targets[0]:s.targets.join(", "):s.entry||"default",o=Wt(s),h={queued:e.jsx(Fn,{className:"status-icon queued",size:12}),building:e.jsx(ve,{className:"status-icon building",size:12}),success:e.jsx(en,{className:"status-icon success",size:12}),failed:e.jsx(nn,{className:"status-icon failed",size:12}),cancelled:e.jsx(de,{className:"status-icon cancelled",size:12})}[s.status],d=s.status==="building",i=s.status==="queued"||s.status==="building";return e.jsxs("div",{className:`queue-item ${s.status}`,children:[e.jsxs("div",{className:"queue-item-main",children:[h,e.jsxs("div",{className:"queue-item-info",children:[e.jsxs("span",{className:"queue-item-name",title:`${l}:${c}`,children:[l,e.jsxs("span",{className:"queue-item-target",children:[":",c]})]}),o&&s.status==="building"&&e.jsx("span",{className:"queue-item-stage",title:o.name,children:o.name})]}),e.jsxs("div",{className:"queue-item-meta",children:[i&&e.jsxs("span",{className:"queue-item-time",children:[e.jsx(Fe,{size:10}),Yt(t)]}),i&&e.jsx("button",{className:`queue-item-cancel${d?" building":""}`,onClick:n,title:"Cancel build",children:e.jsx(he,{size:12})})]})]}),s.error&&s.status==="failed"&&e.jsxs("div",{className:"queue-item-error",title:s.error,children:[s.error.substring(0,50),"..."]})]})}function Xt({builds:s,onCancelBuild:n}){return s.length===0?e.jsx("div",{className:"queue-empty",children:e.jsx("span",{children:"No active builds"})}):e.jsx("div",{className:"build-queue-panel",children:s.map(t=>e.jsx(Kt,{build:t,onCancel:()=>n(t.buildId)},t.buildId))})}function Je(s,n,t){if(!s||!Array.isArray(s))return;let r=s.find(l=>{if(l.status!=="building"&&l.status!=="queued"||(l.projectName||(l.projectRoot?l.projectRoot.split("/").pop():null))!==n)return!1;const o=l.targets||[];return o.length>0?o.includes(t):l.name===t});return r||(r=s.find(l=>(l.status==="building"||l.status==="queued")&&l.name===t&&(l.projectName===n||l.projectName===null))),r}function Gt(s,n){if(!s||!s.includes(":"))return null;const[t,r]=s.split(":");if(!r)return null;const l=(n||[]).filter(c=>c.entry!==s).map(c=>({name:c.name,type:c.type,path:c.entry,children:[]})).sort((c,o)=>{const h={module:0,component:1,interface:2,parameter:3},d=(h[c.type]||99)-(h[o.type]||99);return d!==0?d:c.name.localeCompare(o.name)});return{name:r,type:"module",path:s,children:l}}function es(s){return s?s==="failed"?"error":s==="interrupted"||s==="building"||s==="queued"?"idle":s:"idle"}function Zt({state:s,selection:n,activeStageFilter:t}){const r=a.useMemo(()=>{var y;return(y=s==null?void 0:s.projects)!=null&&y.length?s.projects.map(f=>{var $,P,p;const M=(($=s.projectModules)==null?void 0:$[f.root])||[],j=f.targets.map(x=>{var S,T,H,U,X,I;const u=Je(s.builds,f.name,x.name),V=Gt(x.entry,M),F=u!=null&&u.stages&&u.stages.length>0?u.stages:null,B=(S=x.lastBuild)==null?void 0:S.stages,_=F||B||[];return{id:x.name,name:x.name,entry:x.entry,status:(u==null?void 0:u.status)==="failed"?"error":(u==null?void 0:u.status)||es((T=x.lastBuild)==null?void 0:T.status),warnings:(u==null?void 0:u.warnings)??((H=x.lastBuild)==null?void 0:H.warnings),errors:(u==null?void 0:u.errors)??((U=x.lastBuild)==null?void 0:U.errors),elapsedSeconds:u==null?void 0:u.elapsedSeconds,duration:(X=x.lastBuild)==null?void 0:X.elapsedSeconds,buildId:u==null?void 0:u.buildId,stages:_.map(Y=>({...Y,status:Y.status==="failed"?"error":Y.status})),symbols:V?[V]:[],queuePosition:u==null?void 0:u.queuePosition,lastBuild:x.lastBuild?{status:es(x.lastBuild.status),timestamp:x.lastBuild.timestamp,elapsedSeconds:x.lastBuild.elapsedSeconds,warnings:x.lastBuild.warnings,errors:x.lastBuild.errors,stages:(I=x.lastBuild.stages)==null?void 0:I.map(Y=>({name:Y.name,displayName:Y.displayName,status:Y.status==="failed"?"error":Y.status,elapsedSeconds:Y.elapsedSeconds}))}:void 0}});let C,N;for(const x of j){const u=x.status!=="idle"?x.status:(P=x.lastBuild)==null?void 0:P.status,V=(p=x.lastBuild)==null?void 0:p.timestamp;u==="error"||u==="failed"?C="error":u==="warning"&&C!=="error"?C="warning":u==="success"&&!C&&(C="success"),V&&(!N||V>N)&&(N=V)}return{id:f.root,name:f.name,type:"project",root:f.root,builds:j,lastBuildStatus:C,lastBuildTimestamp:N}}):[]},[s==null?void 0:s.projects,s==null?void 0:s.builds,s==null?void 0:s.projectModules]),l=a.useMemo(()=>{var y;return(y=s==null?void 0:s.packages)!=null&&y.length?s.packages.filter(f=>f&&f.identifier&&f.name).map(f=>{var $,P;const j=["default","usage"].map(p=>{const x=Je(s.builds,f.name,p);return{id:p,name:p,entry:`${f.name||"unknown"}.ato:${(f.name||"unknown").replace(/-/g,"_")}`,status:(x==null?void 0:x.status)||"idle",buildId:x==null?void 0:x.buildId,elapsedSeconds:x==null?void 0:x.elapsedSeconds,warnings:x==null?void 0:x.warnings,errors:x==null?void 0:x.errors,stages:(x==null?void 0:x.stages)||[],queuePosition:x==null?void 0:x.queuePosition,lastBuild:x&&(x.status==="success"||x.status==="failed"||x.status==="warning")&&x.startedAt?{status:x.status==="failed"?"error":x.status,timestamp:new Date((x.startedAt+(x.elapsedSeconds||0))*1e3).toISOString(),elapsedSeconds:x.elapsedSeconds,warnings:x.warnings||0,errors:x.errors||0}:void 0}});let C,N;for(const p of j){const x=p.status!=="idle"?p.status:($=p.lastBuild)==null?void 0:$.status,u=(P=p.lastBuild)==null?void 0:P.timestamp;x==="error"||x==="failed"?C="error":x==="warning"&&C!=="error"?C="warning":x==="success"&&!C&&(C="success"),u&&(!N||u>N)&&(N=u)}return{id:f.identifier,name:f.name,type:"package",path:`packages/${f.identifier}`,version:f.version||void 0,latestVersion:f.latestVersion,installed:f.installed??!1,installedIn:f.installedIn||[],publisher:f.publisher||void 0,summary:f.summary||f.description||"",description:f.description||f.summary||"",homepage:f.homepage,repository:f.repository,license:f.license,keywords:f.keywords||[],downloads:f.downloads,versionCount:f.versionCount,builds:j,lastBuildStatus:C,lastBuildTimestamp:N}}):[]},[s==null?void 0:s.packages,s==null?void 0:s.builds]),c=[...r,...l];let o=0,h=0;for(const y of c)y.type==="package"?h++:o++;const d=(s==null?void 0:s.queuedBuilds)||[],i=a.useMemo(()=>new Map(c.map(y=>[y.id,y])),[c]),g=(s==null?void 0:s.problems)||[],m=a.useMemo(()=>{const y=s==null?void 0:s.problemFilter,f=j=>j.toLowerCase().replace(/[-_\s]+/g,""),M=(j,C)=>{if(j===C)return!0;const N=f(j),$=f(C);return!!(N===$||N.includes($)||$.includes(N))};return g.filter(j=>{if(t){if(t.stageName&&(!j.stage||!M(t.stageName,j.stage))||t.buildId&&j.buildName&&j.buildName!==t.buildId)return!1;if(t.projectId&&j.projectName){const C=i.get(t.projectId);if(C&&j.projectName!==C.name)return!1}return!0}if(n.type==="project"&&n.projectId){const C=i.get(n.projectId);if(C&&j.projectName&&j.projectName!==C.name)return!1}else if(n.type==="build"&&n.projectId&&n.buildId){const C=i.get(n.projectId);if(C&&j.projectName&&j.projectName!==C.name||j.buildName&&j.buildName!==n.buildId)return!1}return y?!(y.levels&&y.levels.length>0&&!y.levels.includes(j.level)||y.buildNames&&y.buildNames.length>0&&j.buildName&&!y.buildNames.includes(j.buildName)||y.stageIds&&y.stageIds.length>0&&j.stage&&!y.stageIds.includes(j.stage)):!0})},[g,s==null?void 0:s.problemFilter,t,n,i]);let v=0,z=0;for(const y of m)y.level==="error"?v++:y.level==="warning"&&z++;return{projects:c,projectCount:o,packageCount:h,queuedBuilds:d,projectsById:i,problems:g,filteredProblems:m,totalErrors:v,totalWarnings:z}}function Jt({selectedProjectRoot:s,selectedTargetName:n,collapsedSections:t,sectionHeights:r,setSectionHeights:l,setCollapsedSections:c,containerRef:o,action:h}){const d=a.useRef(0),i=a.useRef(0);a.useEffect(()=>{const g=m=>{const v=m.detail;if(!(v!=null&&v.sectionId)||!(v!=null&&v.type))return;const z=v.sectionId;c(y=>{const f=new Set(y);return v.type==="openSection"?f.delete(z):v.type==="closeSection"?f.add(z):v.type==="toggleSection"&&(f.has(z)?f.delete(z):f.add(z)),f})};return window.addEventListener("atopile:ui_action",g),()=>window.removeEventListener("atopile:ui_action",g)},[c]),a.useEffect(()=>{const g=setTimeout(()=>{h("refreshProblems"),h("refreshPackages"),h("refreshStdlib")},100);return()=>clearTimeout(g)},[h]),a.useEffect(()=>{if(!s){se.getState().setBomData(null),se.getState().setBomError(null);return}if(!n)return;const g=++d.current;se.getState().setLoadingBom(!0),se.getState().setBomError(null),h("refreshBOM",{projectRoot:s,target:n,requestId:g})},[s,n]),a.useEffect(()=>{if(!s){se.getState().setVariablesData(null),se.getState().setVariablesError(null);return}if(!n)return;const g=++i.current;se.getState().setLoadingVariables(!0),se.getState().setVariablesError(null),h("fetchVariables",{projectRoot:s,target:n,requestId:g})},[s,n]),a.useEffect(()=>{const g=new Map,m=v=>{var y,f;const z=v.detail;if((z==null?void 0:z.action)==="installPackage"){const M=(y=z.payload)==null?void 0:y.packageId;if(z.result&&!z.result.success&&z.result.error){if(M){se.getState().setInstallError(M,z.result.error);const j=g.get(M);j&&(clearTimeout(j),g.delete(M))}}else if((f=z.result)!=null&&f.success&&M){const j=g.get(M);j&&clearTimeout(j);const C=setTimeout(()=>{se.getState().installingPackageIds.includes(M)&&(console.log("[install-debug] Timeout fallback: clearing stuck package:",M),se.getState().removeInstallingPackage(M)),g.delete(M)},6e4);g.set(M,C)}}};return window.addEventListener("atopile:action_result",m),()=>{window.removeEventListener("atopile:action_result",m),g.forEach(v=>clearTimeout(v)),g.clear()}},[]),a.useEffect(()=>{const g=se.subscribe((m,v)=>{const z=m.installingPackageIds;z.length!==0&&m.packages!==v.packages&&m.packages&&z.forEach(y=>{const f=m.packages.find(M=>M.identifier===y);f!=null&&f.installed&&se.getState().removeInstallingPackage(y)})});return()=>g()},[]),a.useEffect(()=>{const g=o.current;if(!g)return;const m=["projects","packages","problems","stdlib","variables","bom"];let v=null;const z=()=>{const j=g.clientHeight;let C=0,N=null;for(const P of m){if(t.has(P))continue;const p=g.querySelector(`[data-section-id="${P}"]`);if(!p)continue;const x=p.querySelector(".section-body"),u=p.querySelector(".section-title-bar");if(u&&(C+=u.offsetHeight),x){const F=x.offsetHeight,B=x.scrollHeight;C+=F,B>F+5&&!N&&(N={id:P,neededHeight:B-F,currentHeight:p.offsetHeight})}const V=p.querySelector(".section-resize-handle");V&&(C+=V.offsetHeight),C+=1}const $=j-C;if($>20&&N){const P=Math.min($,N.neededHeight),p=N.currentHeight+P,x=r[N.id];(!x||Math.abs(x-p)>5)&&l(u=>({...u,[N.id]:p}))}},y=()=>{v!==null&&clearTimeout(v),v=setTimeout(z,100)},f=setTimeout(z,150),M=new ResizeObserver(y);return M.observe(g),()=>{clearTimeout(f),v!==null&&clearTimeout(v),M.disconnect()}},[t,r,l,o])}function ea({projects:s,state:n,sectionHeights:t,setSectionHeights:r,setCollapsedSections:l,setSelection:c,setSelectedPackage:o,setActiveStageFilter:h,action:d}){const i=a.useRef(null),g=a.useRef(0),m=a.useRef(0),v=a.useRef(null),z=w=>{l(A=>{const k=new Set(A);return k.has(w)?k.delete(w):k.add(w),k})},y=w=>{if(c(w),w.type==="project"||w.type==="build"||w.type==="symbol"){const A=s.find(D=>D.id===w.projectId),k=(A==null?void 0:A.root)||(A==null?void 0:A.path);k&&(se.getState().setSelectedTargets([]),d("setSelectedTargets",{targetNames:[]}),d("selectProject",{projectRoot:k}))}},f=w=>{se.getState().selectProject(w),se.getState().setSelectedTargets([]),d("selectProject",{projectRoot:w}),d("setSelectedTargets",{targetNames:[]})},M=(w,A)=>{se.getState().selectProject(w),se.getState().setSelectedTargets([A]),d("selectProject",{projectRoot:w}),d("setSelectedTargets",{targetNames:[A]})},j=(w,A,k)=>{d("build",{level:w,id:A,label:k})},C=w=>{d("cancelBuild",{buildId:w})},N=w=>{d("cancelBuild",{buildId:w})},$=(w,A,k)=>{h({stageName:w||void 0,buildId:A,projectId:k}),l(D=>{const O=new Set(D);return O.delete("problems"),O})},P=()=>{h(null)},p=w=>{o(w),d("getPackageDetails",{packageId:w.fullName})},x=(w,A,k)=>{se.getState().addInstallingPackage(w),d("installPackage",{packageId:w,projectRoot:A,version:k})},u=(w,A)=>{d("createProject",{parentDirectory:w,name:A})},V=w=>{var O,Z,G;const A=(O=n==null?void 0:n.projectModules)==null?void 0:O[w];w&&(!A||A.length===0)&&d("fetchModules",{projectRoot:w});const k=(Z=n==null?void 0:n.projectFiles)==null?void 0:Z[w];w&&(!k||k.length===0)&&d("fetchFiles",{projectRoot:w});const D=(G=n==null?void 0:n.projectDependencies)==null?void 0:G[w];w&&(!D||D.length===0)&&d("fetchDependencies",{projectRoot:w})},F=(w,A)=>{d("openSource",{projectId:w,entry:A})},B=(w,A)=>{d("openKiCad",{projectId:w,buildId:A})},_=(w,A)=>{d("openLayout",{projectId:w,buildId:A})},S=(w,A)=>{d("open3D",{projectId:w,buildId:A})},T=async w=>{var L,q,W,K,te;const A=((L=n==null?void 0:n.projectModules)==null?void 0:L[w])||[],k=A.find(R=>R.name==="App"||R.type==="module")||A[0],D=(k==null?void 0:k.entry)||"main.ato:App",O=((W=(q=n==null?void 0:n.projects)==null?void 0:q.find(R=>R.root===w))==null?void 0:W.targets)||[],Z=new Set(O.map(R=>R.name));let G="new-build",E=1;for(;Z.has(G);)G=`new-build-${E}`,E++;try{const R=await xe("addBuildTarget",{project_root:w,name:G,entry:D});(K=R.result)!=null&&K.success?d("refreshProjects"):console.error("Failed to add build target:",(te=R.result)==null?void 0:te.message)}catch(R){console.error("Failed to add build target:",R)}},H=async(w,A,k)=>{var G,E;const D=A,O=k.name!==D?k.name:void 0,Z=k.entry;try{const L=await xe("updateBuildTarget",{project_root:w,old_name:D,new_name:O,new_entry:Z});(G=L.result)!=null&&G.success?d("refreshProjects"):console.error("Failed to update build target:",(E=L.result)==null?void 0:E.message)}catch(L){console.error("Failed to update build target:",L)}},U=async(w,A)=>{var k,D;try{const O=await xe("deleteBuildTarget",{project_root:w,name:A});(k=O.result)!=null&&k.success?d("refreshProjects"):console.error("Failed to delete build target:",(D=O.result)==null?void 0:D.message)}catch(O){console.error("Failed to delete build target:",O)}},X=async(w,A,k)=>{var D,O;try{const Z=await xe("updateDependencyVersion",{project_root:w,identifier:A,new_version:k});(D=Z.result)!=null&&D.success?d("fetchDependencies",{projectRoot:w}):console.error("Failed to update dependency version:",(O=Z.result)==null?void 0:O.message)}catch(Z){console.error("Failed to update dependency version:",Z)}},I=a.useCallback(w=>{i.current&&(v.current!==null&&cancelAnimationFrame(v.current),v.current=requestAnimationFrame(()=>{const A=w.clientY-g.current,k=Math.max(100,m.current+A);r(D=>({...D,[i.current]:k})),v.current=null}))},[r]),Y=a.useCallback(()=>{v.current!==null&&(cancelAnimationFrame(v.current),v.current=null),i.current=null,document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",Y)},[I]),ne=a.useCallback((w,A)=>{if(A.preventDefault(),i.current=w,g.current=A.clientY,t[w])m.current=t[w];else{const k=A.target.closest(".collapsible-section");m.current=k?k.getBoundingClientRect().height:200}document.addEventListener("mousemove",I),document.addEventListener("mouseup",Y)},[t,I,Y]);return{toggleSection:z,handleSelect:y,handleBuild:j,handleCancelBuild:C,handleCancelQueuedBuild:N,handleStageFilter:$,clearStageFilter:P,handleOpenPackageDetail:p,handlePackageInstall:x,handleCreateProject:u,handleProjectExpand:V,handleOpenSource:F,handleOpenKiCad:B,handleOpenLayout:_,handleOpen3D:S,handleAddBuild:T,handleUpdateBuild:H,handleDeleteBuild:U,handleDependencyVersionChange:X,handleSelectProject:f,handleSelectTarget:M,handleResizeStart:ne}}const ys="atopile-theme-preference";function Te(){if(typeof window>"u")return"system";const s=localStorage.getItem(ys);return s==="dark"||s==="light"||s==="system"?s:"system"}function Be(){return typeof window>"u"?"dark":window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}function sa(){const[s,n]=a.useState(Te),[t,r]=a.useState(()=>{const o=Te();return o==="system"?Be():o}),l=a.useCallback(o=>{document.documentElement.setAttribute("data-theme",o);const d=o==="system"?Be():o;r(d)},[]),c=a.useCallback(o=>{n(o),localStorage.setItem(ys,o),l(o)},[l]);return a.useEffect(()=>{l(s)},[l,s]),a.useEffect(()=>{if(s!=="system")return;const o=window.matchMedia("(prefers-color-scheme: light)"),h=()=>{r(Be())};return o.addEventListener("change",h),()=>o.removeEventListener("change",h)},[s]),{theme:s,resolvedTheme:t,setTheme:c,isDark:t==="dark",isLight:t==="light"}}function na(){if(typeof window>"u")return;const s=Te();document.documentElement.setAttribute("data-theme",s)}const le=(s,n)=>{if(s==="openUrl"&&n&&"url"in n){const t=n.url;if(t){window.open(t,"_blank","noopener,noreferrer");return}}ss(s,n)};function ta({logoUri:s,version:n,atopile:t,developerMode:r}){var _,S,T,H,U,X;const[l,c]=a.useState(!1),o=a.useRef(null),{theme:h,setTheme:d}=sa(),i=typeof navigator<"u"&&navigator.hardwareConcurrency||4,[g,m]=a.useState(!0),[v,z]=a.useState(i),[y,f]=a.useState(i),[M,j]=a.useState(""),[C,N]=a.useState(!1),$=a.useRef(null),[P,p]=a.useState({isValidating:!1,valid:null,version:null,error:null}),x=a.useRef(null),[u,V]=a.useState({type:null,value:null}),F=(((_=t==null?void 0:t.availableVersions)==null?void 0:_.length)??0)===0;a.useEffect(()=>{if(u.type==="version"&&(t==null?void 0:t.currentVersion)===u.value){V({type:null,value:null});return}if(u.type==="branch"&&(t==null?void 0:t.branch)===u.value){V({type:null,value:null});return}if(u.type!==null){const I=setTimeout(()=>{V({type:null,value:null})},6e4);return()=>clearTimeout(I)}},[t==null?void 0:t.currentVersion,t==null?void 0:t.branch,u]),a.useEffect(()=>{F&&(t==null?void 0:t.source)==="release"&&(V({type:null,value:null}),le("setAtopileSource",{source:"branch"}))},[F,t==null?void 0:t.source]);const B=(t==null?void 0:t.isInstalling)||u.type!==null;return a.useEffect(()=>{if(!l)return;const I=Y=>{o.current&&!o.current.contains(Y.target)&&c(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[l]),a.useEffect(()=>{l&&le("getMaxConcurrentSetting")},[l]),a.useEffect(()=>{if(!C)return;const I=Y=>{$.current&&!$.current.contains(Y.target)&&N(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[C]),a.useEffect(()=>{if((t==null?void 0:t.source)!=="local"||!(t!=null&&t.localPath)){p({isValidating:!1,valid:null,version:null,error:null});return}return x.current&&clearTimeout(x.current),p(I=>({...I,isValidating:!0})),x.current=setTimeout(()=>{le("validateAtopilePath",{path:t.localPath})},500),()=>{x.current&&clearTimeout(x.current)}},[t==null?void 0:t.source,t==null?void 0:t.localPath]),a.useEffect(()=>{const I=Y=>{const ne=Y.detail,w=ne==null?void 0:ne.result;w!=null&&w.setting&&(m(w.setting.use_default),z(w.setting.custom_value||w.setting.default_value),f(w.setting.default_value)),(ne==null?void 0:ne.action)==="validateAtopilePath"&&w&&p({isValidating:!1,valid:w.valid??!1,version:w.version??null,error:w.error??null})};return window.addEventListener("atopile:action_result",I),()=>window.removeEventListener("atopile:action_result",I)},[]),e.jsxs("div",{className:"panel-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("img",{className:"logo",src:s||Et,alt:"atopile"}),e.jsx("span",{children:"atopile"}),n&&e.jsxs("span",{className:"version-badge",children:["v",n]})]}),e.jsx("div",{className:"header-actions",children:e.jsxs("div",{className:"settings-dropdown-container",ref:o,children:[e.jsx("button",{className:`icon-btn${l?" active":""}`,onClick:()=>c(!l),title:"Settings",children:e.jsx(On,{size:14})}),l&&e.jsxs("div",{className:"settings-dropdown",children:[(t==null?void 0:t.error)&&e.jsxs("div",{className:"settings-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:t.error})]}),F&&e.jsxs("div",{className:"settings-error",children:[e.jsx(de,{size:12}),e.jsx("span",{children:"No compatible release found. Select a branch or local install."})]}),e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Source"})}),e.jsxs("div",{className:"settings-source-buttons",children:[e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="release"?" active":""}${F?" disabled":""}`,onClick:()=>{F||(V({type:null,value:null}),le("setAtopileSource",{source:"release"}))},title:"Use a released version from PyPI",disabled:F,children:[e.jsx(be,{size:12}),"Release"]}),e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="branch"?" active":""}`,onClick:()=>{V({type:null,value:null}),le("setAtopileSource",{source:"branch"})},title:"Use a git branch from GitHub",children:[e.jsx(Ke,{size:12}),"Branch"]}),e.jsxs("button",{className:`source-btn${(t==null?void 0:t.source)==="local"?" active":""}`,onClick:()=>{V({type:null,value:null}),le("setAtopileSource",{source:"local"})},title:"Use a local installation",children:[e.jsx(Ie,{size:12}),"Local"]})]})]}),(t==null?void 0:t.source)==="release"&&!F&&e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Version"})}),e.jsxs("div",{className:"settings-select-wrapper",children:[e.jsx("select",{className:"settings-select",value:(t==null?void 0:t.currentVersion)||"",onChange:I=>{const Y=I.target.value;Y!==(t==null?void 0:t.currentVersion)&&V({type:"version",value:Y}),le("setAtopileVersion",{version:Y})},children:((t==null?void 0:t.availableVersions)||[]).slice(0,20).map(I=>{var Y;return e.jsxs("option",{value:I,children:[I,I===((Y=t==null?void 0:t.availableVersions)==null?void 0:Y[0])?" (latest)":""]},I)})}),e.jsx(J,{size:12,className:"select-chevron"})]}),B&&e.jsxs("div",{className:"install-status",children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:((S=t==null?void 0:t.installProgress)==null?void 0:S.message)||(u.type==="version"?`Installing v${u.value}...`:"Installing...")}),e.jsx("button",{className:"install-cancel-btn",onClick:()=>{V({type:null,value:null}),le("setAtopileInstalling",{installing:!1})},title:"Cancel installation",children:e.jsx(he,{size:10})})]})]}),(t==null?void 0:t.source)==="branch"&&e.jsxs("div",{className:"settings-group",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Branch"})}),e.jsxs("div",{className:"branch-search-container",ref:$,children:[e.jsxs("div",{className:"branch-search-input-wrapper",children:[e.jsx(ue,{size:12,className:"branch-search-icon"}),e.jsx("input",{type:"text",className:"branch-search-input",placeholder:"Search branches...",value:M,onChange:I=>{j(I.target.value),N(!0)},onFocus:()=>N(!0)}),(t==null?void 0:t.branch)&&!M&&e.jsx("span",{className:"branch-current-value",children:t.branch})]}),C&&e.jsxs("div",{className:"branch-dropdown",children:[((t==null?void 0:t.availableBranches)||["main","develop"]).filter(I=>!M||I.toLowerCase().includes(M.toLowerCase())).slice(0,15).map(I=>e.jsxs("button",{className:`branch-option${I===(t==null?void 0:t.branch)?" active":""}`,onClick:()=>{I!==(t==null?void 0:t.branch)&&V({type:"branch",value:I}),le("setAtopieBranch",{branch:I}),j(""),N(!1)},children:[e.jsx(Ke,{size:12}),e.jsx("span",{children:I}),I==="main"&&e.jsx("span",{className:"branch-tag",children:"default"})]},I)),M&&!((t==null?void 0:t.availableBranches)||[]).some(I=>I.toLowerCase().includes(M.toLowerCase()))&&e.jsxs("div",{className:"branch-no-results",children:['No branches match "',M,'"']})]})]}),e.jsxs("span",{className:"settings-hint",children:["Installs from git+https://github.com/atopile/atopile.git@",(t==null?void 0:t.branch)||"main"]}),B&&e.jsxs("div",{className:"install-status",children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:((T=t==null?void 0:t.installProgress)==null?void 0:T.message)||(u.type==="branch"?`Installing ${u.value}...`:"Installing...")}),e.jsx("button",{className:"install-cancel-btn",onClick:()=>{V({type:null,value:null}),le("setAtopileInstalling",{installing:!1})},title:"Cancel installation",children:e.jsx(he,{size:10})})]})]}),(t==null?void 0:t.source)==="local"&&e.jsxs("div",{className:"settings-group local-path-section",children:[e.jsx("label",{className:"settings-label",children:e.jsx("span",{className:"settings-label-title",children:"Local Path"})}),(((H=t==null?void 0:t.detectedInstallations)==null?void 0:H.length)??0)>0&&e.jsxs("div",{className:"detected-installations",children:[e.jsx("span",{className:"detected-label",children:"Detected:"}),(U=t==null?void 0:t.detectedInstallations)==null?void 0:U.map((I,Y)=>e.jsxs("button",{className:`detected-item${(t==null?void 0:t.localPath)===I.path?" active":""}`,onClick:()=>le("setAtopileLocalPath",{path:I.path}),title:I.path,children:[e.jsx("span",{className:"detected-source",children:I.source}),I.version&&e.jsxs("span",{className:"detected-version",children:["v",I.version]})]},Y))]}),e.jsxs("div",{className:"settings-path-input",children:[e.jsx("input",{type:"text",className:`settings-input${P.valid===!0?" valid":""}${P.valid===!1?" invalid":""}`,placeholder:"/path/to/atopile or ato",value:(t==null?void 0:t.localPath)||"",onChange:I=>{le("setAtopileLocalPath",{path:I.target.value})}}),e.jsx("button",{className:"path-browse-btn",onClick:()=>le("browseAtopilePath"),title:"Browse...",children:e.jsx(Ie,{size:12})})]}),(t==null?void 0:t.localPath)&&e.jsx("div",{className:`path-validation-status${P.valid===!0?" valid":""}${P.valid===!1?" invalid":""}`,children:P.isValidating?e.jsxs(e.Fragment,{children:[e.jsx(ge,{size:12,className:"spinner"}),e.jsx("span",{children:"Validating..."})]}):P.valid===!0?e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:12}),e.jsxs("span",{children:["Found atopile",P.version?` v${P.version}`:""]})]}):P.valid===!1?e.jsxs(e.Fragment,{children:[e.jsx(he,{size:12}),e.jsx("span",{children:P.error||"Invalid path"})]}):null})]}),!(t!=null&&t.isInstalling)&&(t==null?void 0:t.currentVersion)&&e.jsxs("div",{className:"settings-status",children:[e.jsx(ie,{size:12,className:"status-ok"}),e.jsx("span",{children:t.source==="local"?`Using local: ${((X=t.localPath)==null?void 0:X.split("/").pop())||"atopile"}`:`v${t.currentVersion} installed`})]}),e.jsx("div",{className:"settings-divider"}),e.jsx("div",{className:"settings-group",children:e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label-title",children:"Theme"}),e.jsx("div",{className:"settings-inline-control",children:e.jsxs("div",{className:"theme-toggle-group",children:[e.jsx("button",{className:`theme-btn${h==="system"?" active":""}`,onClick:()=>d("system"),title:"Follow system preference",children:e.jsx($n,{size:12})}),e.jsx("button",{className:`theme-btn${h==="light"?" active":""}`,onClick:()=>d("light"),title:"Light theme",children:e.jsx(Zn,{size:12})}),e.jsx("button",{className:`theme-btn${h==="dark"?" active":""}`,onClick:()=>d("dark"),title:"Dark theme",children:e.jsx(In,{size:12})})]})})]})}),e.jsx("div",{className:"settings-group",children:e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label-title",children:"Parallel builds"}),e.jsx("div",{className:"settings-inline-control",children:g?e.jsxs("button",{className:"settings-value-btn",onClick:()=>m(!1),title:"Click to set custom limit",children:["Auto (",y,")"]}):e.jsxs("div",{className:"settings-custom-input",children:[e.jsx("input",{type:"number",className:"settings-input small",min:1,max:32,value:v,onChange:I=>{const Y=Math.max(1,Math.min(32,parseInt(I.target.value)||1));z(Y),le("setMaxConcurrentSetting",{useDefault:!1,customValue:Y})}}),e.jsx("button",{className:"settings-reset-btn",onClick:()=>{m(!0),le("setMaxConcurrentSetting",{useDefault:!0,customValue:null})},title:"Reset to auto",children:"Auto"})]})})]})}),e.jsx("div",{className:"settings-divider"}),e.jsx("div",{className:"settings-section-header",children:"Developer"}),e.jsxs("div",{className:"settings-group",children:[e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label-title",children:"Show all problems"}),e.jsx("div",{className:"settings-inline-control",children:e.jsxs("label",{className:"settings-toggle",children:[e.jsx("input",{type:"checkbox",checked:r||!1,onChange:I=>le("setDeveloperMode",{enabled:I.target.checked})}),e.jsx("span",{className:"settings-toggle-slider"})]})})]}),e.jsx("div",{className:"settings-hint",children:"Show internal developer messages in Problems panel"})]})]})]})})]})}const pe=(s,n)=>{if(s==="openUrl"&&n&&"url"in n){const t=n.url;if(t){window.open(t,"_blank","noopener,noreferrer");return}}ss(s,n)};function aa(){var x,u,V,F,B,_;const s=se(S=>S),n=(s==null?void 0:s.selectedProjectRoot)??null,t=(s==null?void 0:s.selectedTargetNames)??[],r=a.useMemo(()=>{var T,H,U;if(!n)return null;if(t.length>0)return t[0];const S=(T=s==null?void 0:s.projects)==null?void 0:T.find(X=>X.root===n);return((U=(H=S==null?void 0:S.targets)==null?void 0:H[0])==null?void 0:U.name)??null},[n,t,s==null?void 0:s.projects]),[l,c]=a.useState({type:"none"}),[o,h]=a.useState(new Set(["buildQueue","problems","stdlib","variables","bom"])),[d,i]=a.useState({}),[g,m]=a.useState(null),[v,z]=a.useState(null),y=a.useRef(null),{projects:f,projectCount:M,packageCount:j,queuedBuilds:C,filteredProblems:N,totalErrors:$,totalWarnings:P}=Zt({state:s,selection:l,activeStageFilter:v});Jt({selectedProjectRoot:n,selectedTargetName:r,collapsedSections:o,sectionHeights:d,setSectionHeights:i,setCollapsedSections:h,containerRef:y,action:pe});const p=ea({projects:f,state:s,sectionHeights:d,setSectionHeights:i,setCollapsedSections:h,setSelection:c,setSelectedPackage:m,setActiveStageFilter:z,action:pe});return s?e.jsxs("div",{className:`unified-layout ${g?"package-detail-open":""}`,children:[e.jsx(ta,{logoUri:s==null?void 0:s.logoUri,version:s==null?void 0:s.version,atopile:s==null?void 0:s.atopile,developerMode:s==null?void 0:s.developerMode}),e.jsxs("div",{className:"panel-sections",ref:y,children:[e.jsx(je,{id:"projects",title:"Projects",badge:M,loading:s==null?void 0:s.isLoadingProjects,collapsed:o.has("projects"),onToggle:()=>p.toggleSection("projects"),height:d.projects,maxHeight:d.projects?void 0:350,onResizeStart:S=>p.handleResizeStart("projects",S),children:e.jsx(Xe,{selection:l,onSelect:p.handleSelect,onBuild:p.handleBuild,onCancelBuild:p.handleCancelBuild,onStageFilter:p.handleStageFilter,onCreateProject:p.handleCreateProject,onProjectExpand:p.handleProjectExpand,onOpenSource:p.handleOpenSource,onOpenKiCad:p.handleOpenKiCad,onOpenLayout:p.handleOpenLayout,onOpen3D:p.handleOpen3D,onFileClick:(S,T)=>{const H=f.find(U=>U.id===S);if(H){const U=`${H.root}/${T}`;pe("openFile",{file:U})}},onAddBuild:p.handleAddBuild,onUpdateBuild:p.handleUpdateBuild,onDeleteBuild:p.handleDeleteBuild,filterType:"projects",projects:f,projectModules:(s==null?void 0:s.projectModules)||{},projectFiles:(s==null?void 0:s.projectFiles)||{},projectDependencies:(s==null?void 0:s.projectDependencies)||{},onDependencyVersionChange:p.handleDependencyVersionChange,onRemoveDependency:(S,T)=>{pe("removePackage",{projectRoot:S,packageId:T})}})}),e.jsx(je,{id:"buildQueue",title:"Build Queue",badge:C.length>0?C.length:void 0,badgeType:"count",collapsed:o.has("buildQueue"),onToggle:()=>p.toggleSection("buildQueue"),height:o.has("buildQueue")?void 0:d.buildQueue,onResizeStart:S=>p.handleResizeStart("buildQueue",S),children:e.jsx(Xt,{builds:C,onCancelBuild:p.handleCancelQueuedBuild})}),e.jsx(je,{id:"packages",title:"Packages",badge:j,loading:s==null?void 0:s.isLoadingPackages,warningMessage:(s==null?void 0:s.packagesError)||null,collapsed:o.has("packages"),onToggle:()=>p.toggleSection("packages"),height:d.packages,maxHeight:d.packages?void 0:350,onResizeStart:S=>p.handleResizeStart("packages",S),children:e.jsx(Xe,{selection:l,onSelect:p.handleSelect,onBuild:p.handleBuild,onCancelBuild:p.handleCancelBuild,onStageFilter:p.handleStageFilter,onOpenPackageDetail:p.handleOpenPackageDetail,onPackageInstall:p.handlePackageInstall,onOpenSource:p.handleOpenSource,onOpenKiCad:p.handleOpenKiCad,onOpenLayout:p.handleOpenLayout,onOpen3D:p.handleOpen3D,filterType:"packages",projects:f,installingPackageIds:s==null?void 0:s.installingPackageIds})}),e.jsx(je,{id:"problems",title:v?`Problems: ${v.stageName||v.buildId||"Filtered"}`:"Problems",badge:v?N.length:$+P,badgeType:v?"filter":"count",errorCount:v?void 0:$,warningCount:v?void 0:P,collapsed:o.has("problems"),onToggle:()=>p.toggleSection("problems"),onClearFilter:v?p.clearStageFilter:void 0,height:o.has("problems")?void 0:d.problems,onResizeStart:S=>p.handleResizeStart("problems",S),children:e.jsx(At,{problems:N,projects:((x=s==null?void 0:s.projects)==null?void 0:x.map(S=>({id:S.root,name:S.name,root:S.root})))||[],selectedProjectRoot:n,onSelectProject:p.handleSelectProject,onProblemClick:S=>{pe("openFile",{file:S.file,line:S.line,column:S.column})}})}),e.jsx(je,{id:"stdlib",title:"Standard Library",badge:((u=s==null?void 0:s.stdlibItems)==null?void 0:u.length)||0,collapsed:o.has("stdlib"),onToggle:()=>p.toggleSection("stdlib"),height:o.has("stdlib")?void 0:d.stdlib,onResizeStart:S=>p.handleResizeStart("stdlib",S),children:e.jsx(zt,{items:s==null?void 0:s.stdlibItems,isLoading:s==null?void 0:s.isLoadingStdlib,onRefresh:()=>pe("refreshStdlib")})}),e.jsx(je,{id:"variables",title:"Variables",badge:(()=>{const S=s==null?void 0:s.currentVariablesData;if(!(S!=null&&S.nodes))return 0;const T=H=>{var X;let U=0;for(const I of H)U+=((X=I.variables)==null?void 0:X.length)||0,I.children&&(U+=T(I.children));return U};return T(S.nodes)})(),collapsed:o.has("variables"),onToggle:()=>p.toggleSection("variables"),height:o.has("variables")?void 0:d.variables,onResizeStart:S=>p.handleResizeStart("variables",S),children:e.jsx(Vt,{variablesData:s==null?void 0:s.currentVariablesData,isLoading:s==null?void 0:s.isLoadingVariables,error:s==null?void 0:s.variablesError,projects:s==null?void 0:s.projects,selectedProjectRoot:s==null?void 0:s.selectedProjectRoot,selectedTargetNames:s==null?void 0:s.selectedTargetNames,onSelectProject:p.handleSelectProject,onSelectTarget:p.handleSelectTarget})}),e.jsx(je,{id:"bom",title:"BOM",badge:((F=(V=s==null?void 0:s.bomData)==null?void 0:V.components)==null?void 0:F.length)??0,warningCount:(B=s==null?void 0:s.bomData)!=null&&B.components?s.bomData.components.filter(S=>S.stock!==null&&S.stock===0).length:0,collapsed:o.has("bom"),onToggle:()=>p.toggleSection("bom"),height:o.has("bom")?void 0:d.bom,onResizeStart:S=>p.handleResizeStart("bom",S),children:e.jsx(Dt,{bomData:s==null?void 0:s.bomData,isLoading:s==null?void 0:s.isLoadingBom,error:s==null?void 0:s.bomError,projects:s==null?void 0:s.projects,selectedProjectRoot:s==null?void 0:s.selectedProjectRoot,selectedTargetNames:s==null?void 0:s.selectedTargetNames,onSelectProject:p.handleSelectProject,onSelectTarget:p.handleSelectTarget,onGoToSource:(S,T)=>{pe("openFile",{file:S,line:T})}})})]}),g&&e.jsx("div",{className:"detail-panel-container",children:e.jsx(Ut,{package:g,packageDetails:(s==null?void 0:s.selectedPackageDetails)||null,isLoading:(s==null?void 0:s.isLoadingPackageDetails)||!1,isInstalling:((_=s==null?void 0:s.installingPackageIds)==null?void 0:_.includes(g.fullName))||!1,installError:(s==null?void 0:s.installError)||null,error:(s==null?void 0:s.packageDetailsError)||null,onClose:()=>{m(null),pe("clearPackageDetails")},onInstall:S=>{var H,U;const T=(s==null?void 0:s.selectedProjectRoot)||((U=(H=s==null?void 0:s.projects)==null?void 0:H[0])==null?void 0:U.root);T&&(se.getState().addInstallingPackage(g.fullName),pe("installPackage",{packageId:g.fullName,projectRoot:T,version:S}))},onBuild:S=>{var H,U;const T=(s==null?void 0:s.selectedProjectRoot)||((U=(H=s==null?void 0:s.projects)==null?void 0:H[0])==null?void 0:U.root);T&&pe("buildPackage",{packageId:g.fullName,projectRoot:T,entry:S})}})})]}):e.jsx("div",{className:"sidebar loading",children:"Loading..."})}na();Es.createRoot(document.getElementById("root")).render(e.jsx($s.StrictMode,{children:e.jsx(Bs,{children:e.jsx(aa,{})})}));
